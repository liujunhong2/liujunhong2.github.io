<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>algorithm</title>
    <url>/algorithm.html</url>
    <content><![CDATA[<!--more-->
<h1 id="PDFä¸‹è½½"><a href="#PDFä¸‹è½½" class="headerlink" title="PDFä¸‹è½½"></a>PDFä¸‹è½½</h1><p><a href="/pdfs/algorithm.pdf">ğŸ“¥ ä¸‹è½½ç…®æ³¢åŒæ¬¾PDF</a>.</p>
<h1 id="ç®—æ³•æ±‡æ€»"><a href="#ç®—æ³•æ±‡æ€»" class="headerlink" title="ç®—æ³•æ±‡æ€»"></a>ç®—æ³•æ±‡æ€»</h1><h2 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h2><h3 id="å»ºå›¾"><a href="#å»ºå›¾" class="headerlink" title="å»ºå›¾"></a>å»ºå›¾</h3><p>ä¸‰ç§å»ºå›¾æ–¹å¼</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">11</span>; <span class="comment">// æœ€å¤§ç‚¹æ•°</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">21</span>; <span class="comment">// æœ€å¤§è¾¹æ•°ï¼ˆæ— å‘å›¾éœ€ 2 å€ï¼‰</span></span><br><span class="line"><span class="comment">// é‚»æ¥çŸ©é˜µ</span></span><br><span class="line"><span class="type">int</span> graph1[MAXN][MAXN];</span><br><span class="line"><span class="comment">// é‚»æ¥è¡¨</span></span><br><span class="line">vector&lt;vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt;&gt; graph2;</span><br><span class="line"><span class="comment">// é“¾å¼å‰å‘æ˜Ÿ</span></span><br><span class="line"><span class="type">int</span> head[MAXN], nxt[MAXM], to[MAXM], weight[MAXM], cnt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ¸…ç©ºé‚»æ¥çŸ©é˜µ</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">            graph1[i][j] = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// æ¸…ç©ºé‚»æ¥è¡¨</span></span><br><span class="line">    graph2.<span class="built_in">clear</span>();</span><br><span class="line">    graph2.<span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// æ¸…ç©ºé“¾å¼å‰å‘æ˜Ÿ</span></span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">0</span>, <span class="built_in">sizeof</span>(head));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">    nxt[ ++cnt] = head[u];</span><br><span class="line">    to[cnt] = v;</span><br><span class="line">    weight[cnt] = w;</span><br><span class="line">    head[u] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æœ‰å‘</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">directGraph</span><span class="params">(<span class="type">const</span> vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&amp; edges)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span>&amp; edge : edges) &#123;</span><br><span class="line">        graph1[edge[<span class="number">0</span>]][edge[<span class="number">1</span>]] = edge[<span class="number">2</span>];</span><br><span class="line">        graph2[edge[<span class="number">0</span>]].<span class="built_in">emplace_back</span>(edge[<span class="number">1</span>], edge[<span class="number">2</span>]);</span><br><span class="line">        <span class="built_in">addEdge</span>(edge[<span class="number">0</span>], edge[<span class="number">1</span>], edge[<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ— å‘</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">undirectGraph</span><span class="params">(<span class="type">const</span> vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&amp; edges)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span>&amp; edge : edges) &#123;</span><br><span class="line">        graph1[edge[<span class="number">0</span>]][edge[<span class="number">1</span>]] = edge[<span class="number">2</span>];</span><br><span class="line">        graph1[edge[<span class="number">1</span>]][edge[<span class="number">0</span>]] = edge[<span class="number">2</span>];</span><br><span class="line">        </span><br><span class="line">        graph2[edge[<span class="number">0</span>]].<span class="built_in">emplace_back</span>(edge[<span class="number">1</span>], edge[<span class="number">2</span>]);</span><br><span class="line">        graph2[edge[<span class="number">1</span>]].<span class="built_in">emplace_back</span>(edge[<span class="number">0</span>], edge[<span class="number">2</span>]);</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">addEdge</span>(edge[<span class="number">0</span>], edge[<span class="number">1</span>], edge[<span class="number">2</span>]);</span><br><span class="line">        <span class="built_in">addEdge</span>(edge[<span class="number">1</span>], edge[<span class="number">0</span>], edge[<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">traversal</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;é‚»æ¥çŸ©é˜µéå†:&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            cout &lt;&lt; graph1[i][j] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;é‚»æ¥è¡¨éå†:&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        cout &lt;&lt; i &lt;&lt; <span class="string">&quot; (é‚»å±…,è¾¹æƒ): &quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; edge : graph2[i]) &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;(&quot;</span> &lt;&lt; edge.first &lt;&lt; <span class="string">&quot;,&quot;</span> &lt;&lt; edge.second &lt;&lt; <span class="string">&quot;) &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;é“¾å¼å‰å‘æ˜Ÿéå†:&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        cout &lt;&lt; i &lt;&lt; <span class="string">&quot; (é‚»å±…,è¾¹æƒ): &quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> ei = head[i]; ei &gt; <span class="number">0</span>; ei = nxt[ei]) &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;(&quot;</span> &lt;&lt; to[ei] &lt;&lt; <span class="string">&quot;,&quot;</span> &lt;&lt; weight[ei] &lt;&lt; <span class="string">&quot;) &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n1 = <span class="number">4</span>;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; edges1 = &#123;&#123;<span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>&#125;, &#123;<span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>&#125;, &#123;<span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>&#125;, &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">7</span>&#125;, &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>&#125;, &#123;<span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>&#125;&#125;;</span><br><span class="line">    <span class="built_in">build</span>(n1);</span><br><span class="line">    <span class="built_in">directGraph</span>(edges1);</span><br><span class="line">    <span class="built_in">traversal</span>(n1);</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;==============================&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="type">int</span> n2 = <span class="number">5</span>;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; edges2 = &#123;&#123;<span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>&#125;, &#123;<span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>&#125;, &#123;<span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>&#125;, &#123;<span class="number">5</span>, <span class="number">2</span>, <span class="number">4</span>&#125;, &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">7</span>&#125;, &#123;<span class="number">1</span>, <span class="number">5</span>, <span class="number">5</span>&#125;, &#123;<span class="number">4</span>, <span class="number">2</span>, <span class="number">6</span>&#125;&#125;;</span><br><span class="line">    <span class="built_in">build</span>(n2);</span><br><span class="line">    <span class="built_in">undirectGraph</span>(edges2);</span><br><span class="line">    <span class="built_in">traversal</span>(n2);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ¬§æ‹‰å›è·¯ä¸æ¬§æ‹‰è·¯å¾„"><a href="#æ¬§æ‹‰å›è·¯ä¸æ¬§æ‹‰è·¯å¾„" class="headerlink" title="æ¬§æ‹‰å›è·¯ä¸æ¬§æ‹‰è·¯å¾„"></a>æ¬§æ‹‰å›è·¯ä¸æ¬§æ‹‰è·¯å¾„</h3><p>ä¸ƒæ¡¥é—®é¢˜æºè‡ªæŸ¯å°¼æ–¯å ¡åŸï¼ˆç°åŠ é‡Œå®æ ¼å‹’ï¼‰çš„ä¸ƒåº§æ¡¥ï¼Œè¯¢é—®èƒ½å¦ä»æŸå¤„å‡ºå‘ï¼Œ<strong>æ°å¥½ä¸€æ¬¡</strong>èµ°è¿‡æ¯åº§æ¡¥å¹¶å›åˆ°èµ·ç‚¹ï¼ˆæˆ–ä¸å›åˆ°èµ·ç‚¹ï¼‰ã€‚</p>
<p><strong>åº¦ï¼ˆdegreeï¼‰</strong>ï¼šæ— å‘å›¾ä¸­ä¸é¡¶ç‚¹ç›¸ incident çš„è¾¹æ¡æ•°ï¼Œè®°ä½œ <code>deg(v)</code>ã€‚</p>
<p><strong>æ¬§æ‹‰è·¯å¾„ï¼ˆEuler trail/pathï¼‰</strong>ï¼šç»è¿‡<strong>æ¯æ¡è¾¹æ°å¥½ä¸€æ¬¡</strong>çš„<strong>è·¯</strong>ã€‚</p>
<p><strong>æ¬§æ‹‰å›è·¯ï¼ˆEuler circuit/tourï¼‰</strong>ï¼šç»è¿‡<strong>æ¯æ¡è¾¹æ°å¥½ä¸€æ¬¡</strong>å¹¶<strong>å›åˆ°èµ·ç‚¹</strong>çš„<strong>ç¯</strong>ã€‚</p>
<p><strong>è¿é€šæ€§</strong>ï¼šå¿½ç•¥åº¦ä¸º 0 çš„é¡¶ç‚¹åï¼Œå›¾åœ¨æ— å‘æ„ä¹‰ä¸‹åº”å½“<strong>è¿é€š</strong>ã€‚</p>
<p>åˆ¤å®šå®šç†ï¼ˆå¿…è¦ä¸”å……åˆ†ï¼‰</p>
<p><strong>æ— å‘å›¾ï¼ˆå…è®¸å¤šé‡è¾¹ï¼‰</strong>ï¼š</p>
<ol>
<li>éé›¶åº¦é¡¶ç‚¹è¯±å¯¼çš„å­å›¾è¿é€šï¼›</li>
<li>è®¾å¥‡åº¦é¡¶ç‚¹ä¸ªæ•°ä¸º <code>k</code>ï¼š<ul>
<li><code>k = 0</code> â‡’ å­˜åœ¨<strong>æ¬§æ‹‰å›è·¯</strong>ï¼ˆä¹Ÿå­˜åœ¨è·¯å¾„ï¼‰ï¼›</li>
<li><code>k = 2</code> â‡’ å­˜åœ¨<strong>æ¬§æ‹‰è·¯å¾„ä½†æ— å›è·¯</strong>ï¼ˆèµ·ç‚¹/ç»ˆç‚¹ä¸ºè¿™ä¸¤ä¸ªå¥‡åº¦é¡¶ç‚¹ä¹‹ä¸€ï¼‰ï¼›</li>
<li>å…¶ä»– <code>k</code> â‡’ <strong>ä¸å­˜åœ¨</strong>æ¬§æ‹‰è·¯å¾„ã€‚</li>
</ul>
</li>
</ol>
<p><strong>ç›´è§‚ç†è§£</strong>ï¼šè¿›å…¥ä¸ç¦»å¼€åŒä¸€é¡¶ç‚¹æ¶ˆè€— 2 æ¡ incident è¾¹ï¼Œæ‰€ä»¥é™¤èµ·ç‚¹/ç»ˆç‚¹å¤–åº”ä¸ºå¶åº¦ï¼›è‹¥å›è·¯ï¼ˆèµ·ç‚¹=ç»ˆç‚¹ï¼‰ï¼Œåˆ™æ‰€æœ‰é¡¶ç‚¹å¶åº¦ã€‚</p>
<h3 id="å›¾æœ€çŸ­è·¯"><a href="#å›¾æœ€çŸ­è·¯" class="headerlink" title="å›¾æœ€çŸ­è·¯"></a>å›¾æœ€çŸ­è·¯</h3><p>ä»æŸä¸€åŸºç‚¹åˆ°å…¶ä»–ç‚¹çš„æœ€çŸ­è·¯å¾„</p>
<h4 id="Dijkstraç®—æ³•"><a href="#Dijkstraç®—æ³•" class="headerlink" title="Dijkstraç®—æ³•"></a>Dijkstraç®—æ³•</h4><h5 id="æ™®é€šå †"><a href="#æ™®é€šå †" class="headerlink" title="æ™®é€šå †"></a>æ™®é€šå †</h5><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m, st;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; st;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">distance</span><span class="params">(n + <span class="number">1</span>, INT_MAX)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">visited</span><span class="params">(n + <span class="number">1</span>, <span class="literal">false</span>)</span></span>;</span><br><span class="line">    vector&lt;vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;&gt; <span class="built_in">g</span>(n + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, u, v, w; i &lt; m; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">        g[u].<span class="built_in">push_back</span>(&#123;v, w&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"> 	priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;,vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;,greater&lt;&gt;&gt; q1;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : g[st])&#123;</span><br><span class="line">        q1.<span class="built_in">push</span>(&#123;it.second,it.first&#125;);  </span><br><span class="line">    &#125;</span><br><span class="line">    distance[st] = <span class="number">0</span>;</span><br><span class="line">    pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; temp;</span><br><span class="line">    <span class="type">int</span> u, w, v;</span><br><span class="line">    <span class="keyword">while</span>(!q1.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        temp = q1.<span class="built_in">top</span>();</span><br><span class="line">        q1.<span class="built_in">pop</span>();</span><br><span class="line">        u = temp.second;</span><br><span class="line">        w = temp.first;</span><br><span class="line">        <span class="keyword">if</span>(visited[u]) <span class="keyword">continue</span>;</span><br><span class="line">        visited[u] = <span class="literal">true</span>;</span><br><span class="line">        distance[u] = w;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> it : g[u])&#123;</span><br><span class="line">            v = it.first;</span><br><span class="line">            <span class="keyword">if</span>(!visited[v] &amp;&amp; it.second + distance[u] &lt; distance[v])&#123;</span><br><span class="line">                q1.<span class="built_in">push</span>(&#123;it.second + distance[u], v&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">        cout &lt;&lt; distance[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="åå‘ç´¢å¼•å †"><a href="#åå‘ç´¢å¼•å †" class="headerlink" title="åå‘ç´¢å¼•å †"></a>åå‘ç´¢å¼•å †</h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">//heap</span></span><br><span class="line"><span class="type">int</span> MAXN = <span class="number">100001</span>;</span><br><span class="line"><span class="type">int</span> MAXM = <span class="number">200001</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head</span><span class="params">(MAXN)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">next1</span><span class="params">(MAXM)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">to</span><span class="params">(MAXM)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">weight</span><span class="params">(MAXM)</span></span>;</span><br><span class="line"><span class="type">int</span> cnt = <span class="number">1</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">heap</span><span class="params">(MAXN)</span></span>;</span><br><span class="line"><span class="type">int</span> sizeh = <span class="number">0</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">where</span><span class="params">(MAXN,<span class="number">-1</span>)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">distance1</span><span class="params">(MAXN,INT_MAX)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap1</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">swap</span>(heap[i], heap[j]);</span><br><span class="line">    where[heap[i]] = i;</span><br><span class="line">    where[heap[j]] = j;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heapInsert</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (i &gt; <span class="number">0</span> &amp;&amp; distance1[heap[i]] &lt; distance1[heap[(i - <span class="number">1</span>) / <span class="number">2</span>]])&#123;</span><br><span class="line">        <span class="built_in">swap1</span>(i, (i - <span class="number">1</span>) / <span class="number">2</span>);</span><br><span class="line">        i = (i - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heapify</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = i * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> max_mark;</span><br><span class="line">    <span class="type">int</span> mark;</span><br><span class="line">    <span class="keyword">while</span> (l &lt; sizeh) &#123;</span><br><span class="line">        max_mark = l + <span class="number">1</span> &lt; sizeh &amp;&amp; distance1[heap[l + <span class="number">1</span>]] &lt; distance1[heap[l]] ? l + <span class="number">1</span> : l;</span><br><span class="line">        mark =distance1[ heap[i]] &lt;distance1[ heap[max_mark]] ? i : max_mark;</span><br><span class="line">        <span class="keyword">if</span> (mark == i) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">swap1</span>(i, mark);</span><br><span class="line">            i = mark;</span><br><span class="line">            l = i * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m, s;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; s;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, x, y, w; i &lt; m; i++) &#123;</span><br><span class="line">        cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;</span><br><span class="line">        next1[cnt] = head[x];</span><br><span class="line">        to[cnt] = y;</span><br><span class="line">        weight[cnt] = w;</span><br><span class="line">        head[x] = cnt++;</span><br><span class="line">    &#125;</span><br><span class="line">    heap[sizeh++] = s;</span><br><span class="line">    distance1[s] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (sizeh) &#123;</span><br><span class="line">        <span class="type">int</span> u = heap[<span class="number">0</span>];</span><br><span class="line">        <span class="built_in">swap1</span>(<span class="number">0</span>, --sizeh);</span><br><span class="line">        <span class="built_in">heapify</span>(<span class="number">0</span>);</span><br><span class="line">        where[u] = <span class="number">-2</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> ei = head[u]; ei &gt; <span class="number">0</span>; ei = next1[ei]) &#123;</span><br><span class="line">            <span class="type">int</span> v = to[ei];</span><br><span class="line">            <span class="type">int</span> w = weight[ei];</span><br><span class="line">            <span class="keyword">if</span> (where[v] == <span class="number">-1</span>) &#123;</span><br><span class="line">                distance1[v] = w + distance1[u];</span><br><span class="line">                where[v] = sizeh;</span><br><span class="line">                heap[sizeh++] = v;</span><br><span class="line">                <span class="built_in">heapInsert</span>(where[v]);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (where[v] &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">                distance1[v] = <span class="built_in">min</span>(distance1[v], distance1[u] + w);</span><br><span class="line">                <span class="built_in">heapInsert</span>(where[v]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        cout &lt;&lt; distance1[i];</span><br><span class="line">        <span class="keyword">if</span> (i != n) cout &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="æ±‚æœ€çŸ­å¥‡å¶è·¯å¾„"><a href="#æ±‚æœ€çŸ­å¥‡å¶è·¯å¾„" class="headerlink" title="æ±‚æœ€çŸ­å¥‡å¶è·¯å¾„"></a>æ±‚æœ€çŸ­å¥‡å¶è·¯å¾„</h5><p>è¯¥æ€æƒ³å¯æ‹“å±•ä¸ºæŸä¸€ä¸ªèŠ‚ç‚¹æœ‰nç§çŠ¶æ€ï¼Œæ•…æ¯æ¡è¾¹å¢åŠ ä¸€ä¸ªå˜é‡ä¸ºè·¯çš„æ•°é‡ï¼Œä¸€èˆ¬è®¾ç½®ä¸ºt = 1,è€Œè·‘DJç®—æ³•æ—¶ï¼Œå¯ä»¥åœ¨ä¼˜å…ˆé˜Ÿåˆ—åé¢å†åŠ ä¸€ä¸ªå±æ€§è¡¨ç¤ºçŠ¶æ€typeï¼Œtype = (type + t) % nã€‚</p>
<p>å½“å†å¢åŠ ä¸€ä¸ªå±æ€§è¡¨ç¤ºèŠ‚ç‚¹çš„ç±»åˆ«ï¼Œç›¸åŒèŠ‚ç‚¹é—´å¯ä»¥ä»¥æŸä¸ªä»£ä»·ç›¸äº’ä¼ é€æ—¶ï¼Œåˆ™å¯ä»¥æŠ½è±¡ä¸ºæ–°å¢äº†ä¸€ä¸ªç¥–å…ˆèŠ‚ç‚¹ï¼Œè¯¥ç¥–å…ˆä¸æ‰€æœ‰è¯¥ç±»åˆ«çš„èŠ‚ç‚¹ç›¸äº’è”é€šï¼ŒèŠ‚ç‚¹åˆ°ç¥–å…ˆçš„t=1ï¼Œç¥–å…ˆåˆ°èŠ‚ç‚¹çš„t=0ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å‡è®¾è¾¹æƒä¸º1,è‹¥ä¸ä¸º1åˆ™w+1å˜æˆw+weight[ei]</span></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–å¥‡æ•°å’Œå¶æ•°è·¯å¾„é•¿åº¦çš„è·ç¦»æ•°ç»„</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dis_o</span><span class="params">(n + <span class="number">1</span>, <span class="number">1e18</span>)</span>, <span class="title">dis_e</span><span class="params">(n + <span class="number">1</span>, <span class="number">1e18</span>)</span></span>; <span class="comment">// dis_o: æœ€çŸ­å¥‡æ•°è·¯å¾„ï¼Œdis_e: æœ€çŸ­å¶æ•°è·¯å¾„</span></span><br><span class="line">dis_e[<span class="number">1</span>] = <span class="number">0</span>; <span class="comment">// èµ·ç‚¹ï¼ˆèŠ‚ç‚¹1ï¼‰çš„å¶æ•°è·¯å¾„é•¿åº¦ä¸º0</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨æœ€å°å †ä¼˜å…ˆé˜Ÿåˆ—å­˜å‚¨ &#123;è·ç¦», èŠ‚ç‚¹&#125; å¯¹</span></span><br><span class="line">priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;, vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;, greater&lt;&gt;&gt; q1;</span><br><span class="line">q1.<span class="built_in">push</span>(&#123;<span class="number">0</span>, <span class="number">1</span>&#125;); <span class="comment">// ä»èŠ‚ç‚¹1å¼€å§‹ï¼Œè·ç¦»ä¸º0</span></span><br><span class="line"><span class="comment">// Dijkstraç®—æ³•</span></span><br><span class="line"><span class="keyword">while</span> (!q1.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">    <span class="keyword">auto</span> [w, u] = q1.<span class="built_in">top</span>(); <span class="comment">// w: å½“å‰è·ç¦»ï¼Œu: å½“å‰èŠ‚ç‚¹</span></span><br><span class="line">    q1.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="comment">// éå†èŠ‚ç‚¹uçš„æ‰€æœ‰é‚»å±…</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> ei = head[u]; ei; ei = next[ei]) &#123;</span><br><span class="line">        <span class="type">int</span> v = to[ei]; <span class="comment">// é‚»å±…èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (w &amp; <span class="number">1</span>) &#123; <span class="comment">// å¦‚æœåˆ°uçš„è·¯å¾„é•¿åº¦ä¸ºå¥‡æ•°</span></span><br><span class="line">            <span class="keyword">if</span> (dis_e[v] &gt; w + <span class="number">1</span>) &#123; <span class="comment">// å°è¯•æ›´æ–°vçš„å¶æ•°è·¯å¾„</span></span><br><span class="line">                dis_e[v] = w + <span class="number">1</span>;</span><br><span class="line">                q1.<span class="built_in">push</span>(&#123;w + <span class="number">1</span>, v&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// å¦‚æœåˆ°uçš„è·¯å¾„é•¿åº¦ä¸ºå¶æ•°</span></span><br><span class="line">            <span class="keyword">if</span> (dis_o[v] &gt; w + <span class="number">1</span>) &#123; <span class="comment">// å°è¯•æ›´æ–°vçš„å¥‡æ•°è·¯å¾„</span></span><br><span class="line">                dis_o[v] = w + <span class="number">1</span>;</span><br><span class="line">                q1.<span class="built_in">push</span>(&#123;w + <span class="number">1</span>, v&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*è¿·å®«æœ‰nä¸ªæˆ¿é—´ï¼Œé€šè¿‡mæ¡å•å‘é“è·¯è¿æ¥ï¼Œè¿·å®«çš„èµ·ç‚¹æ˜¯1å·æˆ¿é—´ï¼Œç»ˆç‚¹æ˜¯nå·æˆ¿é—´ã€‚æ¯æ¡é“è·¯éƒ½æœ‰ä¸€ä¸ªå®ˆè·¯äººï¼Œéœ€è¦æ”¯ä»˜å¯¹åº”æ•°é‡çš„é‡‘å¸æ‰èƒ½é€šè¿‡ï¼Œè¿™ä¸ªè¿·å®«è¿˜å­˜åœ¨ç€ä¸¤ä¸ªç¥ç§˜çš„è§„åˆ™ï¼š</span></span><br><span class="line"><span class="comment">1.åªæœ‰å½“èµ°åˆ°ç»ˆç‚¹æ—¶ç»è¿‡çš„è·¯çš„æ•°é‡æ˜¯3çš„å€æ•°æ—¶å¥¹æ‰èƒ½é¡ºåˆ©é€ƒç¦»è¿·å®«ã€‚</span></span><br><span class="line"><span class="comment">2.æ¯ä¸ªæˆ¿é—´éƒ½æœ‰ä¸€ä¸ªç±»åˆ«å±æ€§ï¼Œå¥¹å¯ä»¥èŠ±è´¹xä¸ªé‡‘å¸åœ¨ç›¸åŒç±»åˆ«çš„å±æ€§ä¹‹é—´ç¬ç§»ï¼ˆæ³¨æ„æ¯æ¬¡ç¬ç§»ä¹Ÿç®—ä½œèµ°è¿‡äº†ä¸€æ¡è·¯ï¼‰ï¼Œç‰¹æ®Šåœ°å¥¹å¯ä»¥åœ¨åŒä¸ªæˆ¿é—´å†…è¿›è¡Œç¬ç§»</span></span><br><span class="line"><span class="comment">å¦‚æœæ€æ ·éƒ½ä¸èƒ½èµ°å‡ºè¿·å®«çš„è¯è¾“å‡ºâ€œ-1â€*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> inf = <span class="number">1e18</span>;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>)-&gt;ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    <span class="keyword">while</span>(t --)&#123;</span><br><span class="line">		<span class="type">int</span> n, m, k;</span><br><span class="line">		cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">		<span class="function">vector <span class="title">adj</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, vector&lt;array&lt;<span class="type">int</span>, <span class="number">3</span>&gt;&gt;())</span></span>;</span><br><span class="line">		<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sta</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">			cin &gt;&gt; sta[i];</span><br><span class="line">			adj[i].<span class="built_in">push_back</span>(&#123;sta[i] + n, k, <span class="number">1</span>&#125;);</span><br><span class="line">			adj[sta[i] + n].<span class="built_in">push_back</span>(&#123;i, <span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, u, v, w; i &lt;= m; i ++)&#123;</span><br><span class="line">			cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">			adj[u].<span class="built_in">push_back</span>(&#123;v, w, <span class="number">1</span>&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">		vector&lt;array&lt;<span class="type">int</span>, 3&gt;&gt; <span class="built_in">dis</span>(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, &#123;inf, inf, inf&#125;);</span><br><span class="line">		priority_queue&lt;array&lt;<span class="type">int</span>, 3&gt;, vector&lt;array&lt;<span class="type">int</span>, 3&gt;&gt;, greater&lt;&gt;&gt; q1;</span><br><span class="line">		array&lt;<span class="type">int</span>, 3&gt; t1;</span><br><span class="line">		<span class="type">int</span> u, val, in, in1;</span><br><span class="line">		dis[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">		q1.<span class="built_in">push</span>(&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;);</span><br><span class="line">		<span class="keyword">while</span>(!q1.<span class="built_in">empty</span>())&#123;</span><br><span class="line">			t1 = q1.<span class="built_in">top</span>();</span><br><span class="line">			q1.<span class="built_in">pop</span>();</span><br><span class="line">			val = t1[<span class="number">0</span>], u = t1[<span class="number">1</span>], in = t1[<span class="number">2</span>];</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">auto</span> [v, w, gap] : adj[u])&#123;</span><br><span class="line">				in1 = (in + gap) % <span class="number">3</span>;</span><br><span class="line">				<span class="keyword">if</span>(dis[v][in1] &gt; val + w)&#123;</span><br><span class="line">					dis[v][in1] = val + w;</span><br><span class="line">					q1.<span class="built_in">push</span>(&#123;dis[v][in1], v, in1&#125;);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(dis[n][<span class="number">0</span>] == inf)&#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;-1\n&quot;</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			cout &lt;&lt; dis[n][<span class="number">0</span>] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Floydç®—æ³•"><a href="#Floydç®—æ³•" class="headerlink" title="Floydç®—æ³•"></a>Floydç®—æ³•</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = numeric_limits&lt;<span class="type">int</span>&gt;::<span class="built_in">max</span>();</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">floydWarshallTemplate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–é‚»æ¥çŸ©é˜µï¼Œé»˜è®¤ä¸å¯è¾¾æ—¶æƒå€¼ä¸º INF</span></span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">dist</span>(n, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(n, INF));</span><br><span class="line">    <span class="comment">// è‡ªå·±åˆ°è‡ªå·±è·ç¦»ä¸º 0</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        dist[i][i] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¯»å…¥è¾¹ï¼Œå‡è®¾è¾“å…¥ä¸ºæ— å‘å›¾ï¼Œè‹¥ä¸ºæœ‰å‘å›¾åˆ™åªæ›´æ–°ä¸€è¾¹</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="type">int</span> u, v, w;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">        u--; v--; <span class="comment">// è‹¥è¾“å…¥é¡¶ç‚¹ç¼–å·ä» 1 å¼€å§‹åˆ™è½¬æ¢ä¸ºä» 0 å¼€å§‹</span></span><br><span class="line">        <span class="comment">// å¯¹äºå¤šé‡è¾¹å–æƒå€¼æœ€å°çš„ä¸€æ¡</span></span><br><span class="line">        dist[u][v] = <span class="built_in">min</span>(dist[u][v], w);</span><br><span class="line">        dist[v][u] = <span class="built_in">min</span>(dist[v][u], w);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Floydâ€“Warshall ç®—æ³•ï¼šæšä¸¾ä¸­è½¬ç‚¹ kã€èµ·ç‚¹ i å’Œç»ˆç‚¹ j</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; n; k++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœ i-&gt;k ä¸å¯è¾¾åˆ™æ— éœ€æ›´æ–°</span></span><br><span class="line">            <span class="keyword">if</span> (dist[i][k] == INF) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">                <span class="comment">// è‹¥è·¯å¾„ i-&gt;k å’Œ k-&gt;j å‡å¯è¾¾ï¼Œæ›´æ–° i-&gt;j çš„æœ€çŸ­è·¯å¾„</span></span><br><span class="line">                <span class="keyword">if</span> (dist[k][j] &lt; INF)</span><br><span class="line">                    dist[i][j] = <span class="built_in">min</span>(dist[i][j], dist[i][k] + dist[k][j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¾“å‡ºç»“æœï¼šè‹¥ä¸¤ç‚¹ä¸å¯è¾¾åˆ™è¾“å‡º 0ï¼Œå¦åˆ™è¾“å‡ºæœ€çŸ­è·¯å¾„é•¿åº¦</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            cout &lt;&lt; (dist[i][j] == INF ? <span class="number">0</span> : dist[i][j]) &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="SPFAï¼ˆShortest-Path-Faster-Algorithmï¼‰ç®—æ³•"><a href="#SPFAï¼ˆShortest-Path-Faster-Algorithmï¼‰ç®—æ³•" class="headerlink" title="SPFAï¼ˆShortest Path Faster Algorithmï¼‰ç®—æ³•"></a><code>SPFA</code>ï¼ˆShortest Path Faster Algorithmï¼‰ç®—æ³•</h4><p><code>SPFA</code> ç®—æ³•æ˜¯å¯¹ Bellman-Ford ç®—æ³•çš„ä¸€ç§æ”¹è¿›ï¼Œä¸»è¦ç”¨äºåœ¨å«æœ‰è´Ÿæƒè¾¹çš„å›¾ä¸­æ±‚æœ€çŸ­è·¯å¾„ã€‚å®ƒåˆ©ç”¨é˜Ÿåˆ—æ¥ç»´æŠ¤â€œå¾…æ›´æ–°â€çš„èŠ‚ç‚¹ï¼Œä»è€Œæé«˜æ›´æ–°æ•ˆç‡ã€‚</p>
<p>æ ¹æ®æœ€çŸ­è·¯å¾„ç†è®ºï¼Œåœ¨æ²¡æœ‰è´Ÿæƒå›è·¯çš„å›¾ä¸­ï¼Œä»èµ·ç‚¹åˆ°ä»»ä¸€èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„æœ€å¤šåªéœ€è¦ç»è¿‡ <code>n-1</code> æ¡è¾¹ã€‚æ‰€ä»¥è‹¥æŸèŠ‚ç‚¹çš„è·¯å¾„æ›´æ–°æ¬¡æ•°è¶…è¿‡ <code>n-1</code>ï¼Œå°±èƒ½ç¡®å®šæœ‰è´Ÿæƒå›è·¯å­˜åœ¨ã€‚</p>
<p><code>visited</code>ï¼šæ ‡è®°å½“å‰èŠ‚ç‚¹æ˜¯å¦åœ¨é˜Ÿåˆ—ä¸­ï¼Œé˜²æ­¢é‡å¤å…¥é˜Ÿ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">6001</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head</span><span class="params">(M/<span class="number">2</span>)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">next1</span><span class="params">(M)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">to</span><span class="params">(M)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">weight</span><span class="params">(M)</span></span>;</span><br><span class="line"><span class="type">int</span> cnt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> w)</span></span>&#123;</span><br><span class="line">    next1[cnt] = head[x];</span><br><span class="line">    to[cnt] = y;</span><br><span class="line">    weight[cnt] = w;</span><br><span class="line">    head[x] = cnt++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    cnt=<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">fill</span>(head.<span class="built_in">begin</span>(),head.<span class="built_in">end</span>(),<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, x, y, w; i &lt; m; i++) &#123;</span><br><span class="line">        cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;</span><br><span class="line">        <span class="built_in">addedge</span>(x,y,w);</span><br><span class="line">        <span class="keyword">if</span> (w &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">addedge</span>(y,x,w);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; heap;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">distance</span><span class="params">(n + <span class="number">1</span>, INT_MAX)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">upcnt</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">visited</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    heap.<span class="built_in">push</span>(<span class="number">1</span>);</span><br><span class="line">    distance[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    upcnt[<span class="number">1</span>]++;</span><br><span class="line">    visited[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (!heap.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="type">int</span> u = heap.<span class="built_in">front</span>();</span><br><span class="line">        heap.<span class="built_in">pop</span>();</span><br><span class="line">        visited[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> ei = head[u];ei &gt; <span class="number">0</span>;ei = next1[ei]) &#123;</span><br><span class="line">            <span class="type">int</span> v = to[ei];</span><br><span class="line">            <span class="type">int</span> w = weight[ei];</span><br><span class="line">            <span class="keyword">if</span> (w + distance[u] &lt; distance[v]) &#123;</span><br><span class="line">                distance[v] = w + distance[u];</span><br><span class="line">                <span class="keyword">if</span> (visited[v]==<span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((++upcnt[v])  &gt; n<span class="number">-1</span>) &#123;</span><br><span class="line">                        <span class="comment">//å­˜åœ¨è´Ÿæƒå›è·¯</span></span><br><span class="line">                        cout &lt;&lt; <span class="string">&quot;YES&quot;</span> &lt;&lt; endl;</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    visited[v] = <span class="number">1</span>;</span><br><span class="line">                    heap.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;NO&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æœ€å°ç”Ÿæˆæ ‘"><a href="#æœ€å°ç”Ÿæˆæ ‘" class="headerlink" title="æœ€å°ç”Ÿæˆæ ‘"></a>æœ€å°ç”Ÿæˆæ ‘</h3><p>æ ‘ä¸Šçš„ä¸€æ¡æ— å›è·¯çš„è¿é€šæ‰€æœ‰èŠ‚ç‚¹çš„ä¸€æ¡æƒå€¼æœ€å°çš„è·¯å¾„</p>
<h4 id="Kruskalç®—æ³•"><a href="#Kruskalç®—æ³•" class="headerlink" title="Kruskalç®—æ³•"></a>Kruskalç®—æ³•</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Kruskal ç®—æ³•ï¼šåˆ©ç”¨å¹¶æŸ¥é›†æ±‚æœ€å°ç”Ÿæˆæ ‘</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kruskal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    vector&lt;tuple&lt;<span class="type">int</span>,<span class="type">int</span>,<span class="type">int</span>&gt;&gt; edges; <span class="comment">// (æƒå€¼, ç‚¹u, ç‚¹v)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="type">int</span> u, v, w;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">        edges.<span class="built_in">push_back</span>(&#123;w, u, v&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(edges.<span class="built_in">begin</span>(), edges.<span class="built_in">end</span>());</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">parent</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) parent[i] = i;</span><br><span class="line">	<span class="keyword">auto</span> find = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> x) -&gt; <span class="type">int</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(parent[x] != x)&#123;</span><br><span class="line">			parent[x] = <span class="built_in">f</span>(f,parent[x]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> parent[x];</span><br><span class="line">	&#125;;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> [w, u, v] : edges) &#123;</span><br><span class="line">        <span class="type">int</span> pu = <span class="built_in">find</span>(find, u), pv = <span class="built_in">find</span>(find, v);</span><br><span class="line">        <span class="keyword">if</span> (pu != pv) &#123;</span><br><span class="line">            parent[pu] = pv;</span><br><span class="line">            sum += w;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="Primç®—æ³•"><a href="#Primç®—æ³•" class="headerlink" title="Primç®—æ³•"></a>Primç®—æ³•</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Prim ç®—æ³•</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">prim</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    vector&lt;vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;&gt; <span class="built_in">graph</span>(n + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="type">int</span> u, v, w;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">        graph[u].<span class="built_in">push_back</span>(&#123;v, w&#125;);</span><br><span class="line">        graph[v].<span class="built_in">push_back</span>(&#123;u, w&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">visited</span><span class="params">(n + <span class="number">1</span>, <span class="literal">false</span>)</span></span>;</span><br><span class="line">    <span class="comment">// ä¼˜å…ˆé˜Ÿåˆ—ï¼špair(æƒå€¼, èŠ‚ç‚¹)</span></span><br><span class="line">    priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;, vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;, greater&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;&gt; pq;</span><br><span class="line">    visited[<span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> edge : graph[<span class="number">1</span>]) pq.<span class="built_in">push</span>(&#123;edge.second, edge.first&#125;);</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!pq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">auto</span> [w, u] = pq.<span class="built_in">top</span>();</span><br><span class="line">        pq.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span> (visited[u]) <span class="keyword">continue</span>;</span><br><span class="line">        visited[u] = <span class="literal">true</span>;</span><br><span class="line">        sum += w;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> edge : graph[u])</span><br><span class="line">            <span class="keyword">if</span> (!visited[edge.first])</span><br><span class="line">                pq.<span class="built_in">push</span>(&#123;edge.second, edge.first&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="äºŒå‰æ ‘"><a href="#äºŒå‰æ ‘" class="headerlink" title="äºŒå‰æ ‘"></a>äºŒå‰æ ‘</h3><h4 id="äºŒå‰æ ‘çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–åŠå…ˆä¸­åºæ„é€ "><a href="#äºŒå‰æ ‘çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–åŠå…ˆä¸­åºæ„é€ " class="headerlink" title="äºŒå‰æ ‘çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–åŠå…ˆä¸­åºæ„é€ "></a>äºŒå‰æ ‘çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–åŠå…ˆä¸­åºæ„é€ </h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TreeNode</span>&#123;</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    TreeNode * left, * right;</span><br><span class="line">    <span class="built_in">TreeNode</span> (<span class="type">int</span> x)&#123;</span><br><span class="line">        val = x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//å…ˆåºçš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Codec</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">serialize</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        string r;</span><br><span class="line">        <span class="built_in">serialize_h</span>(root,r);</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">TreeNode* <span class="title">deserialize</span><span class="params">(string data)</span> </span>&#123;</span><br><span class="line">        vector&lt;string&gt; vals = <span class="built_in">split</span>(data,<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">        <span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">deserialize_h</span>(vals,cnt);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">serialize_h</span><span class="params">(TreeNode* root,string&amp; r)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            r+=<span class="string">&quot;#,&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            r+=<span class="built_in">to_string</span>(root-&gt;val)+<span class="string">&quot;,&quot;</span>;</span><br><span class="line">            <span class="built_in">serialize_h</span>(root-&gt;left,r);</span><br><span class="line">            <span class="built_in">serialize_h</span>(root-&gt;right,r);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">TreeNode* <span class="title">deserialize_h</span><span class="params">(<span class="type">const</span> vector&lt;string&gt;&amp; vals,<span class="type">int</span>&amp; cnt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(cnt &gt;= vals.<span class="built_in">size</span>() || vals[cnt]==<span class="string">&quot;#&quot;</span> )&#123;</span><br><span class="line">            cnt++;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        TreeNode* node = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="built_in">stoi</span>(vals[cnt++]));</span><br><span class="line">        node-&gt;left=<span class="built_in">deserialize_h</span>(vals,cnt);</span><br><span class="line">        node-&gt;right=<span class="built_in">deserialize_h</span>(vals,cnt);</span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;string&gt; <span class="title">split</span><span class="params">(<span class="type">const</span> string&amp;s,<span class="type">char</span> delimiter)</span></span>&#123;</span><br><span class="line">        vector&lt;string&gt; tokens;</span><br><span class="line">        string token;</span><br><span class="line">        <span class="function">istringstream <span class="title">tokenStream</span><span class="params">(s)</span></span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">getline</span>(tokenStream,token,delimiter))&#123;</span><br><span class="line">            tokens.<span class="built_in">push_back</span>(token);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> tokens;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æŒ‰å±‚çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</span></span><br><span class="line">    <span class="function">string <span class="title">serialize1</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>) <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        string result;</span><br><span class="line">        queue&lt;TreeNode*&gt; q;</span><br><span class="line">        q.<span class="built_in">push</span>(root);</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            TreeNode* node = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(node!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">                result += <span class="built_in">to_string</span>(node-&gt;val)+<span class="string">&quot;,&quot;</span>;</span><br><span class="line">                q.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                q.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">            &#125;<span class="keyword">else</span> result+=<span class="string">&quot;#,&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">TreeNode* <span class="title">deserialize1</span><span class="params">(string data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(data.<span class="built_in">empty</span>()) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="function">stringstream <span class="title">ss</span><span class="params">(data)</span></span>;</span><br><span class="line">        string item;</span><br><span class="line">        <span class="built_in">getline</span>(ss,item,<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">        TreeNode* root = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="built_in">stoi</span>(item));</span><br><span class="line">        queue&lt;TreeNode*&gt; q;</span><br><span class="line">        q.<span class="built_in">push</span>(root);</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            TreeNode* node = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">getline</span>(ss,item,<span class="string">&#x27;,&#x27;</span>))&#123;</span><br><span class="line">                <span class="keyword">if</span>(item==<span class="string">&quot;#&quot;</span>)&#123;</span><br><span class="line">                    node-&gt;left=<span class="literal">nullptr</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    node-&gt;left = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="built_in">stoi</span>(item));</span><br><span class="line">                    q.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">getline</span>(ss,item,<span class="string">&#x27;,&#x27;</span>))&#123;</span><br><span class="line">                <span class="keyword">if</span>(item==<span class="string">&quot;#&quot;</span>)&#123;</span><br><span class="line">                    node-&gt;right=<span class="literal">nullptr</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    node-&gt;right=<span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="built_in">stoi</span>(item));</span><br><span class="line">                    q.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="åˆ©ç”¨å…ˆåºå’Œä¸­åºæ„é€ äºŒå‰æ ‘"><a href="#åˆ©ç”¨å…ˆåºå’Œä¸­åºæ„é€ äºŒå‰æ ‘" class="headerlink" title="åˆ©ç”¨å…ˆåºå’Œä¸­åºæ„é€ äºŒå‰æ ‘"></a>åˆ©ç”¨å…ˆåºå’Œä¸­åºæ„é€ äºŒå‰æ ‘</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å…ˆåºå’Œä¸­åºæ„é€ äºŒå‰æ ‘</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">buildTree</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; preorder, vector&lt;<span class="type">int</span>&gt;&amp; inorder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preorder.<span class="built_in">empty</span>() || inorder.<span class="built_in">empty</span>() || preorder.<span class="built_in">size</span>() != inorder.<span class="built_in">size</span>()) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt; map;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;inorder.<span class="built_in">size</span>();i++) map[inorder[i]]=i;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">build</span>(preorder,<span class="number">0</span>,inorder.<span class="built_in">size</span>()<span class="number">-1</span>,inorder,<span class="number">0</span>,inorder.<span class="built_in">size</span>()<span class="number">-1</span>,map);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">build</span><span class="params">(<span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; preorder,<span class="type">int</span> l1,<span class="type">int</span> r1,<span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; inorder,<span class="type">int</span> l2,<span class="type">int</span> r2,</span></span></span><br><span class="line"><span class="params"><span class="function">    unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&amp; map)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l1&gt;r1) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        TreeNode* root = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(preorder[l1]);</span><br><span class="line">        <span class="keyword">if</span>(l1==r1) <span class="keyword">return</span> root;</span><br><span class="line">        <span class="type">int</span> k=map[preorder[l1]];</span><br><span class="line">        root-&gt;left = <span class="built_in">build</span>(preorder,l1+<span class="number">1</span>,l1+k-l2,inorder,l2,k<span class="number">-1</span>,map);</span><br><span class="line">        root-&gt;right = <span class="built_in">build</span>(preorder,l1+k-l2+<span class="number">1</span>,r1,inorder,k+<span class="number">1</span>,r2,map);</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="äºŒå‰æ ‘ä¸­LCAç®—æ³•"><a href="#äºŒå‰æ ‘ä¸­LCAç®—æ³•" class="headerlink" title="äºŒå‰æ ‘ä¸­LCAç®—æ³•"></a>äºŒå‰æ ‘ä¸­LCAç®—æ³•</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//LCAé—®é¢˜</span></span><br><span class="line"><span class="comment">//æ±‚äºŒå‰æ ‘ä¸¤ä¸ªèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">lowestCommonAncestor</span><span class="params">(TreeNode* root, TreeNode* p, TreeNode* q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span> || root==p || root==q)&#123;</span><br><span class="line">        	<span class="keyword">return</span> root;</span><br><span class="line">		&#125;</span><br><span class="line">        TreeNode* l = <span class="built_in">lowestCommonAncestor</span>(root-&gt;left,p,q);</span><br><span class="line">        TreeNode* r = <span class="built_in">lowestCommonAncestor</span>(root-&gt;right,p,q);</span><br><span class="line">        <span class="keyword">if</span>(l!=<span class="literal">nullptr</span> &amp;&amp; r!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        	<span class="comment">//å·¦å³ä¸¤è¾¹éƒ½å·²ç»æ‰¾åˆ°</span></span><br><span class="line">        	<span class="keyword">return</span> root;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(l==<span class="literal">nullptr</span> &amp;&amp; r==<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        	<span class="comment">//å·¦å³ä¸¤è¾¹éƒ½æ²¡æœ‰æ‰¾åˆ°</span></span><br><span class="line">        	<span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//åªæœ‰ä¸€è¾¹æ‰¾åˆ°äº†ï¼Œè¿”å›æ‰¾åˆ°çš„ä¸€è¾¹</span></span><br><span class="line">        <span class="keyword">return</span> l==<span class="literal">nullptr</span>?r:l;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//æ±‚çº¿ç´¢äºŒå‰æ ‘ä¸¤ä¸ªèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">lowestCommonAncestor</span><span class="params">(TreeNode* root, TreeNode* p, TreeNode* q)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// rootä»ä¸Šåˆ°ä¸‹</span></span><br><span class="line">		<span class="comment">// å¦‚æœå…ˆé‡åˆ°äº†pï¼Œè¯´æ˜pæ˜¯ç­”æ¡ˆ</span></span><br><span class="line">		<span class="comment">// å¦‚æœå…ˆé‡åˆ°äº†qï¼Œè¯´æ˜qæ˜¯ç­”æ¡ˆ</span></span><br><span class="line">		<span class="comment">// å¦‚æœrootåœ¨p~qçš„å€¼ä¹‹é—´ï¼Œä¸ç”¨ç®¡på’Œqè°å¤§è°å°ï¼Œåªè¦rootåœ¨ä¸­é—´ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„rootå°±æ˜¯ç­”æ¡ˆ</span></span><br><span class="line">		<span class="comment">// å¦‚æœrootåœ¨p~qçš„å€¼çš„å·¦ä¾§ï¼Œé‚£ä¹ˆrootå¾€å³ç§»åŠ¨</span></span><br><span class="line">		<span class="comment">// å¦‚æœrootåœ¨p~qçš„å€¼çš„å³ä¾§ï¼Œé‚£ä¹ˆrootå¾€å·¦ç§»åŠ¨</span></span><br><span class="line">        <span class="keyword">while</span>(root-&gt;val!=p-&gt;val &amp;&amp; root-&gt;val!=q-&gt;val)&#123;</span><br><span class="line">            <span class="keyword">if</span>(root-&gt;val &lt; <span class="built_in">max</span>(p-&gt;val,q-&gt;val) &amp;&amp; root-&gt;val &gt; <span class="built_in">min</span>(p-&gt;val,q-&gt;val))&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            root = root-&gt;val &lt; <span class="built_in">min</span>(q-&gt;val,p-&gt;val)?root-&gt;right:root-&gt;left;</span><br><span class="line">        &#125;<span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="Morriséå†"><a href="#Morriséå†" class="headerlink" title="Morriséå†"></a>Morriséå†</h3><p>Morriséå†æ˜¯äºŒå‰æ ‘éå†çš„è¿›é˜¶ç®—æ³•ï¼Œç›¸æ¯”é€’å½’ï¼ˆO(h)ç©ºé—´ï¼‰å’Œéé€’å½’æ ˆå®ç°ï¼ˆO(h)ç©ºé—´ï¼‰ï¼Œå®ƒå·§å¦™åˆ©ç”¨æ ‘ä¸­ç©ºé—²æŒ‡é’ˆï¼ˆå¶èŠ‚ç‚¹å·¦å³ä¸ºç©ºï¼‰ï¼Œå°†<strong>ç©ºé—´å¤æ‚åº¦æé™ä¼˜åŒ–è‡³O(1)</strong>ï¼Œ<strong>æ—¶é—´å¤æ‚åº¦ä»ä¸ºO(N)</strong>ï¼Œå®ç°é«˜æ•ˆæ— æ ˆéå†ã€‚</p>
<p>å®ç°åŸåˆ™ï¼ˆä»¥å½“å‰èŠ‚ç‚¹curä¸ºä¾‹ï¼‰ï¼š</p>
<ol>
<li>è‹¥curæ— å·¦å­æ ‘ï¼Œç›´æ¥å‘å³ç§»åŠ¨ï¼šcur = cur-&gt;rightã€‚</li>
<li>è‹¥curæœ‰å·¦å­æ ‘ï¼Œæ‰¾åˆ°å·¦å­æ ‘æœ€å³èŠ‚ç‚¹mostRightï¼š<ul>
<li>è‹¥mostRight-&gt;right == nullï¼ˆé¦–æ¬¡è®¿é—®ï¼‰ï¼šè®¾mostRight-&gt;right = curï¼Œç„¶åå‘å·¦ç§»åŠ¨ï¼šcur = cur-&gt;leftã€‚</li>
<li>è‹¥mostRight-&gt;right == curï¼ˆäºŒæ¬¡è®¿é—®ï¼‰ï¼šæ¢å¤mostRight-&gt;right = nullï¼Œç„¶åå‘å³ç§»åŠ¨ï¼šcur = cur-&gt;rightã€‚</li>
</ul>
</li>
</ol>
<p>éµå¾ªæ­¤æœºåˆ¶ï¼Œå³å®ŒæˆMorriséå†æ¡†æ¶ã€‚</p>
<p>å®è´¨æ´å¯Ÿï¼šé€šè¿‡ä¸´æ—¶â€œçº¿ç´¢â€æŒ‡é’ˆï¼ˆå³æŒ‡é’ˆçº¿ç¨‹åŒ–ï¼‰ï¼Œç¡®ä¿<strong>æ— å·¦å­æ ‘èŠ‚ç‚¹è®¿é—®1æ¬¡</strong>ï¼Œæœ‰<strong>å·¦å­æ ‘èŠ‚ç‚¹è®¿é—®2æ¬¡ï¼ˆé¦–æ¬¡å…¥å·¦ã€äºŒæ¬¡å‡ºå·¦ï¼‰</strong>ï¼Œä»è€Œæ¨¡æ‹Ÿé€’å½’è·¯å¾„è€Œä¸è€—é¢å¤–ç©ºé—´ã€‚é€‚ç”¨äº<strong>å‰/ä¸­/ååºéå†</strong>åŠè¡ç”Ÿé—®é¢˜ï¼ˆå¦‚<strong>BSTæ ¡éªŒã€æœ€å°æ·±åº¦ã€LCA</strong>ï¼‰ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TreeNode</span> &#123;</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    TreeNode* left;</span><br><span class="line">    TreeNode* right;</span><br><span class="line">    <span class="built_in">TreeNode</span>(<span class="type">int</span> x) : <span class="built_in">val</span>(x), <span class="built_in">left</span>(<span class="literal">nullptr</span>), <span class="built_in">right</span>(<span class="literal">nullptr</span>) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// ===== é€šç”¨Morrisæ¡†æ¶ =====</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">morrisFrame</span><span class="params">(TreeNode* head, function&lt;<span class="type">void</span>(TreeNode*)&gt; process)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!head) <span class="keyword">return</span>;</span><br><span class="line">    TreeNode* cur = head;</span><br><span class="line">    TreeNode* mostRight = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">while</span> (cur) &#123;</span><br><span class="line">        mostRight = cur-&gt;left;</span><br><span class="line">        <span class="keyword">if</span> (mostRight) &#123;</span><br><span class="line">            <span class="keyword">while</span> (mostRight-&gt;right &amp;&amp; mostRight-&gt;right != cur) &#123;</span><br><span class="line">                mostRight = mostRight-&gt;right;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!mostRight-&gt;right) &#123;  <span class="comment">// ç¬¬ä¸€æ¬¡</span></span><br><span class="line">                mostRight-&gt;right = cur;</span><br><span class="line">                cur = cur-&gt;left;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;  <span class="comment">// ç¬¬äºŒæ¬¡</span></span><br><span class="line">                mostRight-&gt;right = <span class="literal">nullptr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">process</span>(cur);  <span class="comment">// è‡ªå®šä¹‰å¤„ç†</span></span><br><span class="line">        cur = cur-&gt;right;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ===== 1. å‰åºéå† (LeetCode 144) =====</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">preorderTraversal</span><span class="params">(TreeNode* head)</span> </span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line">    TreeNode* cur = head;</span><br><span class="line">    TreeNode* mostRight = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">while</span> (cur) &#123;</span><br><span class="line">        mostRight = cur-&gt;left;</span><br><span class="line">        <span class="keyword">if</span> (mostRight) &#123;</span><br><span class="line">            <span class="keyword">while</span> (mostRight-&gt;right &amp;&amp; mostRight-&gt;right != cur) mostRight = mostRight-&gt;right;</span><br><span class="line">            <span class="keyword">if</span> (!mostRight-&gt;right) &#123;</span><br><span class="line">                ans.<span class="built_in">push_back</span>(cur-&gt;val);  <span class="comment">// è®¿é—®</span></span><br><span class="line">                mostRight-&gt;right = cur;</span><br><span class="line">                cur = cur-&gt;left; <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                mostRight-&gt;right = <span class="literal">nullptr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ans.<span class="built_in">push_back</span>(cur-&gt;val);  <span class="comment">// è®¿é—®</span></span><br><span class="line">        &#125;</span><br><span class="line">        cur = cur-&gt;right;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ===== 2. ä¸­åºéå† (LeetCode 94) =====</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">inorderTraversal</span><span class="params">(TreeNode* head)</span> </span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line">    <span class="built_in">morrisFrame</span>(head, [&amp;](TreeNode* node) &#123; ans.<span class="built_in">push_back</span>(node-&gt;val); &#125;);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ===== 3. ååºéå† (LeetCode 145) =====</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverseRightEdge</span><span class="params">(TreeNode* from, vector&lt;<span class="type">int</span>&gt;&amp; ans)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!from) <span class="keyword">return</span>;</span><br><span class="line">    TreeNode* pre = <span class="literal">nullptr</span>;</span><br><span class="line">    TreeNode* next = <span class="literal">nullptr</span>;</span><br><span class="line">    TreeNode* tail = from;</span><br><span class="line">    <span class="comment">// ç¬¬ä¸€éç¿»è½¬</span></span><br><span class="line">    <span class="keyword">while</span> (tail) &#123;</span><br><span class="line">        next = tail-&gt;right;</span><br><span class="line">        tail-&gt;right = pre;</span><br><span class="line">        pre = tail;</span><br><span class="line">        tail = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// pre ç°åœ¨æ˜¯åŸå°¾éƒ¨ï¼Œé“¾å·²åè½¬</span></span><br><span class="line">    <span class="comment">// æ”¶é›†ï¼šä»preéå†rightï¼ˆåè½¬é“¾ï¼‰ï¼Œå¾—åˆ°é€†åº</span></span><br><span class="line">    TreeNode* cur = pre;</span><br><span class="line">    <span class="keyword">while</span> (cur) &#123;</span><br><span class="line">        ans.<span class="built_in">push_back</span>(cur-&gt;val);</span><br><span class="line">        cur = cur-&gt;right;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ¢å¤ï¼šä»preï¼ˆåŸå°¾ï¼‰å†ç¿»è½¬ä¸€æ¬¡</span></span><br><span class="line">    tail = pre;</span><br><span class="line">    pre = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">while</span> (tail) &#123;</span><br><span class="line">        next = tail-&gt;right;</span><br><span class="line">        tail-&gt;right = pre;</span><br><span class="line">        pre = tail;</span><br><span class="line">        tail = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç°åœ¨é“¾æ¢å¤ï¼ŒåŸå¤´æ˜¯pre</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">postorderTraversal</span><span class="params">(TreeNode* head)</span> </span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line">    <span class="keyword">if</span> (!head) <span class="keyword">return</span> ans;</span><br><span class="line">    TreeNode* cur = head;</span><br><span class="line">    TreeNode* mostRight = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">while</span> (cur) &#123;</span><br><span class="line">        mostRight = cur-&gt;left;</span><br><span class="line">        <span class="keyword">if</span> (mostRight) &#123;</span><br><span class="line">            <span class="keyword">while</span> (mostRight-&gt;right &amp;&amp; mostRight-&gt;right != cur) mostRight = mostRight-&gt;right;</span><br><span class="line">            <span class="keyword">if</span> (!mostRight-&gt;right) &#123;</span><br><span class="line">                mostRight-&gt;right = cur;</span><br><span class="line">                cur = cur-&gt;left; <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                mostRight-&gt;right = <span class="literal">nullptr</span>;</span><br><span class="line">                <span class="built_in">reverseRightEdge</span>(cur-&gt;left, ans);  <span class="comment">// å·¦è¾¹ç•Œé€†åº</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cur = cur-&gt;right;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">reverseRightEdge</span>(head, ans);  <span class="comment">// æ ¹å³è¾¹ç•Œé€†åº</span></span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ===== 4. æ£€æŸ¥BST (LeetCode 98) =====</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isValidBST</span><span class="params">(TreeNode* head)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!head) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    TreeNode* cur = head;</span><br><span class="line">    TreeNode* mostRight = <span class="literal">nullptr</span>;</span><br><span class="line">    TreeNode* pre = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="type">bool</span> valid = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">while</span> (cur) &#123;</span><br><span class="line">        mostRight = cur-&gt;left;</span><br><span class="line">        <span class="keyword">if</span> (mostRight) &#123;</span><br><span class="line">            <span class="keyword">while</span> (mostRight-&gt;right &amp;&amp; mostRight-&gt;right != cur) mostRight = mostRight-&gt;right;</span><br><span class="line">            <span class="keyword">if</span> (!mostRight-&gt;right) &#123;</span><br><span class="line">                mostRight-&gt;right = cur;</span><br><span class="line">                cur = cur-&gt;left; <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                mostRight-&gt;right = <span class="literal">nullptr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (pre &amp;&amp; pre-&gt;val &gt;= cur-&gt;val) valid = <span class="literal">false</span>;</span><br><span class="line">        pre = cur;</span><br><span class="line">        cur = cur-&gt;right;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> valid;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ===== 5. æœ€å°æ·±åº¦ (LeetCode 111) =====</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">minDepth</span><span class="params">(TreeNode* head)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!head) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    TreeNode* cur = head;</span><br><span class="line">    TreeNode* mostRight = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="type">int</span> preLevel = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> rightLen = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> ans = INT_MAX;</span><br><span class="line">    <span class="keyword">while</span> (cur) &#123;</span><br><span class="line">        mostRight = cur-&gt;left;</span><br><span class="line">        <span class="keyword">if</span> (mostRight) &#123;</span><br><span class="line">            rightLen = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (mostRight-&gt;right &amp;&amp; mostRight-&gt;right != cur) &#123;</span><br><span class="line">                rightLen++;</span><br><span class="line">                mostRight = mostRight-&gt;right;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!mostRight-&gt;right) &#123;</span><br><span class="line">                preLevel++;</span><br><span class="line">                mostRight-&gt;right = cur;</span><br><span class="line">                cur = cur-&gt;left; <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (!mostRight-&gt;left) ans = <span class="built_in">min</span>(ans, preLevel);  <span class="comment">// å·¦æ— å­</span></span><br><span class="line">                preLevel -= rightLen;</span><br><span class="line">                mostRight-&gt;right = <span class="literal">nullptr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            preLevel++;</span><br><span class="line">        &#125;</span><br><span class="line">        cur = cur-&gt;right;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æœ€å³å¶</span></span><br><span class="line">    rightLen = <span class="number">1</span>; cur = head;</span><br><span class="line">    <span class="keyword">while</span> (cur-&gt;right) &#123; rightLen++; cur = cur-&gt;right; &#125;</span><br><span class="line">    <span class="keyword">if</span> (!cur-&gt;left) ans = <span class="built_in">min</span>(ans, rightLen);</span><br><span class="line">    <span class="keyword">return</span> ans == INT_MAX ? <span class="number">0</span> : ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ===== 6. LCA (LeetCode 236) =====</span></span><br><span class="line"><span class="function">TreeNode* <span class="title">preOrderFind</span><span class="params">(TreeNode* head, TreeNode* o1, TreeNode* o2)</span> </span>&#123;  <span class="comment">// å…ˆåºæ‰¾ç¬¬ä¸€ä¸ªo1/o2</span></span><br><span class="line">    <span class="keyword">if</span> (!head) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    TreeNode* cur = head;</span><br><span class="line">    TreeNode* mostRight = <span class="literal">nullptr</span>;</span><br><span class="line">    TreeNode* res = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">while</span> (cur) &#123;</span><br><span class="line">        mostRight = cur-&gt;left;</span><br><span class="line">        <span class="keyword">if</span> (mostRight) &#123;</span><br><span class="line">            <span class="keyword">while</span> (mostRight-&gt;right &amp;&amp; mostRight-&gt;right != cur) mostRight = mostRight-&gt;right;</span><br><span class="line">            <span class="keyword">if</span> (!mostRight-&gt;right) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!res &amp;&amp; (cur == o1 || cur == o2)) res = cur;</span><br><span class="line">                mostRight-&gt;right = cur;</span><br><span class="line">                cur = cur-&gt;left; <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                mostRight-&gt;right = <span class="literal">nullptr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!res &amp;&amp; (cur == o1 || cur == o2)) res = cur;</span><br><span class="line">        &#125;</span><br><span class="line">        cur = cur-&gt;right;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">rightCheck</span><span class="params">(TreeNode* head, TreeNode* target)</span> </span>&#123;  <span class="comment">// å³è¾¹ç•Œæ‰¾target</span></span><br><span class="line">    <span class="keyword">while</span> (head) &#123;</span><br><span class="line">        <span class="keyword">if</span> (head == target) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        head = head-&gt;right;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">TreeNode* <span class="title">lowestCommonAncestor</span><span class="params">(TreeNode* head, TreeNode* o1, TreeNode* o2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">preOrderFind</span>(o1-&gt;left, o1, o2) || <span class="built_in">preOrderFind</span>(o1-&gt;right, o1, o2)) <span class="keyword">return</span> o1;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">preOrderFind</span>(o2-&gt;left, o1, o2) || <span class="built_in">preOrderFind</span>(o2-&gt;right, o1, o2)) <span class="keyword">return</span> o2;</span><br><span class="line">    TreeNode* left = <span class="built_in">preOrderFind</span>(head, o1, o2);</span><br><span class="line">    <span class="keyword">if</span> (!left) <span class="keyword">return</span> head;  <span class="comment">// å¦‚æœleftä¸ºç©ºï¼Œheadæ˜¯LCA</span></span><br><span class="line">    TreeNode* cur = head;</span><br><span class="line">    TreeNode* mostRight = <span class="literal">nullptr</span>;</span><br><span class="line">    TreeNode* lca = <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">while</span> (cur) &#123;</span><br><span class="line">        mostRight = cur-&gt;left;</span><br><span class="line">        <span class="keyword">if</span> (mostRight) &#123;</span><br><span class="line">            <span class="keyword">while</span> (mostRight-&gt;right &amp;&amp; mostRight-&gt;right != cur) mostRight = mostRight-&gt;right;</span><br><span class="line">            <span class="keyword">if</span> (!mostRight-&gt;right) &#123;</span><br><span class="line">                mostRight-&gt;right = cur;</span><br><span class="line">                cur = cur-&gt;left; <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                mostRight-&gt;right = <span class="literal">nullptr</span>;</span><br><span class="line">                <span class="keyword">if</span> (!lca) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="built_in">rightCheck</span>(cur-&gt;left, left)) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="built_in">preOrderFind</span>(left-&gt;right, o1, o2)) lca = left;</span><br><span class="line">                        left = cur;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cur = cur-&gt;right;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> lca ? lca : left;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ===== ç¤ºä¾‹æµ‹è¯• =====</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å»ºæ ‘: LeetCode 236 æ ·ä¾‹</span></span><br><span class="line">    TreeNode* root = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="number">3</span>);</span><br><span class="line">    root-&gt;left = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="number">5</span>);</span><br><span class="line">    root-&gt;left-&gt;left = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="number">6</span>);</span><br><span class="line">    root-&gt;left-&gt;right = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="number">2</span>);</span><br><span class="line">    root-&gt;left-&gt;right-&gt;left = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="number">7</span>);</span><br><span class="line">    root-&gt;left-&gt;right-&gt;right = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="number">4</span>);</span><br><span class="line">    root-&gt;right = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="number">1</span>);</span><br><span class="line">    root-&gt;right-&gt;left = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="number">8</span>);</span><br><span class="line">    root-&gt;right-&gt;right = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">// æµ‹è¯•</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Preorder: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> v : <span class="built_in">preorderTraversal</span>(root)) cout &lt;&lt; v &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">    </span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Inorder: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> v : <span class="built_in">inorderTraversal</span>(root)) cout &lt;&lt; v &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Postorder: &quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> v : <span class="built_in">postorderTraversal</span>(root)) cout &lt;&lt; v &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Is BST: &quot;</span> &lt;&lt; (<span class="built_in">isValidBST</span>(root) ? <span class="string">&quot;Yes&quot;</span> : <span class="string">&quot;No&quot;</span>) &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Min Depth: &quot;</span> &lt;&lt; <span class="built_in">minDepth</span>(root) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    TreeNode* n1 = root-&gt;left-&gt;right-&gt;left;  <span class="comment">// 7</span></span><br><span class="line">    TreeNode* n2 = root-&gt;right-&gt;left;        <span class="comment">// 8</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;LCA(7,8): &quot;</span> &lt;&lt; <span class="built_in">lowestCommonAncestor</span>(root, n1, n2)-&gt;val &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ ‘çŠ¶æ•°ç»„"><a href="#æ ‘çŠ¶æ•°ç»„" class="headerlink" title="æ ‘çŠ¶æ•°ç»„"></a>æ ‘çŠ¶æ•°ç»„</h3><h4 id="ä¸€ç»´"><a href="#ä¸€ç»´" class="headerlink" title="ä¸€ç»´"></a>ä¸€ç»´</h4><h5 id="å•ç‚¹ä¿®æ”¹åŒºé—´æŸ¥è¯¢"><a href="#å•ç‚¹ä¿®æ”¹åŒºé—´æŸ¥è¯¢" class="headerlink" title="å•ç‚¹ä¿®æ”¹åŒºé—´æŸ¥è¯¢"></a>å•ç‚¹ä¿®æ”¹åŒºé—´æŸ¥è¯¢</h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">5e5</span> + <span class="number">1</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">low</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &amp; -x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= n)&#123;</span><br><span class="line">        v1[i] += x;</span><br><span class="line">        i += <span class="built_in">low</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i)&#123;</span><br><span class="line">        ans += v1[i];</span><br><span class="line">        i -= <span class="built_in">low</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">range</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">get</span>(j) - <span class="built_in">get</span>(i - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, x; i &lt;= n; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">        <span class="built_in">add</span>(i, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, op, x, y; i &lt; m; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; op &gt;&gt; x &gt;&gt; y;</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="built_in">add</span>(x, y);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            cout &lt;&lt; <span class="built_in">range</span>(x, y) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="åŒºé—´ä¿®æ”¹å•ç‚¹æŸ¥è¯¢"><a href="#åŒºé—´ä¿®æ”¹å•ç‚¹æŸ¥è¯¢" class="headerlink" title="åŒºé—´ä¿®æ”¹å•ç‚¹æŸ¥è¯¢"></a>åŒºé—´ä¿®æ”¹å•ç‚¹æŸ¥è¯¢</h5><p>åœ¨å•ç‚¹åŸºç¡€ä¸Šï¼Œåˆ©ç”¨ä¸€ç»´å·®åˆ†ï¼Œæœ€åæ±‚ä»0åˆ°içš„ç´¯åŠ å’Œå³ä¸ºiç‚¹çš„å€¼</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">5e5</span> + <span class="number">1</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; <span class="title">v1</span><span class="params">(N, <span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">low</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &amp; -x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= n)&#123;</span><br><span class="line">        v1[i] += x;</span><br><span class="line">        i += <span class="built_in">low</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">get</span><span class="params">(<span class="type">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i)&#123;</span><br><span class="line">        ans += v1[i];</span><br><span class="line">        i -= <span class="built_in">low</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">range</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">get</span>(j) - <span class="built_in">get</span>(i - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, x; i &lt;= n; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">        <span class="built_in">add</span>(i, x);</span><br><span class="line">        <span class="built_in">add</span>(i + <span class="number">1</span>, -x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, op, x, y, z; i &lt; m; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; op;</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">            cin &gt;&gt; x &gt;&gt; y &gt;&gt; z;</span><br><span class="line">            <span class="built_in">add</span>(x, z);</span><br><span class="line">            <span class="built_in">add</span>(y + <span class="number">1</span>, -z);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            cin &gt;&gt; x;</span><br><span class="line">            cout &lt;&lt; <span class="built_in">range</span>(<span class="number">1</span>, x) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="èŒƒå›´ä¿®æ”¹èŒƒå›´æŸ¥è¯¢"><a href="#èŒƒå›´ä¿®æ”¹èŒƒå›´æŸ¥è¯¢" class="headerlink" title="èŒƒå›´ä¿®æ”¹èŒƒå›´æŸ¥è¯¢"></a>èŒƒå›´ä¿®æ”¹èŒƒå›´æŸ¥è¯¢</h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">1</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; <span class="title">v1</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; <span class="title">v2</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">low</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &amp; -x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> x, vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; &amp; v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= n)&#123;</span><br><span class="line">        v[i] += x;</span><br><span class="line">        i += <span class="built_in">low</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">get</span><span class="params">(<span class="type">int</span> i, vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; &amp; v)</span></span>&#123;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i)&#123;</span><br><span class="line">        ans += v[i];</span><br><span class="line">        i -= <span class="built_in">low</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">range</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> j * <span class="built_in">get</span>(j, v1) - <span class="built_in">get</span>(j, v2) - ((i - <span class="number">1</span>) * <span class="built_in">get</span>(i - <span class="number">1</span>, v1) - <span class="built_in">get</span>(i <span class="number">-1</span>, v2));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">long</span> <span class="type">long</span> w)</span></span>&#123;</span><br><span class="line">    <span class="built_in">add</span>(x, w, v1);</span><br><span class="line">    <span class="built_in">add</span>(y + <span class="number">1</span>, -w, v1);</span><br><span class="line">    <span class="built_in">add</span>(x, (x - <span class="number">1</span>) * w, v2);</span><br><span class="line">    <span class="built_in">add</span>(y + <span class="number">1</span>, - y * w, v2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, x; i &lt;= n; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">        <span class="built_in">add</span>(i, i, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, op, x, y, z; i &lt; m; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; op;</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">            cin &gt;&gt; x &gt;&gt; y &gt;&gt; z;</span><br><span class="line">            <span class="built_in">add</span>(x, y, z);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            cin &gt;&gt; x &gt;&gt; y;</span><br><span class="line">            cout &lt;&lt; <span class="built_in">range</span>(x,  y) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="äºŒç»´"><a href="#äºŒç»´" class="headerlink" title="äºŒç»´"></a>äºŒç»´</h4><h5 id="å•ç‚¹ä¿®æ”¹èŒƒå›´æŸ¥è¯¢"><a href="#å•ç‚¹ä¿®æ”¹èŒƒå›´æŸ¥è¯¢" class="headerlink" title="å•ç‚¹ä¿®æ”¹èŒƒå›´æŸ¥è¯¢"></a>å•ç‚¹ä¿®æ”¹èŒƒå›´æŸ¥è¯¢</h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">low</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> i &amp; -i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; &amp; bit, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> w, <span class="type">int</span> n, <span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = x; i &lt;= n; i += <span class="built_in">low</span>(i)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = y; j &lt;= m; j += <span class="built_in">low</span>(j)) &#123;</span><br><span class="line">            bit[i][j] += w;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; &amp;bit, <span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = x; i &gt; <span class="number">0</span>; i -= <span class="built_in">low</span>(i)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = y; j &gt; <span class="number">0</span>; j -= <span class="built_in">low</span>(j)) &#123;</span><br><span class="line">            ans += bit[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; &amp;bit, <span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x1 &gt; x2 || y1 &gt; y2) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">query</span>(bit, x2, y2) - <span class="built_in">query</span>(bit, x1 - <span class="number">1</span>, y2) - <span class="built_in">query</span>(bit, x2, y1 - <span class="number">1</span>) + <span class="built_in">query</span>(bit, x1 - <span class="number">1</span>, y1 - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">v1</span>(n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(m + <span class="number">1</span>, <span class="number">0</span>)); <span class="comment">// åŸå§‹æ•°ç»„</span></span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">bit</span>(n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(m + <span class="number">1</span>, <span class="number">0</span>)); <span class="comment">// æ ‘çŠ¶æ•°ç»„</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">            cin &gt;&gt; v1[i][j];</span><br><span class="line">            <span class="built_in">add</span>(bit, i, j, v1[i][j], n, m);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> q;</span><br><span class="line">    cin &gt;&gt; q;</span><br><span class="line">    <span class="type">int</span> type;</span><br><span class="line">    <span class="type">int</span> x, y, w;</span><br><span class="line">    <span class="type">int</span> diff;</span><br><span class="line">    <span class="type">int</span> x1, y1, x2, y2;</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        cin &gt;&gt; type;</span><br><span class="line">        <span class="keyword">if</span> (type == <span class="number">1</span>) &#123; </span><br><span class="line">            cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;</span><br><span class="line">            diff = w - v1[x][y];</span><br><span class="line">            v1[x][y] = w;</span><br><span class="line">            <span class="built_in">add</span>(bit, x, y, diff, n, m);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == <span class="number">2</span>) &#123;</span><br><span class="line">            cin &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2;</span><br><span class="line">            cout &lt;&lt; <span class="built_in">get</span>(bit, x1, y1, x2, y2) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="èŒƒå›´æŸ¥è¯¢èŒƒå›´ä¿®æ”¹"><a href="#èŒƒå›´æŸ¥è¯¢èŒƒå›´ä¿®æ”¹" class="headerlink" title="èŒƒå›´æŸ¥è¯¢èŒƒå›´ä¿®æ”¹"></a>èŒƒå›´æŸ¥è¯¢èŒƒå›´ä¿®æ”¹</h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2050</span>;</span><br><span class="line"><span class="type">int</span> bit1[N][N];</span><br><span class="line"><span class="type">int</span> bit2[N][N];</span><br><span class="line"><span class="type">int</span> bit3[N][N];</span><br><span class="line"><span class="type">int</span> bit4[N][N];</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> a, b, c, d, w;</span><br><span class="line"><span class="type">int</span> v1, v2, v3, v4;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">low</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &amp; -x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">    v1 = v;</span><br><span class="line">    v2 = x * v;</span><br><span class="line">    v3 = y * v;</span><br><span class="line">    v4 = x * y * v;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = x; i &lt;= n; i += <span class="built_in">low</span>(i))&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = y; j &lt;= m; j += <span class="built_in">low</span>(j))&#123;</span><br><span class="line">            bit1[i][j] += v1;</span><br><span class="line">            bit2[i][j] += v2;</span><br><span class="line">            bit3[i][j] += v3;</span><br><span class="line">            bit4[i][j] += v4;</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = x; i; i -= <span class="built_in">low</span>(i))&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = y; j; j -= <span class="built_in">low</span>(j))&#123;</span><br><span class="line">            ans += (x + <span class="number">1</span>) * (y + <span class="number">1</span>) * bit1[i][j] - (y + <span class="number">1</span>) * bit2[i][j] - (x + <span class="number">1</span>) * bit3[i][j] + bit4[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2, <span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="built_in">add</span>(x1, y1, v);</span><br><span class="line">    <span class="built_in">add</span>(x2 + <span class="number">1</span>, y2 + <span class="number">1</span>, v);</span><br><span class="line">    <span class="built_in">add</span>(x1, y2 + <span class="number">1</span>, - v);</span><br><span class="line">    <span class="built_in">add</span>(x2 + <span class="number">1</span>, y1, - v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">get</span>(x2, y2) + <span class="built_in">get</span>(x1 - <span class="number">1</span>, y1 - <span class="number">1</span>) - <span class="built_in">get</span>(x1 - <span class="number">1</span>, y2) - <span class="built_in">get</span>(x2, y1 - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">char</span> C)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(C == <span class="string">&#x27;L&#x27;</span>)&#123;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c &gt;&gt; d &gt;&gt; w;</span><br><span class="line">        <span class="built_in">add</span>(a, b, c, d, w);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(C != <span class="string">&#x27;X&#x27;</span>)&#123;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c &gt;&gt; d;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">get</span>(a, b, c, d) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">char</span> C;</span><br><span class="line">    <span class="keyword">while</span> (cin &gt;&gt; C) &#123;</span><br><span class="line">        <span class="built_in">solve</span>(C);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="çº¿æ®µæ ‘"><a href="#çº¿æ®µæ ‘" class="headerlink" title="çº¿æ®µæ ‘"></a>çº¿æ®µæ ‘</h3><h4 id="èŒƒå›´å¢åŠ èŒƒå›´æŸ¥è¯¢ç´¯åŠ å’Œ"><a href="#èŒƒå›´å¢åŠ èŒƒå›´æŸ¥è¯¢ç´¯åŠ å’Œ" class="headerlink" title="èŒƒå›´å¢åŠ èŒƒå›´æŸ¥è¯¢ç´¯åŠ å’Œ"></a>èŒƒå›´å¢åŠ èŒƒå›´æŸ¥è¯¢ç´¯åŠ å’Œ</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P3372</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>) -&gt; ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--)&#123;</span><br><span class="line">		<span class="type">int</span> n, q;</span><br><span class="line">		cin &gt;&gt; n &gt;&gt; q;</span><br><span class="line">		<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">sum</span><span class="params">((n &lt;&lt; <span class="number">2</span>) + <span class="number">1</span>)</span>, <span class="title">add</span><span class="params">((n &lt;&lt; <span class="number">2</span>) + <span class="number">1</span>)</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">			cin &gt;&gt; v1[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">auto</span> build = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">				sum[i] = v1[l];</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">				<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">				sum[i] = sum[i &lt;&lt; <span class="number">1</span>] + sum[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			add[i] = <span class="number">0</span>;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> up = [&amp;](<span class="type">int</span> i)&#123;</span><br><span class="line">			sum[i] = sum[i &lt;&lt; <span class="number">1</span>] + sum[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> lazy = [&amp;](<span class="type">int</span> i, <span class="type">int</span> val, <span class="type">int</span> len)&#123;</span><br><span class="line">			sum[i] += val * len;</span><br><span class="line">			add[i] += val;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> down = [&amp;](<span class="type">int</span> i, <span class="type">int</span> lenl, <span class="type">int</span> lenr)&#123;</span><br><span class="line">			<span class="keyword">if</span>(add[i] == <span class="number">0</span>)&#123;</span><br><span class="line">				<span class="keyword">return</span> ;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">lazy</span>(i &lt;&lt; <span class="number">1</span>, add[i], lenl);</span><br><span class="line">			<span class="built_in">lazy</span>(i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, add[i], lenr);</span><br><span class="line">			add[i] = <span class="number">0</span>;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> add1 = [&amp;](<span class="keyword">auto</span> &amp;&amp; f,<span class="type">int</span> i, <span class="type">int</span> val, <span class="type">int</span> basel, <span class="type">int</span> baser, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(basel &lt;= l &amp;&amp; baser &gt;= r)&#123;</span><br><span class="line">				<span class="built_in">lazy</span>(i, val, r - l + <span class="number">1</span>);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">down</span>(i, mid - l + <span class="number">1</span>, r - mid);</span><br><span class="line">				<span class="keyword">if</span>(basel &lt;= mid)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, val, basel, baser, l, mid);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(baser &gt;= mid + <span class="number">1</span>)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, val, basel ,baser, mid + <span class="number">1</span>, r);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="built_in">up</span>(i);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="built_in">build</span>(build, <span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">		<span class="keyword">auto</span> query = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> basel, <span class="type">int</span> baser, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(basel &lt;= l &amp;&amp; baser &gt;= r)&#123;</span><br><span class="line">				<span class="keyword">return</span> sum[i];</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">down</span>(i, mid - l + <span class="number">1</span>, r - mid);</span><br><span class="line">				<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">if</span>(basel &lt;= mid)&#123;</span><br><span class="line">					ans += <span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, basel, baser, l, mid);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(baser &gt;= mid + <span class="number">1</span>)&#123;</span><br><span class="line">					ans += <span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, basel, baser, mid + <span class="number">1</span>, r);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">return</span> ans;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; q; i ++)&#123;</span><br><span class="line">			<span class="type">int</span> op;</span><br><span class="line">			cin &gt;&gt; op;</span><br><span class="line">			<span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">				<span class="type">int</span> l, r, val;</span><br><span class="line">				cin &gt;&gt; l &gt;&gt; r &gt;&gt; val;</span><br><span class="line">				<span class="built_in">add1</span>(add1, <span class="number">1</span>, val, l , r, <span class="number">1</span>, n);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="type">int</span> l, r;</span><br><span class="line">				cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">				cout &lt;&lt; <span class="built_in">query</span>(query, <span class="number">1</span>, l, r, <span class="number">1</span>, n) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æœ‰ä¼˜å…ˆçº§è°ƒæ•´çš„å¤šèŒƒå›´ä¿®æ”¹ä»»åŠ¡"><a href="#æœ‰ä¼˜å…ˆçº§è°ƒæ•´çš„å¤šèŒƒå›´ä¿®æ”¹ä»»åŠ¡" class="headerlink" title="æœ‰ä¼˜å…ˆçº§è°ƒæ•´çš„å¤šèŒƒå›´ä¿®æ”¹ä»»åŠ¡"></a>æœ‰ä¼˜å…ˆçº§è°ƒæ•´çš„å¤šèŒƒå›´ä¿®æ”¹ä»»åŠ¡</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P1253</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>) -&gt; ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--)&#123;</span><br><span class="line">		 <span class="type">int</span> n, q;</span><br><span class="line">		 cin &gt;&gt; n &gt;&gt; q;</span><br><span class="line">		 <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">change</span><span class="params">((n &lt;&lt; <span class="number">2</span>))</span>, <span class="title">max1</span><span class="params">((n &lt;&lt; <span class="number">2</span>))</span>, <span class="title">add</span><span class="params">((n &lt;&lt; <span class="number">2</span>))</span></span>;</span><br><span class="line">		 <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">has</span><span class="params">((n &lt;&lt; <span class="number">2</span>))</span></span>;</span><br><span class="line">		 <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">		 	cin &gt;&gt; v1[i];</span><br><span class="line">		 &#125;</span><br><span class="line">		 <span class="keyword">auto</span> biuld = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">		 	<span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">			 	 max1[i] = v1[l];</span><br><span class="line">		 	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		 		<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">		 		<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">		 		<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">		 		max1[i] = <span class="built_in">max</span>(max1[i &lt;&lt; <span class="number">1</span>], max1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);</span><br><span class="line">		 	&#125;</span><br><span class="line">		 	has[i] = <span class="literal">false</span>;</span><br><span class="line">		 	add[i] = <span class="number">0</span>;</span><br><span class="line">		 &#125;;</span><br><span class="line">		 <span class="built_in">biuld</span>(biuld, <span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">		 <span class="keyword">auto</span> up = [&amp;](<span class="type">int</span> i) &#123;</span><br><span class="line">		 	max1[i] = <span class="built_in">max</span>(max1[i &lt;&lt; <span class="number">1</span>], max1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);</span><br><span class="line">		 &#125;;</span><br><span class="line">		 <span class="keyword">auto</span> lazyadd = [&amp;](<span class="type">int</span> i, <span class="type">int</span> val) &#123;</span><br><span class="line">		 	max1[i] += val;</span><br><span class="line">		 	add[i] += val;</span><br><span class="line">		 &#125;;</span><br><span class="line">		 <span class="keyword">auto</span> lazyset = [&amp;](<span class="type">int</span> i, <span class="type">int</span> val) &#123;</span><br><span class="line">		 	max1[i] = val;</span><br><span class="line">		 	change[i] = val;</span><br><span class="line">		 	add[i] = <span class="number">0</span>;</span><br><span class="line">		 	has[i] = <span class="literal">true</span>;</span><br><span class="line">		 &#125;;</span><br><span class="line">		 <span class="keyword">auto</span> down = [&amp;](<span class="type">int</span> i) &#123;</span><br><span class="line">			<span class="keyword">if</span>(has[i])&#123;</span><br><span class="line">				<span class="built_in">lazyset</span>(i &lt;&lt; <span class="number">1</span>, change[i]);</span><br><span class="line">				<span class="built_in">lazyset</span>(i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, change[i]);</span><br><span class="line">				has[i] = <span class="literal">false</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(add[i])&#123;</span><br><span class="line">				<span class="built_in">lazyadd</span>(i &lt;&lt; <span class="number">1</span>, add[i]);</span><br><span class="line">				<span class="built_in">lazyadd</span>(i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, add[i]);</span><br><span class="line">				add[i] = <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		 &#125;;</span><br><span class="line">		 <span class="keyword">auto</span> add1 = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> val, <span class="type">int</span> basel, <span class="type">int</span> baser, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">		 	<span class="keyword">if</span>(basel &lt;= l &amp;&amp; baser &gt;= r)&#123;</span><br><span class="line">		 		<span class="built_in">lazyadd</span>(i, val);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">down</span>(i);</span><br><span class="line">				<span class="keyword">if</span>(basel &lt;= mid)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, val, basel, baser, l, mid);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(baser &gt; mid)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, val, basel, baser, mid + <span class="number">1</span>, r);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="built_in">up</span>(i);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> set = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> val, <span class="type">int</span> basel, <span class="type">int</span> baser, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(basel &lt;= l &amp;&amp; baser &gt;= r)&#123;</span><br><span class="line">				<span class="built_in">lazyset</span>(i, val);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">down</span>(i);</span><br><span class="line">				<span class="keyword">if</span>(basel &lt;= mid)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, val, basel, baser, l, mid);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(baser &gt; mid)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, val, basel, baser, mid + <span class="number">1</span>, r);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="built_in">up</span>(i);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> query = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> basel, <span class="type">int</span> baser, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">int</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(basel &lt;= l &amp;&amp; baser &gt;= r)&#123;</span><br><span class="line">				<span class="keyword">return</span> max1[i];</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">down</span>(i);</span><br><span class="line">				<span class="type">int</span> ans = <span class="number">-1e18</span>;</span><br><span class="line">				<span class="keyword">if</span>(basel &lt;= mid)&#123;</span><br><span class="line">					ans = <span class="built_in">max</span>(ans, <span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, basel, baser, l, mid));</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(baser &gt; mid)&#123;</span><br><span class="line">					ans = <span class="built_in">max</span>(ans, <span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, basel, baser, mid + <span class="number">1</span>, r));</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">return</span> ans;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; q; i ++)&#123;</span><br><span class="line">			<span class="type">int</span> op;</span><br><span class="line">			cin &gt;&gt; op;</span><br><span class="line">			<span class="type">int</span> l, r;</span><br><span class="line">			cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">			<span class="keyword">if</span>(op == <span class="number">2</span>)&#123;</span><br><span class="line">				<span class="type">int</span> x;</span><br><span class="line">				cin &gt;&gt; x;</span><br><span class="line">				<span class="built_in">add1</span>(add1, <span class="number">1</span>, x, l, r, <span class="number">1</span>, n);</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">				<span class="type">int</span> x;</span><br><span class="line">				cin &gt;&gt; x;</span><br><span class="line">				<span class="built_in">set</span>(set, <span class="number">1</span>, x, l, r, <span class="number">1</span>, n);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				cout &lt;&lt; <span class="built_in">query</span>(query, <span class="number">1</span>, l, r, <span class="number">1</span>, n) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ç¦»æ•£åŒ–"><a href="#ç¦»æ•£åŒ–" class="headerlink" title="ç¦»æ•£åŒ–"></a>ç¦»æ•£åŒ–</h4><p>ç¦»æ•£åŒ–ä¹‹åè¦æ³¨æ„é—´éš™ï¼Œå¦‚è¦†ç›–é—®é¢˜ï¼Œè¦åœ¨ç¦»æ•£åŒ–ä¹‹åçš„ä¸¤ä¸ªå·®å€¼ä¸ä¸ºä¸€içš„æ•°æ®ä¸­é—´æ·»åŠ ä¸€ä¸ªæ•°</p>
<h4 id="åŒºé—´æœ€å€¼å’Œå†å²æœ€å€¼"><a href="#åŒºé—´æœ€å€¼å’Œå†å²æœ€å€¼" class="headerlink" title="åŒºé—´æœ€å€¼å’Œå†å²æœ€å€¼"></a>åŒºé—´æœ€å€¼å’Œå†å²æœ€å€¼</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P6242</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="type">int</span> n, m;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">max1</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span>,    <span class="comment">// åŒºé—´å½“å‰æœ€å¤§å€¼</span></span></span><br><span class="line"><span class="function">                    <span class="title">sec</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span>,     <span class="comment">// åŒºé—´ä¸¥æ ¼æ¬¡å¤§å€¼</span></span></span><br><span class="line"><span class="function">                    <span class="title">cnt</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span>,     <span class="comment">// åŒºé—´ç­‰äºæœ€å¤§å€¼çš„å…ƒç´ ä¸ªæ•°</span></span></span><br><span class="line"><span class="function">                    <span class="title">sum</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span>,     <span class="comment">// åŒºé—´å…ƒç´ å’Œ</span></span></span><br><span class="line"><span class="function">                    <span class="title">his</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span>,     <span class="comment">// åŒºé—´å†å²æœ€å¤§å€¼ï¼ˆæ›¾ç»å‡ºç°è¿‡çš„æœ€å¤§å€¼ï¼‰</span></span></span><br><span class="line"><span class="function">                    <span class="title">add1</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span>,    <span class="comment">// æ‡’æ ‡è®° Aï¼šå¯¹â€œå½“å‰æœ€å¤§å€¼å…ƒç´ â€åšåŠ æ³•</span></span></span><br><span class="line"><span class="function">                    <span class="title">add2</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span>,    <span class="comment">// æ‡’æ ‡è®° Bï¼šå¯¹â€œéæœ€å¤§å€¼å…ƒç´ â€åšåŠ æ³•</span></span></span><br><span class="line"><span class="function">                    <span class="title">adds1</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span>,   <span class="comment">// å†å²æœ€å¤§å€¼æ‡’æ ‡è®° A</span></span></span><br><span class="line"><span class="function">                    <span class="title">adds2</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span></span>;   <span class="comment">// å†å²æœ€å¤§å€¼æ‡’æ ‡è®° B</span></span><br><span class="line">        <span class="keyword">auto</span> up = [&amp;](<span class="type">int</span> i)&#123;</span><br><span class="line">            sum[i] = sum[i&lt;&lt;<span class="number">1</span>] + sum[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">            his[i] = <span class="built_in">max</span>(his[i&lt;&lt;<span class="number">1</span>], his[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">            max1[i] = <span class="built_in">max</span>(max1[i&lt;&lt;<span class="number">1</span>], max1[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">            <span class="comment">// åˆå¹¶ cnt ä¸ sec</span></span><br><span class="line">            <span class="keyword">if</span>(max1[i&lt;&lt;<span class="number">1</span>] == max1[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>])&#123;</span><br><span class="line">                cnt[i] = cnt[i&lt;&lt;<span class="number">1</span>] + cnt[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">                sec[i] = <span class="built_in">max</span>(sec[i&lt;&lt;<span class="number">1</span>], sec[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(max1[i&lt;&lt;<span class="number">1</span>] &gt; max1[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>])&#123;</span><br><span class="line">                cnt[i] = cnt[i&lt;&lt;<span class="number">1</span>];</span><br><span class="line">                sec[i] = <span class="built_in">max</span>(sec[i&lt;&lt;<span class="number">1</span>], max1[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                cnt[i] = cnt[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">                sec[i] = <span class="built_in">max</span>(sec[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>], max1[i&lt;&lt;<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">auto</span> build = [&amp;](<span class="keyword">auto</span>&amp;&amp; self, <span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">                <span class="type">int</span> x;</span><br><span class="line">                cin &gt;&gt; x;</span><br><span class="line">                max1[i] = sum[i] = his[i] = x;  <span class="comment">// å½“å‰å€¼ã€åŒºé—´å’Œå€¼ã€å†å²æœ€å¤§å‡ä¸º x</span></span><br><span class="line">                cnt[i] = <span class="number">1</span>;                     <span class="comment">// åªæœ‰ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">                sec[i] = LLONG_MIN / <span class="number">2</span>;         <span class="comment">// æ¬¡å¤§å€¼è®¾ä¸º -INFï¼ˆç”¨å¾ˆå°çš„æ•°ï¼‰</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>, l, mid);</span><br><span class="line">                <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r);</span><br><span class="line">                <span class="built_in">up</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ‡’æ ‡è®°åˆå§‹ä¸º 0</span></span><br><span class="line">            add1[i] = add2[i] = adds1[i] = adds2[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="built_in">build</span>(build, <span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">        <span class="comment">// æ ¸å¿ƒæ‡’æ ‡è®°ä¸‹å‘å‡½æ•°</span></span><br><span class="line">        <span class="comment">// val1: åŠ åˆ°â€œå½“å‰æœ€å¤§å€¼å…ƒç´ â€ä¸Šçš„å¢é‡</span></span><br><span class="line">        <span class="comment">// val2: åŠ åˆ°â€œéæœ€å¤§å€¼å…ƒç´ â€ä¸Šçš„å¢é‡</span></span><br><span class="line">        <span class="comment">// val3/val4: ç”¨äºæ›´æ–°å†å²æœ€å¤§å€¼çš„å¢é‡</span></span><br><span class="line">        <span class="comment">// len: æœ¬åŒºé—´é•¿åº¦</span></span><br><span class="line">        <span class="keyword">auto</span> lazy = [&amp;](<span class="type">int</span> i, <span class="type">int</span> val1, <span class="type">int</span> val2, <span class="type">int</span> val3, <span class="type">int</span> val4, <span class="type">int</span> len)&#123;</span><br><span class="line">            <span class="comment">// æ›´æ–°å†å²æœ€å¤§å€¼</span></span><br><span class="line">            his[i] = <span class="built_in">max</span>(his[i], max1[i] + val3);</span><br><span class="line">            <span class="comment">// æ›´æ–°å­æ ‘çš„å†å²æ‡’æ ‡è®°</span></span><br><span class="line">            adds1[i] = <span class="built_in">max</span>(adds1[i], add1[i] + val3);</span><br><span class="line">            adds2[i] = <span class="built_in">max</span>(adds2[i], add2[i] + val4);</span><br><span class="line">            <span class="comment">// åŒºé—´å’Œæ›´æ–°</span></span><br><span class="line">            sum[i] += val1 * cnt[i] + val2 * (len - cnt[i]);</span><br><span class="line">            <span class="comment">// æ›´æ–°â€œå½“å‰æœ€å¤§å€¼â€ä¸â€œéæœ€å¤§å€¼â€æ‡’æ ‡è®°</span></span><br><span class="line">            add1[i] += val1;</span><br><span class="line">            add2[i] += val2;</span><br><span class="line">            <span class="comment">// æ›´æ–°å½“å‰æœ€å¤§å€¼</span></span><br><span class="line">            max1[i] += val1;</span><br><span class="line">            <span class="comment">// æ¬¡å¤§å€¼ä¹Ÿéœ€åŠ  val2ï¼ˆè‹¥ä¸å­˜åœ¨åˆ™ä¿æŒ -INFï¼‰</span></span><br><span class="line">            <span class="keyword">if</span>(sec[i] &gt; LLONG_MIN/<span class="number">2</span>) sec[i] += val2;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// ä¸‹æ¨å‡½æ•°ï¼šå°† i èŠ‚ç‚¹çš„æ‡’æ ‡è®°ä¼ é€’ç»™å·¦å³å­èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">auto</span> down = [&amp;](<span class="type">int</span> i, <span class="type">int</span> lenL, <span class="type">int</span> lenR)&#123;</span><br><span class="line">            <span class="comment">// å·¦å³å­èŠ‚ç‚¹æ–°çš„â€œå½“å‰æœ€å¤§â€å€¼</span></span><br><span class="line">            <span class="type">int</span> tL = max1[i&lt;&lt;<span class="number">1</span>], tR = max1[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">            <span class="comment">// çˆ¶èŠ‚ç‚¹æœ€é«˜å€¼</span></span><br><span class="line">            <span class="type">int</span> mx = <span class="built_in">max</span>(max1[i&lt;&lt;<span class="number">1</span>], max1[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">            <span class="comment">// å·¦å­æ ‘</span></span><br><span class="line">            <span class="keyword">if</span>(tL == mx)&#123;</span><br><span class="line">                <span class="comment">// å·¦å­æ ‘ä¸­æœ‰çˆ¶åŒºé—´æœ€å¤§å€¼å…ƒç´ </span></span><br><span class="line">                <span class="built_in">lazy</span>(i&lt;&lt;<span class="number">1</span>, add1[i], add2[i], adds1[i], adds2[i], lenL);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// å·¦å­æ ‘ä¸­åªæœ‰â€œéæœ€å¤§å€¼â€å…ƒç´ </span></span><br><span class="line">                <span class="built_in">lazy</span>(i&lt;&lt;<span class="number">1</span>, add2[i], add2[i], adds2[i], adds2[i], lenL);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å³å­æ ‘ï¼ˆåŒç†ï¼‰</span></span><br><span class="line">            <span class="keyword">if</span>(tR == mx)&#123;</span><br><span class="line">                <span class="built_in">lazy</span>(i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, add1[i], add2[i], adds1[i], adds2[i], lenR);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">lazy</span>(i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, add2[i], add2[i], adds2[i], adds2[i], lenR);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ¸…ç©ºçˆ¶èŠ‚ç‚¹æ‡’æ ‡è®°</span></span><br><span class="line">            add1[i] = add2[i] = adds1[i] = adds2[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// åŒºé—´åŠ æ³• [bl,br] å…¨åŠ  val</span></span><br><span class="line">        <span class="keyword">auto</span> addRange = [&amp;](<span class="keyword">auto</span>&amp;&amp; self, <span class="type">int</span> i, <span class="type">int</span> bl, <span class="type">int</span> br, <span class="type">int</span> val, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(bl &lt;= l &amp;&amp; r &lt;= br)&#123;</span><br><span class="line">                <span class="comment">// ç»Ÿä¸€æ‰“æ‡’æ ‡è®°ï¼Œval1=val2=val3=val4=val</span></span><br><span class="line">                <span class="built_in">lazy</span>(i, val, val, val, val, r-l+<span class="number">1</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">down</span>(i, mid-l+<span class="number">1</span>, r-mid);</span><br><span class="line">                <span class="keyword">if</span>(bl &lt;= mid)      <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>, bl, br, val, l, mid);</span><br><span class="line">                <span class="keyword">if</span>(br &gt; mid)       <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, bl, br, val, mid+<span class="number">1</span>, r);</span><br><span class="line">                <span class="built_in">up</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// åŒºé—´ chminï¼šæŠŠåŒºé—´å†…æ‰€æœ‰å¤§äº val çš„å€¼é™åˆ° val</span></span><br><span class="line">        <span class="keyword">auto</span> chminRange = [&amp;](<span class="keyword">auto</span>&amp;&amp; self, <span class="type">int</span> i, <span class="type">int</span> bl, <span class="type">int</span> br, <span class="type">int</span> val, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(max1[i] &lt;= val) <span class="keyword">return</span>;  <span class="comment">// æœ¬åŒºé—´æœ€å¤§å€¼å·² â‰¤ valï¼Œæ— éœ€æ“ä½œ</span></span><br><span class="line">            <span class="keyword">if</span>(bl &lt;= l &amp;&amp; r &lt;= br &amp;&amp; sec[i] &lt; val)&#123;</span><br><span class="line">                <span class="comment">// å…¨åŒºé—´æœ€å¤§å€¼éƒ½å¤§äº valï¼Œä¸”æ¬¡å¤§å€¼ &lt; val</span></span><br><span class="line">                <span class="comment">// åªéœ€æŠŠâ€œæœ€å¤§å€¼å…ƒç´ â€é™åˆ° val</span></span><br><span class="line">                <span class="built_in">lazy</span>(i, val-max1[i], <span class="number">0</span>, val-max1[i], <span class="number">0</span>, r-l+<span class="number">1</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">down</span>(i, mid-l+<span class="number">1</span>, r-mid);</span><br><span class="line">                <span class="keyword">if</span>(bl &lt;= mid)      <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>, bl, br, val, l, mid);</span><br><span class="line">                <span class="keyword">if</span>(br &gt; mid)       <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, bl, br, val, mid+<span class="number">1</span>, r);</span><br><span class="line">                <span class="built_in">up</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// åŒºé—´æ±‚å’Œ</span></span><br><span class="line">        <span class="keyword">auto</span> querySum = [&amp;](<span class="keyword">auto</span>&amp;&amp; self, <span class="type">int</span> i, <span class="type">int</span> bl, <span class="type">int</span> br, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(bl &lt;= l &amp;&amp; r &lt;= br)&#123;</span><br><span class="line">                <span class="keyword">return</span> sum[i];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">down</span>(i, mid-l+<span class="number">1</span>, r-mid);</span><br><span class="line">                <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span>(bl &lt;= mid)    res += <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>, bl, br, l, mid);</span><br><span class="line">                <span class="keyword">if</span>(br &gt; mid)     res += <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, bl, br, mid+<span class="number">1</span>, r);</span><br><span class="line">                <span class="keyword">return</span> res;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// åŒºé—´æœ€å¤§å€¼</span></span><br><span class="line">        <span class="keyword">auto</span> queryMax = [&amp;](<span class="keyword">auto</span>&amp;&amp; self, <span class="type">int</span> i, <span class="type">int</span> bl, <span class="type">int</span> br, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(bl &lt;= l &amp;&amp; r &lt;= br)&#123;</span><br><span class="line">                <span class="keyword">return</span> max1[i];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">down</span>(i, mid-l+<span class="number">1</span>, r-mid);</span><br><span class="line">                <span class="type">int</span> res = LLONG_MIN/<span class="number">2</span>;</span><br><span class="line">                <span class="keyword">if</span>(bl &lt;= mid)    res = <span class="built_in">max</span>(res, <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>, bl, br, l, mid));</span><br><span class="line">                <span class="keyword">if</span>(br &gt; mid)     res = <span class="built_in">max</span>(res, <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, bl, br, mid+<span class="number">1</span>, r));</span><br><span class="line">                <span class="keyword">return</span> res;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// åŒºé—´å†å²æœ€å¤§å€¼</span></span><br><span class="line">        <span class="keyword">auto</span> queryHis = [&amp;](<span class="keyword">auto</span>&amp;&amp; self, <span class="type">int</span> i, <span class="type">int</span> bl, <span class="type">int</span> br, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(bl &lt;= l &amp;&amp; r &lt;= br)&#123;</span><br><span class="line">                <span class="keyword">return</span> his[i];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">down</span>(i, mid-l+<span class="number">1</span>, r-mid);</span><br><span class="line">                <span class="type">int</span> res = LLONG_MIN/<span class="number">2</span>;</span><br><span class="line">                <span class="keyword">if</span>(bl &lt;= mid)    res = <span class="built_in">max</span>(res, <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>, bl, br, l, mid));</span><br><span class="line">                <span class="keyword">if</span>(br &gt; mid)     res = <span class="built_in">max</span>(res, <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, bl, br, mid+<span class="number">1</span>, r));</span><br><span class="line">                <span class="keyword">return</span> res;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// å¤„ç† m æ¬¡æ“ä½œ</span></span><br><span class="line">        <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">            <span class="type">int</span> op, l, r;</span><br><span class="line">            cin &gt;&gt; op &gt;&gt; l &gt;&gt; r;</span><br><span class="line">            <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">                <span class="type">int</span> x; cin &gt;&gt; x;</span><br><span class="line">                <span class="built_in">addRange</span>(addRange, <span class="number">1</span>, l, r, x, <span class="number">1</span>, n);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)&#123;</span><br><span class="line">                <span class="type">int</span> x; cin &gt;&gt; x;</span><br><span class="line">                <span class="built_in">chminRange</span>(chminRange, <span class="number">1</span>, l, r, x, <span class="number">1</span>, n);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">3</span>)&#123;</span><br><span class="line">                cout &lt;&lt; <span class="built_in">querySum</span>(querySum, <span class="number">1</span>, l, r, <span class="number">1</span>, n) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">4</span>)&#123;</span><br><span class="line">                cout &lt;&lt; <span class="built_in">queryMax</span>(queryMax, <span class="number">1</span>, l, r, <span class="number">1</span>, n) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">5</span>)&#123;</span><br><span class="line">                cout &lt;&lt; <span class="built_in">queryHis</span>(queryHis, <span class="number">1</span>, l, r, <span class="number">1</span>, n) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ç»“åˆæ‘©å°”æŠ•ç¥¨"><a href="#ç»“åˆæ‘©å°”æŠ•ç¥¨" class="headerlink" title="ç»“åˆæ‘©å°”æŠ•ç¥¨"></a>ç»“åˆæ‘©å°”æŠ•ç¥¨</h4><h5 id="ç»å…¸æ‘©å°”æŠ•ç¥¨ï¼Œæ±‚æ•°ç»„ä¸­å‡ºç°æ¬¡æ•°å¤§äº-frac-n-2-d-æ•°"><a href="#ç»å…¸æ‘©å°”æŠ•ç¥¨ï¼Œæ±‚æ•°ç»„ä¸­å‡ºç°æ¬¡æ•°å¤§äº-frac-n-2-d-æ•°" class="headerlink" title="ç»å…¸æ‘©å°”æŠ•ç¥¨ï¼Œæ±‚æ•°ç»„ä¸­å‡ºç°æ¬¡æ•°å¤§äº$\frac{n}{2}$d æ•°"></a>ç»å…¸æ‘©å°”æŠ•ç¥¨ï¼Œæ±‚æ•°ç»„ä¸­å‡ºç°æ¬¡æ•°å¤§äº$\frac{n}{2}$d æ•°</h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">majorityElement</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">  		<span class="type">int</span> now = <span class="number">-1</span>, cnt = <span class="number">0</span>;</span><br><span class="line">  		<span class="keyword">for</span>(<span class="keyword">auto</span> x : nums)&#123;</span><br><span class="line">  			<span class="keyword">if</span>(!cnt)&#123;</span><br><span class="line">  				now = x;</span><br><span class="line">  				cnt = <span class="number">1</span>;</span><br><span class="line">  			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  				<span class="keyword">if</span>(now == x)&#123;</span><br><span class="line">  					cnt ++;</span><br><span class="line">  				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  					cnt --;</span><br><span class="line">  				&#125;</span><br><span class="line">  			&#125;</span><br><span class="line">  		&#125;</span><br><span class="line">  		<span class="keyword">return</span> now;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="ç»“åˆçº¿æ®µæ ‘æ±‚åŒºé—´æµ·ç‹æ•°"><a href="#ç»“åˆçº¿æ®µæ ‘æ±‚åŒºé—´æµ·ç‹æ•°" class="headerlink" title="ç»“åˆçº¿æ®µæ ‘æ±‚åŒºé—´æµ·ç‹æ•°"></a>ç»“åˆçº¿æ®µæ ‘æ±‚åŒºé—´æµ·ç‹æ•°</h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://leetcode.cn/problems/online-majority-element-in-subarray/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MajorityChecker</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; val, cnt, v1;</span><br><span class="line">	vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt; v2;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(!cnt[i &lt;&lt; <span class="number">1</span>] &amp;&amp; !cnt[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>])&#123;</span><br><span class="line">			cnt[i] = <span class="number">0</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(!cnt[i &lt;&lt; <span class="number">1</span>])&#123;</span><br><span class="line">			cnt[i] = cnt[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">			val[i] = val[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(!cnt[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>])&#123;</span><br><span class="line">			cnt[i] = cnt[i &lt;&lt; <span class="number">1</span>];</span><br><span class="line">			val[i] = val[i &lt;&lt; <span class="number">1</span>];</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(val[i &lt;&lt; <span class="number">1</span>] == val[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>])&#123;</span><br><span class="line">				val[i] = val[i &lt;&lt; <span class="number">1</span>];</span><br><span class="line">				cnt[i] = cnt[i &lt;&lt; <span class="number">1</span>] + cnt[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">if</span>(cnt[i &lt;&lt; <span class="number">1</span>] &gt;= cnt[i &lt;&lt; <span class="number">1</span>| <span class="number">1</span>])&#123;</span><br><span class="line">					val[i] = val[i &lt;&lt; <span class="number">1</span>];</span><br><span class="line">					cnt[i] = cnt[i &lt;&lt; <span class="number">1</span>] - cnt[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					val[i] = val[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">					cnt[i] = cnt[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] - cnt[i &lt;&lt; <span class="number">1</span>];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">			cnt[i] = <span class="number">1</span>;</span><br><span class="line">			val[i] = v1[l];</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			<span class="built_in">build</span>(i &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">			<span class="built_in">build</span>(i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">			<span class="built_in">up</span>(i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; <span class="title">get</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> bl, <span class="type">int</span> br, <span class="type">int</span> l, <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(bl &lt;= l &amp;&amp; br &gt;= r)&#123;</span><br><span class="line">			<span class="keyword">return</span> &#123;val[i], cnt[i]&#125;;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; left = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;, right = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;, ans;</span><br><span class="line">			<span class="keyword">if</span>(bl &lt;= mid)&#123;</span><br><span class="line">				left = <span class="built_in">get</span>(i &lt;&lt; <span class="number">1</span>, bl, br, l, mid);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(br &gt; mid)&#123;</span><br><span class="line">				right = <span class="built_in">get</span>(i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, bl, br, mid + <span class="number">1</span>, r);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(!left.sc &amp;&amp; !right.sc)&#123;</span><br><span class="line">				ans.sc = <span class="number">0</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(!left.sc)&#123;</span><br><span class="line">				ans.fr = right.fr;</span><br><span class="line">				ans.sc = right.sc;</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(!right.sc)&#123;</span><br><span class="line">				ans.fr = left.fr;</span><br><span class="line">				ans.sc = left.sc;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">if</span>(left.fr == right.fr)&#123;</span><br><span class="line">					ans.fr = left.fr;</span><br><span class="line">					ans.sc = left.sc + right.sc;</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					<span class="keyword">if</span>(left.sc &gt;= right.sc)&#123;</span><br><span class="line">						ans.fr = left.fr;</span><br><span class="line">						ans.sc = left.sc - right.sc;</span><br><span class="line">					&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">						ans.fr = right.fr;</span><br><span class="line">						ans.sc = right.sc - left.sc;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> ans;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> in)</span> </span>&#123;</span><br><span class="line">		<span class="type">int</span> l = <span class="number">0</span>, r = n - <span class="number">1</span>;</span><br><span class="line">		<span class="type">int</span> mid, ans = <span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">			mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(v2[mid].fr &gt; x)&#123;</span><br><span class="line">				r = mid - <span class="number">1</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(v2[mid].fr &lt; x)&#123;</span><br><span class="line">				l = mid + <span class="number">1</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(v2[mid].sc &gt;= in)&#123;</span><br><span class="line">                    				ans = mid;</span><br><span class="line">					r = mid - <span class="number">1</span>;</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					l = mid + <span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line">	&#125;;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">find2</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> in)</span> </span>&#123;</span><br><span class="line">		<span class="type">int</span> l = <span class="number">0</span>, r = n - <span class="number">1</span>;</span><br><span class="line">		<span class="type">int</span> mid, ans = <span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">			mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(v2[mid].fr &gt; x)&#123;</span><br><span class="line">				r = mid - <span class="number">1</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(v2[mid].fr &lt; x)&#123;</span><br><span class="line">				l = mid + <span class="number">1</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(v2[mid].sc &lt;= in)&#123;</span><br><span class="line">                    				ans = mid;</span><br><span class="line">					l = mid + <span class="number">1</span>;</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					r = mid - <span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line">	&#125;;</span><br><span class="line">    <span class="built_in">MajorityChecker</span>(vector&lt;<span class="type">int</span>&gt;&amp; arr) &#123;</span><br><span class="line">    	v1.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">auto</span> x : arr)&#123;</span><br><span class="line">    		v1.<span class="built_in">push_back</span>(x);</span><br><span class="line">    	&#125;</span><br><span class="line">     	n = arr.<span class="built_in">size</span>();</span><br><span class="line">     	val.<span class="built_in">resize</span>(n &lt;&lt; <span class="number">2</span>);</span><br><span class="line">     	cnt.<span class="built_in">resize</span>(n &lt;&lt; <span class="number">2</span>); </span><br><span class="line">     	<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">     	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">     		v2.<span class="built_in">push_back</span>(&#123;v1[i], i&#125;);</span><br><span class="line">     	&#125;</span><br><span class="line">     	<span class="built_in">sort</span>(v2.<span class="built_in">begin</span>(), v2.<span class="built_in">end</span>(), [](pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; a, pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; b)&#123;</span><br><span class="line">     		<span class="keyword">if</span>(a.fr == b.fr)&#123;</span><br><span class="line">     			<span class="keyword">return</span> a.sc &lt; b.sc;</span><br><span class="line">     		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">     			<span class="keyword">return</span> a.fr &lt; b.fr;</span><br><span class="line">     		&#125;</span><br><span class="line">     	&#125;);</span><br><span class="line">        <span class="comment">// for(int i = 0; i &lt; n; i ++)&#123;</span></span><br><span class="line">        <span class="comment">//     cout &lt;&lt; v2[i].fr &lt;&lt; &quot; &quot; &lt;&lt; v2[i].sc &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> left, <span class="type">int</span> right, <span class="type">int</span> threshold)</span> </span>&#123;</span><br><span class="line">    	left ++, right ++;</span><br><span class="line">    	pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; temp = <span class="built_in">get</span>(<span class="number">1</span>, left, right, <span class="number">1</span>, n);</span><br><span class="line">    	<span class="keyword">if</span>(temp.sc == <span class="number">0</span>)&#123;</span><br><span class="line">    		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    	&#125;</span><br><span class="line">        <span class="comment">// cout &lt;&lt; temp.fr &lt;&lt; &quot; &quot; &lt;&lt;  temp.sc &lt;&lt; &quot; &quot;;</span></span><br><span class="line">    	<span class="type">int</span> l = <span class="built_in">find</span>(temp.fr, left), r = <span class="built_in">find2</span>(temp.fr, right);</span><br><span class="line">        <span class="comment">// cout &lt;&lt; &quot;L; &quot; &lt;&lt;  left &lt;&lt; &quot; R: &quot; &lt;&lt; right &lt;&lt; &quot; l1: &quot; &lt;&lt; l &lt;&lt; &quot; r1: &quot; &lt;&lt; r &lt;&lt; &quot;\n&quot;; </span></span><br><span class="line">    	<span class="keyword">return</span> (r - l + <span class="number">1</span>) &gt;= threshold ? temp.fr : <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="æ±‚ä¸€ä¸ªæ•°ç»„ä¸­æŸä¸€ä¸ªåŒºé—´å‡ºç°äº†æŸä¸ªæ•°çš„æ¬¡æ•°"><a href="#æ±‚ä¸€ä¸ªæ•°ç»„ä¸­æŸä¸€ä¸ªåŒºé—´å‡ºç°äº†æŸä¸ªæ•°çš„æ¬¡æ•°" class="headerlink" title="æ±‚ä¸€ä¸ªæ•°ç»„ä¸­æŸä¸€ä¸ªåŒºé—´å‡ºç°äº†æŸä¸ªæ•°çš„æ¬¡æ•°"></a>æ±‚ä¸€ä¸ªæ•°ç»„ä¸­æŸä¸€ä¸ªåŒºé—´å‡ºç°äº†æŸä¸ªæ•°çš„æ¬¡æ•°</h5><p>å‚è€ƒä¸Šé¢æ‘©å°”æŠ•ç¥¨ç»“åˆçº¿æ®µæ ‘çš„ä¾‹å­ï¼Œå°†ä¸€ä¸ªæ•°ç»„æŒ‰ç…§æ•°çš„å¤§å°å’Œå‡ºç°é¡ºåºå‡åºæ’åºï¼Œç„¶åç”¨ä¸åŒé€»è¾‘çš„äºŒåˆ†æŸ¥æ‰¾å¾—åˆ°ç›¸å¯¹ä½ç½®</p>
<h4 id="æŸ¥è¯¢æœ€å€¼ä»¥åŠå‡ºç°ä½ç½®"><a href="#æŸ¥è¯¢æœ€å€¼ä»¥åŠå‡ºç°ä½ç½®" class="headerlink" title="æŸ¥è¯¢æœ€å€¼ä»¥åŠå‡ºç°ä½ç½®"></a>æŸ¥è¯¢æœ€å€¼ä»¥åŠå‡ºç°ä½ç½®</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://ac.nowcoder.com/acm/contest/108307/F</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1e6</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">r</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">p</span><span class="params">(N + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">W</span><span class="params">(N &lt;&lt; <span class="number">2</span> | <span class="number">1</span>)</span>, <span class="title">add1</span><span class="params">(N &lt;&lt; <span class="number">2</span> | <span class="number">1</span>)</span>, <span class="title">P</span><span class="params">(N &lt;&lt; <span class="number">2</span> | <span class="number">1</span>)</span>, <span class="title">L</span><span class="params">(N + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>)-&gt;ios_base::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    <span class="keyword">auto</span> build = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">    	add1[i] = W[i] = <span class="number">0</span>;</span><br><span class="line">    	P[i] = r;</span><br><span class="line">    	<span class="keyword">if</span>(l != r) &#123;</span><br><span class="line">    		<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    		<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">    		<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">	<span class="keyword">auto</span> up = [&amp;](<span class="type">int</span> i) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(W[i &lt;&lt; <span class="number">1</span>] &gt;= W[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]) W[i] = W[i &lt;&lt; <span class="number">1</span>], P[i] = P[i &lt;&lt; <span class="number">1</span>];</span><br><span class="line">		<span class="keyword">else</span> W[i] = W[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>], P[i] = P[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">	&#125;;</span><br><span class="line">    <span class="keyword">auto</span> lazy = [&amp;](<span class="type">int</span> i, <span class="type">int</span> w) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">    	W[i] += w, add1[i] += w;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">auto</span> down = [&amp;](<span class="type">int</span> i) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">    	<span class="built_in">lazy</span>(i &lt;&lt; <span class="number">1</span>, add1[i]), <span class="built_in">lazy</span>(i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, add1[i]);</span><br><span class="line">    	add1[i] = <span class="number">0</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">auto</span> add = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> L, <span class="type">int</span> R, <span class="type">int</span> w) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">    	<span class="keyword">if</span>(l &gt;= L &amp;&amp; r &lt;= R) <span class="keyword">return</span> <span class="built_in">lazy</span>(i, w);</span><br><span class="line">    	<span class="built_in">down</span>(i);</span><br><span class="line">    	<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    	<span class="keyword">if</span>(L &lt;= mid) <span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, l, mid, L, R, w);</span><br><span class="line">    	<span class="keyword">if</span>(R &gt; mid) <span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, L, R, w);</span><br><span class="line">    	<span class="built_in">up</span>(i);</span><br><span class="line">    &#125;;</span><br><span class="line">   	<span class="keyword">while</span>(t --)&#123;</span><br><span class="line">		<span class="type">int</span> n;</span><br><span class="line">		cin &gt;&gt; n;</span><br><span class="line">		<span class="built_in">build</span>(build, <span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    	<span class="built_in">fill</span>(r.<span class="built_in">begin</span>(), r.<span class="built_in">begin</span>() + <span class="number">1</span> + n, n + <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span> ; i &lt;= n; i ++) &#123;</span><br><span class="line">			cin &gt;&gt; v1[i];</span><br><span class="line">			<span class="keyword">if</span>(p[v1[i]]) r[p[v1[i]]] = i;</span><br><span class="line">			p[v1[i]] = i;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// for(int i = 1; i &lt;= n; i ++) cout &lt;&lt; r[i] &lt;&lt; &quot; &quot; &lt;&lt; p[v1[i]] &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">		<span class="type">int</span> ans = <span class="number">0</span>, ans_l = <span class="number">2</span>, ans_r = <span class="number">3</span>; </span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line">			<span class="comment">// cout &lt;&lt; i &lt;&lt; &quot; &quot;;</span></span><br><span class="line">			<span class="keyword">if</span>(L[v1[i]]) <span class="built_in">add</span>(add, <span class="number">1</span>, <span class="number">1</span>, n, L[v1[i]], p[v1[i]], <span class="number">-1</span>);</span><br><span class="line">			L[v1[i]] = r[i] + <span class="number">1</span>;</span><br><span class="line">			<span class="comment">// cout &lt;&lt; L[v1[i]] &lt;&lt; &quot; &quot; &lt;&lt; p[v1[i]] &lt;&lt; &quot; &quot;;</span></span><br><span class="line">			<span class="built_in">add</span>(add, <span class="number">1</span>, <span class="number">1</span>, n, L[v1[i]], p[v1[i]], <span class="number">1</span>);</span><br><span class="line">			<span class="comment">// cout &lt;&lt; W[1] &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">			<span class="keyword">if</span>(ans &lt; W[<span class="number">1</span>]) ans = W[<span class="number">1</span>], ans_l = i + <span class="number">1</span>, ans_r = P[<span class="number">1</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span> &lt;&lt; ans_l &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; ans_r &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) p[v1[i]] = L[v1[i]] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç¨€ç–è¡¨ST"><a href="#ç¨€ç–è¡¨ST" class="headerlink" title="ç¨€ç–è¡¨ST"></a>ç¨€ç–è¡¨ST</h3><p><strong>Sparse Tableï¼ˆç¨€ç–è¡¨ï¼‰</strong>æ˜¯ä¸€ç§é«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼Œä¸»è¦ç”¨äº <strong>é™æ€æ•°ç»„çš„åŒºé—´æœ€å€¼æŸ¥è¯¢ï¼ˆRMQï¼‰</strong>ã€‚</p>
<ul>
<li>é€‚ç”¨äºï¼š<strong>æŸ¥è¯¢é¢‘ç¹ï¼Œä¿®æ”¹ä¸éœ€è¦æˆ–å¾ˆå°‘</strong></li>
<li>æŸ¥è¯¢æ—¶é—´å¤æ‚åº¦ï¼š<strong>O(1)</strong></li>
<li>é¢„å¤„ç†æ—¶é—´å¤æ‚åº¦ï¼š<strong>O(n log n)</strong></li>
</ul>
<p>æ”¯æŒçš„è¿ç®—</p>
<p>Sparse Table æ”¯æŒ <strong>å¹‚ç­‰æ“ä½œï¼ˆidempotent operationsï¼‰</strong>ï¼š</p>
<p>å¯ä»¥æ±‚<code>min()</code> ã€<code>max()</code> ã€<code>gcd()</code> </p>
<p>ä¸å¯æ±‚<code>lcm()</code> ï¼ˆä¸æ»¡è¶³å¹‚ç­‰æ€§ï¼‰ã€<code>sum()</code> ï¼ˆä¸æ»¡è¶³å¹‚ç­‰æ€§ï¼‰</p>
<p>æ ¸å¿ƒæ„å»ºæµç¨‹ï¼ˆä»¥æœ€å¤§å€¼ä¸ºä¾‹ï¼‰</p>
<ol>
<li>å®šä¹‰</li>
</ol>
<ul>
<li><code>st[i][j]</code> è¡¨ç¤ºä» <strong>ä¸‹æ ‡ i å¼€å§‹ï¼Œé•¿åº¦ä¸º 2^j çš„åŒºé—´æœ€å¤§å€¼</strong></li>
</ul>
<ol>
<li>åˆå§‹åŒ–</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    st[i][<span class="number">0</span>] = arr[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>çŠ¶æ€è½¬ç§»</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; (<span class="number">1</span> &lt;&lt; j) &lt;= n; j++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= n; i++) &#123;</span><br><span class="line">        st[i][j] = <span class="built_in">max</span>(st[i][j - <span class="number">1</span>], st[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¢„å¤„ç† log2 è¡¨</p>
<p>ä¸ºä»€ä¹ˆè¦æå‰é¢„å¤„ç† <code>log2[]</code>ï¼Ÿ</p>
<p>æŸ¥è¯¢æ—¶éœ€è®¡ç®—åŒºé—´é•¿åº¦å¯¹åº”çš„ <code>log2(r - l + 1)</code>ï¼Œé¢„å¤„ç†å¯é¿å…æµ®ç‚¹è¯¯å·®å’Œæ—¶é—´æµªè´¹</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">log2[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    log2[i] = log2[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åŒºé—´æŸ¥è¯¢ï¼ˆä»¥æœ€å¤§å€¼ä¸ºä¾‹ï¼‰</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> k = log2[r - l + <span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> res = <span class="built_in">max</span>(st[l][k], st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæŸ¥è¯¢æ–¹å¼çš„æ ¸å¿ƒæ˜¯ä½¿ç”¨<strong>ä¸¤ä¸ªé•¿åº¦ä¸º <code>2^k</code> çš„åŒºé—´è¦†ç›–æ•´ä¸ª <code>[l, r]</code> åŒºé—´</strong>ã€‚</p>
<p>Luogu P4155ï¼šç¯å½¢åŒºé—´è¦†ç›–è·³è·ƒä¼˜åŒ–</p>
<p><strong>ç›®æ ‡ï¼š</strong>ç»™å®šä¸€ç³»åˆ—åŒºé—´ï¼Œåœ¨ç¯ä¸ŠæŸ¥æ‰¾è¦†ç›–é•¿åº¦ä¸º <code>m</code> æ‰€éœ€çš„æœ€å°‘è·³è·ƒæ¬¡æ•°ï¼ˆå€å¢æ€æƒ³ï¼‰</p>
<p><strong>å…³é”®ç”¨æ³•ï¼š</strong></p>
<ul>
<li><code>st[i][j]</code> è¡¨ç¤ºä»ç¬¬ <code>i</code> ä¸ªåŒºé—´å¼€å§‹ï¼Œè·³ <code>2^j</code> æ­¥å¯è¦†ç›–åˆ°çš„ä½ç½®</li>
</ul>
<p><strong>æ„å»ºï¼š</strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">st[i][<span class="number">0</span>] = rightmost reachable from i</span><br><span class="line">st[i][j] = st[st[i][j - <span class="number">1</span>]][j - <span class="number">1</span>];</span><br></pre></td></tr></table></figure>
<p><strong>æŸ¥è¯¢ï¼š</strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = logn; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">    <span class="keyword">if</span> (v1[st[cur][j]][<span class="number">2</span>] &lt; goal) &#123;</span><br><span class="line">        cur = st[cur][j];</span><br><span class="line">        ans += <span class="number">1</span> &lt;&lt; j;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ©ç”¨ Sparse Table è¿›è¡Œè·³è·ƒä¼˜åŒ–ï¼ˆå€å¢æ€æƒ³ï¼‰</p>
<p>æ¯æ¬¡è·³è·ƒä»£è¡¨ä¸€æ®µåŒºé—´ï¼Œç”¨äºè®¡ç®—è¦†ç›–é•¿åº¦æœ€å°‘çš„è·¯å¾„</p>
<p>æ¨¡æ¿å°è£…ï¼ˆæœ€å€¼æŸ¥è¯¢ï¼‰</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, LOG = <span class="number">20</span>;</span><br><span class="line"><span class="type">int</span> st[N][LOG], log2[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build_st</span><span class="params">(<span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; a)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n = a.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">    log2[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        st[i][<span class="number">0</span>] = a[i];</span><br><span class="line">        log2[i] = log2[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; (<span class="number">1</span> &lt;&lt; j) &lt;= n; j++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= n; i++) &#123;</span><br><span class="line">            st[i][j] = <span class="built_in">max</span>(st[i][j - <span class="number">1</span>], st[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query_max</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> k = log2[r - l + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>(st[l][k], st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="LCA"><a href="#LCA" class="headerlink" title="LCA"></a>LCA</h3><p>æœ€è¿‘ç¥–å…ˆé—®é¢˜ï¼Œç”¨äºå¿«é€ŸæŸ¥è¯¢æ ‘ä¸­ä¸¤ä¸ªèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚</p>
<h4 id="é‡‡ç”¨deepæ•°ç»„å’Œstè¡¨"><a href="#é‡‡ç”¨deepæ•°ç»„å’Œstè¡¨" class="headerlink" title="é‡‡ç”¨deepæ•°ç»„å’Œstè¡¨"></a>é‡‡ç”¨deepæ•°ç»„å’Œstè¡¨</h4><p>deepæ•°ç»„ç”¨äºè®°å½•æ·±åº¦ï¼Œstè¡¨ç”¨äºå¿«é€ŸæŸ¥è¯¢çˆ¶äº²åŠä»¥ä¸ŠèŠ‚ç‚¹</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P3379</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>), cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">	<span class="keyword">while</span>(t --)&#123;</span><br><span class="line">		<span class="type">int</span> n, m, root;</span><br><span class="line">		cin &gt;&gt; n &gt;&gt; m &gt;&gt; root;</span><br><span class="line">		<span class="function">vector <span class="title">adj</span><span class="params">(n + <span class="number">1</span>, vector&lt;<span class="type">int</span>&gt;())</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;  i &lt; n; i ++)&#123;</span><br><span class="line">			<span class="type">int</span> u, v;</span><br><span class="line">			cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">			adj[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">			adj[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">		&#125;</span><br><span class="line">        <span class="comment">// æ„å»ºLCAç»“æ„</span></span><br><span class="line">		<span class="type">int</span> n1 = <span class="built_in">log2</span>(n);</span><br><span class="line">		<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">deep</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">		<span class="function">vector <span class="title">st</span><span class="params">(n + <span class="number">1</span>, vector&lt;<span class="type">int</span>&gt;(n1 + <span class="number">1</span>))</span></span>;</span><br><span class="line">		<span class="keyword">auto</span> dfs = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> u, <span class="type">int</span> last, <span class="type">int</span> d) -&gt; <span class="type">void</span>&#123;</span><br><span class="line">			deep[u] = d;</span><br><span class="line">			st[u][<span class="number">0</span>] = last;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n1; i ++)&#123;</span><br><span class="line">				st[u][i] = st[st[u][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">auto</span> v : adj[u])&#123;</span><br><span class="line">				<span class="keyword">if</span>(v != last)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, v, u, d + <span class="number">1</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="built_in">dfs</span>(dfs, root, root, <span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i ++)&#123;</span><br><span class="line">			<span class="type">int</span> u, v;</span><br><span class="line">			cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">			<span class="comment">// æŸ¥è¯¢å…¬å…±ç¥–å…ˆéƒ¨åˆ†éƒ¨åˆ†</span></span><br><span class="line">            <span class="comment">// å…ˆç»Ÿä¸€é«˜åº¦</span></span><br><span class="line">			<span class="keyword">if</span>(deep[u] &lt; deep[v])&#123;</span><br><span class="line">				<span class="built_in">swap</span>(u, v);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = n1; j &gt;= <span class="number">0</span>; j --)&#123;</span><br><span class="line">				<span class="keyword">if</span>(deep[st[u][j]] &gt;= deep[v])&#123;</span><br><span class="line">					u = st[u][j];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">            <span class="comment">// ç‰¹åˆ¤</span></span><br><span class="line">			<span class="keyword">if</span>(u == v)&#123;</span><br><span class="line">				cout &lt;&lt; v &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> j = n1; j &gt;= <span class="number">0</span>; j --)&#123;</span><br><span class="line">					<span class="keyword">if</span>(st[u][j] != st[v][j])&#123;</span><br><span class="line">						u = st[u][j];</span><br><span class="line">						v = st[v][j];</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				cout &lt;&lt; st[u][<span class="number">0</span>] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Tarjan"><a href="#Tarjan" class="headerlink" title="Tarjan"></a>Tarjan</h4><p>åˆ©ç”¨å¹¶æŸ¥é›†æ¥ä¸€æ¬¡dfså°±æ„å»ºå¥½lcaä¿¡æ¯</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P3379</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>), cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">	<span class="keyword">while</span>(t --)&#123;</span><br><span class="line">		<span class="type">int</span> n, m, root;</span><br><span class="line">		cin &gt;&gt; n &gt;&gt; m &gt;&gt; root;</span><br><span class="line">		<span class="function">vector <span class="title">adj</span><span class="params">(n + <span class="number">1</span>, vector&lt;<span class="type">int</span>&gt;())</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, u, v; i &lt; n; i ++)&#123;</span><br><span class="line">			cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">			adj[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">			adj[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function">vector <span class="title">adj2</span><span class="params">(m + <span class="number">1</span>, vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt;())</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, u, v; i &lt;= m; i ++)&#123;</span><br><span class="line">			cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">			adj2[u].<span class="built_in">push_back</span>(&#123;v, i&#125;);</span><br><span class="line">			adj2[v].<span class="built_in">push_back</span>(&#123;u, i&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">fa</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">ans</span><span class="params">(m + <span class="number">1</span>)</span></span>;</span><br><span class="line">		<span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">vi</span><span class="params">(n + <span class="number">1</span>, <span class="literal">false</span>)</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">			fa[i] = i;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">auto</span> find = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(x != fa[x])&#123;</span><br><span class="line">				fa[x] = <span class="built_in">f</span>(f, fa[x]);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> fa[x];</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> tarjin = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> u, <span class="type">int</span> last) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">			vi[u] = <span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">auto</span> v : adj[u])&#123;</span><br><span class="line">				<span class="keyword">if</span>(v != last)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, v, u);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">auto</span> [v, n1] : adj2[u])&#123;</span><br><span class="line">				<span class="keyword">if</span>(vi[v])&#123;</span><br><span class="line">					ans[n1] = <span class="built_in">find</span>(find, v);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			fa[u] = last;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="built_in">tarjin</span>(tarjin, root, <span class="number">-1</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i ++)&#123;</span><br><span class="line">			cout &lt;&lt; ans[i] &lt;&lt; <span class="string">&quot; \n&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://www.luogu.com.cn/problem/P3379">ç»ƒä¹ é¢˜</a></p>
<h3 id="æ ‘çš„é‡å¿ƒ"><a href="#æ ‘çš„é‡å¿ƒ" class="headerlink" title="æ ‘çš„é‡å¿ƒ"></a>æ ‘çš„é‡å¿ƒ</h3><p>å¦‚æœåœ¨æ ‘ä¸­é€‰æ‹©æŸä¸ªèŠ‚ç‚¹å¹¶åˆ é™¤ï¼Œè¿™æ£µæ ‘å°†åˆ†ä¸ºè‹¥å¹²æ£µå­æ ‘ï¼Œä½¿æ‰€æœ‰å­æ ‘æœ€å¤§å€¼æœ€å°çš„èŠ‚ç‚¹è¢«ç§°ä¸ºæ•´ä¸ªæ ‘çš„é‡å¿ƒã€‚</p>
<p>æ€§è´¨ï¼š</p>
<ul>
<li>æ ‘çš„é‡å¿ƒå¦‚æœä¸å”¯ä¸€ï¼Œåˆ™è‡³å¤šæœ‰ä¸¤ä¸ªï¼Œä¸”è¿™ä¸¤ä¸ªé‡å¿ƒç›¸é‚»ã€‚</li>
<li>ä»¥æ ‘çš„é‡å¿ƒä¸ºæ ¹æ—¶ï¼Œæ‰€æœ‰å­æ ‘çš„å¤§å°éƒ½ä¸è¶…è¿‡æ•´æ£µæ ‘å¤§å°çš„ä¸€åŠã€‚</li>
<li>æ ‘ä¸­æ‰€æœ‰ç‚¹åˆ°æŸä¸ªç‚¹çš„è·ç¦»å’Œä¸­ï¼Œåˆ°é‡å¿ƒçš„è·ç¦»å’Œæ˜¯æœ€å°çš„ï¼›å¦‚æœæœ‰ä¸¤ä¸ªé‡å¿ƒï¼Œé‚£ä¹ˆåˆ°å®ƒä»¬çš„è·ç¦»å’Œä¸€æ ·ã€‚</li>
<li>æŠŠä¸¤æ£µæ ‘é€šè¿‡ä¸€æ¡è¾¹ç›¸è¿å¾—åˆ°ä¸€æ£µæ–°çš„æ ‘ï¼Œé‚£ä¹ˆæ–°çš„æ ‘çš„é‡å¿ƒåœ¨è¿æ¥åŸæ¥ä¸¤æ£µæ ‘çš„é‡å¿ƒçš„è·¯å¾„ä¸Šã€‚</li>
<li>åœ¨ä¸€æ£µæ ‘ä¸Šæ·»åŠ æˆ–åˆ é™¤ä¸€ä¸ªå¶å­ï¼Œé‚£ä¹ˆå®ƒçš„é‡å¿ƒæœ€å¤šåªç§»åŠ¨ä¸€æ¡è¾¹çš„è·ç¦»ã€‚</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e4</span> + <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> head[N] ,next1[N &lt;&lt; <span class="number">1</span>], to[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> size1[N], max1[N];</span><br><span class="line"><span class="type">int</span> cnt1 = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span> <span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">	next1[cnt1] = head[u];</span><br><span class="line">	to[cnt1] = v;</span><br><span class="line">	head[u] = cnt1 ++;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> last)</span></span>&#123;</span><br><span class="line">	size1[u] = <span class="number">1</span>;</span><br><span class="line">	max1[u] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> ei = head[u], v; ei; ei = next1[ei])&#123;</span><br><span class="line">		v = to[ei];</span><br><span class="line">		<span class="keyword">if</span>(v != last)&#123;</span><br><span class="line">			<span class="built_in">dfs</span>(v, u);</span><br><span class="line">			max1[u] = <span class="built_in">max</span>(max1[u], size1[v]);</span><br><span class="line">			size1[u] += size1[v];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	max1[u] = <span class="built_in">max</span>(max1[u], n - size1[u]);;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">	<span class="keyword">while</span>(t --)&#123;</span><br><span class="line">		cin &gt;&gt; n;</span><br><span class="line">		<span class="built_in">fill</span>(head, head + <span class="number">1</span> + n, <span class="number">0</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i ++)&#123;</span><br><span class="line">			<span class="type">int</span> u, v;</span><br><span class="line">			cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">			<span class="built_in">add</span>(u, v);</span><br><span class="line">			<span class="built_in">add</span>(v, u);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">		<span class="type">int</span> ans[<span class="number">2</span>];</span><br><span class="line">		<span class="type">int</span> m = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">            <span class="comment">// ä¾ç…§æ ‘çš„é‡å¿ƒçš„å®šä¹‰</span></span><br><span class="line">			<span class="keyword">if</span>(max1[i] &lt;= n &gt;&gt; <span class="number">1</span>)&#123;</span><br><span class="line">				ans[m ++] = i;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i ++)&#123;</span><br><span class="line">			cout &lt;&lt; ans[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å½“èŠ‚ç‚¹æœ‰å€¼æ—¶ï¼Œé‡å¿ƒçš„ä¾æ®æ˜¯èŠ‚ç‚¹æƒè€Œä¸æ˜¯è¾¹æƒã€‚</p>
<h3 id="æ ‘çš„ç›´å¾„"><a href="#æ ‘çš„ç›´å¾„" class="headerlink" title="æ ‘çš„ç›´å¾„"></a>æ ‘çš„ç›´å¾„</h3><p>æ ‘ä¸Šä»»æ„ä¸¤ç‚¹ä¹‹é—´æœ€å¸¸çš„ç®€å•è·¯å¾„ä¸ºæ ‘çš„ç›´å¾„ï¼Œä¸€æ£µæ ‘å¯ä»¥æœ‰å¤šæ¡ç›´å¾„ï¼Œé•¿åº¦ç›¸ç­‰</p>
<h4 id="ä¸¤æ¬¡DFS"><a href="#ä¸¤æ¬¡DFS" class="headerlink" title="ä¸¤æ¬¡DFS"></a>ä¸¤æ¬¡DFS</h4><p>é€‚ç”¨ä¸æ— è´Ÿè¾¹æ ‘</p>
<p>é¦–å…ˆä»ä»»æ„èŠ‚ç‚¹ y å¼€å§‹è¿›è¡Œç¬¬ä¸€æ¬¡ DFSï¼Œåˆ°è¾¾è·ç¦»å…¶æœ€è¿œçš„èŠ‚ç‚¹ï¼Œè®°ä¸º zï¼Œç„¶åå†ä»z å¼€å§‹åšç¬¬äºŒæ¬¡ DFSï¼Œåˆ°è¾¾è·ç¦»zæœ€è¿œçš„èŠ‚ç‚¹ï¼Œè®°ä¸ºzâ€™ï¼Œåˆ™ $\delta(z,zâ€™)$ å³ä¸ºæ ‘çš„ç›´å¾„ã€‚</p>
<p>æ˜¾ç„¶ï¼Œå¦‚æœç¬¬ä¸€æ¬¡ DFS åˆ°è¾¾çš„èŠ‚ç‚¹zæ˜¯ç›´å¾„çš„ä¸€ç«¯ï¼Œé‚£ä¹ˆç¬¬äºŒæ¬¡ DFS åˆ°è¾¾çš„èŠ‚ç‚¹zâ€™ä¸€å®šæ˜¯ç›´å¾„çš„ä¸€ç«¯ã€‚æˆ‘ä»¬åªéœ€è¯æ˜åœ¨ä»»æ„æƒ…å†µä¸‹ï¼Œzå¿…ä¸ºç›´å¾„çš„ä¸€ç«¯ã€‚</p>
<p>å®šç†ï¼šåœ¨ä¸€æ£µæ ‘ä¸Šï¼Œä»ä»»æ„èŠ‚ç‚¹yå¼€å§‹è¿›è¡Œä¸€æ¬¡ DFSï¼Œåˆ°è¾¾çš„è·ç¦»å…¶æœ€è¿œçš„èŠ‚ç‚¹zå¿…ä¸ºç›´å¾„çš„ä¸€ç«¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> n;</span><br><span class="line">cin &gt;&gt; n;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span>, <span class="title">next</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">to</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">weight</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="type">int</span> cnt1 = <span class="number">1</span>;</span><br><span class="line"><span class="comment">// ä¸¤æ¬¡DFS</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dis</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span>, <span class="title">fa</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">len</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="type">int</span> st, en;</span><br><span class="line"><span class="keyword">auto</span> dfs = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> u, <span class="type">int</span> last, <span class="type">int</span> val) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">    dis[u] = val;</span><br><span class="line">    fa[u] = last;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> ei = head[u], v, w; ei; ei = next[ei])&#123;</span><br><span class="line">        v = to[ei];</span><br><span class="line">        w = weight[ei];</span><br><span class="line">        <span class="keyword">if</span>(v != last)&#123;</span><br><span class="line">            len[v] = w;</span><br><span class="line">            <span class="built_in">f</span>(f, v, u, val + w);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">dfs</span>(dfs, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, max1 = <span class="number">0</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(max1 &lt; dis[i])&#123;</span><br><span class="line">        max1 = dis[i];</span><br><span class="line">        dis[i] = len[i] = <span class="number">0</span>;</span><br><span class="line">        st = i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">dfs</span>(dfs, st, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, max1 = <span class="number">0</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(max1 &lt; dis[i])&#123;</span><br><span class="line">        max1 = dis[i];</span><br><span class="line">        en = i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> sum1 = dis[en]; <span class="comment">// ç›´å¾„</span></span><br></pre></td></tr></table></figure>
<h4 id="æ ‘å½¢DP"><a href="#æ ‘å½¢DP" class="headerlink" title="æ ‘å½¢DP"></a>æ ‘å½¢DP</h4><p>å¯ç”¨äºæœ‰è´Ÿè¾¹æ ‘</p>
<p>æˆ‘ä»¬è®°å½•å½“1ä¸ºæ ‘çš„æ ¹æ—¶ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä½œä¸ºå­æ ‘çš„æ ¹å‘ä¸‹ï¼Œæ‰€èƒ½å»¶ä¼¸çš„æœ€é•¿è·¯å¾„é•¿åº¦$d<em>{1}$ä¸æ¬¡é•¿è·¯å¾„ï¼ˆä¸æœ€é•¿è·¯å¾„æ— å…¬å…±è¾¹ï¼‰$d</em>{2}$ï¼Œé‚£ä¹ˆç›´å¾„å°±æ˜¯å¯¹äºæ¯ä¸€ä¸ªç‚¹ï¼Œè¯¥ç‚¹çš„$d<em>{1}+d</em>{2}$èƒ½å–åˆ°çš„æœ€å¤§å€¼</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head1</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span>, <span class="title">next1</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">to1</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">weight</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span></span>;</span><br><span class="line">cnt1 = <span class="number">1</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">ans</span><span class="params">(n + <span class="number">1</span>)</span>ï¼Œ<span class="title">v1</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="keyword">auto</span> dfs3 = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> u, <span class="type">int</span> last) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">    ans[u] = <span class="number">0</span>, v1[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> ei = head1[u], v, w; ei; ei = next1[ei])&#123;</span><br><span class="line">        v = to1[ei], w = weight[ei];</span><br><span class="line">        <span class="keyword">if</span>(v != last)&#123;</span><br><span class="line">            <span class="built_in">f</span>(f, v, u);</span><br><span class="line">            ans[u] = <span class="built_in">max</span>(ans[u], v1[u] + v1[v] + w);</span><br><span class="line">            v1[u] = <span class="built_in">max</span>(v1[u], v1[v] + w);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">dfs3</span>(dfs3, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="type">int</span> max2 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    max2 = <span class="built_in">max</span>(max2, ans[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ ‘ä¸Šå·®åˆ†"><a href="#æ ‘ä¸Šå·®åˆ†" class="headerlink" title="æ ‘ä¸Šå·®åˆ†"></a>æ ‘ä¸Šå·®åˆ†</h3><p>åœ¨æ ‘ä¸Šå¯¹å¤šæ¡è·¯å¾„ä¸Šçš„ç‚¹æˆ–è€…è¾¹è¿›è¡Œä¿®æ”¹æ—¶ï¼Œä¸èƒ½ç›´æ¥ä¾¿åˆ©æ“ä½œï¼Œè€Œæ˜¯åˆ©ç”¨å·®åˆ†æ€æƒ³ç§¯ç´¯ä¿¡æ¯ï¼Œæœ€åç´¯åŠ </p>
<ul>
<li>å¯¹äºç‚¹ï¼Œè·¯å¾„ä¸¤ç«¯++,ä¸¤ç«¯LCAå’ŒLCAçš„çˆ¶äº²â€”</li>
<li>å¯¹äºè¾¹ï¼Œè·¯å¾„ä¸¤ç«¯++,å…¶å€¼å¯ç†è§£ä¸ºè¯¥ç‚¹åˆ°å…¶çˆ¶äº²çš„è¾¹ï¼Œä¸¤ç«¯LCA-=2</li>
</ul>
<h4 id="ç‚¹å·®åˆ†"><a href="#ç‚¹å·®åˆ†" class="headerlink" title="ç‚¹å·®åˆ†"></a>ç‚¹å·®åˆ†</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P3128</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">5e4</span>, K = <span class="number">1e5</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head</span><span class="params">(N + <span class="number">1</span>, <span class="number">0</span>)</span>, <span class="title">next1</span><span class="params">(N &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">to</span><span class="params">(N &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head2</span><span class="params">(K + <span class="number">1</span>, <span class="number">0</span>)</span>, <span class="title">next2</span><span class="params">(K &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">to2</span><span class="params">(K &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">in</span><span class="params">(K &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span></span>; </span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">fa_lca</span><span class="params">(K + <span class="number">1</span>)</span>, <span class="title">lca</span><span class="params">(K + <span class="number">1</span>)</span>, <span class="title">has</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">fa</span><span class="params">(N + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="type">int</span> cnt1 = <span class="number">1</span>, cnt2 = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>)-&gt;ios_base::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">   	 <span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">	<span class="keyword">while</span>(t --)&#123; </span><br><span class="line">		<span class="type">int</span> n, q;</span><br><span class="line">		cin &gt;&gt; n &gt;&gt; q;</span><br><span class="line">		<span class="keyword">auto</span> add = [&amp;](<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> i, <span class="type">int</span> f) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(!f) &#123;</span><br><span class="line">				next1[cnt1] = head[u];</span><br><span class="line">				to[cnt1] = v;</span><br><span class="line">				head[u] = cnt1 ++;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				next2[cnt2] = head2[u];</span><br><span class="line">				to2[cnt2] = v;</span><br><span class="line">				in[cnt2] = i;</span><br><span class="line">				head2[u] = cnt2 ++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, u, v; i &lt; n; i ++) &#123;</span><br><span class="line">			cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">			<span class="built_in">add</span>(u, v, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">			<span class="built_in">add</span>(v, u, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">iota</span>(fa_lca.<span class="built_in">begin</span>() + <span class="number">1</span>, fa_lca.<span class="built_in">begin</span>() + <span class="number">1</span> + q, <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">auto</span> find = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(x != fa_lca[x]) fa_lca[x] = <span class="built_in">f</span>(f, fa_lca[x]);</span><br><span class="line">			<span class="keyword">return</span> fa_lca[x];</span><br><span class="line">		&#125;;</span><br><span class="line">		vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt; <span class="built_in">edges</span>(q);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, u, v; i &lt; q; i ++) &#123;</span><br><span class="line">			cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">			edges[i] = &#123;u, v&#125;;</span><br><span class="line">			<span class="built_in">add</span>(u, v, i, <span class="number">1</span>);</span><br><span class="line">			<span class="built_in">add</span>(v, u, i, <span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">auto</span> tarjan = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> u, <span class="type">int</span> last) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">			has[u] = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> ei = head[u], v; ei; ei = next1[ei]) &#123;</span><br><span class="line">				v = to[ei];</span><br><span class="line">				<span class="keyword">if</span>(v != last) <span class="built_in">f</span>(f, v, u);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> ei = head2[u], v; ei; ei = next2[ei]) &#123;</span><br><span class="line">				v = to2[ei];</span><br><span class="line">				<span class="comment">// æ³¨æ„lcaçš„ç¼–å·æ˜¯in[ei]è€Œä¸æ˜¯væˆ–è€…ei</span></span><br><span class="line">				<span class="keyword">if</span>(has[v]) lca[in[ei]] = <span class="built_in">find</span>(find, v);</span><br><span class="line">			&#125;</span><br><span class="line">			fa[u] = last;</span><br><span class="line">			fa_lca[u] = last;</span><br><span class="line">		&#125;;</span><br><span class="line">        <span class="comment">// è·‘lca</span></span><br><span class="line">		<span class="built_in">tarjan</span>(tarjan, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">		<span class="comment">// å·®åˆ†</span></span><br><span class="line">		<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">ans</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; q; i ++) &#123;</span><br><span class="line">			ans[edges[i].fr] ++, ans[edges[i].sc] ++;</span><br><span class="line">			ans[lca[i]] --, ans[fa[lca[i]]] --;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">auto</span> dfs = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> u, <span class="type">int</span> last) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> ei = head[u], v; ei; ei = next1[ei]) &#123;</span><br><span class="line">				v = to[ei];</span><br><span class="line">				<span class="keyword">if</span>(v != last) &#123;</span><br><span class="line">					<span class="built_in">f</span>(f, v, u);</span><br><span class="line">					ans[u] += ans[v];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">        <span class="comment">// è·‘å·®åˆ†</span></span><br><span class="line">		<span class="built_in">dfs</span>(dfs, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">		<span class="type">int</span> max1 = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line">			<span class="comment">// cout &lt;&lt; i &lt;&lt; &quot; &quot; &lt;&lt; ans[i] &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">			max1 = <span class="built_in">max</span>(max1, ans[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; max1 &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="è¾¹å·®åˆ†"><a href="#è¾¹å·®åˆ†" class="headerlink" title="è¾¹å·®åˆ†"></a>è¾¹å·®åˆ†</h4><blockquote>
<p>Tarjan</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P2680</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>)-&gt;ios_base::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>; <span class="comment">// é¢˜ç›®åªæœ‰ä¸€ç»„æ•°æ®</span></span><br><span class="line">    <span class="keyword">while</span> (t--) &#123; </span><br><span class="line">        <span class="type">int</span> n, m;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ ‘çš„é‚»æ¥è¡¨å­˜å‚¨</span></span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span>, <span class="title">next1</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">to</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">wei</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="comment">// æŸ¥è¯¢å›¾ï¼ˆç”¨äº Tarjan ç¦»çº¿ LCAï¼‰</span></span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head2</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span>, <span class="title">next2</span><span class="params">(m &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">to2</span><span class="params">(m &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">in</span><span class="params">(m &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å„ç§è¾…åŠ©æ•°ç»„</span></span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">len</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">has</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span>, <span class="title">fa_lca</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">lca</span><span class="params">(m)</span>, <span class="title">cost</span><span class="params">(m)</span></span>;</span><br><span class="line">        <span class="type">int</span> cnt1 = <span class="number">1</span>, cnt2 = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åŠ è¾¹ï¼ˆæ ‘è¾¹ï¼‰</span></span><br><span class="line">        <span class="keyword">auto</span> add = [&amp;](<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w) &#123;</span><br><span class="line">            next1[cnt1] = head[u];</span><br><span class="line">            to[cnt1] = v;</span><br><span class="line">            wei[cnt1] = w;</span><br><span class="line">            head[u] = cnt1++;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åŠ è¾¹ï¼ˆæŸ¥è¯¢è¾¹ï¼‰</span></span><br><span class="line">        <span class="keyword">auto</span> add2 = [&amp;](<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> i) &#123;</span><br><span class="line">            next2[cnt2] = head2[u];</span><br><span class="line">            to2[cnt2] = v;</span><br><span class="line">            in[cnt2] = i;</span><br><span class="line">            head2[u] = cnt2++;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¯»å…¥æ ‘</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, u, v, w; i &lt; n; i++) &#123;</span><br><span class="line">            cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">            <span class="built_in">add</span>(u, v, w);</span><br><span class="line">            <span class="built_in">add</span>(v, u, w);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> max1 = <span class="number">0</span>; <span class="comment">// æœ€å¤§è·¯å¾„é•¿åº¦</span></span><br><span class="line">        vector&lt;array&lt;<span class="type">int</span>, 2&gt;&gt; <span class="built_in">edges</span>(m);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è¯»å…¥è¿è¾“ä»»åŠ¡</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            cin &gt;&gt; edges[i][<span class="number">0</span>] &gt;&gt; edges[i][<span class="number">1</span>];</span><br><span class="line">            <span class="built_in">add2</span>(edges[i][<span class="number">0</span>], edges[i][<span class="number">1</span>], i);</span><br><span class="line">            <span class="built_in">add2</span>(edges[i][<span class="number">1</span>], edges[i][<span class="number">0</span>], i);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¹¶æŸ¥é›† find</span></span><br><span class="line">        <span class="keyword">auto</span> find = [&amp;](<span class="keyword">auto</span> &amp;&amp;f, <span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (x != fa_lca[x]) fa_lca[x] = <span class="built_in">f</span>(f, fa_lca[x]);</span><br><span class="line">            <span class="keyword">return</span> fa_lca[x];</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">iota</span>(fa_lca.<span class="built_in">begin</span>(), fa_lca.<span class="built_in">end</span>(), <span class="number">0</span>); <span class="comment">// åˆå§‹åŒ–å¹¶æŸ¥é›†</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Tarjan ç¦»çº¿ LCA</span></span><br><span class="line">        <span class="keyword">auto</span> tarjan = [&amp;](<span class="keyword">auto</span> &amp;&amp;f, <span class="type">int</span> u, <span class="type">int</span> last, <span class="type">int</span> w) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">            len[u] = w;    <span class="comment">// ä»æ ¹åˆ° u çš„è·ç¦»</span></span><br><span class="line">            has[u] = <span class="number">1</span>;    <span class="comment">// æ ‡è®°å·²è®¿é—®</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// éå†æ ‘çš„å­èŠ‚ç‚¹</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> ei = head[u], v; ei; ei = next1[ei]) &#123;</span><br><span class="line">                v = to[ei];</span><br><span class="line">                <span class="keyword">if</span> (v != last) <span class="built_in">f</span>(f, v, u, w + wei[ei]);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// éå†ä¸ u æœ‰å…³çš„æŸ¥è¯¢</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> ei = head2[u], v; ei; ei = next2[ei]) &#123;</span><br><span class="line">                v = to2[ei];</span><br><span class="line">                <span class="keyword">if</span> (has[v]) &#123;</span><br><span class="line">                    lca[in[ei]] = <span class="built_in">find</span>(find, v); <span class="comment">// æ‰¾åˆ° LCA</span></span><br><span class="line">                    <span class="comment">// è·¯å¾„é•¿åº¦ = len[u] + len[v] - 2 * len[lca]</span></span><br><span class="line">                    cost[in[ei]] = len[v] + len[u] - <span class="number">2</span> * len[lca[in[ei]]];</span><br><span class="line">                    max1 = <span class="built_in">max</span>(max1, cost[in[ei]]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            fa_lca[u] = last; <span class="comment">// å›æº¯å¹¶æŸ¥é›†çˆ¶èŠ‚ç‚¹</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">tarjan</span>(tarjan, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>); <span class="comment">// ä»æ ¹èŠ‚ç‚¹ 1 å¼€å§‹</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// äºŒåˆ†ç­”æ¡ˆ</span></span><br><span class="line">        <span class="type">int</span> l = <span class="number">0</span>, r = max1, ans = <span class="number">0</span>, mid;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">num</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="type">int</span> cnt, need;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ£€æŸ¥å‡½æ•°ï¼ˆåˆ¤æ–­æ˜¯å¦èƒ½åœ¨é™åˆ¶ x ä¸‹å®Œæˆä»»åŠ¡ï¼‰</span></span><br><span class="line">        <span class="keyword">auto</span> cf = [&amp;](<span class="keyword">auto</span> &amp;&amp;f, <span class="type">int</span> u, <span class="type">int</span> last, <span class="type">int</span> w) -&gt; <span class="type">bool</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> ei = head[u], v; ei; ei = next1[ei]) &#123;</span><br><span class="line">                v = to[ei];</span><br><span class="line">                <span class="keyword">if</span> (v != last) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="built_in">f</span>(f, v, u, wei[ei])) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    num[u] += num[v];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> num[u] == cnt &amp;&amp; w &gt;= need; <span class="comment">// åˆ¤æ–­æ˜¯å¦æ‰¾åˆ°å…³é”®è¾¹</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">auto</span> F = [&amp;](<span class="type">int</span> x) -&gt; <span class="type">bool</span> &#123;</span><br><span class="line">            cnt = <span class="number">0</span>;</span><br><span class="line">            need = max1 - x;</span><br><span class="line">            <span class="built_in">fill</span>(num.<span class="built_in">begin</span>(), num.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æ ‡è®°éœ€è¦å‡å°‘çš„è·¯å¾„</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (cost[i] &gt; x) &#123;</span><br><span class="line">                    num[edges[i][<span class="number">0</span>]]++;</span><br><span class="line">                    num[edges[i][<span class="number">1</span>]]++;</span><br><span class="line">                    num[lca[i]] -= <span class="number">2</span>;</span><br><span class="line">                    cnt++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> !cnt || <span class="built_in">cf</span>(cf, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">            mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">F</span>(mid)) ans = mid, r = mid - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> l = mid + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ST</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P2680</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>)-&gt;ios_base::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="type">int</span> n, m;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ ‘çš„é‚»æ¥è¡¨</span></span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span>, <span class="title">next1</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">to</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">wei</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="type">int</span> cnt1 = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">auto</span> add = [&amp;](<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">            next1[cnt1] = head[u];</span><br><span class="line">            to[cnt1] = v;</span><br><span class="line">            wei[cnt1] = w;</span><br><span class="line">            head[u] = cnt1++;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¯»å…¥æ ‘</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, u, v, w; i &lt; n; i++) &#123;</span><br><span class="line">            cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">            <span class="built_in">add</span>(u, v, w);</span><br><span class="line">            <span class="built_in">add</span>(v, u, w);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> n1 = <span class="built_in">log2</span>(n);</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">deep</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>; <span class="comment">// æ·±åº¦</span></span><br><span class="line">        <span class="function">vector <span class="title">st_lca</span><span class="params">(n + <span class="number">1</span>, vector&lt;<span class="type">int</span>&gt;(n1 + <span class="number">1</span>))</span></span>; <span class="comment">// å€å¢çˆ¶èŠ‚ç‚¹è¡¨</span></span><br><span class="line">        <span class="function">vector <span class="title">st_len</span><span class="params">(n + <span class="number">1</span>, vector&lt;<span class="type">int</span>&gt;(n1 + <span class="number">1</span>))</span></span>; <span class="comment">// å¯¹åº”çš„è¾¹æƒå’Œ</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// é¢„å¤„ç† DFS</span></span><br><span class="line">        <span class="keyword">auto</span> dfs = [&amp;](<span class="keyword">auto</span> &amp;&amp;f, <span class="type">int</span> u, <span class="type">int</span> last, <span class="type">int</span> d, <span class="type">int</span> w) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">            deep[u] = d;</span><br><span class="line">            st_lca[u][<span class="number">0</span>] = last;</span><br><span class="line">            st_len[u][<span class="number">0</span>] = w;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å€å¢è¡¨æ›´æ–°</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n1; i++) &#123;</span><br><span class="line">                st_lca[u][i] = st_lca[st_lca[u][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">                st_len[u][i] = st_len[u][i - <span class="number">1</span>] + st_len[st_lca[u][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> ei = head[u], v; ei; ei = next1[ei]) &#123;</span><br><span class="line">                v = to[ei];</span><br><span class="line">                <span class="keyword">if</span> (v != last) <span class="built_in">f</span>(f, v, u, d + <span class="number">1</span>, wei[ei]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">dfs</span>(dfs, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        vector&lt;array&lt;<span class="type">int</span>, 4&gt;&gt; <span class="built_in">edges</span>(m);</span><br><span class="line">        <span class="type">int</span> max1 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// LCA æŸ¥è¯¢</span></span><br><span class="line">        <span class="keyword">auto</span> lca = [&amp;](<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> i1) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (deep[u] &lt; deep[v]) <span class="built_in">swap</span>(u, v);</span><br><span class="line">            <span class="type">int</span> len = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å…ˆè®© u å’Œ v åˆ°åŒä¸€æ·±åº¦</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = n1; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">                <span class="keyword">if</span> (deep[st_lca[u][i]] &gt;= deep[v])</span><br><span class="line">                    len += st_len[u][i], u = st_lca[u][i];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (u == v) <span class="keyword">goto</span> t1;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// åŒæ—¶å‘ä¸Šè·³</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = n1; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">                <span class="keyword">if</span> (st_lca[u][i] != st_lca[v][i]) &#123;</span><br><span class="line">                    len += st_len[u][i] + st_len[v][i];</span><br><span class="line">                    u = st_lca[u][i];</span><br><span class="line">                    v = st_lca[v][i];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// æœ€åä¸€æ­¥</span></span><br><span class="line">            len += st_len[u][<span class="number">0</span>] + st_len[v][<span class="number">0</span>];</span><br><span class="line">            u = st_lca[u][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">            t1:;</span><br><span class="line">            max1 = <span class="built_in">max</span>(max1, len);</span><br><span class="line">            edges[i1][<span class="number">2</span>] = len;</span><br><span class="line">            edges[i1][<span class="number">3</span>] = u; <span class="comment">// å­˜å‚¨ LCA</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¯»å…¥ä»»åŠ¡å¹¶è®¡ç®—è·¯å¾„é•¿åº¦</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            cin &gt;&gt; edges[i][<span class="number">0</span>] &gt;&gt; edges[i][<span class="number">1</span>];</span><br><span class="line">            <span class="built_in">lca</span>(edges[i][<span class="number">0</span>], edges[i][<span class="number">1</span>], i);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// äºŒåˆ†ç­”æ¡ˆ</span></span><br><span class="line">        <span class="type">int</span> l = <span class="number">0</span>, r = max1, ans = <span class="number">0</span>, mid;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">num</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="type">int</span> cnt, need;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">auto</span> cf = [&amp;](<span class="keyword">auto</span> &amp;&amp;f, <span class="type">int</span> u, <span class="type">int</span> last, <span class="type">int</span> w) -&gt; <span class="type">bool</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> ei = head[u], v; ei; ei = next1[ei]) &#123;</span><br><span class="line">                v = to[ei];</span><br><span class="line">                <span class="keyword">if</span> (v != last) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="built_in">f</span>(f, v, u, wei[ei])) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                    num[u] += num[v];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> num[u] == cnt &amp;&amp; w &gt;= need;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">auto</span> F = [&amp;](<span class="type">int</span> x) -&gt; <span class="type">bool</span> &#123;</span><br><span class="line">            cnt = <span class="number">0</span>;</span><br><span class="line">            need = max1 - x;</span><br><span class="line">            <span class="built_in">fill</span>(num.<span class="built_in">begin</span>(), num.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (edges[i][<span class="number">2</span>] &gt; x) &#123;</span><br><span class="line">                    num[edges[i][<span class="number">0</span>]]++;</span><br><span class="line">                    num[edges[i][<span class="number">1</span>]]++;</span><br><span class="line">                    num[edges[i][<span class="number">3</span>]] -= <span class="number">2</span>;</span><br><span class="line">                    cnt++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> !cnt || <span class="built_in">cf</span>(cf, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">            mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">F</span>(mid)) ans = mid, r = mid - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> l = mid + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="æ ‘ä¸Šæ¢æ ¹"><a href="#æ ‘ä¸Šæ¢æ ¹" class="headerlink" title="æ ‘ä¸Šæ¢æ ¹"></a>æ ‘ä¸Šæ¢æ ¹</h3><p>åœ¨æ ‘ä¸ŠåšDPæ—¶ï¼Œå¾ˆå¤šæ—¶å€™ä¸æ ¹æœ‰å…³ï¼Œå¦‚æœæŠŠæ ¹ä»çˆ¶äº²æ¢åˆ°å„¿å­ï¼Œç­”æ¡ˆå¯èƒ½æŒ‰ç…§åŒæ ·çš„è®¡ç®—æ–¹æ³•é€šè¿‡å¯æ¨å¯¼å…¬å¼è¿›è¡Œå˜æ¢ï¼Œé€šå¸¸æ˜¯dfsä¸€æ¬¡å…ˆç®—å‡ºæŸä¸€ä¸ªèŠ‚ç‚¹çš„å€¼å¹¶ä¸”åŒæ—¶æ„é€ å‡ºå¿…è¦ä¿¡æ¯ï¼Œç¬¬äºŒæ¬¡dfsåˆ†ä¸ºç›´æ¥è®¡ç®—ç­”æ¡ˆå’Œæ„é€ å‰åç¼€ä¿¡æ¯ã€‚é€šå¸¸çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(n)</p>
<h4 id="å¢é‡æ¢æ ¹å…¬å¼ï¼ˆè½»é‡ï¼‰"><a href="#å¢é‡æ¢æ ¹å…¬å¼ï¼ˆè½»é‡ï¼‰" class="headerlink" title="å¢é‡æ¢æ ¹å…¬å¼ï¼ˆè½»é‡ï¼‰"></a>å¢é‡æ¢æ ¹å…¬å¼ï¼ˆè½»é‡ï¼‰</h4><p>ä»…æ ¹æ®ç¬¬ä¸€æ¬¡dfsæ—¶æ„é€ çš„å˜é‡ï¼Œé€šè¿‡ç¬¬äºŒæ¬¡éå†æŒ‰èŠ‚ç‚¹ä¼ é€’ç­”æ¡ˆå¹¶åˆ©ç”¨å˜é‡è¿›è¡Œè®¡ç®—</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://codeforces.com/problemset/problem/1187/E</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">2e5</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">next1</span><span class="params">(N &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">to</span><span class="params">(N &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">S</span><span class="params">(N + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="type">int</span> cnt1;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>)-&gt;ios_base::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// å»ºå›¾å‡½æ•°ï¼ˆé“¾å¼å‰å‘æ˜Ÿå­˜å‚¨ï¼‰</span></span><br><span class="line">    <span class="keyword">auto</span> add = [&amp;](<span class="type">int</span> u, <span class="type">int</span> v) &#123;</span><br><span class="line">        next1[cnt1] = head[u];</span><br><span class="line">        to[cnt1] = v;</span><br><span class="line">        head[u] = cnt1++;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="type">int</span> n;</span><br><span class="line">        cin &gt;&gt; n;</span><br><span class="line">        cnt1 = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">fill</span>(head.<span class="built_in">begin</span>(), head.<span class="built_in">begin</span>() + <span class="number">1</span> + n, <span class="number">0</span>);</span><br><span class="line">        <span class="comment">// è¾“å…¥è¾¹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, u, v; i &lt; n; i++) cin &gt;&gt; u &gt;&gt; v, <span class="built_in">add</span>(u, v), <span class="built_in">add</span>(v, u);</span><br><span class="line">        <span class="type">int</span> val1 = <span class="number">0</span>; <span class="comment">// ä»¥ 1 ä¸ºæ ¹æ—¶æ‰€æœ‰å­æ ‘å¤§å°ä¹‹å’Œ</span></span><br><span class="line">        <span class="comment">// ç¬¬ä¸€æ¬¡ DFSï¼šè®¡ç®—å­æ ‘å¤§å°å’Œ val1</span></span><br><span class="line">        <span class="keyword">auto</span> dfs = [&amp;](<span class="keyword">auto</span>&amp;&amp; f, <span class="type">int</span> u, <span class="type">int</span> fa) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">            S[u] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> ei = head[u], v = to[ei]; ei; ei = next1[ei], v = to[ei]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (v != fa) <span class="built_in">f</span>(f, v, u), S[u] += S[v];</span><br><span class="line">            &#125;</span><br><span class="line">            val1 += S[u];</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="built_in">dfs</span>(dfs, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="comment">// ç¬¬äºŒæ¬¡ DFSï¼šæ¢æ ¹ï¼ŒåŠ¨æ€ç»´æŠ¤ç­”æ¡ˆ</span></span><br><span class="line">        <span class="keyword">auto</span> dfs2 = [&amp;](<span class="keyword">auto</span>&amp;&amp; f, <span class="type">int</span> u, <span class="type">int</span> fa, <span class="type">int</span> val) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">            <span class="type">int</span> val2 = val; <span class="comment">// å½“å‰ç­”æ¡ˆ</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> ei = head[u], v = to[ei]; ei; ei = next1[ei], v = to[ei]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (v != fa) &#123;</span><br><span class="line">                    <span class="comment">// æ¢æ ¹å…¬å¼ï¼šval + n - 2 * S[v]</span></span><br><span class="line">                    val2 = <span class="built_in">max</span>(val2, <span class="built_in">f</span>(f, v, u, val + n - (S[v] &lt;&lt; <span class="number">1</span>)));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> val2;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        cout &lt;&lt; <span class="built_in">dfs2</span>(dfs2, <span class="number">1</span>, <span class="number">0</span>, val1) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å‰åç¼€åˆå¹¶"><a href="#å‰åç¼€åˆå¹¶" class="headerlink" title="å‰åç¼€åˆå¹¶"></a>å‰åç¼€åˆå¹¶</h4><p>å½“æ¯ä¸ªç‚¹çš„ DP æ¥è‡ªâ€œåˆå¹¶æ‰€æœ‰å­æ ‘çš„è´¡çŒ®â€ï¼Œä¸”è¿™ä¸ªåˆå¹¶æ»¡è¶³<strong>ç»“åˆå¾‹</strong>ï¼ˆå¦‚ max/sum/min çš„ç»„åˆï¼‰ï¼Œå°±å¯ä»¥ç”¨<strong>å‰ç¼€/åç¼€</strong>æŠŠâ€œé™¤æŸä¸ªå„¿å­å¤–çš„å…¶ä½™è´¡çŒ®â€åœ¨ O(1) æ‹¿åˆ°ï¼Œå†ä½œä¸ºâ€œçˆ¶ä¿¡æ¯â€ä¸‹æ¨ç»™å„¿å­ï¼Œå®ç°â€œä»çˆ¶å¸¦æ¥çš„è´¡çŒ® + è‡ªå·±å­æ ‘è´¡çŒ®â€çš„é‡ç»„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P6419</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">5e5</span>;</span><br><span class="line"><span class="comment">// é“¾å¼å‰å‘æ˜Ÿå­˜å›¾</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">next1</span><span class="params">(N &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">to</span><span class="params">(N &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">wei</span><span class="params">(N &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="type">int</span> cnt1;</span><br><span class="line"><span class="comment">// DP æ•°ç»„</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sum_in</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">sum_out</span><span class="params">(N + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">max_in</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">max_in2</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">cho</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">max_out</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">has</span><span class="params">(N + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>)-&gt;ios_base::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">auto</span> add = [&amp;](<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">        next1[cnt1] = head[u];</span><br><span class="line">        to[cnt1] = v;</span><br><span class="line">        wei[cnt1] = w;</span><br><span class="line">        head[u] = cnt1++;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="type">int</span> n, k;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">        cnt1 = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">fill</span>(head.<span class="built_in">begin</span>(), head.<span class="built_in">begin</span>() + <span class="number">1</span> + n, <span class="number">0</span>);</span><br><span class="line">        <span class="comment">// è¾“å…¥è¾¹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, u, v, w; i &lt; n; i++) cin &gt;&gt; u &gt;&gt; v &gt;&gt; w, <span class="built_in">add</span>(u, v, w), <span class="built_in">add</span>(v, u, w);</span><br><span class="line">        <span class="comment">// è¾“å…¥ç‰¹æ®ŠèŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, x; i &lt; k; i++) cin &gt;&gt; x, has[x] = <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// ç¬¬ä¸€æ¬¡ DFSï¼šè‡ªåº•å‘ä¸Š</span></span><br><span class="line">        <span class="keyword">auto</span> dfs = [&amp;](<span class="keyword">auto</span>&amp;&amp; f, <span class="type">int</span> u, <span class="type">int</span> fa) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">            max_in[u] = max_in2[u] = sum_in[u] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> ei = head[u], v = to[ei]; ei; ei = next1[ei], v = to[ei]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (v != fa) &#123;</span><br><span class="line">                    <span class="built_in">f</span>(f, v, u);</span><br><span class="line">                    <span class="comment">// ç´¯è®¡å­æ ‘ä»£ä»·</span></span><br><span class="line">                    sum_in[u] += sum_in[v] + (has[v] || sum_in[v]) * (wei[ei] &lt;&lt; <span class="number">1</span>);</span><br><span class="line">                    <span class="comment">// æ›´æ–°æœ€é•¿è·¯å¾„</span></span><br><span class="line">                    <span class="type">int</span> w = max_in[v] + (has[v] || sum_in[v]) * wei[ei];</span><br><span class="line">                    <span class="keyword">if</span> (w &gt; max_in[u]) &#123;</span><br><span class="line">                        cho[u] = v;</span><br><span class="line">                        max_in2[u] = max_in[u];</span><br><span class="line">                        max_in[u] = w;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (w &gt; max_in2[u]) max_in2[u] = w;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="built_in">dfs</span>(dfs, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="comment">// ç¬¬äºŒæ¬¡ DFSï¼šè‡ªé¡¶å‘ä¸‹</span></span><br><span class="line">        <span class="keyword">auto</span> dfs2 = [&amp;](<span class="keyword">auto</span>&amp;&amp; f, <span class="type">int</span> u, <span class="type">int</span> fa) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> ei = head[u], v = to[ei]; ei; ei = next1[ei], v = to[ei]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (v != fa) &#123;</span><br><span class="line">                    max_out[v] = max_out[u];</span><br><span class="line">                    <span class="keyword">if</span> (cho[u] == v) <span class="comment">// å¦‚æœèµ°çš„æ˜¯é‡å„¿å­ï¼Œç”¨æ¬¡ä¼˜çš„ max_in2</span></span><br><span class="line">                        max_out[v] = <span class="built_in">max</span>(max_out[v] + wei[ei], max_in2[u] + wei[ei]);</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        max_out[v] = <span class="built_in">max</span>(max_out[v] + wei[ei], max_in[u] + wei[ei]);</span><br><span class="line">                    <span class="comment">// sum_out çš„è®¡ç®—</span></span><br><span class="line">                    sum_out[v] = (sum_in[u] - sum_in[v] + sum_out[u]) </span><br><span class="line">                               + (sum_in[v] == <span class="number">0</span> &amp;&amp; !has[v]) * wei[ei] * <span class="number">2</span>;</span><br><span class="line">                    <span class="comment">// ç‰¹æ®Šæƒ…å†µï¼šè¯¥è¾¹å”¯ä¸€è¿æ¥æ‰€æœ‰ç‰¹æ®Šç‚¹æ—¶ï¼Œå»æ‰é‡å¤</span></span><br><span class="line">                    <span class="keyword">if</span> (sum_in[u] == sum_in[v] + (wei[ei] &lt;&lt; <span class="number">1</span>) &amp;&amp; !sum_out[u])</span><br><span class="line">                        max_out[v] = sum_out[v] = <span class="number">0</span>;</span><br><span class="line">                    <span class="built_in">f</span>(f, v, u);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="built_in">dfs2</span>(dfs2, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="comment">// è¾“å‡ºç­”æ¡ˆ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            cout &lt;&lt; sum_in[i] + sum_out[i] - <span class="built_in">max</span>(max_in[i], max_out[i]) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="AVLæ ‘"><a href="#AVLæ ‘" class="headerlink" title="AVLæ ‘"></a>AVLæ ‘</h3><p><strong>AVLæ ‘</strong>ï¼ˆè‹±è¯­ï¼šAdelson-Velsky and Landis treeï¼‰æ˜¯<a href="https://zh.wikipedia.org/wiki/è®¡ç®—æœºç§‘å­¦">è®¡ç®—æœºç§‘å­¦</a>ä¸­æœ€æ—©è¢«å‘æ˜çš„<a href="https://zh.wikipedia.org/wiki/è‡ªå¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘">è‡ªå¹³è¡¡äºŒå‰æŸ¥æ‰¾æ ‘</a>ã€‚åœ¨AVLæ ‘ä¸­ï¼Œä»»ä¸€èŠ‚ç‚¹å¯¹åº”çš„ä¸¤æ£µå­æ ‘çš„æœ€å¤§é«˜åº¦å·®ä¸º1ï¼Œå› æ­¤å®ƒä¹Ÿè¢«ç§°ä¸º<strong>é«˜åº¦å¹³è¡¡æ ‘</strong>ã€‚æŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤åœ¨å¹³å‡å’Œæœ€åæƒ…å†µä¸‹çš„<a href="https://zh.wikipedia.org/wiki/æ—¶é—´å¤æ‚åº¦">æ—¶é—´å¤æ‚åº¦</a>éƒ½æ˜¯ O(logâ¡n)ã€‚å¢åŠ å’Œåˆ é™¤å…ƒç´ çš„æ“ä½œåˆ™å¯èƒ½éœ€è¦å€Ÿç”±ä¸€æ¬¡æˆ–å¤šæ¬¡<a href="https://zh.wikipedia.org/wiki/æ ‘æ—‹è½¬">æ ‘æ—‹è½¬</a>ï¼Œä»¥å®ç°æ ‘çš„é‡æ–°å¹³è¡¡ã€‚AVLæ ‘å¾—åäºå®ƒçš„å‘æ˜è€…<a href="https://zh.wikipedia.org/wiki/æ ¼å¥¥å°”å‰Â·é˜¿æ°å°”æ¾-éŸ¦åˆ©æ–¯åŸº">æ ¼å¥¥å°”å‰Â·é˜¿æ°å°”æ¾-éŸ¦åˆ©æ–¯åŸº</a>å’Œ<a href="https://zh.wikipedia.org/wiki/è‘‰å¤«æ ¹å°¼Â·è˜­è¿ªæ–¯">å¶å¤«æ ¹å°¼Â·å…°è¿ªæ–¯</a>ï¼Œä»–ä»¬åœ¨1962å¹´çš„è®ºæ–‡ã€ŠAn algorithm for the organization of informationã€‹ä¸­å…¬å¼€äº†è¿™ä¸€æ•°æ®ç»“æ„ã€‚</p>
<p>ä¸€ç§æœ‰åºè¡¨æ•°æ®ç»“æ„</p>
<p><strong>å®šä¹‰</strong></p>
<ul>
<li>å¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼Œå·¦å³å­æ ‘é«˜åº¦å·® â‰¤ 1</li>
<li>æ’å…¥ã€åˆ é™¤ã€æŸ¥è¯¢æ“ä½œå¤æ‚åº¦ï¼šO(log n)</li>
</ul>
<hr>
<p><strong>èŠ‚ç‚¹ä¿¡æ¯</strong></p>
<ul>
<li>keyï¼šå€¼</li>
<li>countï¼šé‡å¤å€¼é¢‘æ¬¡</li>
<li>heightï¼šå­æ ‘é«˜åº¦</li>
<li>sizeï¼šå­æ ‘å¤§å°ï¼ˆç»Ÿè®¡æ’åã€k-thï¼‰</li>
<li>left/rightï¼šå·¦å³å­èŠ‚ç‚¹</li>
</ul>
<hr>
<p><strong>æ ¸å¿ƒå‡½æ•°</strong></p>
<ul>
<li><code>up(i)</code>ï¼šæ›´æ–° size &amp; height</li>
<li><code>maintain(i)</code>ï¼šæ£€æµ‹å¹³è¡¡å¹¶æ—‹è½¬</li>
<li><code>rotateL / rotateR</code>ï¼šå·¦æ—‹ / å³æ—‹</li>
</ul>
<hr>
<p><strong>æ’å…¥</strong></p>
<ol>
<li>æŒ‰ BST è§„åˆ™é€’å½’</li>
<li>å‘½ä¸­ç›¸ç­‰ â†’ count++</li>
<li>å›æº¯æ—¶ <code>up + maintain</code></li>
</ol>
<hr>
<p><strong>åˆ é™¤</strong></p>
<ol>
<li>count &gt; 1 â†’ countâ€”</li>
<li>æ— å­ â†’ ç›´æ¥åˆ </li>
<li>å•å­ â†’ ç”¨å”¯ä¸€å­æ›¿ä»£</li>
<li>åŒå­ â†’ æ‰¾å³å­æ ‘æœ€å·¦èŠ‚ç‚¹æ›¿ä»£ï¼Œåˆ æ‰å®ƒ</li>
<li>å›æº¯ <code>up + maintain</code></li>
</ol>
<hr>
<p><strong>æŸ¥è¯¢</strong></p>
<ul>
<li>rank(x)ï¼šå°äº x çš„å…ƒç´ æ•° + 1</li>
<li>index(k)ï¼šç¬¬ k å°ï¼Œé  size åˆ¤æ–­èµ°å‘</li>
<li>pre(x)ï¼šå°äº x çš„æœ€å¤§å€¼</li>
<li>suf(x)ï¼šå¤§äº x çš„æœ€å°å€¼</li>
</ul>
<hr>
<p><strong>æ—‹è½¬ç±»å‹</strong></p>
<ul>
<li>LLï¼šå³æ—‹</li>
<li>RRï¼šå·¦æ—‹</li>
<li>LRï¼šå…ˆå·¦æ—‹å­æ ‘ï¼Œå†å³æ—‹</li>
<li>RLï¼šå…ˆå³æ—‹å­æ ‘ï¼Œå†å·¦æ—‹</li>
</ul>
<hr>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P3369</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1e5</span>;</span><br><span class="line"><span class="comment">// èŠ‚ç‚¹ä¿¡æ¯</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">key</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">height</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">left1</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">right1</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">size1</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">count1</span><span class="params">(N + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="type">int</span> head, cnt1; <span class="comment">// head: æ ¹èŠ‚ç‚¹ç¼–å·, cnt1: èŠ‚ç‚¹æ€»æ•°</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>)-&gt;ios_base::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// æ›´æ–°èŠ‚ç‚¹ä¿¡æ¯ï¼šå­æ ‘å¤§å° + é«˜åº¦</span></span><br><span class="line">	<span class="keyword">auto</span> up = [&amp;](<span class="type">int</span> i) &#123;</span><br><span class="line">		size1[i] = size1[left1[i]] + size1[right1[i]] + count1[i];</span><br><span class="line">		height[i] = <span class="built_in">max</span>(height[left1[i]], height[right1[i]]) + <span class="number">1</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">// å·¦æ—‹</span></span><br><span class="line">	<span class="keyword">auto</span> rotate_l = [&amp;](<span class="type">int</span> i) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">		<span class="type">int</span> r = right1[i];</span><br><span class="line">		right1[i] = left1[r];</span><br><span class="line">		left1[r] = i;</span><br><span class="line">		<span class="built_in">up</span>(i);</span><br><span class="line">		<span class="built_in">up</span>(r);</span><br><span class="line">		<span class="keyword">return</span> r;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">// å³æ—‹</span></span><br><span class="line">	<span class="keyword">auto</span> rotate_r = [&amp;](<span class="type">int</span> i) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">		<span class="type">int</span> l = left1[i];</span><br><span class="line">		left1[i] = right1[l];</span><br><span class="line">		right1[l] = i;</span><br><span class="line">		<span class="built_in">up</span>(i);</span><br><span class="line">		<span class="built_in">up</span>(l);</span><br><span class="line">		<span class="keyword">return</span> l;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">// ä¿æŒå¹³è¡¡ï¼šæ£€æŸ¥å¹¶æ—‹è½¬</span></span><br><span class="line">	<span class="keyword">auto</span> maintain = [&amp;](<span class="type">int</span> i) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">		<span class="type">int</span> ln = height[left1[i]], rn = height[right1[i]];</span><br><span class="line">		<span class="keyword">if</span>(ln - rn &gt; <span class="number">1</span>) &#123; <span class="comment">// å·¦å­æ ‘æ›´é«˜</span></span><br><span class="line">			<span class="keyword">if</span>(height[left1[left1[i]]] &gt;= height[right1[left1[i]]]) </span><br><span class="line">				i = <span class="built_in">rotate_r</span>(i); <span class="comment">// LL</span></span><br><span class="line">			<span class="keyword">else</span> </span><br><span class="line">				left1[i] = <span class="built_in">rotate_l</span>(left1[i]), i = <span class="built_in">rotate_r</span>(i); <span class="comment">// LR</span></span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span>(rn - ln &gt; <span class="number">1</span>) &#123; <span class="comment">// å³å­æ ‘æ›´é«˜</span></span><br><span class="line">			<span class="keyword">if</span>(height[right1[right1[i]]] &gt;= height[left1[right1[i]]]) </span><br><span class="line">				i = <span class="built_in">rotate_l</span>(i); <span class="comment">// RR</span></span><br><span class="line">			<span class="keyword">else</span> </span><br><span class="line">				right1[i] = <span class="built_in">rotate_r</span>(right1[i]), i = <span class="built_in">rotate_l</span>(i); <span class="comment">// RL</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> i;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">// æ’å…¥èŠ‚ç‚¹ x</span></span><br><span class="line">	<span class="keyword">auto</span> add = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">0</span>) &#123; <span class="comment">// æ–°å»ºèŠ‚ç‚¹</span></span><br><span class="line">			key[++cnt1] = x;</span><br><span class="line">			count1[cnt1] = size1[cnt1] = height[cnt1] = <span class="number">1</span>;</span><br><span class="line">			left1[cnt1] = right1[cnt1] = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">return</span> cnt1;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(x == key[i]) count1[i] ++;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(x &lt; key[i]) left1[i] = <span class="built_in">f</span>(f, left1[i], x);</span><br><span class="line">		<span class="keyword">else</span> right1[i] = <span class="built_in">f</span>(f, right1[i], x);</span><br><span class="line">		<span class="built_in">up</span>(i);</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">maintain</span>(i);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">// åˆ é™¤å­æ ‘ä¸­çš„æœ€å·¦èŠ‚ç‚¹</span></span><br><span class="line">	<span class="keyword">auto</span> removel = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(i == x) <span class="keyword">return</span> right1[i];</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			left1[i] = <span class="built_in">f</span>(f, left1[i], x);</span><br><span class="line">			<span class="built_in">up</span>(i);</span><br><span class="line">			<span class="keyword">return</span> <span class="built_in">maintain</span>(i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">// åˆ é™¤å€¼ä¸º x çš„èŠ‚ç‚¹ï¼ˆè‹¥å­˜åœ¨ï¼‰</span></span><br><span class="line">	<span class="keyword">auto</span> remove = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(x &lt; key[i]) left1[i] = <span class="built_in">f</span>(f, left1[i], x);</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(x &gt; key[i]) right1[i] = <span class="built_in">f</span>(f, right1[i], x);</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			count1[i] --; <span class="comment">// å¤šæ¬¡å‡ºç°ï¼Œå‡é¢‘æ¬¡</span></span><br><span class="line">			<span class="keyword">if</span>(!count1[i]) &#123; <span class="comment">// é¢‘æ¬¡ä¸º 0 -&gt; åˆ é™¤èŠ‚ç‚¹</span></span><br><span class="line">				<span class="keyword">if</span>(!left1[i] &amp;&amp; !right1[i]) <span class="keyword">return</span> <span class="number">0</span>;       <span class="comment">// æ— å­</span></span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span>(!left1[i] &amp;&amp; right1[i]) i = right1[i]; <span class="comment">// åªæœ‰å³å­</span></span><br><span class="line">				<span class="keyword">else</span> <span class="keyword">if</span>(left1[i] &amp;&amp; !right1[i]) i = left1[i]; <span class="comment">// åªæœ‰å·¦å­</span></span><br><span class="line">				<span class="keyword">else</span> &#123; <span class="comment">// ä¸¤ä¸ªå­</span></span><br><span class="line">					<span class="type">int</span> l = right1[i];</span><br><span class="line">					<span class="keyword">while</span>(left1[l]) l = left1[l]; <span class="comment">// æ‰¾å³å­æ ‘æœ€å·¦èŠ‚ç‚¹</span></span><br><span class="line">					right1[i] = <span class="built_in">removel</span>(removel, right1[i],  l);</span><br><span class="line">					right1[l] = right1[i];</span><br><span class="line">					left1[l] = left1[i];</span><br><span class="line">					i = l;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">up</span>(i);</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">maintain</span>(i);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">// ç»Ÿè®¡å°äº x çš„å…ƒç´ ä¸ªæ•°</span></span><br><span class="line">	<span class="keyword">auto</span> small = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(key[i] &gt;= x) <span class="keyword">return</span> <span class="built_in">f</span>(f, left1[i], x);</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">return</span> count1[i] + <span class="built_in">f</span>(f, right1[i], x) + size1[left1[i]];</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">// æŸ¥è¯¢ç¬¬ x å°çš„æ•°</span></span><br><span class="line">	<span class="keyword">auto</span> index = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(size1[left1[i]] &gt;= x) <span class="keyword">return</span> <span class="built_in">f</span>(f, left1[i], x);</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(size1[left1[i]] + count1[i] &lt; x) </span><br><span class="line">			<span class="keyword">return</span> <span class="built_in">f</span>(f, right1[i], x - size1[left1[i]] - count1[i]);</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">return</span> key[i];</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">// æŸ¥è¯¢å‰é©±ï¼šå°äº x çš„æœ€å¤§å€¼</span></span><br><span class="line">	<span class="keyword">auto</span> pre = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">0</span>) <span class="keyword">return</span> INT_MIN;</span><br><span class="line">		<span class="keyword">if</span>(key[i] &gt;= x) <span class="keyword">return</span> <span class="built_in">f</span>(f, left1[i], x);</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">max</span>(key[i], <span class="built_in">f</span>(f, right1[i], x));</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">// æŸ¥è¯¢åç»§ï¼šå¤§äº x çš„æœ€å°å€¼</span></span><br><span class="line">	<span class="keyword">auto</span> suf = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">		<span class="keyword">if</span>(i == <span class="number">0</span>) <span class="keyword">return</span> INT_MAX;</span><br><span class="line">		<span class="keyword">if</span>(key[i] &lt;= x) <span class="keyword">return</span> <span class="built_in">f</span>(f, right1[i], x);</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">min</span>(key[i], <span class="built_in">f</span>(f, left1[i], x));</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">while</span>(t --) &#123; </span><br><span class="line">		<span class="type">int</span> n;</span><br><span class="line">		cin &gt;&gt; n;</span><br><span class="line">		cnt1 = head = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, op, x; i &lt; n; i ++) &#123;</span><br><span class="line">			cin &gt;&gt; op &gt;&gt; x;</span><br><span class="line">			<span class="keyword">if</span>(op == <span class="number">1</span>) head = <span class="built_in">add</span>(add, head, x);                <span class="comment">// æ’å…¥ x</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>) &#123;                                   <span class="comment">// åˆ é™¤ x</span></span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">small</span>(small, head, x) != <span class="built_in">small</span>(small, head, x + <span class="number">1</span>)) </span><br><span class="line">					head = <span class="built_in">remove</span>(remove, head, x);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">3</span>) cout &lt;&lt; <span class="built_in">small</span>(small, head, x) + <span class="number">1</span> &lt;&lt; <span class="string">&quot;\n&quot;</span>; <span class="comment">// æŸ¥è¯¢æ’å</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">4</span>) cout &lt;&lt; <span class="built_in">index</span>(index, head, x) &lt;&lt; <span class="string">&quot;\n&quot;</span>;     <span class="comment">// æŸ¥è¯¢ç¬¬ k å°</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">5</span>) cout &lt;&lt; <span class="built_in">pre</span>(pre, head, x) &lt;&lt; <span class="string">&quot;\n&quot;</span>;         <span class="comment">// å‰é©±</span></span><br><span class="line">			<span class="keyword">else</span> cout &lt;&lt; <span class="built_in">suf</span>(suf, head, x) &lt;&lt; <span class="string">&quot;\n&quot;</span>;                     <span class="comment">// åç»§</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç¬›å¡å°”æ ‘"><a href="#ç¬›å¡å°”æ ‘" class="headerlink" title="ç¬›å¡å°”æ ‘"></a>ç¬›å¡å°”æ ‘</h3><p>ç¬›å¡å°”æ ‘æ˜¯ä¸€ç§äºŒå‰æ ‘ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹ç”±ä¸€ä¸ªé”®å€¼äºŒå…ƒç»„ <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="(k,w)"> æ„æˆã€‚è¦æ±‚ <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="k"> æ»¡è¶³äºŒå‰æœç´¢æ ‘çš„æ€§è´¨ï¼Œè€Œ <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="w"> æ»¡è¶³å †çš„æ€§è´¨ã€‚å¦‚æœç¬›å¡å°”æ ‘çš„ <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="k,w"> é”®å€¼ç¡®å®šï¼Œä¸” <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="k"> äº’ä¸ç›¸åŒï¼Œ<img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="w"> ä¹Ÿäº’ä¸ç›¸åŒï¼Œé‚£ä¹ˆè¿™æ£µç¬›å¡å°”æ ‘çš„ç»“æ„æ˜¯å”¯ä¸€çš„</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://ac.nowcoder.com/acm/contest/108306/G</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1e6</span>;</span><br><span class="line"><span class="comment">// å•è°ƒæ ˆå»ºæ ‘ç›¸å…³</span></span><br><span class="line"><span class="type">int</span> head, tot;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">L</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">R</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">S</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">H</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">st</span><span class="params">(N + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="comment">// ç»„åˆæ•°é¢„å¤„ç†</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">fac</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">inv</span><span class="params">(N + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>)-&gt;ios_base::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    <span class="comment">// é¢„å¤„ç†é˜¶ä¹˜ä¸é€†å…ƒï¼šfac[i] = i!ï¼Œinv[i] = (i!)^&#123;-1&#125;</span></span><br><span class="line">    fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) fac[i] = fac[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">    <span class="comment">// å¿«é€Ÿå¹‚</span></span><br><span class="line">    <span class="keyword">auto</span> power = [&amp;](<span class="type">int</span> x, <span class="type">int</span> n) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(n) &#123;</span><br><span class="line">            <span class="keyword">if</span>(n &amp; <span class="number">1</span>) ans = ans * x % mod;</span><br><span class="line">            x = x * x % mod;</span><br><span class="line">            n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// è´¹é©¬å°å®šç†æ±‚é€†é˜¶ä¹˜</span></span><br><span class="line">    inv[N] = <span class="built_in">power</span>(fac[N], mod - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --) inv[i] = inv[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % mod;</span><br><span class="line">    <span class="keyword">while</span>(t --)&#123;</span><br><span class="line">        <span class="type">int</span> n;</span><br><span class="line">        cin &gt;&gt; n;</span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–å·¦å³å„¿å­æŒ‡é’ˆ</span></span><br><span class="line">        <span class="built_in">fill</span>(L.<span class="built_in">begin</span>(), L.<span class="built_in">begin</span>() + <span class="number">1</span> + n, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">fill</span>(R.<span class="built_in">begin</span>(), R.<span class="built_in">begin</span>() + <span class="number">1</span> + n, <span class="number">0</span>);</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="type">int</span> min1 = <span class="number">1e18</span>;</span><br><span class="line">        <span class="comment">// è¯»å…¥å¹¶è®°å½•å…¨å±€æœ€å°å€¼ä½ç½®ï¼ˆCartesian Tree çš„æ ¹ï¼‰</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line">            cin &gt;&gt; v1[i];</span><br><span class="line">            <span class="keyword">if</span>(v1[i] &lt; min1) min1 = v1[i], head = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç”¨å•è°ƒé€’å¢æ ˆæ„é€ â€œæœ€å°å€¼ Cartesian Treeâ€</span></span><br><span class="line">        <span class="comment">// è§„åˆ™ï¼ˆç»å…¸åšæ³•ï¼‰ï¼š</span></span><br><span class="line">        <span class="comment">// - å¼¹å‡ºæ‰€æœ‰æ¯”å½“å‰å€¼å¤§çš„æ ˆé¡¶ï¼›</span></span><br><span class="line">        <span class="comment">// - æ ˆé¡¶ï¼ˆè‹¥å­˜åœ¨ï¼‰ä½œä¸ºå½“å‰ç»“ç‚¹çš„å·¦/å³å…³ç³»çš„ä¸€ç«¯ï¼›</span></span><br><span class="line">        <span class="comment">// - ç»´æŠ¤ Lã€R ä¸ºæ¯ä¸ªç»“ç‚¹çš„å·¦å³å„¿å­ã€‚</span></span><br><span class="line">        tot = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, now; i &lt;= n; i ++) &#123;</span><br><span class="line">            now = tot;</span><br><span class="line">            <span class="keyword">while</span>(tot &amp;&amp; v1[i] &lt; v1[st[tot]]) tot --;   <span class="comment">// ä¿æŒå•è°ƒï¼ˆä¸¥æ ¼é€’å¢ï¼‰</span></span><br><span class="line">            <span class="keyword">if</span>(tot) R[st[tot]] = i;                     <span class="comment">// æ ˆé¡¶çš„å³å„¿å­æ˜¯å½“å‰ i</span></span><br><span class="line">            <span class="keyword">if</span>(now &gt; tot) L[i] = st[tot + <span class="number">1</span>];           <span class="comment">// è¢«å¼¹å‡ºçš„ç¬¬ä¸€ä¸ªæˆä¸º i çš„å·¦å„¿å­</span></span><br><span class="line">            st[++tot] = i;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// ç»„åˆæ•° C(k, n) = nCkï¼Œè¿™é‡Œå‚æ•°åæ˜¯ (up, down)ï¼Œå®é™…è¿”å›çš„æ˜¯ C(up, down)</span></span><br><span class="line">        <span class="keyword">auto</span> C = [&amp;](<span class="type">int</span> up, <span class="type">int</span> down) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> fac[down] * inv[up] % mod * inv[down - up] % mod;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// DFSï¼š</span></span><br><span class="line">        <span class="comment">// - å…ˆé€’å½’å„¿å­ï¼Œå¾—åˆ°å­æ ‘è§„æ¨¡ S[*]</span></span><br><span class="line">        <span class="comment">// - æœ¬ç»“ç‚¹è´¡çŒ®ï¼šC(d, d+S[i]-1)ï¼ˆç­‰ä»·äº C(d+S[i]-1, d)ï¼‰</span></span><br><span class="line">        <span class="comment">// - è¿”å›å­æ ‘æ€»ç­”æ¡ˆä¹‹å’Œ</span></span><br><span class="line">        <span class="keyword">auto</span> dfs = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> d) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">            <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span>(!L[i] &amp;&amp; !R[i]) &#123;</span><br><span class="line">                S[i] = <span class="number">1</span>;                               <span class="comment">// å¶å­</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(L[i]) ans = (ans + <span class="built_in">f</span>(f, L[i], d + <span class="number">1</span>)) % mod;</span><br><span class="line">                <span class="keyword">if</span>(R[i]) ans = (ans + <span class="built_in">f</span>(f, R[i], d + <span class="number">1</span>)) % mod;</span><br><span class="line">                S[i] = S[L[i]] + S[R[i]] + <span class="number">1</span>;           <span class="comment">// å­æ ‘è§„æ¨¡</span></span><br><span class="line">            &#125;</span><br><span class="line">            ans = (ans + <span class="built_in">C</span>(d, d + S[i] - <span class="number">1</span>)) % mod;     <span class="comment">// åŠ ä¸Šå½“å‰ç»“ç‚¹çš„ç»„åˆè´¡çŒ®</span></span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// æœ€å +1 ä¸€èˆ¬ç”¨äºæŠŠâ€œç©ºé›†/ç©ºæ–¹æ¡ˆâ€ç­‰è®¡å…¥ç­”æ¡ˆï¼ˆå…·ä½“å–å†³äºé¢˜æ„ï¼‰</span></span><br><span class="line">        cout &lt;&lt; (<span class="built_in">dfs</span>(dfs, head, <span class="number">1</span>) + <span class="number">1</span>) % mod&lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¹¶æŸ¥é›†"><a href="#å¹¶æŸ¥é›†" class="headerlink" title="å¹¶æŸ¥é›†"></a>å¹¶æŸ¥é›†</h3><p>å¯¹æ•°æ®è¿›è¡Œåˆ†ç±»</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é€’å½’æ‰¾ç¥–å…ˆ</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x != fa[x]) fa[x] = <span class="built_in">find</span>(fa[x]);</span><br><span class="line">    <span class="keyword">return</span> fa[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">U</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">    fa[<span class="built_in">find</span>(x)] = <span class="built_in">find</span>(y);</span><br><span class="line">    <span class="built_in">find</span>(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ€åä½¿ç”¨å‰è®°å¾—ç»Ÿä¸€æ ¹ï¼Œå³ä¾¿åˆ©ä¸€éæ—¶æ“ä½œfind</p>
<h3 id="å¸¸è§äºŒåˆ†"><a href="#å¸¸è§äºŒåˆ†" class="headerlink" title="å¸¸è§äºŒåˆ†"></a>å¸¸è§äºŒåˆ†</h3><p>åŠ é€ŸæŸ¥è¯¢</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; v1 = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line"><span class="comment">// æœ€å°å¤§äºç­‰äº</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F1</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> r = v1.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> ans, mid;</span><br><span class="line">    <span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(x &gt;= v1[mid])&#123;</span><br><span class="line">            ans = mid;</span><br><span class="line">            l = mid - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æœ€å°å¤§äº</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F2</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> r = v1.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> ans, mid;</span><br><span class="line">    <span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(x &gt; v1[mid])&#123;</span><br><span class="line">            ans = mid;</span><br><span class="line">            l = mid - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æœ€é•¿é€’å¢å­åºåˆ—</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F1</span><span class="params">(<span class="type">int</span> x, vector&lt;<span class="type">int</span>&gt; &amp; v)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> r = v1.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> mid;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(x &gt; v[mid]) l = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            r = mid - <span class="number">1</span>;</span><br><span class="line">            ans = mid;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æœ€é•¿é€’å‡å­åºåˆ—</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F2</span><span class="params">(<span class="type">int</span> x, vector&lt;<span class="type">int</span>&gt; &amp; v)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> r = v1.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> mid;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(x &lt; v[mid]) l = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            r = mid - <span class="number">1</span>;</span><br><span class="line">            ans = mid;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä¸‰åˆ†"><a href="#ä¸‰åˆ†" class="headerlink" title="ä¸‰åˆ†"></a>ä¸‰åˆ†</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Fè§†å…·ä½“æƒ…å†µ</span></span><br><span class="line"><span class="function">ll <span class="title">ternary_search</span><span class="params">(ll l, ll r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (r - l &gt; <span class="number">3</span>) &#123;</span><br><span class="line">        ll m1 = l + (r - l) / <span class="number">3</span>;</span><br><span class="line">        ll m2 = r - (r - l) / <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">F</span>(m1) &lt;= <span class="built_in">F</span>(m2)) &#123;</span><br><span class="line">            r = m2;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            l = m1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll best = <span class="number">1e9</span>;</span><br><span class="line">    <span class="comment">// æœ€åæš´åŠ›æ±‚è§£</span></span><br><span class="line">    <span class="keyword">for</span> (ll i = l; i &lt;= r; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">F</span>(i) &lt; <span class="built_in">F</span>(best)) &#123;</span><br><span class="line">            best = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> best;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="åšå¼ˆè®ºï¼ˆSGå®šç†ï¼‰"><a href="#åšå¼ˆè®ºï¼ˆSGå®šç†ï¼‰" class="headerlink" title="åšå¼ˆè®ºï¼ˆSGå®šç†ï¼‰"></a>åšå¼ˆè®ºï¼ˆ<code>SG</code>å®šç†ï¼‰</h3><p>æ‰€æœ‰ç›¸åŒå­æ¸¸æˆæœ€ç»ˆ<code>sg</code>å¼‚æˆ–ç»“æœä¸º0åˆ™å…ˆæ‰‹å¿…è´¥ï¼Œä¸ä¸ºé›¶åˆ™å…ˆæ‰‹å¿…èƒœï¼Œ<code>sg</code>ä¸ºä»æŸä¸€èŠ‚ç‚¹å¼€å§‹ï¼Œåˆ°æœ€å¤§é™åº¦å¾€å‰ä¾¿åˆ©åçš„ç¬¬ä¸€ä¸ªæ²¡æœ‰å‡ºç°çš„è‡ªç„¶æ•°ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// è®¡ç®—é›†åˆä¸­ç¼ºå¤±çš„æœ€å°éè´Ÿæ•´æ•°ï¼ˆmexå‡½æ•°ï¼‰</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">mex</span><span class="params">(<span class="type">const</span> set&lt;<span class="type">int</span>&gt;&amp; s)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> m = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (s.<span class="built_in">count</span>(m)) m++;</span><br><span class="line">    <span class="keyword">return</span> m;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;è¯·è¾“å…¥çŸ³å­å †çš„çŸ³å­æ•°é‡ï¼š&quot;</span>;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="comment">// å…è®¸çš„æ“ä½œï¼šæ¯æ¬¡å¯ä»¥å– 1ã€2 æˆ– 3 ä¸ªçŸ³å­</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; moves = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line">    <span class="comment">// åŠ¨æ€è§„åˆ’æ•°ç»„ï¼Œsg[i] è¡¨ç¤ºå½“å‰çŸ³å­æ•°é‡ä¸º i æ—¶çš„ SG å€¼</span></span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sg</span><span class="params">(n+<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    sg[<span class="number">0</span>] = <span class="number">0</span>; <span class="comment">// æ²¡æœ‰çŸ³å­æ—¶ï¼ŒSGå€¼ä¸º0</span></span><br><span class="line">    <span class="comment">// è®¡ç®—æ¯ä¸ªçŠ¶æ€çš„ SG å€¼</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        set&lt;<span class="type">int</span>&gt; nextSG;</span><br><span class="line">        <span class="comment">// å¯¹æ¯ä¸€ç§å…è®¸çš„èµ°æ³•ï¼Œè®¡ç®—ä¸‹ä¸€çŠ¶æ€çš„ SG å€¼</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> move : moves) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i - move &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                nextSG.<span class="built_in">insert</span>(sg[i - move]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        sg[i] = <span class="built_in">mex</span>(nextSG);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;çŠ¶æ€ &quot;</span> &lt;&lt; n &lt;&lt; <span class="string">&quot; çš„ SG å€¼ä¸ºï¼š&quot;</span> &lt;&lt; sg[n] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(sg[n] != <span class="number">0</span>)</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;å…ˆæ‰‹å¿…èƒœ\n&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;åæ‰‹å¿…èƒœ\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ä¹˜ç§¯æœ€å¤§å­æ•°ç»„"><a href="#ä¹˜ç§¯æœ€å¤§å­æ•°ç»„" class="headerlink" title="ä¹˜ç§¯æœ€å¤§å­æ•°ç»„"></a>ä¹˜ç§¯æœ€å¤§å­æ•°ç»„</h3><p>ä¿ç•™ä¹˜ç§¯æœ€å°çš„ç»“æœä»¥å‡†å¤‡è§¦åº•åå¼¹</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line"><span class="type">int</span> min1 = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> max1 = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> ans1 = INT_MIN;</span><br><span class="line"><span class="type">int</span> pre1 = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> pre2 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; v1.<span class="built_in">size</span>(); i ++)&#123;</span><br><span class="line">    max1 = <span class="built_in">max</span>(&#123;v1[i], pre1 * v1[i], pre2 * v1[i]&#125;);</span><br><span class="line">    min1 = <span class="built_in">min</span>(&#123;v1[i], pre1 * v1[i], pre2 * v1[i]&#125;);</span><br><span class="line">    pre1 = max1;</span><br><span class="line">    pre2 = min1;</span><br><span class="line">    ans1 = <span class="built_in">max</span>(ans1, max1);</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; ans1 &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br></pre></td></tr></table></figure>
<h3 id="æ ˆ"><a href="#æ ˆ" class="headerlink" title="æ ˆ"></a>æ ˆ</h3><h4 id="å•è°ƒæ ˆ"><a href="#å•è°ƒæ ˆ" class="headerlink" title="å•è°ƒæ ˆ"></a>å•è°ƒæ ˆ</h4><p>æ±‚æŸä¸€ä¾§ç¬¬ä¸€ä¸ª å¤§äºæˆ–è€…å°äºå…¶çš„æ•°</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="comment">// æ±‚å³è¾¹ç¬¬ä¸€ä¸ªæ¯”å…¶å¤§çš„æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp; v1, <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">ans</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="type">int</span> size=v1.<span class="built_in">size</span>();</span><br><span class="line">    stack&lt;<span class="type">int</span>&gt; s1;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;size;i++)&#123;</span><br><span class="line">        <span class="keyword">while</span>(!s1.<span class="built_in">empty</span>() &amp;&amp; v1[i] &gt; v1[s1.<span class="built_in">top</span>()])&#123;</span><br><span class="line">            ans[s1.<span class="built_in">top</span>()] = i+<span class="number">1</span>;</span><br><span class="line">            s1.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        s1.<span class="built_in">push</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;size;i++)&#123;</span><br><span class="line">        cout&lt;&lt;ans[i]&lt;&lt;<span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    &#125;cout&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        cin&gt;&gt;v1[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">solve</span>(v1, n);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æœ€å¤§é¢‘ç‡æ ˆ"><a href="#æœ€å¤§é¢‘ç‡æ ˆ" class="headerlink" title="æœ€å¤§é¢‘ç‡æ ˆ"></a>æœ€å¤§é¢‘ç‡æ ˆ</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FreqStack</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    unordered_map&lt;<span class="type">int</span>,vector&lt;<span class="type">int</span>&gt;&gt; s1;</span><br><span class="line">    unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt; t1;</span><br><span class="line">    <span class="type">int</span> max1;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">FreqStack</span>() &#123;</span><br><span class="line">        max1=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> val)</span> </span>&#123;</span><br><span class="line">        t1[val]++;</span><br><span class="line">        s1[t1[val]].<span class="built_in">push_back</span>(val);</span><br><span class="line">        max1=t1[val]&gt;max1?t1[val]:max1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    int pop() åˆ é™¤å¹¶è¿”å›å †æ ˆä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å…ƒç´ ã€‚</span></span><br><span class="line"><span class="comment">	å¦‚æœå‡ºç°é¢‘ç‡æœ€é«˜çš„å…ƒç´ ä¸åªä¸€ä¸ªï¼Œåˆ™ç§»é™¤å¹¶è¿”å›æœ€æ¥è¿‘æ ˆé¡¶çš„å…ƒç´ ã€‚</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ans=s1[max1].<span class="built_in">back</span>();</span><br><span class="line">        s1[t1[ans]--].<span class="built_in">pop_back</span>();</span><br><span class="line">        <span class="keyword">if</span>(t1[ans]==<span class="number">0</span>)&#123;</span><br><span class="line">            t1.<span class="built_in">erase</span>(ans);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(s1[max1].<span class="built_in">empty</span>())&#123;</span><br><span class="line">            max1--;</span><br><span class="line">            s1.<span class="built_in">erase</span>(max1+<span class="number">1</span>);</span><br><span class="line">        &#125;<span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="å †"><a href="#å †" class="headerlink" title="å †"></a>å †</h3><h4 id="åŠ¨æ€å †å¯»æ‰¾ä¸­ä½æ•°"><a href="#åŠ¨æ€å †å¯»æ‰¾ä¸­ä½æ•°" class="headerlink" title="åŠ¨æ€å †å¯»æ‰¾ä¸­ä½æ•°"></a>åŠ¨æ€å †å¯»æ‰¾ä¸­ä½æ•°</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1e5</span>;</span><br><span class="line"><span class="type">int</span> n;               <span class="comment">// æ“ä½œæ¬¡æ•°</span></span><br><span class="line">string op;            <span class="comment">// è¾“å…¥çš„æ“ä½œå‘½ä»¤</span></span><br><span class="line"><span class="type">int</span> size1 = <span class="number">0</span>;        <span class="comment">// å½“å‰æ ˆçš„å¤§å°</span></span><br><span class="line"><span class="type">int</span> minsize = <span class="number">0</span>;      <span class="comment">// å°æ ¹å †ä¸­å…ƒç´ çš„æ•°é‡</span></span><br><span class="line"><span class="type">int</span> maxsize = <span class="number">0</span>;      <span class="comment">// å¤§æ ¹å †ä¸­å…ƒç´ çš„æ•°é‡</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">stack1</span><span class="params">(N)</span></span>;    <span class="comment">// ç”¨äºæ¨¡æ‹Ÿæ ˆï¼Œå­˜å‚¨æ‰€æœ‰æ’å…¥çš„æ•°å­—</span></span><br><span class="line">priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;<span class="type">int</span>&gt;&gt; minheap;  <span class="comment">// å°æ ¹å †ï¼Œç”¨äºå­˜å‚¨å¤§äºç­‰äºä¸­ä½æ•°çš„æ•°</span></span><br><span class="line">priority_queue&lt;<span class="type">int</span>&gt; maxheap;  <span class="comment">// å¤§æ ¹å †ï¼Œç”¨äºå­˜å‚¨å°äºç­‰äºä¸­ä½æ•°çš„æ•°</span></span><br><span class="line"><span class="comment">// ç”¨äºå»¶è¿Ÿåˆ é™¤çš„æ˜ å°„ï¼šè®°å½•éœ€è¦ä»å †ä¸­åˆ é™¤ä½†è¿˜æœªå®é™…åˆ é™¤çš„æ•°å­—åŠå…¶æ¬¡æ•°</span></span><br><span class="line">unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; delayed;  </span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">prune</span><span class="params">(T &amp;heap)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å½“å †ä¸ä¸ºç©ºæ—¶ï¼Œæ£€æŸ¥å †é¡¶å…ƒç´ æ˜¯å¦åœ¨å»¶è¿Ÿåˆ é™¤æ˜ å°„ä¸­</span></span><br><span class="line">    <span class="keyword">while</span> (!heap.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="type">int</span> num = heap.<span class="built_in">top</span>();</span><br><span class="line">        <span class="keyword">if</span> (delayed.<span class="built_in">count</span>(num)) &#123;  <span class="comment">// å¦‚æœå †é¡¶å…ƒç´ éœ€è¦è¢«åˆ é™¤</span></span><br><span class="line">            delayed[num]--;        <span class="comment">// å»¶è¿Ÿåˆ é™¤è®¡æ•°å‡ä¸€</span></span><br><span class="line">            <span class="keyword">if</span> (delayed[num] == <span class="number">0</span>)</span><br><span class="line">                delayed.<span class="built_in">erase</span>(num);  <span class="comment">// å¦‚æœæ¬¡æ•°ä¸º0åˆ™ä»æ˜ å°„ä¸­åˆ é™¤</span></span><br><span class="line">            heap.<span class="built_in">pop</span>();              <span class="comment">// å¼¹å‡ºå †é¡¶å…ƒç´ </span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">break</span>; <span class="comment">// å †é¡¶å…ƒç´ æœªè¢«å»¶è¿Ÿåˆ é™¤ï¼Œé€€å‡ºå¾ªç¯</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">balance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¦‚æœå¤§æ ¹å †çš„å…ƒç´ æ¯”å°æ ¹å †å¤šè¶…è¿‡1ä¸ªï¼Œåˆ™å°†å¤§æ ¹å †çš„å †é¡¶ç§»åŠ¨åˆ°å°æ ¹å †ä¸­</span></span><br><span class="line">    <span class="keyword">if</span> (maxsize &gt; minsize + <span class="number">1</span>) &#123;</span><br><span class="line">        minheap.<span class="built_in">push</span>(maxheap.<span class="built_in">top</span>());</span><br><span class="line">        maxheap.<span class="built_in">pop</span>();</span><br><span class="line">        minsize++;</span><br><span class="line">        maxsize--;</span><br><span class="line">        <span class="built_in">prune</span>(maxheap);  <span class="comment">// æ¸…ç†å¤§æ ¹å †å †é¡¶å¯èƒ½å­˜åœ¨çš„å»¶è¿Ÿåˆ é™¤å…ƒç´ </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¦‚æœå¤§æ ¹å †çš„å…ƒç´ æ•°ç›®å°äºå°æ ¹å †ï¼Œåˆ™å°†å°æ ¹å †çš„å †é¡¶ç§»åŠ¨åˆ°å¤§æ ¹å †ä¸­</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (maxsize &lt; minsize) &#123;</span><br><span class="line">        maxheap.<span class="built_in">push</span>(minheap.<span class="built_in">top</span>());</span><br><span class="line">        minheap.<span class="built_in">pop</span>();</span><br><span class="line">        maxsize++;</span><br><span class="line">        minsize--;</span><br><span class="line">        <span class="built_in">prune</span>(minheap);  <span class="comment">// æ¸…ç†å°æ ¹å †å †é¡¶å¯èƒ½å­˜åœ¨çš„å»¶è¿Ÿåˆ é™¤å…ƒç´ </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">erase</span><span class="params">(<span class="type">int</span> num)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ ‡è®°è¯¥æ•°å­—éœ€è¦å»¶è¿Ÿåˆ é™¤</span></span><br><span class="line">    delayed[num]++;</span><br><span class="line">    <span class="keyword">if</span> (num &lt;= maxheap.<span class="built_in">top</span>()) &#123;</span><br><span class="line">        maxsize--;</span><br><span class="line">        <span class="comment">// å¦‚æœå¾…åˆ é™¤æ•°å­—æ°å¥½æ˜¯å¤§æ ¹å †å †é¡¶ï¼Œåˆ™ç«‹å³æ¸…ç†</span></span><br><span class="line">        <span class="keyword">if</span> (num == maxheap.<span class="built_in">top</span>()) &#123;</span><br><span class="line">            <span class="built_in">prune</span>(maxheap);</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        minsize--;</span><br><span class="line">        <span class="comment">// å¦‚æœå¾…åˆ é™¤æ•°å­—æ°å¥½æ˜¯å°æ ¹å †å †é¡¶ï¼Œåˆ™ç«‹å³æ¸…ç†</span></span><br><span class="line">        <span class="keyword">if</span> (num == minheap.<span class="built_in">top</span>())</span><br><span class="line">            <span class="built_in">prune</span>(minheap);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">balance</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        cin &gt;&gt; op;</span><br><span class="line">        <span class="comment">// peek</span></span><br><span class="line">        <span class="keyword">if</span> (op[<span class="number">1</span>] == <span class="string">&#x27;e&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (size1 == <span class="number">0</span>)</span><br><span class="line">                cout &lt;&lt; <span class="string">&quot;Invalid&quot;</span> &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="comment">// ä¸­ä½æ•°ä¸ºå¤§æ ¹å †çš„å †é¡¶</span></span><br><span class="line">                cout &lt;&lt; maxheap.<span class="built_in">top</span>() &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="comment">// pop</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (op[<span class="number">1</span>] == <span class="string">&#x27;o&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (size1 == <span class="number">0</span>)</span><br><span class="line">                cout &lt;&lt; <span class="string">&quot;Invalid&quot;</span> &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// è¾“å‡ºæ ˆé¡¶å…ƒç´ </span></span><br><span class="line">                cout &lt;&lt; stack1[size1 - <span class="number">1</span>] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">                <span class="comment">// åˆ é™¤æ ˆé¡¶å…ƒç´ ï¼Œå¹¶åœ¨å †ä¸­å»¶è¿Ÿåˆ é™¤å¯¹åº”æ•°å­—</span></span><br><span class="line">                <span class="built_in">erase</span>(stack1[--size1]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="comment">// push</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            cin &gt;&gt; stack1[size1++];</span><br><span class="line">            <span class="comment">// å¦‚æœå¤§æ ¹å †ä¸ºç©ºï¼Œåˆ™ç›´æ¥æ’å…¥åˆ°å¤§æ ¹å †ä¸­</span></span><br><span class="line">            <span class="keyword">if</span> (maxsize == <span class="number">0</span>) &#123;</span><br><span class="line">                maxheap.<span class="built_in">push</span>(stack1[size1 - <span class="number">1</span>]);</span><br><span class="line">                maxsize++;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ ¹æ®æ–°æ’å…¥æ•°å­—ä¸å½“å‰ä¸­ä½æ•°æ¯”è¾ƒï¼Œå†³å®šæ”¾å…¥å“ªä¸ªå †</span></span><br><span class="line">            <span class="keyword">if</span> (stack1[size1 - <span class="number">1</span>] &gt; maxheap.<span class="built_in">top</span>()) &#123;</span><br><span class="line">                minheap.<span class="built_in">push</span>(stack1[size1 - <span class="number">1</span>]);</span><br><span class="line">                minsize++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                maxheap.<span class="built_in">push</span>(stack1[size1 - <span class="number">1</span>]);</span><br><span class="line">                maxsize++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// ä¿æŒä¸¤ä¸ªå †çš„å¹³è¡¡</span></span><br><span class="line">            <span class="built_in">balance</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>) -&gt; ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> t; </span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¤§å°æ ¹å †"><a href="#å¤§å°æ ¹å †" class="headerlink" title="å¤§å°æ ¹å †"></a>å¤§å°æ ¹å †</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// å‘å †ä¸­æ’å…¥æ–°å…ƒç´ ï¼Œä½¿å…¶æ»¡è¶³å¤§é¡¶å †æ€§è´¨</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heapInsert</span><span class="params">(<span class="type">int</span> arr[], <span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(arr[i] &gt; arr[(i<span class="number">-1</span>)/<span class="number">2</span>]) &#123;</span><br><span class="line">        <span class="built_in">swap</span>(arr[i], arr[(i<span class="number">-1</span>)/<span class="number">2</span>]);</span><br><span class="line">        i = (i<span class="number">-1</span>)/<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å †åŒ–ï¼šä»ä¸‹æ ‡ i å¼€å§‹å‘ä¸‹è°ƒæ•´ï¼Œä½¿å­æ ‘æ»¡è¶³å¤§é¡¶å †æ€§è´¨ï¼Œsize ä¸ºå †çš„å¤§å°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heapify</span><span class="params">(<span class="type">int</span> arr[], <span class="type">int</span> i, <span class="type">int</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = i * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> maxIdx;  <span class="comment">// ä¿å­˜å·¦å³å­©å­ä¸­è¾ƒå¤§å€¼çš„ä¸‹æ ‡</span></span><br><span class="line">    <span class="type">int</span> idx;     <span class="comment">// ä¿å­˜çˆ¶èŠ‚ç‚¹ä¸è¾ƒå¤§å­©å­ä¸­è¾ƒå¤§è€…çš„ä¸‹æ ‡</span></span><br><span class="line">    <span class="keyword">while</span>(l &lt; size) &#123;</span><br><span class="line">        <span class="comment">// åœ¨å·¦å³å­©å­ä¸­é€‰æ‹©è¾ƒå¤§è€…</span></span><br><span class="line">        maxIdx = (l + <span class="number">1</span> &lt; size &amp;&amp; arr[l+<span class="number">1</span>] &gt; arr[l]) ? l + <span class="number">1</span> : l;</span><br><span class="line">        <span class="comment">// é€‰æ‹©çˆ¶èŠ‚ç‚¹ä¸è¾ƒå¤§å­©å­ä¸­è¾ƒå¤§è€…</span></span><br><span class="line">        idx = (arr[i] &gt; arr[maxIdx]) ? i : maxIdx;</span><br><span class="line">        <span class="keyword">if</span>(idx == i) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">swap</span>(arr[i], arr[idx]);</span><br><span class="line">            i = idx;</span><br><span class="line">            l = i * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">heapPop</span><span class="params">(<span class="type">int</span> arr[], <span class="type">int</span> &amp;size)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(size &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> top = arr[<span class="number">0</span>];             <span class="comment">// ä¿å­˜å †é¡¶å…ƒç´ </span></span><br><span class="line">    <span class="built_in">swap</span>(arr[<span class="number">0</span>], arr[size - <span class="number">1</span>]);    <span class="comment">// å°†å †é¡¶ä¸æœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢</span></span><br><span class="line">    size--;                       <span class="comment">// åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">    <span class="built_in">heapify</span>(arr, <span class="number">0</span>, size);        <span class="comment">// ä»é¡¶ç«¯é‡æ–°è°ƒæ•´å †</span></span><br><span class="line">    <span class="keyword">return</span> top;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ‰«æçº¿"><a href="#æ‰«æçº¿" class="headerlink" title="æ‰«æçº¿"></a>æ‰«æçº¿</h3><p>åˆ©ç”¨æ‰«ææ€æƒ³å¹³ç§»æŸä¸€ä¸ªè½´æ—¶ï¼ŒåŠ å·¥å¦ä¸€ä¸ªè½´çš„ä¿¡æ¯æ¥ä¸€è¾¹æ‰«è¿‡å»å°±èƒ½è§£å†³é—®é¢˜</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P5490</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>) -&gt; ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">	<span class="keyword">while</span>(t --)&#123;</span><br><span class="line">		<span class="type">int</span> n;</span><br><span class="line">		cin &gt;&gt; n;</span><br><span class="line">		vector&lt;<span class="type">int</span>&gt; v2 = &#123;<span class="number">-2</span>&#125;;</span><br><span class="line">		vector&lt;array&lt;<span class="type">int</span>, 4&gt;&gt; v1;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++)&#123;</span><br><span class="line">			<span class="type">int</span> x1, y1, x2, y2;</span><br><span class="line">			cin &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2;</span><br><span class="line">			v2.<span class="built_in">push_back</span>(y1);</span><br><span class="line">			v2.<span class="built_in">push_back</span>(y2);</span><br><span class="line">			v1.<span class="built_in">push_back</span>(&#123;x1, y1, y2, <span class="number">1</span>&#125;);</span><br><span class="line">			v1.<span class="built_in">push_back</span>(&#123;x2, y1, y2, <span class="number">-1</span>&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">sort</span>(v2.<span class="built_in">begin</span>() + <span class="number">1</span>, v2.<span class="built_in">end</span>());</span><br><span class="line">		<span class="type">int</span> m = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt; v2.<span class="built_in">size</span>(); i ++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(v2[i] != v2[m])&#123;</span><br><span class="line">				v2[++ m] = v2[i];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		v2.<span class="built_in">push_back</span>(v2[m]);</span><br><span class="line">		<span class="keyword">auto</span> find = [&amp;](<span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="type">int</span> l = <span class="number">1</span>, r = m;</span><br><span class="line">			<span class="type">int</span> mid, ans = <span class="number">-1</span>;</span><br><span class="line">			<span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">				mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">if</span>(v2[mid] &gt;= x)&#123;</span><br><span class="line">					ans = mid;</span><br><span class="line">					r = mid - <span class="number">1</span>;</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					l = mid + <span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> ans;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sum1</span><span class="params">(m &lt;&lt; <span class="number">4</span>)</span>, <span class="title">cnt1</span><span class="params">(m &lt;&lt; <span class="number">4</span>)</span>, <span class="title">cover</span><span class="params">(m &lt;&lt; <span class="number">4</span>)</span></span>;</span><br><span class="line">		<span class="keyword">auto</span> build = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(l &lt; r)&#123;</span><br><span class="line">				<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">				<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">			&#125;</span><br><span class="line">			cover[i] = v2[r + <span class="number">1</span>] - v2[l];</span><br><span class="line">			sum1[i] = cnt1[i] = <span class="number">0</span>;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="built_in">build</span>(build, <span class="number">1</span>, <span class="number">1</span>, m);</span><br><span class="line">		<span class="keyword">auto</span> up = [&amp;](<span class="type">int</span> i) &#123;</span><br><span class="line">			<span class="keyword">if</span>(cnt1[i] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">				sum1[i] = cover[i]; </span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				sum1[i] = sum1[i &lt;&lt; <span class="number">1</span>] + sum1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> set = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> bl, <span class="type">int</span> br, <span class="type">int</span> val, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(bl &lt;= l &amp;&amp; br &gt;= r)&#123;</span><br><span class="line">				cnt1[i] += val;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">if</span>(bl &lt;= mid)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, bl, br, val, l, mid);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(br &gt; mid)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, bl, br, val, mid + <span class="number">1</span>, r);</span><br><span class="line">				&#125;     </span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">up</span>(i);</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="built_in">sort</span>(v1.<span class="built_in">begin</span>(), v1.<span class="built_in">end</span>());</span><br><span class="line">		<span class="type">int</span> last = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n &lt;&lt; <span class="number">1</span>; i ++)&#123;</span><br><span class="line">			<span class="type">int</span> now = v1[i][<span class="number">0</span>];</span><br><span class="line">			ans += sum1[<span class="number">1</span>] * (now - last);</span><br><span class="line">			<span class="comment">// cout &lt;&lt; sum1[1] &lt;&lt; &quot; &quot; &lt;&lt; now &lt;&lt; &quot; &quot; &lt;&lt; last &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">			last = now;</span><br><span class="line">			<span class="built_in">set</span>(set, <span class="number">1</span>, <span class="built_in">find</span>(v1[i][<span class="number">1</span>]), <span class="built_in">find</span>(v1[i][<span class="number">2</span>]) - <span class="number">1</span>, v1[i][<span class="number">3</span>], <span class="number">1</span>, m);</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h3><h4 id="å½’å¹¶åˆ†æ²»"><a href="#å½’å¹¶åˆ†æ²»" class="headerlink" title="å½’å¹¶åˆ†æ²»"></a>å½’å¹¶åˆ†æ²»</h4><p>åˆ†è€Œæ²»ä¹‹</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 500</span></span><br><span class="line"><span class="type">int</span> a1[M];</span><br><span class="line"><span class="type">int</span> temp[M];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> m,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> i=l;</span><br><span class="line">    <span class="type">int</span> j=m+<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> mark=l;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;=m &amp;&amp; j&lt;=r) a1[mark++]=temp[i]&lt;temp[j]?temp[i++]:temp[j++];</span><br><span class="line">    <span class="keyword">while</span>(i&lt;=m) a1[mark++]=temp[i++];</span><br><span class="line">    <span class="keyword">while</span>(j&lt;=r) a1[mark++]=temp[j++];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k=l;k&lt;=r;k++) temp[k]=a1[k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">guibing</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(l&gt;=r) <span class="keyword">return</span> ;</span><br><span class="line">	<span class="type">int</span> m=(l+r)/<span class="number">2</span>;</span><br><span class="line">	<span class="built_in">guibing</span>(l,m);</span><br><span class="line">	<span class="built_in">guibing</span>(m+<span class="number">1</span>,r);</span><br><span class="line">	<span class="built_in">merge</span>(l,m,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        cin&gt;&gt;a1[i];</span><br><span class="line">        temp[i]=a1[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">guibing</span>(<span class="number">0</span>,n<span class="number">-1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++) cout&lt;&lt;a1[i]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="éšæœºå¿«æ’-amp-é€‰æ‹©ç¬¬-k-å°-å¤§-çš„æ•°"><a href="#éšæœºå¿«æ’-amp-é€‰æ‹©ç¬¬-k-å°-å¤§-çš„æ•°" class="headerlink" title="éšæœºå¿«æ’ &amp; é€‰æ‹©ç¬¬ k å°/å¤§ çš„æ•°"></a>éšæœºå¿«æ’ &amp; é€‰æ‹©ç¬¬ k å°/å¤§ çš„æ•°</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 500</span></span><br><span class="line"><span class="comment">// ç»å…¸</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">partition1</span><span class="params">(<span class="type">int</span> a1[],<span class="type">int</span> l,<span class="type">int</span> mid,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> i=l;</span><br><span class="line">    <span class="type">int</span> j=r;</span><br><span class="line">    <span class="type">int</span> temp=a1[mid];</span><br><span class="line">    <span class="built_in">swap</span>(a1[mid],a1[l]);</span><br><span class="line">    <span class="keyword">while</span>(i&lt;j)&#123;</span><br><span class="line">        <span class="keyword">while</span>(j&gt;i &amp;&amp; a1[j]&gt;temp)&#123;</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">        a1[i]=a1[j];</span><br><span class="line">        <span class="keyword">while</span>(i&lt;j &amp;&amp; a1[i]&lt;=temp)&#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        a1[j]=a1[i];</span><br><span class="line">    &#125;</span><br><span class="line">    a1[i]=temp;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">qs1</span><span class="params">(<span class="type">int</span> a1[],<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="type">int</span> x=l+(<span class="built_in">rand</span>()%(r-l+<span class="number">1</span>));</span><br><span class="line">    <span class="type">int</span> mid=<span class="built_in">partition1</span>(a1,l,x,r);</span><br><span class="line">    <span class="built_in">qs1</span>(a1,l,mid<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">qs1</span>(a1,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä¼˜åŒ–</span></span><br><span class="line"><span class="type">int</span> first;</span><br><span class="line"><span class="type">int</span> second;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">partition2</span><span class="params">(<span class="type">int</span> a1[],<span class="type">int</span> l,<span class="type">int</span> mid,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    first=l;</span><br><span class="line">    second=r;</span><br><span class="line">    <span class="type">int</span> temp=a1[mid];</span><br><span class="line">    <span class="type">int</span> i=l;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;=second)&#123;</span><br><span class="line">        <span class="keyword">if</span>(a1[i]==temp)&#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(a1[i]&lt;temp)&#123;</span><br><span class="line">            <span class="built_in">swap</span>(a1[first++],a1[i++]);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">swap</span>(a1[i],a1[second--]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">qs2</span><span class="params">(<span class="type">int</span> a1[],<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="type">int</span> x=l+(<span class="built_in">rand</span>()%(r-l+<span class="number">1</span>));</span><br><span class="line">    <span class="built_in">partition2</span>(a1,l,x,r);</span><br><span class="line">    <span class="type">int</span> left=first;</span><br><span class="line">    <span class="type">int</span> right=second;</span><br><span class="line">    <span class="built_in">qs2</span>(a1,l,left<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">qs2</span>(a1,right+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// éšæœºé€‰æ‹©ç¬¬ tar å°çš„å…ƒç´ ï¼ˆ0-basedï¼‰</span></span><br><span class="line"><span class="comment">// è¦æ±‚ç¬¬kå¤§çš„å…ƒç´ ç­‰åŒäºæ±‚n - kå°çš„å…ƒç´ </span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">randomizedSelect</span><span class="params">(<span class="type">int</span> a1[], <span class="type">int</span> k, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>, r = n - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">        <span class="type">int</span> x = l + <span class="built_in">rand</span>() % (r - l + <span class="number">1</span>); <span class="comment">// éšæœºé€‰å–æ¢çº½å€¼</span></span><br><span class="line">        <span class="built_in">partition2</span>(a1, l, x, r); <span class="comment">// ä¸‰è·¯åˆ’åˆ†ï¼Œç»“æœé€šè¿‡ first å’Œ second è¡¨ç¤º</span></span><br><span class="line">        <span class="keyword">if</span> (k &lt; first) &#123;</span><br><span class="line">            r = first - <span class="number">1</span>; <span class="comment">// ç›®æ ‡åœ¨å·¦ä¾§</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (k &gt; second) &#123;</span><br><span class="line">            l = second + <span class="number">1</span>; <span class="comment">// ç›®æ ‡åœ¨å³ä¾§</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> a1[k]; <span class="comment">// å‘½ä¸­ï¼štar ä½äºç­‰äºåŒºåŸŸå†…</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è‹¥æœªæ‰¾åˆ°ï¼ˆç†è®ºä¸Šä¸ä¼šå‡ºç°ï¼‰ï¼Œè¿”å› -1 è¡¨ç¤ºé”™è¯¯</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="é˜¶ä¹˜ä¸é€†å…ƒ"><a href="#é˜¶ä¹˜ä¸é€†å…ƒ" class="headerlink" title="é˜¶ä¹˜ä¸é€†å…ƒ"></a>é˜¶ä¹˜ä¸é€†å…ƒ</h3><p>ä¹˜ä»¥é€†å…ƒç­‰äºé™¤ä»¥æŸä¸€ä¸ªæ•°å†å–æ¨¡&gt;</p>
<blockquote>
<p>1!,2!,3!â€¦n!çš„é€†å…ƒ<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">auto</span> power = [&amp;](<span class="type">int</span> x, <span class="type">int</span> n) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n &amp; <span class="number">1</span>)&#123;</span><br><span class="line">            ans = ans * x % mod;</span><br><span class="line">        &#125;</span><br><span class="line">        x = x * x % mod;</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">fac</span><span class="params">(n + <span class="number">1</span>)</span></span>; <span class="comment">// é˜¶ä¹˜</span></span><br><span class="line">fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    fac[i] = fac[i - <span class="number">1</span>] * i % mod; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">inv</span><span class="params">(n + <span class="number">1</span>)</span></span>; <span class="comment">// é€†å…ƒ</span></span><br><span class="line">inv[n] = <span class="built_in">power</span>(fac[n], mod - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --)&#123;</span><br><span class="line">    inv[i] = inv[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">auto</span> C = [&amp;](<span class="type">int</span> n, <span class="type">int</span> m) -&gt; <span class="type">int</span> &#123; <span class="comment">// ç»„åˆæ•°</span></span><br><span class="line">    <span class="keyword">if</span>(m &gt; n)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fac[n] * inv[m] % mod * inv[n - m] % mod;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="çº¿æ€§é€’æ¨é€†å…ƒ"><a href="#çº¿æ€§é€’æ¨é€†å…ƒ" class="headerlink" title="çº¿æ€§é€’æ¨é€†å…ƒ"></a>çº¿æ€§é€’æ¨é€†å…ƒ</h3><blockquote>
<p>1,2,3â€¦.nçš„é€†å…ƒ<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// p å¿…é¡»ä¸ºè´¨æ•°</span></span><br><span class="line">inv2[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">	inv2[i] = (p - p / i) * inv2[p % i] % p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="çŸ©é˜µå¿«é€Ÿå¹‚"><a href="#çŸ©é˜µå¿«é€Ÿå¹‚" class="headerlink" title="çŸ©é˜µå¿«é€Ÿå¹‚"></a>çŸ©é˜µå¿«é€Ÿå¹‚</h3><p>åŠ é€ŸçŸ©é˜µè®¡ç®—</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;&gt; <span class="built_in">multiply</span>(<span class="type">const</span> vector&lt;vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;&gt; &amp;a,<span class="type">const</span> vector&lt;vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;&gt; &amp;b) &#123;</span><br><span class="line">		<span class="type">int</span> n = a.<span class="built_in">size</span>(), p = a[<span class="number">0</span>].<span class="built_in">size</span>(), m = b[<span class="number">0</span>].<span class="built_in">size</span>();</span><br><span class="line">		<span class="function">vector <span class="title">ans</span><span class="params">(n, vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;(m, <span class="number">0</span>))</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j++) &#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; p; k++) &#123;</span><br><span class="line">					ans[i][j] += a[i][k] * b[k][j];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line">	&#125;</span><br><span class="line">	vector&lt;vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;&gt; <span class="built_in">power</span>(vector&lt;vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;&gt; v, <span class="type">int</span> cnt) &#123;</span><br><span class="line">		<span class="type">int</span> n = v.<span class="built_in">size</span>();</span><br><span class="line">		vector&lt;vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;&gt; <span class="built_in">ans</span>(n, <span class="built_in">vector</span>&lt;<span class="type">long</span> <span class="type">long</span>&gt;(n, <span class="number">0</span>));</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">			ans[i][i] = <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span> (cnt) &#123;</span><br><span class="line">			<span class="keyword">if</span> (cnt &amp; <span class="number">1</span>) &#123;</span><br><span class="line">				ans = <span class="built_in">multiply</span>(ans, v);</span><br><span class="line">			&#125;</span><br><span class="line">			v = <span class="built_in">multiply</span>(v, v);</span><br><span class="line">			cnt &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">tribonacci</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(n == <span class="number">1</span> || n == <span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        vector&lt;vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;&gt; start = &#123;&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line">        vector&lt;vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;&gt; base = &#123;&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">multiply</span>(start, <span class="built_in">power</span>(base, n - <span class="number">2</span>))[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•"><a href="#æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•" class="headerlink" title="æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•"></a>æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</h3><p>å¾—åˆ°æŸä¸€ä¸ªax + by = dçš„å„ç§å‚æ•°ï¼Œdä¸ºæœ€å¤§å…¬çº¦æ•°ï¼Œxå’Œyä¸ºè´ç¥–ç³»æ•°ï¼ˆè£´èœ€å®šç†çš„ç®—æ³•å®ç°ï¼‰</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> x, y, px, py;</span><br><span class="line"><span class="type">int</span> d;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">gcd1</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)&#123;</span><br><span class="line">        x = <span class="number">1</span>;</span><br><span class="line">        y = <span class="number">0</span>;</span><br><span class="line">        d = a;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">gcd1</span>(b, a % b);</span><br><span class="line">        px = x;</span><br><span class="line">        py = y;</span><br><span class="line">        x = py;</span><br><span class="line">        y = px - py * (a / b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>); cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> a, b;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="built_in">gcd1</span>(a, b);</span><br><span class="line">    cout &lt;&lt; (x % b + b) % b &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰"><a href="#ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰" class="headerlink" title="ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰"></a>ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰</h3><p>æ±‚è§£åŒä½™æ–¹ç¨‹ç»„</p>
<script type="math/tex; mode=display">
x \equiv r_i \pmod{m_i}, \quad i = 1,2,\dots,n</script><p>è‹¥æœ‰è§£ï¼Œæ±‚å…¶æœ€å°éè´Ÿæ•´æ•°è§£ xã€‚</p>
<ul>
<li><p><strong>äº’ç´ ç‰ˆï¼ˆCRTï¼‰</strong>ï¼šæ‰€æœ‰æ¨¡æ•° $m_i$ ä¸¤ä¸¤äº’ç´ ã€‚<br>   æ€æƒ³ï¼šæ„é€ æ€»æ¨¡ $M=\prod m_i$â€‹ï¼Œå¯¹æ¯ä¸ªæ–¹ç¨‹æ±‚éƒ¨åˆ†ç§¯ $M_i=M/m_i$â€‹ çš„é€†å…ƒ $inv_i$â€‹ï¼Œç´¯åŠ </p>
<script type="math/tex; mode=display">
  x = \sum r_i M_i inv_i \pmod{M}</script></li>
<li><p><strong>æ‰©å±•ç‰ˆï¼ˆCRT_Eï¼‰</strong>ï¼šæ¨¡æ•°å¯ä¸äº’ç´ ã€‚<br>   æ€æƒ³ï¼šé€æ­¥åˆå¹¶ä¸¤ä¸ªæ–¹ç¨‹ï¼š</p>
<script type="math/tex; mode=display">
  \begin{cases} x \equiv a_1 \pmod{m_1}\\ x \equiv a_2 \pmod{m_2} \end{cases} \Rightarrow \text{è§£ } lcm = \frac{m_1m_2}{\gcd(m_1,m_2)}</script><p>  ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—æ±‚è§£å·®å€¼æ–¹ç¨‹ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰è§£å¹¶æ›´æ–°ã€‚</p>
</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="comment">// æ‰©å±•æ¬§å‡ é‡Œå¾—çš„è§£ï¼šax + by = dï¼Œå…¶ä¸­ d = gcd(a, b)</span></span><br><span class="line"><span class="type">int</span> x, y, d;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">gcd1</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>) &#123;</span><br><span class="line">        d = a;</span><br><span class="line">        x = <span class="number">1</span>;</span><br><span class="line">        y = <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">gcd1</span>(b, a % b);</span><br><span class="line">        <span class="type">int</span> lx = x;</span><br><span class="line">        <span class="type">int</span> ly = y;</span><br><span class="line">        x = ly;</span><br><span class="line">        y = lx - (a / b) * ly;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ…¢ä¹˜æ³•</span></span><br><span class="line"><span class="keyword">auto</span> mul = [](<span class="type">int</span> x, <span class="type">int</span> n, <span class="type">int</span> mod) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    x = (x % mod + mod) % mod;</span><br><span class="line">    n = (n % mod + mod) % mod;</span><br><span class="line">    <span class="keyword">while</span> (n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &amp; <span class="number">1</span>) ans = (ans + x) % mod;</span><br><span class="line">        x = (x + x) % mod;</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * ä¸­å›½å‰©ä½™å®šç†ï¼ˆäº’ç´ ç‰ˆï¼‰</span></span><br><span class="line"><span class="comment"> * è¾“å…¥ï¼š</span></span><br><span class="line"><span class="comment"> *   n, æ¥ç€ n è¡Œï¼Œæ¯è¡Œï¼šm_i  r_i   è¡¨ç¤º x â‰¡ r_i (mod m_i)</span></span><br><span class="line"><span class="comment"> * å‡è®¾ï¼š</span></span><br><span class="line"><span class="comment"> *   æ‰€æœ‰æ¨¡æ•° m_i ä¸¤ä¸¤äº’ç´ </span></span><br><span class="line"><span class="comment"> * åŸç†ï¼š</span></span><br><span class="line"><span class="comment"> *   æ€»æ¨¡ M = âˆ m_i</span></span><br><span class="line"><span class="comment"> *   å¯¹äºç¬¬ i ä¸ªåŒä½™ï¼šä»¤ M_i = M / m_i</span></span><br><span class="line"><span class="comment"> *   æ±‚ M_i åœ¨æ¨¡ m_i ä¸‹çš„ä¹˜æ³•é€†å…ƒ inv_iï¼Œä½¿å¾— M_i * inv_i â‰¡ 1 (mod m_i)</span></span><br><span class="line"><span class="comment"> *   åˆ™è§£ä¸ºï¼šx â‰¡ Î£ (r_i * M_i * inv_i) (mod M)</span></span><br><span class="line"><span class="comment"> * è¿”å›ï¼š</span></span><br><span class="line"><span class="comment"> *   æœ€å°éè´Ÿè§£ x âˆˆ [0, M)</span></span><br><span class="line"><span class="comment"> * æ³¨æ„ï¼š</span></span><br><span class="line"><span class="comment"> *   ä»£ç é‡Œç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—æ±‚ inv_iï¼Œå¹¶ç”¨ mul é¿å…æº¢å‡ºã€‚</span></span><br><span class="line"><span class="comment"> *   lcm0 = âˆ m_i è‹¥è¿‡å¤§å¯èƒ½æº¢å‡º 64 ä½ï¼Œæœ¬å®ç°ä¸åšé¢å¤–é˜²æŠ¤ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">CRT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="type">int</span> lcm0 = <span class="number">1</span>; <span class="comment">// å®é™…ä¸Šæ˜¯æ‰€æœ‰ m_i çš„ä¹˜ç§¯ï¼ˆäº’ç´ åœºæ™¯ä¸‹ç­‰äº LCMï¼‰</span></span><br><span class="line">    vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt; <span class="built_in">v1</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; [modi, ri] : v1) &#123;</span><br><span class="line">        cin &gt;&gt; modi &gt;&gt; ri;</span><br><span class="line">        lcm0 *= modi; <span class="comment">// å¯èƒ½æº¢å‡º</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>; <span class="comment">// ç´¯åŠ å¼æ„é€ çš„è§£ï¼ˆæœ€ç»ˆå¯¹ lcm0 å–æ¨¡ï¼‰</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++) &#123;</span><br><span class="line">        <span class="type">int</span> Mi = lcm0 / v1[i].fr; <span class="comment">// M_i</span></span><br><span class="line">        <span class="built_in">gcd1</span>(Mi, v1[i].fr);       <span class="comment">// æ±‚ gcd åŠç³»æ•° x,yï¼Œå…¶ä¸­ x æ˜¯ Mi å…³äºæ¨¡ m_i çš„â€œé€†å…ƒâ€åŸå‹</span></span><br><span class="line">        <span class="comment">// å°† x è§„çº¦åˆ° [0, m_i) ä½œä¸ºé€†å…ƒ inv_i</span></span><br><span class="line">        x = ((x % v1[i].fr) + v1[i].fr) % v1[i].fr;</span><br><span class="line">        <span class="comment">// ans += r_i * M_i * inv_i ï¼ˆå…¨è¿‡ç¨‹éƒ½åœ¨ mod M ä¸‹åšï¼‰</span></span><br><span class="line">        ans = (ans + <span class="built_in">mul</span>(<span class="built_in">mul</span>(v1[i].sc, Mi, lcm0), x, lcm0)) % lcm0;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans; <span class="comment">// æœ€å°éè´Ÿè§£</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * ä¸­å›½å‰©ä½™å®šç†ï¼ˆæ‰©å±•ç‰ˆ / éäº’ç´ ä¹Ÿå¯ï¼‰</span></span><br><span class="line"><span class="comment"> * è¾“å…¥ï¼š</span></span><br><span class="line"><span class="comment"> *   n, æ¥ç€ n è¡Œï¼Œæ¯è¡Œï¼šm_i  r_i   è¡¨ç¤º x â‰¡ r_i (mod m_i)</span></span><br><span class="line"><span class="comment"> * èƒ½åŠ›ï¼š</span></span><br><span class="line"><span class="comment"> *   æ”¯æŒæ¨¡æ•° m_i ä¹‹é—´ä¸äº’ç´ çš„æƒ…å†µï¼›</span></span><br><span class="line"><span class="comment"> *   è‹¥ç³»ç»Ÿæ— è§£ï¼Œè¿”å› -1ã€‚</span></span><br><span class="line"><span class="comment"> * æ€è·¯ï¼ˆå¢é‡åˆå¹¶ï¼‰ï¼š</span></span><br><span class="line"><span class="comment"> *   å·²æœ‰æ–¹ç¨‹ç»„åˆå¹¶ä¸º x â‰¡ tail (mod lcm)</span></span><br><span class="line"><span class="comment"> *   åŠ å…¥æ–°æ–¹ç¨‹ x â‰¡ r (mod m)ï¼š</span></span><br><span class="line"><span class="comment"> *     ä»¤ c = r - tail</span></span><br><span class="line"><span class="comment"> *     è§£ lcm * t â‰¡ c (mod m)</span></span><br><span class="line"><span class="comment"> *     è®¾ d = gcd(lcm, m)ï¼Œè‹¥ c % d != 0 åˆ™æ— è§£</span></span><br><span class="line"><span class="comment"> *     åŒ–ç®€ï¼š (lcm/d) * t â‰¡ c/d (mod m/d)</span></span><br><span class="line"><span class="comment"> *     ç”±æ‰©å±•æ¬§å‡ é‡Œå¾—æ±‚ (lcm/d) å…³äºæ¨¡ (m/d) çš„é€†å…ƒ inv = xï¼ˆgcd1 å¡«çš„å…¨å±€ xï¼‰</span></span><br><span class="line"><span class="comment"> *     å¾— t â‰¡ inv * (c/d) (mod m/d)</span></span><br><span class="line"><span class="comment"> *     ç”¨ tail + lcm * t æ›´æ–° tailï¼Œå¹¶æŠŠæ¨¡æ•°å¹¶æˆ lcm = lcm * (m/d)</span></span><br><span class="line"><span class="comment"> * è¿”å›ï¼š</span></span><br><span class="line"><span class="comment"> *   åˆå¹¶åæœ€å°éè´Ÿè§£ âˆˆ [0, lcm)ï¼Œæˆ– -1 è¡¨ç¤ºæ— è§£</span></span><br><span class="line"><span class="comment"> * å¤æ‚åº¦ï¼š</span></span><br><span class="line"><span class="comment"> *   O(n log V)ï¼ŒV ä¸ºæ•°å€¼ä¸Šç•Œ</span></span><br><span class="line"><span class="comment"> * å¤‡æ³¨ï¼š</span></span><br><span class="line"><span class="comment"> *   ä¸ºé¿å…ä¹˜æ³•æº¢å‡ºï¼Œä½¿ç”¨ mul å®ç°â€œlcm * t (mod temp)â€ç­‰è¿ç®—ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">CRT_E</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt; <span class="built_in">v1</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; [modi, ri] : v1) cin &gt;&gt; modi &gt;&gt; ri;</span><br><span class="line">    <span class="type">int</span> lcm = <span class="number">1</span>;   <span class="comment">// å½“å‰åˆå¹¶åçš„æ¨¡ï¼ˆä¸ä¸€å®šæ˜¯ä¸¥æ ¼ LCMï¼Œé€æ­¥æ‰©å¤§ï¼‰</span></span><br><span class="line">    <span class="type">int</span> tail = <span class="number">0</span>;  <span class="comment">// å½“å‰åˆå¹¶åçš„è§£ï¼ˆæœ€å°éè´Ÿï¼‰</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++) &#123;</span><br><span class="line">        <span class="type">int</span> m = v1[i].fr;  <span class="comment">// æ–°æ¨¡</span></span><br><span class="line">        <span class="type">int</span> r = v1[i].sc;  <span class="comment">// æ–°ä½™æ•°</span></span><br><span class="line">        <span class="built_in">gcd1</span>(lcm, m);      <span class="comment">// å¾—åˆ° d=gcd(lcm,m) ä»¥åŠä¸€ç»„ (x,y) ä½¿ lcm*x + m*y = d</span></span><br><span class="line">        <span class="type">int</span> c = ((r - tail) % m + m) % m; <span class="comment">// ç›®æ ‡å·® cï¼ˆåŒ–åˆ° [0,m)ï¼‰ï¼Œè¦è§£ï¼šlcm*t â‰¡ c (mod m)</span></span><br><span class="line">        <span class="keyword">if</span> (c % d != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// æ— è§£ï¼šc ä¸æ˜¯ d çš„å€æ•°</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// åŒ–ç®€åŒä½™ï¼š(lcm/d)*t â‰¡ (c/d) (mod m/d)</span></span><br><span class="line">        <span class="comment">// ç”± gcd1 å¾—åˆ°çš„ x æ˜¯ lcm å…³äº m çš„â€œè´ç¥–ç³»æ•°â€ï¼Œ</span></span><br><span class="line">        <span class="comment">// å°†å…¶åœ¨æ¨¡ (m/d) ä¸‹ä½œä¸º (lcm/d) çš„é€†å…ƒä½¿ç”¨ï¼ˆéœ€è¦å–æ¨¡è§„çº¦ï¼‰ã€‚</span></span><br><span class="line">        x = <span class="built_in">mul</span>(x, c / d, m / d);                <span class="comment">// t â‰¡ x * (c/d) (mod m/d)</span></span><br><span class="line">        x = (x % (m / d) + (m / d)) % (m / d);   <span class="comment">// è§„çº¦åˆ° [0, m/d)</span></span><br><span class="line">        <span class="type">int</span> temp = lcm * (m / d);                <span class="comment">// æ–°æ¨¡ï¼ˆç­‰ä»·äº lcm ä¸ m çš„æœ€å°å…¬å€æ•°ï¼‰</span></span><br><span class="line">        <span class="comment">// æ›´æ–° tailï¼š x_new = tail + lcm * t ï¼ˆåœ¨æ¨¡ temp ä¸‹ï¼‰</span></span><br><span class="line">        tail = (tail + <span class="built_in">mul</span>(lcm, x, temp)) % temp;</span><br><span class="line">        lcm = temp; <span class="comment">// æ‰©å¤§æ¨¡</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> tail;    <span class="comment">// è¿”å›æœ€ç»ˆæœ€å°éè´Ÿè§£</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t --) &#123;</span><br><span class="line">        <span class="comment">// æ¼”ç¤ºï¼šè°ƒç”¨æ‰©å±• CRTï¼ˆéäº’ç´ ä¹Ÿå¯ï¼‰ã€‚å¦‚éœ€äº’ç´ ç‰ˆè¯·æ”¹ä¸º CRT()</span></span><br><span class="line">        <span class="comment">// è¾“å…¥æ ¼å¼ç¤ºä¾‹ï¼š</span></span><br><span class="line">        <span class="comment">//   n</span></span><br><span class="line">        <span class="comment">//   m1 r1</span></span><br><span class="line">        <span class="comment">//   m2 r2</span></span><br><span class="line">        <span class="comment">//   ...</span></span><br><span class="line">        <span class="comment">// è¾“å‡ºï¼š</span></span><br><span class="line">        <span class="comment">//   æœ€å°éè´Ÿè§£ï¼›è‹¥æ— è§£è¾“å‡º -1</span></span><br><span class="line">        <span class="comment">// cout &lt;&lt; CRT() &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">        cout &lt;&lt; <span class="built_in">CRT_E</span>() &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="GCD"><a href="#GCD" class="headerlink" title="GCD"></a>GCD</h3><p>ä¸€ä¸ªæ•°ç»„çš„GCDå‰ç¼€ä¸åŒç§ç±»æ˜¯logçº§åˆ«çš„ï¼Œå¯é€šè¿‡æ­¤é¢˜è¿›è¡Œè¿›ä¸€æ­¥äº†è§£å’Œä½“ä¼š<a href="https://codeforces.com/gym/105386/problem/E">2024ICPCKunming</a>.</p>
<p>å¯¹ä»»æ„a &gt;= b, æœ‰gcd(a, b) = gcd(a - b, b);</p>
<h4 id="GCD-æœ¬è´¨"><a href="#GCD-æœ¬è´¨" class="headerlink" title="GCD æœ¬è´¨"></a>GCD æœ¬è´¨</h4><p>æ±‚$gcd(a^b, c^d)$.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://ac.nowcoder.com/acm/contest/108304/J</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>)-&gt;ios_base::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	cin &gt;&gt; t;</span><br><span class="line">	<span class="keyword">while</span>(t --) &#123; </span><br><span class="line">		<span class="type">int</span> a, b, c, d;</span><br><span class="line">		cin &gt;&gt; a &gt;&gt; b &gt;&gt; c &gt;&gt; d;</span><br><span class="line">		<span class="keyword">auto</span> power = [&amp;](<span class="type">int</span> x, <span class="type">int</span> n) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">			x %= mod;</span><br><span class="line">			<span class="keyword">while</span>(n) &#123;</span><br><span class="line">				<span class="keyword">if</span>(n &amp; <span class="number">1</span>) ans = ans * x % mod;</span><br><span class="line">				x = x * x % mod;</span><br><span class="line">				n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> ans;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span>(b &gt; d) <span class="built_in">swap</span>(a, c), <span class="built_in">swap</span>(b, d);</span><br><span class="line">			<span class="type">int</span> temp = <span class="built_in">gcd</span>(a, c);</span><br><span class="line">			ans = ans * <span class="built_in">power</span>(temp, b) % mod;</span><br><span class="line">			a = a / temp;</span><br><span class="line"><span class="comment">//             c = temp;</span></span><br><span class="line">			d -= b;</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">gcd</span>(a, c) == <span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Stein-GCDç®—æ³•"><a href="#Stein-GCDç®—æ³•" class="headerlink" title="Stein GCDç®—æ³•"></a>Stein GCDç®—æ³•</h4><p>Steinç®—æ³•æ˜¯ä¸€ç§è®¡ç®—ä¸¤ä¸ªéè´Ÿæ•´æ•°çš„æœ€å¤§å…¬çº¦æ•°çš„ç®—æ³•ã€‚å®ƒæ¯”ä¼ ç»Ÿçš„æ¬§å‡ é‡Œå¾—ç®—æ³•åœ¨æŸäº›æƒ…å†µä¸‹æ›´é«˜æ•ˆï¼Œ<br>å› ä¸ºå®ƒé¿å…äº†ä½¿ç”¨é™¤æ³•æ“ä½œã€‚è¯¥ç®—æ³•åˆ©ç”¨äº†ä»¥ä¸‹å‡ æ¡è§„åˆ™ï¼š<br>GCD(0, b) = bï¼šå¦‚æœä¸€ä¸ªæ•°æ˜¯0ï¼Œå¦ä¸€ä¸ªæ•°å°±æ˜¯æœ€å¤§å…¬çº¦æ•°ã€‚<br>GCD(a, 0) = aï¼šåŒä¸Šï¼Œå¦‚æœä¸€ä¸ªæ•°æ˜¯0ï¼Œå¦ä¸€ä¸ªæ•°å°±æ˜¯æœ€å¤§å…¬çº¦æ•°ã€‚<br>å¦‚æœaå’Œbéƒ½æ˜¯å¶æ•°ï¼Œé‚£ä¹ˆGCD(a, b) = 2 * GCD(a/2, b/2)ã€‚<br>å¦‚æœaæ˜¯å¶æ•°ä¸”bæ˜¯å¥‡æ•°ï¼Œé‚£ä¹ˆGCD(a, b) = GCD(a/2, b)ã€‚<br>å¦‚æœaæ˜¯å¥‡æ•°ä¸”bæ˜¯å¶æ•°ï¼Œé‚£ä¹ˆGCD(a, b) = GCD(a, b/2)ã€‚<br>å¦‚æœaå’Œbéƒ½æ˜¯å¥‡æ•°ï¼Œå¹¶ä¸”a &gt;= bï¼Œé‚£ä¹ˆGCD(a, b) = GCD((a - b)/2, b)ã€‚<br>å¦‚æœaå’Œbéƒ½æ˜¯å¥‡æ•°ï¼Œå¹¶ä¸”a &lt; bï¼Œé‚£ä¹ˆGCD(a, b) = GCD((b - a)/2, a)ã€‚<br>é€šè¿‡ä¸æ–­åº”ç”¨è¿™äº›è§„åˆ™ï¼Œæœ€ç»ˆå¯ä»¥å°†ä¸¤ä¸ªæ•°å˜ä¸º0ï¼Œä»è€Œæ‰¾åˆ°å®ƒä»¬çš„æœ€å¤§å…¬çº¦æ•°ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span> <span class="title">steinGCD</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a, <span class="type">unsigned</span> <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a == <span class="number">0</span>) <span class="keyword">return</span> b;</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>) <span class="keyword">return</span> a;</span><br><span class="line">    <span class="comment">// æ‰¾åˆ°aå’Œbçš„å…±åŒå› å­2çš„æ•°é‡</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> shift = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (((a | b) &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        a &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        shift++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä½¿aæˆä¸ºå¥‡æ•°</span></span><br><span class="line">    <span class="keyword">while</span> ((a &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        a &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="comment">// ä½¿bæˆä¸ºå¥‡æ•°</span></span><br><span class="line">        <span class="keyword">while</span> ((b &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä¿è¯a &lt;= b</span></span><br><span class="line">        <span class="keyword">if</span> (a &gt; b) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(a, b);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// b - aæ˜¯å¶æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç»§ç»­å³ç§»</span></span><br><span class="line">        b = (b - a);</span><br><span class="line">    &#125; <span class="keyword">while</span> (b != <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// æ¢å¤å…±åŒå› å­2çš„æ•°é‡</span></span><br><span class="line">    <span class="keyword">return</span> a &lt;&lt; shift;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Least-Recently-Used-LRU-ç®—æ³•"><a href="#Least-Recently-Used-LRU-ç®—æ³•" class="headerlink" title="Least Recently Used (LRU)ç®—æ³•"></a>Least Recently Used (LRU)ç®—æ³•</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 1010</span></span><br><span class="line"><span class="comment">// Least Recently Used (LRU) ç¼“å­˜å®ç°</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LRU</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// å®šä¹‰åŒå‘é“¾è¡¨èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">DoubleNode</span> &#123;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="type">int</span> key;    <span class="comment">// èŠ‚ç‚¹å¯¹åº”çš„ key</span></span><br><span class="line">        <span class="type">int</span> val;    <span class="comment">// èŠ‚ç‚¹å¯¹åº”çš„ value</span></span><br><span class="line">        DoubleNode* next; <span class="comment">// åç»§èŠ‚ç‚¹æŒ‡é’ˆ</span></span><br><span class="line">        DoubleNode* last; <span class="comment">// å‰é©±èŠ‚ç‚¹æŒ‡é’ˆ</span></span><br><span class="line">        <span class="built_in">DoubleNode</span>(<span class="type">int</span> k, <span class="type">int</span> v): <span class="built_in">key</span>(k), <span class="built_in">val</span>(v), <span class="built_in">last</span>(<span class="literal">nullptr</span>), <span class="built_in">next</span>(<span class="literal">nullptr</span>) &#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// å®šä¹‰åŒå‘é“¾è¡¨ï¼Œç”¨äºç»´æŠ¤è®¿é—®é¡ºåº</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">DoubleList</span> &#123;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        DoubleNode* head; <span class="comment">// é“¾è¡¨å¤´éƒ¨ï¼ˆæœ€ä¹…æœªä½¿ç”¨ï¼‰</span></span><br><span class="line">        DoubleNode* tail; <span class="comment">// é“¾è¡¨å°¾éƒ¨ï¼ˆæœ€è¿‘ä½¿ç”¨ï¼‰</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="built_in">DoubleList</span>(): <span class="built_in">head</span>(<span class="literal">nullptr</span>), <span class="built_in">tail</span>(<span class="literal">nullptr</span>) &#123;&#125;</span><br><span class="line">        <span class="comment">// åœ¨é“¾è¡¨å°¾éƒ¨æ·»åŠ æ–°èŠ‚ç‚¹ï¼ˆæœ€æ–°ä½¿ç”¨çš„èŠ‚ç‚¹ï¼‰</span></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">addNode</span><span class="params">(DoubleNode* newNode)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!newNode) <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">if</span> (!head) &#123;</span><br><span class="line">                head = tail = newNode;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                tail-&gt;next = newNode;</span><br><span class="line">                newNode-&gt;last = tail;</span><br><span class="line">                tail = newNode;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å°†å·²æœ‰èŠ‚ç‚¹ç§»åŠ¨åˆ°é“¾è¡¨å°¾éƒ¨ï¼ˆè¡¨ç¤ºæœ€è¿‘ä½¿ç”¨ï¼‰</span></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">moveNodeToTail</span><span class="params">(DoubleNode* node)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (tail == node) <span class="keyword">return</span>;  <span class="comment">// èŠ‚ç‚¹å·²åœ¨å°¾éƒ¨ï¼Œæ— éœ€ç§»åŠ¨</span></span><br><span class="line">            <span class="keyword">if</span> (head == node) &#123;        <span class="comment">// èŠ‚ç‚¹ä½äºå¤´éƒ¨</span></span><br><span class="line">                head = node-&gt;next;</span><br><span class="line">                <span class="keyword">if</span> (head) head-&gt;last = <span class="literal">nullptr</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;                   <span class="comment">// èŠ‚ç‚¹åœ¨ä¸­é—´</span></span><br><span class="line">                node-&gt;last-&gt;next = node-&gt;next;</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;next)</span><br><span class="line">                    node-&gt;next-&gt;last = node-&gt;last;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// å°†èŠ‚ç‚¹ç§»åŠ¨åˆ°å°¾éƒ¨</span></span><br><span class="line">            node-&gt;last = tail;</span><br><span class="line">            node-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">            <span class="keyword">if</span> (tail) tail-&gt;next = node;</span><br><span class="line">            tail = node;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç§»é™¤é“¾è¡¨å¤´éƒ¨èŠ‚ç‚¹ï¼ˆæœ€ä¹…æœªä½¿ç”¨çš„èŠ‚ç‚¹ï¼‰å¹¶è¿”å›è¯¥èŠ‚ç‚¹</span></span><br><span class="line">        <span class="function">DoubleNode* <span class="title">removeHead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!head) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">            DoubleNode* ans = head;</span><br><span class="line">            <span class="keyword">if</span> (head == tail) &#123;</span><br><span class="line">                head = tail = <span class="literal">nullptr</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                head = head-&gt;next;</span><br><span class="line">                <span class="keyword">if</span> (head) head-&gt;last = <span class="literal">nullptr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="comment">// è¾…åŠ©å‡½æ•°ï¼šæ¸…ç©ºé“¾è¡¨ï¼Œé‡Šæ”¾æ‰€æœ‰èŠ‚ç‚¹</span></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            DoubleNode* cur = head;</span><br><span class="line">            <span class="keyword">while</span>(cur) &#123;</span><br><span class="line">                DoubleNode* next = cur-&gt;next;</span><br><span class="line">                <span class="keyword">delete</span> cur;</span><br><span class="line">                cur = next;</span><br><span class="line">            &#125;</span><br><span class="line">            head = tail = <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;    </span><br><span class="line">        <span class="comment">// æä¾›é“¾è¡¨å¤´éƒ¨è®¿é—®ï¼Œç”¨äºææ„æ—¶éå†</span></span><br><span class="line">        <span class="function">DoubleNode* <span class="title">getHead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    unordered_map&lt;<span class="type">int</span>, DoubleNode*&gt; keyNodeMap; <span class="comment">// å¿«é€Ÿå®šä½ key å¯¹åº”çš„èŠ‚ç‚¹</span></span><br><span class="line">    DoubleList nodeList;                        <span class="comment">// ç»´æŠ¤èŠ‚ç‚¹é¡ºåºçš„åŒå‘é“¾è¡¨</span></span><br><span class="line">    <span class="type">int</span> cap;                                    <span class="comment">// ç¼“å­˜å®¹é‡</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">LRU</span>(<span class="type">int</span> c): <span class="built_in">cap</span>(c) &#123;&#125;</span><br><span class="line">    <span class="comment">// ææ„å‡½æ•°ï¼Œé‡Šæ”¾æ‰€æœ‰ç”³è¯·çš„å†…å­˜</span></span><br><span class="line">    ~<span class="built_in">LRU</span>() &#123;</span><br><span class="line">        <span class="comment">// éå†åŒå‘é“¾è¡¨é‡Šæ”¾èŠ‚ç‚¹</span></span><br><span class="line">        DoubleNode* cur = nodeList.<span class="built_in">getHead</span>();</span><br><span class="line">        <span class="keyword">while</span>(cur) &#123;</span><br><span class="line">            DoubleNode* next = cur-&gt;next;</span><br><span class="line">            <span class="keyword">delete</span> cur;</span><br><span class="line">            cur = next;</span><br><span class="line">        &#125;</span><br><span class="line">        keyNodeMap.<span class="built_in">clear</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @brief è·å– key å¯¹åº”çš„å€¼ï¼Œå¹¶å°†è¯¥èŠ‚ç‚¹ç§»åˆ°å°¾éƒ¨è¡¨ç¤ºæœ€è¿‘ä½¿ç”¨</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * @param key ç¼“å­˜ä¸­çš„é”®</span></span><br><span class="line"><span class="comment">     * @return int è‹¥ key å­˜åœ¨åˆ™è¿”å›å¯¹åº”å€¼ï¼Œå¦åˆ™è¿”å› -1</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (keyNodeMap.<span class="built_in">count</span>(key)) &#123;</span><br><span class="line">            DoubleNode* ans = keyNodeMap[key];</span><br><span class="line">            nodeList.<span class="built_in">moveNodeToTail</span>(ans);  <span class="comment">// æ›´æ–°æœ€è¿‘ä½¿ç”¨</span></span><br><span class="line">            <span class="keyword">return</span> ans-&gt;val;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @brief å‘ç¼“å­˜ä¸­æ’å…¥æˆ–æ›´æ–°ä¸€ä¸ª key-value å¯¹</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * è‹¥ key å­˜åœ¨ï¼Œåˆ™æ›´æ–°å…¶å€¼å¹¶å°†èŠ‚ç‚¹ç§»åˆ°å°¾éƒ¨ï¼›</span></span><br><span class="line"><span class="comment">     * è‹¥ key ä¸å­˜åœ¨ï¼Œåˆ™æ’å…¥æ–°èŠ‚ç‚¹ï¼Œè‹¥ç¼“å­˜å·²æ»¡ï¼Œåˆ™ç§»é™¤æœ€ä¹…æœªä½¿ç”¨çš„èŠ‚ç‚¹ã€‚</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * @param key ç¼“å­˜ä¸­çš„é”®</span></span><br><span class="line"><span class="comment">     * @param val1 ç¼“å­˜ä¸­çš„å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">put</span><span class="params">(<span class="type">int</span> key, <span class="type">int</span> val1)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (keyNodeMap.<span class="built_in">count</span>(key)) &#123;</span><br><span class="line">            <span class="comment">// key å­˜åœ¨ï¼Œæ›´æ–°å€¼å¹¶ç§»åˆ°å°¾éƒ¨</span></span><br><span class="line">            DoubleNode* node = keyNodeMap[key];</span><br><span class="line">            node-&gt;val = val1;</span><br><span class="line">            nodeList.<span class="built_in">moveNodeToTail</span>(node);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœç¼“å­˜å·²æ»¡ï¼Œåˆ é™¤æœ€ä¹…æœªä½¿ç”¨çš„èŠ‚ç‚¹</span></span><br><span class="line">            <span class="keyword">if</span> (keyNodeMap.<span class="built_in">size</span>() == cap) &#123;</span><br><span class="line">                DoubleNode* removed = nodeList.<span class="built_in">removeHead</span>();</span><br><span class="line">                <span class="keyword">if</span>(removed) &#123;</span><br><span class="line">                    keyNodeMap.<span class="built_in">erase</span>(removed-&gt;key);</span><br><span class="line">                    <span class="keyword">delete</span> removed;  <span class="comment">// é‡Šæ”¾å†…å­˜</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æ’å…¥æ–°èŠ‚ç‚¹</span></span><br><span class="line">            DoubleNode* newNode = <span class="keyword">new</span> <span class="built_in">DoubleNode</span>(key, val1);</span><br><span class="line">            keyNodeMap[key] = newNode;</span><br><span class="line">            nodeList.<span class="built_in">addNode</span>(newNode);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">// æµ‹è¯•ç”¨ä¾‹ï¼šåˆ›å»ºå®¹é‡ä¸º3çš„LRUç¼“å­˜</span></span><br><span class="line">    <span class="function">LRU <span class="title">cache</span><span class="params">(<span class="number">3</span>)</span></span>;</span><br><span class="line">    <span class="comment">// æ’å…¥æ•°æ®</span></span><br><span class="line">    cache.<span class="built_in">put</span>(<span class="number">1</span>, <span class="number">100</span>);</span><br><span class="line">    cache.<span class="built_in">put</span>(<span class="number">2</span>, <span class="number">200</span>);</span><br><span class="line">    cache.<span class="built_in">put</span>(<span class="number">3</span>, <span class="number">300</span>);</span><br><span class="line">    <span class="comment">// è®¿é—® key 1ï¼Œå°†å…¶æ›´æ–°ä¸ºæœ€è¿‘ä½¿ç”¨</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;get(1): &quot;</span> &lt;&lt; cache.<span class="built_in">get</span>(<span class="number">1</span>) &lt;&lt; <span class="string">&quot;\n&quot;</span>; <span class="comment">// è¾“å‡º 100</span></span><br><span class="line">    <span class="comment">// æ’å…¥æ–°æ•°æ®ï¼Œå½“ç¼“å­˜æ»¡æ—¶ä¼šæ·˜æ±°æœ€ä¹…æœªä½¿ç”¨çš„ keyï¼ˆæ­¤æ—¶ key 2 è¢«æ·˜æ±°ï¼‰</span></span><br><span class="line">    cache.<span class="built_in">put</span>(<span class="number">4</span>, <span class="number">400</span>);</span><br><span class="line">    <span class="comment">// å°è¯•è·å–è¢«æ·˜æ±°çš„ key 2</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;get(2): &quot;</span> &lt;&lt; cache.<span class="built_in">get</span>(<span class="number">2</span>) &lt;&lt; <span class="string">&quot;\n&quot;</span>; <span class="comment">// è¾“å‡º -1ï¼Œè¡¨ç¤ºä¸å­˜åœ¨</span></span><br><span class="line">    <span class="comment">// ç»§ç»­è·å–å…¶ä»– key çš„å€¼</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;get(3): &quot;</span> &lt;&lt; cache.<span class="built_in">get</span>(<span class="number">3</span>) &lt;&lt; <span class="string">&quot;\n&quot;</span>; <span class="comment">// è¾“å‡º 300</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;get(4): &quot;</span> &lt;&lt; cache.<span class="built_in">get</span>(<span class="number">4</span>) &lt;&lt; <span class="string">&quot;\n&quot;</span>; <span class="comment">// è¾“å‡º 400</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="äºŒè¿›åˆ¶ä½"><a href="#äºŒè¿›åˆ¶ä½" class="headerlink" title="äºŒè¿›åˆ¶ä½"></a>äºŒè¿›åˆ¶ä½</h3><h4 id="ä½å›¾"><a href="#ä½å›¾" class="headerlink" title="ä½å›¾"></a>ä½å›¾</h4><p>åˆ¤æ–­æŸä¸€ä¸ªæ•°æ˜¯å¦å­˜åœ¨</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> arr[],<span class="type">int</span> num)</span></span>&#123;</span><br><span class="line">	arr[num/<span class="number">32</span>] |= <span class="number">1</span>&lt;&lt;(num%<span class="number">32</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">remove</span><span class="params">(<span class="type">int</span> arr[],<span class="type">int</span> num)</span></span>&#123;</span><br><span class="line">	arr[num/<span class="number">32</span>] &amp;= ~(<span class="number">1</span>&lt;&lt;(num%<span class="number">32</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverse</span><span class="params">(<span class="type">int</span> arr[],<span class="type">int</span> num)</span></span>&#123;</span><br><span class="line">	arr[num/<span class="number">32</span>] ^= <span class="number">1</span>&lt;&lt;(num%<span class="number">32</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">contains</span><span class="params">(<span class="type">int</span> arr[],<span class="type">int</span> num)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> arr[num/<span class="number">32</span>] &amp; (<span class="number">1</span>&lt;&lt;(num%<span class="number">32</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	<span class="type">int</span> set[(n + <span class="number">32</span> - <span class="number">1</span>) / <span class="number">32</span>]; <span class="comment">// è¡¨ç¤ºå­˜å‚¨nä¸ªæ•°éœ€è¦çš„å¤§å°</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ä½è¿ç®—å®ç°å››åˆ™è¿ç®—"><a href="#ä½è¿ç®—å®ç°å››åˆ™è¿ç®—" class="headerlink" title="ä½è¿ç®—å®ç°å››åˆ™è¿ç®—"></a>ä½è¿ç®—å®ç°å››åˆ™è¿ç®—</h4><p>åŠ é€Ÿè¿ç®—</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = n;</span><br><span class="line">    <span class="keyword">while</span>(m != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// æ— è¿›ä½ç›¸åŠ </span></span><br><span class="line">        ans = n ^ m;</span><br><span class="line">        <span class="comment">// è®¡ç®—è¿›ä½ï¼Œæ³¨æ„è¿›ä½è¦å·¦ç§»ä¸€ä½</span></span><br><span class="line">        m = (n &amp; m) &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        n = ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">neg</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¯¹ n å–åååŠ  1 å¾—åˆ° -n</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">add</span>(~n, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">minus1</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">add</span>(n, <span class="built_in">neg</span>(m));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(m != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>((m &amp; <span class="number">1</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">            ans = <span class="built_in">add</span>(ans, n);</span><br><span class="line">        &#125;</span><br><span class="line">        n &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        m &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">div1</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è½¬ä¸ºæ­£æ•°å¤„ç†ï¼Œä¿å­˜ç¬¦å·ä¿¡æ¯</span></span><br><span class="line">    <span class="type">int</span> a = n &lt; <span class="number">0</span> ? <span class="built_in">neg</span>(n) : n;</span><br><span class="line">    <span class="type">int</span> b = m &lt; <span class="number">0</span> ? <span class="built_in">neg</span>(m) : m;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// ä»æœ€é«˜ä½å¼€å§‹éå†</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">30</span>; i &gt;= <span class="number">0</span>; i = <span class="built_in">minus1</span>(i, <span class="number">1</span>)) &#123;</span><br><span class="line">        <span class="comment">// åˆ¤æ–­ a å³ç§» i ä½åæ˜¯å¦å¤§äºç­‰äº b</span></span><br><span class="line">        <span class="keyword">if</span>((a &gt;&gt; i) &gt;= b) &#123;</span><br><span class="line">            <span class="comment">// å‡å» b å·¦ç§» i ä½</span></span><br><span class="line">            a = <span class="built_in">minus1</span>(a, (b &lt;&lt; i));</span><br><span class="line">            <span class="comment">// å°†ç»“æœå¯¹åº”ä½è®¾ä¸º1</span></span><br><span class="line">            ans |= (<span class="number">1</span> &lt;&lt; i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¦‚æœ n ä¸ m ç¬¦å·ä¸åŒï¼Œåˆ™ç»“æœå–è´Ÿ</span></span><br><span class="line">    <span class="keyword">return</span> (n &lt; <span class="number">0</span>) ^ (m &lt; <span class="number">0</span>) ? <span class="built_in">neg</span>(ans) : ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å®Œæ•´ç‰ˆ</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">div2</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a == INT_MIN &amp;&amp; b == INT_MIN) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(a != INT_MIN &amp;&amp; b != INT_MIN) <span class="keyword">return</span> <span class="built_in">div1</span>(a, b);</span><br><span class="line">    <span class="keyword">if</span>(b == INT_MIN) <span class="keyword">return</span> <span class="number">0</span>;  <span class="comment">// é™¤æ•°ä¸º INT_MINï¼Œå…¶å®ƒæ•°é™¤ä»¥å®ƒçš„å•†ä¸º0</span></span><br><span class="line">    <span class="keyword">if</span>(b == <span class="built_in">neg</span>(<span class="number">1</span>)) <span class="keyword">return</span> INT_MAX;  <span class="comment">// é˜²æ­¢ INT_MIN / -1 æº¢å‡º</span></span><br><span class="line">    <span class="comment">// è¿‘ä¼¼å¤„ç†ï¼šè°ƒæ•´ a çš„å€¼</span></span><br><span class="line">    a = <span class="built_in">add</span>(a, b &gt; <span class="number">0</span> ? b : <span class="built_in">neg</span>(b));</span><br><span class="line">    <span class="type">int</span> ans = <span class="built_in">div1</span>(a, b);</span><br><span class="line">    <span class="comment">// æ ¹æ®é™¤æ•°çš„æ­£è´Ÿå†³å®šåç§»</span></span><br><span class="line">    <span class="type">int</span> offset = b &gt; <span class="number">0</span> ? <span class="built_in">neg</span>(<span class="number">1</span>) : <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">add</span>(ans, offset);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ä½è¿ç®—éªšæ“ä½œ"><a href="#ä½è¿ç®—éªšæ“ä½œ" class="headerlink" title="ä½è¿ç®—éªšæ“ä½œ"></a>ä½è¿ç®—éªšæ“ä½œ</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">//åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯2çš„å¹‚</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">jurge1</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> n&gt;<span class="number">0</span> &amp;&amp; n == (n&amp;(-n));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯3çš„å¹‚</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 1162261467</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">jurge2</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> n&gt;<span class="number">0</span> &amp;&amp; M%n==<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ±‚å¤§äºç­‰äºnçš„æœ€å°2æ¬¡å¹‚</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F1</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n&lt;=<span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	n--;</span><br><span class="line">	n |= n&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	n |= n&gt;&gt;<span class="number">2</span>;</span><br><span class="line">	n |= n&gt;&gt;<span class="number">4</span>;</span><br><span class="line">	n |= n&gt;&gt;<span class="number">8</span>;</span><br><span class="line">	n |= n&gt;&gt;<span class="number">16</span>;;</span><br><span class="line">	<span class="keyword">return</span> n+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//é€†åºäºŒè¿›åˆ¶çŠ¶æ€</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F2</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	n= ((n&amp;<span class="number">0xaaaaaaaa</span>)&gt;&gt;<span class="number">1</span>) | ((n&amp;<span class="number">0x55555555</span>)&lt;&lt;<span class="number">1</span>);</span><br><span class="line">	n= ((n&amp;<span class="number">0xcccccccc</span>)&gt;&gt;<span class="number">2</span>) | ((n&amp;<span class="number">0x33333333</span>)&lt;&lt;<span class="number">2</span>);</span><br><span class="line">	n= ((n&amp;<span class="number">0xf0f0f0f0</span>)&gt;&gt;<span class="number">4</span>) | ((n&amp;<span class="number">0x0f0f0f0f</span>)&lt;&lt;<span class="number">4</span>);</span><br><span class="line">	n= ((n&amp;<span class="number">0xff00ff00</span>)&gt;&gt;<span class="number">8</span>) | ((n&amp;<span class="number">0x00ff00ff</span>)&lt;&lt;<span class="number">8</span>);</span><br><span class="line">	n = (n&gt;&gt;<span class="number">16</span>) | (n&lt;&lt;<span class="number">16</span>);</span><br><span class="line">	<span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¿”å›nçš„äºŒè¿›åˆ¶ä¸­æœ‰å‡ ä¸ª1</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F3</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	n = (n&amp;<span class="number">0x55555555</span>)+((n&gt;&gt;<span class="number">1</span>)&amp;<span class="number">0x55555555</span>);</span><br><span class="line">	n = (n&amp;<span class="number">0x33333333</span>)+((n&gt;&gt;<span class="number">2</span>)&amp;<span class="number">0x33333333</span>);</span><br><span class="line">	n = (n&amp;<span class="number">0x0f0f0f0f</span>)+((n&gt;&gt;<span class="number">4</span>)&amp;<span class="number">0x0f0f0f0f</span>);</span><br><span class="line">	n = (n&amp;<span class="number">0x00ff00ff</span>)+((n&gt;&gt;<span class="number">8</span>)&amp;<span class="number">0x00ff00ff</span>);</span><br><span class="line">	n = (n&amp;<span class="number">0x0000ffff</span>)+((n&gt;&gt;<span class="number">18</span>)&amp;<span class="number">0x0000ffff</span>);</span><br><span class="line">	<span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ±‚xåˆ°yçš„æ‰€æœ‰æ•°&amp;çš„ç»“æœ</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F4</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(y&gt;x)&#123;</span><br><span class="line">		y -= y &amp;(-y);</span><br><span class="line">	&#125;<span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Brain-Kernighanç®—æ³•"><a href="#Brain-Kernighanç®—æ³•" class="headerlink" title="Brain Kernighanç®—æ³•"></a>Brain Kernighanç®—æ³•</h3><p>å¼‚æˆ–æŠ€å·§</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 500</span></span><br><span class="line"><span class="type">int</span> a1[M];</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="comment">// ä»¥ä¸‹ä¸¤ä¸ªå…¨å±€å˜é‡ç”¨äºåŠŸèƒ½1ï¼šä¸¤ä¸ªå‡ºç°æ¬¡æ•°ä¸ºå¥‡æ•°æ¬¡çš„æ•°å­—</span></span><br><span class="line"><span class="type">int</span> ero1 = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> ero2 = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> a[], <span class="type">int</span> size)</span> </span>&#123;</span><br><span class="line">    ero1 = <span class="number">0</span>;</span><br><span class="line">    ero2 = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// è®¡ç®—æ‰€æœ‰æ•°å­—çš„å¼‚æˆ–ç»“æœ</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">        ero1 ^= a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ‰¾åˆ°æœ€å³ä¾§çš„1</span></span><br><span class="line">    <span class="type">int</span> rightone = ero1 &amp; (-ero1);</span><br><span class="line">    <span class="comment">// æ ¹æ®è¯¥ä½æ˜¯å¦ä¸º1å°†æ•°å­—åˆ†ç»„ï¼Œå¹¶å¯¹å…¶ä¸­ä¸€ç»„å¼‚æˆ–</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((a[i] &amp; rightone) == <span class="number">0</span>) &#123;</span><br><span class="line">            ero2 ^= a[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¦ä¸€ä¸ªå¥‡æ•°æ¬¡æ•°å­—</span></span><br><span class="line">    ero1 = ero1 ^ ero2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä»¥ä¸‹å…¨å±€å˜é‡ç”¨äºåŠŸèƒ½2ï¼šæ±‚æ•°ç»„ä¸­å‡ºç°æ¬¡æ•°å°‘äº cnt æ¬¡çš„æ•°å­—</span></span><br><span class="line"><span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> bits[<span class="number">32</span>];  <span class="comment">// ç”¨äºç»Ÿè®¡å„äºŒè¿›åˆ¶ä½1çš„ä¸ªæ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve2</span><span class="params">(<span class="type">int</span> size, <span class="type">int</span> cnt, <span class="type">int</span> a[])</span> </span>&#123;</span><br><span class="line">    ans = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(bits, <span class="number">0</span>, <span class="built_in">sizeof</span>(bits));</span><br><span class="line">    <span class="comment">// ç»Ÿè®¡æ¯ä¸€ä½çš„1çš„ä¸ªæ•°</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++) &#123;</span><br><span class="line">            <span class="comment">// ç­‰ä»·äºï¼šif(a[i] &amp; (1 &lt;&lt; j)) bits[j]++;</span></span><br><span class="line">            bits[j] += (a[i] &gt;&gt; j) &amp; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¯¹æ¯ä¸€ä½åˆ¤æ–­æ˜¯å¦ä¸ºç›®æ ‡æ•°å­—çš„1</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (bits[j] % cnt) &#123;</span><br><span class="line">            ans |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="é“¾è¡¨åŸºæœ¬æ“ä½œ"><a href="#é“¾è¡¨åŸºæœ¬æ“ä½œ" class="headerlink" title="é“¾è¡¨åŸºæœ¬æ“ä½œ"></a>é“¾è¡¨åŸºæœ¬æ“ä½œ</h3><h4 id="è¿”å›ä¸¤ä¸ªæ— ç¯é“¾è¡¨ç›¸äº¤çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹"><a href="#è¿”å›ä¸¤ä¸ªæ— ç¯é“¾è¡¨ç›¸äº¤çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹" class="headerlink" title="è¿”å›ä¸¤ä¸ªæ— ç¯é“¾è¡¨ç›¸äº¤çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹"></a>è¿”å›ä¸¤ä¸ªæ— ç¯é“¾è¡¨ç›¸äº¤çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LinkNode</span>&#123;</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    LinkNode *next;</span><br><span class="line">    <span class="built_in">LinkNode</span>(<span class="type">int</span> _val) : <span class="built_in">val</span>(_val), <span class="built_in">next</span>(<span class="literal">nullptr</span>) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//è¿”å›ä¸¤ä¸ªæ— ç¯é“¾è¡¨ç›¸äº¤çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line"><span class="function">LinkNode *<span class="title">converge</span><span class="params">(LinkNode *&amp;L1,LinkNode *&amp;L2)</span></span>&#123;</span><br><span class="line">    LinkNode *p1=L1-&gt;next;</span><br><span class="line">    LinkNode *p2=L2-&gt;next;</span><br><span class="line">    <span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(L1==<span class="literal">nullptr</span> || L2==<span class="literal">nullptr</span>) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">while</span>(p1!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        cnt++;</span><br><span class="line">        p1=p1-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(p2!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        cnt--;</span><br><span class="line">        p2=p2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    p1=L1;</span><br><span class="line">    p2=L2;</span><br><span class="line">    <span class="keyword">if</span>(cnt&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">while</span>(cnt--) p1=p1-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        cnt=<span class="built_in">abs</span>(cnt);</span><br><span class="line">        <span class="keyword">while</span>(cnt--) p2=p2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(p1!=p2 &amp;&amp; p1!=<span class="literal">nullptr</span> &amp;&amp; p2!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        p1=p1-&gt;next;</span><br><span class="line">        p2=p2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ¯kä¸ªèŠ‚ç‚¹ä¸€ç»„ç¿»è½¬é“¾è¡¨"><a href="#æ¯kä¸ªèŠ‚ç‚¹ä¸€ç»„ç¿»è½¬é“¾è¡¨" class="headerlink" title="æ¯kä¸ªèŠ‚ç‚¹ä¸€ç»„ç¿»è½¬é“¾è¡¨"></a>æ¯kä¸ªèŠ‚ç‚¹ä¸€ç»„ç¿»è½¬é“¾è¡¨</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æ¯kä¸ªèŠ‚ç‚¹ä¸€ç»„ç¿»è½¬é“¾è¡¨</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverse</span><span class="params">(<span class="type">int</span> k, LinkNode *&amp;L)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(k&lt;=<span class="number">1</span> || L==<span class="literal">nullptr</span> || L-&gt;next==<span class="literal">nullptr</span>) <span class="keyword">return</span>;</span><br><span class="line">    LinkNode *p1=L-&gt;next;</span><br><span class="line">    <span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(p1!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        cnt++;</span><br><span class="line">        p1=p1-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(cnt&lt;k) <span class="keyword">return</span>;</span><br><span class="line">    p1=L;</span><br><span class="line">    LinkNode *pre;</span><br><span class="line">    LinkNode *p;</span><br><span class="line">    LinkNode *pp;</span><br><span class="line">    LinkNode *p0=L;</span><br><span class="line">    LinkNode *last=p0-&gt;next;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;k;i++) p1=p1-&gt;next;</span><br><span class="line">    p=p0-&gt;next;</span><br><span class="line">    pp=p-&gt;next;</span><br><span class="line">    p-&gt;next=p1-&gt;next;</span><br><span class="line">    pre=p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;k;i++)&#123;</span><br><span class="line">        p=pp;</span><br><span class="line">        pp=p-&gt;next;</span><br><span class="line">        p-&gt;next=pre;</span><br><span class="line">        pre=p;</span><br><span class="line">    &#125;</span><br><span class="line">    p0-&gt;next=p1;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=cnt-k;j&gt;=k;j-=k)&#123;</span><br><span class="line">        p0=last;</span><br><span class="line">        p1=last;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;k;i++) p1=p1-&gt;next;</span><br><span class="line">        p=p0-&gt;next;</span><br><span class="line">        last=p;</span><br><span class="line">        pp=p-&gt;next;</span><br><span class="line">        p-&gt;next=p1-&gt;next;</span><br><span class="line">        pre=p;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;k;i++)&#123;</span><br><span class="line">            p=pp;</span><br><span class="line">            pp=p-&gt;next;</span><br><span class="line">            p-&gt;next=pre;</span><br><span class="line">            pre=p;</span><br><span class="line">        &#125;</span><br><span class="line">        p0-&gt;next=p1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¤åˆ¶å¸¦éšæœºæŒ‡é’ˆçš„é“¾è¡¨"><a href="#å¤åˆ¶å¸¦éšæœºæŒ‡é’ˆçš„é“¾è¡¨" class="headerlink" title="å¤åˆ¶å¸¦éšæœºæŒ‡é’ˆçš„é“¾è¡¨"></a>å¤åˆ¶å¸¦éšæœºæŒ‡é’ˆçš„é“¾è¡¨</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¤åˆ¶å¸¦éšæœºæŒ‡é’ˆçš„é“¾è¡¨</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NodeR</span>&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    NodeR *next;</span><br><span class="line">    NodeR *random;</span><br><span class="line">    <span class="built_in">NodeR</span>(<span class="type">int</span> x)&#123;</span><br><span class="line">        val=x;</span><br><span class="line">        next=<span class="literal">nullptr</span>;</span><br><span class="line">        random=<span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">NodeR * <span class="title">copy</span><span class="params">(NodeR *&amp;L1)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L1==<span class="literal">nullptr</span>) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    NodeR* cur=L1-&gt;next;</span><br><span class="line">    <span class="comment">//å¤åˆ¶èŠ‚ç‚¹å¹¶æ’å…¥åŸèŠ‚ç‚¹ä¹‹å</span></span><br><span class="line">    <span class="keyword">while</span>(cur!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        NodeR* next=<span class="keyword">new</span> <span class="built_in">NodeR</span>(cur-&gt;val);</span><br><span class="line">        next-&gt;next=cur-&gt;next;</span><br><span class="line">        cur-&gt;next=next;</span><br><span class="line">        cur=next-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ›´æ–°èŠ‚ç‚¹çš„éšæœºæŒ‡é’ˆ</span></span><br><span class="line">    cur=L1-&gt;next;</span><br><span class="line">    <span class="keyword">while</span>(cur!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(cur-&gt;random!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            cur-&gt;next-&gt;random=cur-&gt;random;</span><br><span class="line">        &#125;</span><br><span class="line">        cur=cur-&gt;next-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ†ç¦»é“¾è¡¨</span></span><br><span class="line">    cur=L1-&gt;next;</span><br><span class="line">    NodeR* L2=<span class="keyword">new</span> <span class="built_in">NodeR</span>(<span class="number">0</span>);</span><br><span class="line">    NodeR* temp=L2;</span><br><span class="line">    <span class="keyword">while</span>(cur!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        temp-&gt;next=cur-&gt;next;</span><br><span class="line">        cur-&gt;next=cur-&gt;next-&gt;next;</span><br><span class="line">        cur=cur-&gt;next;</span><br><span class="line">        temp=temp-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> L2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="åˆ¤æ–­æ˜¯å¦æ˜¯å›æ–‡ç»“æ„ï¼ˆå¿«æ…¢æŒ‡é’ˆï¼‰"><a href="#åˆ¤æ–­æ˜¯å¦æ˜¯å›æ–‡ç»“æ„ï¼ˆå¿«æ…¢æŒ‡é’ˆï¼‰" class="headerlink" title="åˆ¤æ–­æ˜¯å¦æ˜¯å›æ–‡ç»“æ„ï¼ˆå¿«æ…¢æŒ‡é’ˆï¼‰"></a>åˆ¤æ–­æ˜¯å¦æ˜¯å›æ–‡ç»“æ„ï¼ˆå¿«æ…¢æŒ‡é’ˆï¼‰</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ¤æ–­é“¾è¡¨æ˜¯å¦æ˜¯å›æ–‡ç»“æ„ï¼ˆå¿«æ…¢æŒ‡é’ˆï¼‰</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">judge_HuiWen</span><span class="params">(LinkNode *L)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L==<span class="literal">nullptr</span> || L-&gt;next==<span class="literal">nullptr</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">//å¿«æ…¢æŒ‡é’ˆæ‰¾ä¸­ç‚¹</span></span><br><span class="line">    LinkNode* f=L;</span><br><span class="line">    LinkNode* s=L;</span><br><span class="line">    <span class="keyword">while</span>(f!=<span class="literal">nullptr</span> &amp;&amp; f-&gt;next!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        f=f-&gt;next-&gt;next;</span><br><span class="line">        s=s-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ç¿»è½¬</span></span><br><span class="line">    LinkNode* pre=s;</span><br><span class="line">    LinkNode* cur=s-&gt;next;</span><br><span class="line">    LinkNode* next=<span class="literal">nullptr</span>;</span><br><span class="line">    pre-&gt;next=<span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">while</span>(cur!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        next=cur-&gt;next;</span><br><span class="line">        cur-&gt;next=pre;</span><br><span class="line">        pre=cur;</span><br><span class="line">        cur=next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ¤æ–­å›æ–‡</span></span><br><span class="line">    <span class="type">bool</span> ans=<span class="literal">true</span>;</span><br><span class="line">    LinkNode* sta1=L-&gt;next;</span><br><span class="line">    LinkNode* sta2=pre;</span><br><span class="line">    <span class="keyword">while</span>(sta1!=<span class="literal">nullptr</span> &amp;&amp; sta2!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(sta1-&gt;val!=sta2-&gt;val)&#123;</span><br><span class="line">            ans=<span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        sta1=sta1-&gt;next;</span><br><span class="line">        sta2=sta2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//è¿˜åŸ</span></span><br><span class="line">    cur=pre-&gt;next;</span><br><span class="line">    pre-&gt;next=<span class="literal">nullptr</span>;</span><br><span class="line">    next=<span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">while</span>(cur!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        next=cur-&gt;next;</span><br><span class="line">        cur-&gt;next=pre;</span><br><span class="line">        pre=cur;</span><br><span class="line">        cur=next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="è¿”å›ç¬¬ä¸€ä¸ªå…¥ç¯èŠ‚ç‚¹"><a href="#è¿”å›ç¬¬ä¸€ä¸ªå…¥ç¯èŠ‚ç‚¹" class="headerlink" title="è¿”å›ç¬¬ä¸€ä¸ªå…¥ç¯èŠ‚ç‚¹"></a>è¿”å›ç¬¬ä¸€ä¸ªå…¥ç¯èŠ‚ç‚¹</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è¿”å›é“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…¥ç¯èŠ‚ç‚¹</span></span><br><span class="line"><span class="function">LinkNode* <span class="title">cycle</span><span class="params">(LinkNode *L)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (L == <span class="literal">nullptr</span> || L-&gt;next == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    LinkNode* f=L;</span><br><span class="line">    LinkNode* s=L;</span><br><span class="line">    <span class="keyword">while</span>(f!=<span class="literal">nullptr</span> &amp;&amp; f-&gt;next!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        s=s-&gt;next;</span><br><span class="line">        f=f-&gt;next-&gt;next;</span><br><span class="line">        <span class="keyword">if</span>(s==f)&#123;</span><br><span class="line">            f=L;</span><br><span class="line">            <span class="keyword">while</span>(f!=s)&#123;</span><br><span class="line">                f=f-&gt;next;</span><br><span class="line">                s=s-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> f;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ç¨³å®šæ’åº"><a href="#ç¨³å®šæ’åº" class="headerlink" title="ç¨³å®šæ’åº"></a>ç¨³å®šæ’åº</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åœ¨é“¾è¡¨ä¸Šæ’åºï¼Œæ—¶é—´å¤æ‚åº¦Oï¼ˆn*lognï¼‰ï¼Œé¢å¤–ç©ºé—´å¤æ‚åº¦ï¼ˆ1ï¼‰ï¼Œæ’åºæœ‰ç¨³å®šæ€§</span></span><br><span class="line"><span class="function">LinkNode* <span class="title">createNode</span><span class="params">(<span class="type">int</span> data)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">LinkNode</span>(data);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åœ¨é“¾è¡¨å°¾éƒ¨æ·»åŠ èŠ‚ç‚¹</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">appendNode</span><span class="params">(LinkNode*&amp; head, <span class="type">int</span> data)</span> </span>&#123;</span><br><span class="line">    LinkNode* newNode = <span class="built_in">createNode</span>(data);</span><br><span class="line">    LinkNode* temp = head;</span><br><span class="line">    <span class="keyword">while</span> (temp-&gt;next) &#123;</span><br><span class="line">        temp = temp-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    temp-&gt;next = newNode;</span><br><span class="line">&#125;</span><br><span class="line">LinkNode* start;</span><br><span class="line">LinkNode* end1;</span><br><span class="line"><span class="function">LinkNode* <span class="title">FindEnd</span><span class="params">(LinkNode* l,<span class="type">int</span> len)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(l-&gt;next!=<span class="literal">nullptr</span> &amp;&amp; --len!=<span class="number">0</span>)&#123;</span><br><span class="line">        l=l-&gt;next;</span><br><span class="line">    &#125;<span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(LinkNode* l1, LinkNode* r1, LinkNode* l2, LinkNode* r2)</span> </span>&#123;</span><br><span class="line">    LinkNode* pre;</span><br><span class="line">    <span class="keyword">if</span> (l1-&gt;val &lt;= l2-&gt;val) &#123;</span><br><span class="line">        start = l1;</span><br><span class="line">        pre = l1;</span><br><span class="line">        l1 = l1-&gt;next;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        start = l2;</span><br><span class="line">        pre = l2;</span><br><span class="line">        l2 = l2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (l1 != <span class="literal">nullptr</span> &amp;&amp; l2 != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (l1-&gt;val &lt;= l2-&gt;val) &#123;</span><br><span class="line">            pre-&gt;next = l1;</span><br><span class="line">            pre = l1;</span><br><span class="line">            l1 = l1-&gt;next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            pre-&gt;next = l2;</span><br><span class="line">            pre = l2;</span><br><span class="line">            l2 = l2-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (l1 != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        pre-&gt;next = l1;</span><br><span class="line">        end1 = r1;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        pre-&gt;next = l2;</span><br><span class="line">        end1 = r2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sort</span><span class="params">(LinkNode*&amp; L)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (L == <span class="literal">nullptr</span> || L-&gt;next == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> len=<span class="number">0</span>;</span><br><span class="line">    LinkNode* temp=L;</span><br><span class="line">    <span class="keyword">while</span>(temp!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        len++;</span><br><span class="line">        temp=temp-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    LinkNode* l1;</span><br><span class="line">    LinkNode* r1;</span><br><span class="line">    LinkNode* l2;</span><br><span class="line">    LinkNode* r2;</span><br><span class="line">    LinkNode* lastTeamend;</span><br><span class="line">    LinkNode* next;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;len;i&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">        l1=L;</span><br><span class="line">        r1=<span class="built_in">FindEnd</span>(l1,i);</span><br><span class="line">        l2=r1-&gt;next;</span><br><span class="line">        r2=<span class="built_in">FindEnd</span>(l2,i);</span><br><span class="line">        next = r2-&gt;next;</span><br><span class="line">        r1-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">        r2-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="built_in">merge</span>(l1,r1,l2,r2);</span><br><span class="line">        L=start;</span><br><span class="line">        lastTeamend=end1;</span><br><span class="line">        <span class="keyword">while</span>(next!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            l1=next;</span><br><span class="line">            r1=<span class="built_in">FindEnd</span>(l1,i);</span><br><span class="line">        	l2 = r1-&gt;next;</span><br><span class="line">        	<span class="keyword">if</span>(l2==<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        		lastTeamend-&gt;next = l1;</span><br><span class="line">        		<span class="keyword">break</span>;</span><br><span class="line">        	&#125;</span><br><span class="line">            r2 = <span class="built_in">FindEnd</span>(l2, i);</span><br><span class="line">            next = r2-&gt;next;</span><br><span class="line">            r1-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">            r2-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">            <span class="built_in">merge</span>(l1,r1,l2,r2);</span><br><span class="line">            lastTeamend-&gt;next=start;</span><br><span class="line">            lastTeamend=end1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="åˆå¹¶nä¸ªæœ‰åºé“¾è¡¨"><a href="#åˆå¹¶nä¸ªæœ‰åºé“¾è¡¨" class="headerlink" title="åˆå¹¶nä¸ªæœ‰åºé“¾è¡¨"></a>åˆå¹¶nä¸ªæœ‰åºé“¾è¡¨</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 500</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ListNode</span>&#123;</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    ListNode * next;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Create</span><span class="params">(ListNode *&amp;q)</span></span>&#123;</span><br><span class="line">    q=(ListNode *)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(ListNode));</span><br><span class="line">    q-&gt;next=<span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cmp</span>&#123;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(ListNode* a,ListNode* b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a-&gt;val &gt; b-&gt;val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">ListNode *<span class="title">merge</span><span class="params">(vector&lt;ListNode*&gt;&amp; v1)</span></span>&#123;</span><br><span class="line">    priority_queue&lt;ListNode*,vector&lt;ListNode*&gt;,cmp&gt; pq1;</span><br><span class="line">    <span class="keyword">for</span>(ListNode* it : v1) <span class="keyword">if</span>(it) pq1.<span class="built_in">push</span>(it);</span><br><span class="line">    ListNode* ans;</span><br><span class="line">    <span class="built_in">Create</span>(ans);</span><br><span class="line">    ListNode* temp;</span><br><span class="line">    ListNode* pre=ans;</span><br><span class="line">    <span class="keyword">while</span>(!pq1.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        temp=pq1.<span class="built_in">top</span>();</span><br><span class="line">        pq1.<span class="built_in">pop</span>();</span><br><span class="line">        pre-&gt;next=temp;</span><br><span class="line">        pre=temp;</span><br><span class="line">        <span class="keyword">if</span>(temp-&gt;next) pq1.<span class="built_in">push</span>(temp-&gt;next);</span><br><span class="line">    &#125;pre-&gt;next=<span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="type">int</span> cnt;</span><br><span class="line">    ListNode* pre;</span><br><span class="line">    <span class="type">int</span> temp1;</span><br><span class="line">    vector&lt;ListNode*&gt; v1;</span><br><span class="line">    <span class="keyword">while</span>(n--)&#123;</span><br><span class="line">        cin&gt;&gt;cnt;</span><br><span class="line">        ListNode * l=(ListNode*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(ListNode));</span><br><span class="line">        l-&gt;next=<span class="literal">nullptr</span>;</span><br><span class="line">        pre=l;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;cnt;i++)&#123;</span><br><span class="line">            cin&gt;&gt;temp1;</span><br><span class="line">            ListNode *temp=(ListNode*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(ListNode));</span><br><span class="line">            temp-&gt;val=temp1;</span><br><span class="line">            temp-&gt;next=pre-&gt;next;</span><br><span class="line">            pre-&gt;next=temp;</span><br><span class="line">            pre=temp;</span><br><span class="line">        &#125;v1.<span class="built_in">push_back</span>(l-&gt;next);</span><br><span class="line">    &#125;</span><br><span class="line">    ListNode * <span class="keyword">final</span>;</span><br><span class="line">    <span class="built_in">Create</span>(<span class="keyword">final</span>);</span><br><span class="line">    <span class="keyword">final</span>=<span class="built_in">merge</span>(v1);</span><br><span class="line">    pre=<span class="keyword">final</span>-&gt;next;</span><br><span class="line">    <span class="keyword">while</span>(pre)&#123;</span><br><span class="line">        cout&lt;&lt;pre-&gt;val&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">        pre=pre-&gt;next;</span><br><span class="line">    &#125;cout&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="è«é˜Ÿç®—æ³•"><a href="#è«é˜Ÿç®—æ³•" class="headerlink" title="è«é˜Ÿç®—æ³•"></a>è«é˜Ÿç®—æ³•</h3><p>ç¦»çº¿åŠ é€Ÿå¤„ç†æŸ¥è¯¢</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Query</span> &#123;</span><br><span class="line">    <span class="type">int</span> l, r, id, blk;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> n, q;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; q;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">original</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">ans</span><span class="params">(q)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">    	cin &gt;&gt; original[i];</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// ç¦»æ•£åŒ–</span></span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; temp = original;</span><br><span class="line">    <span class="built_in">sort</span>(temp.<span class="built_in">begin</span>()+<span class="number">1</span>, temp.<span class="built_in">end</span>());</span><br><span class="line">    <span class="type">int</span> m = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    	<span class="keyword">if</span>(temp[m] != temp[i])&#123;</span><br><span class="line">    		temp[++ m] = temp[i];</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">auto</span> find = [&amp;](<span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">    	<span class="type">int</span> l = <span class="number">1</span>, r = m;</span><br><span class="line">    	<span class="type">int</span> mid, ans;</span><br><span class="line">    	<span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">    		mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    		<span class="keyword">if</span>(temp[mid] &lt;= x)&#123;</span><br><span class="line">    			ans = mid;</span><br><span class="line">    			l = mid + <span class="number">1</span>;</span><br><span class="line">    		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    			r = mid - <span class="number">1</span>;</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">return</span> ans;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// è«é˜Ÿå‡½æ•°</span></span><br><span class="line">    <span class="type">int</span> now_ans = <span class="number">0</span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">fre</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">auto</span> add = [&amp;](<span class="type">int</span> x) &#123;</span><br><span class="line">    	<span class="type">int</span> &amp; f = fre[<span class="built_in">find</span>(x)];</span><br><span class="line">    	<span class="keyword">if</span> (f == <span class="number">1</span>) &#123;</span><br><span class="line">	        now_ans++;</span><br><span class="line">	    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (f == <span class="number">2</span>) &#123;</span><br><span class="line">	        now_ans--;</span><br><span class="line">	    &#125;</span><br><span class="line">        f++;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">auto</span> remove = [&amp;](<span class="type">int</span> x) &#123;</span><br><span class="line">    	<span class="type">int</span> &amp;f = fre[<span class="built_in">find</span>(x)];</span><br><span class="line">	    <span class="keyword">if</span> (f == <span class="number">2</span>) &#123;</span><br><span class="line">	        now_ans--;</span><br><span class="line">	    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (f == <span class="number">3</span>) &#123;</span><br><span class="line">	        now_ans++;</span><br><span class="line">	    &#125;</span><br><span class="line">        f--;</span><br><span class="line">    &#125;;</span><br><span class="line">	<span class="comment">// çª—å£ä¼˜åŒ–</span></span><br><span class="line">    <span class="type">int</span> blk = (<span class="type">int</span>)<span class="built_in">sqrt</span>(n);</span><br><span class="line">    <span class="function">vector&lt;Query&gt; <span class="title">queries</span><span class="params">(q)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; q; i++) &#123;</span><br><span class="line">        cin &gt;&gt; queries[i].l &gt;&gt; queries[i].r;</span><br><span class="line">        queries[i].id = i;</span><br><span class="line">        queries[i].blk = queries[i].l / blk;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(queries.<span class="built_in">begin</span>(), queries.<span class="built_in">end</span>(), [&amp;](<span class="type">const</span> Query &amp;A, <span class="type">const</span> Query &amp;B) &#123;</span><br><span class="line">        <span class="keyword">if</span> (A.blk == B.blk) <span class="keyword">return</span> A.r &lt; B.r;</span><br><span class="line">        <span class="keyword">return</span> A.blk &lt; B.blk;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="type">int</span> curL = <span class="number">1</span>, curR = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;q : queries) &#123;</span><br><span class="line">        <span class="keyword">while</span> (curR &lt; q.r) <span class="built_in">add</span>(original[++curR]);</span><br><span class="line">        <span class="keyword">while</span> (curR &gt; q.r) <span class="built_in">remove</span>(original[curR--]);</span><br><span class="line">        <span class="keyword">while</span> (curL &lt; q.l) <span class="built_in">remove</span>(original[curL++]);</span><br><span class="line">        <span class="keyword">while</span> (curL &gt; q.l) <span class="built_in">add</span>(original[--curL]);</span><br><span class="line">        ans[q.id] = now_ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; q; i++) cout &lt;&lt; ans[i] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="KMPç®—æ³•"><a href="#KMPç®—æ³•" class="headerlink" title="KMPç®—æ³•"></a>KMPç®—æ³•</h3><p>å­—ç¬¦åŒ¹é…åŒ¹é…åŠ é€Ÿï¼ŒåŠ é€Ÿçš„ç‚¹åœ¨äºåŒ¹é…å¤±è´¥åä¸ä¸€å®šç›´æ¥è¿”å›èµ·ç‚¹é‡æ–°åŒ¹é…ï¼Œè€Œæ˜¯è·³åˆ°æœ€å¤§å‰ç¼€å¤„ï¼Œå¦‚<code>abab......</code>åŒ¹é…å¤±è´¥æ—¶ï¼Œä¼šè·³åˆ°2ä½ç½®è€Œä¸æ˜¯0ä½ç½®</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    string s1, s2;</span><br><span class="line">    cin &gt;&gt; s1 &gt;&gt; s2;</span><br><span class="line">    <span class="type">int</span> n = <span class="built_in">int</span>(s1.<span class="built_in">size</span>());</span><br><span class="line">    <span class="type">int</span> m = <span class="built_in">int</span>(s2.<span class="built_in">size</span>());</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">next1</span><span class="params">(m + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="type">int</span> i1 = <span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> mark1 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i1 &lt;= m)&#123;</span><br><span class="line">        <span class="keyword">if</span>(s2[i1 - <span class="number">1</span>] == s2[mark1])&#123;</span><br><span class="line">            next1[i1++] = ++ mark1;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(mark1 != <span class="number">0</span>)&#123;</span><br><span class="line">            mark1 = next1[mark1];</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            next1[i1++] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> j1 = i1 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(j1 &lt; n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(s1[j1] == s2[i1])&#123;</span><br><span class="line">            j1 ++, i1 ++;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(i1 != <span class="number">0</span>)&#123;</span><br><span class="line">            i1 = next1[i1];</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            j1 ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(i1 == m)&#123;</span><br><span class="line">            cout &lt;&lt; j1 - i1 + <span class="number">1</span> &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            i1 = next1[i1];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i ++)&#123;</span><br><span class="line">    	cout &lt;&lt; next1[i];</span><br><span class="line">    	<span class="keyword">if</span>(i != m) cout &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="manacherç®—æ³•"><a href="#manacherç®—æ³•" class="headerlink" title="manacherç®—æ³•"></a>manacherç®—æ³•</h3><p>ä»¥æŸä¸€èŠ‚ç‚¹ä¸ºä¸­å¿ƒå‘ä¸¤ç«¯æ‰©å±•çš„æœ€å¤§å›æ–‡ä¸²</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long </span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function">string <span class="title">manacherss</span><span class="params">(string s)</span></span>&#123;</span><br><span class="line">	string ss = <span class="string">&quot;#&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i ++)&#123;</span><br><span class="line">		ss += s[i];</span><br><span class="line">		ss += <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ss;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	string s;</span><br><span class="line">	cin &gt;&gt; s;</span><br><span class="line">	string ss = <span class="built_in">manacherss</span>(s);</span><br><span class="line">	<span class="type">int</span> n = ss.<span class="built_in">size</span>();</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">r1</span><span class="params">(n, <span class="number">0</span>)</span></span>; <span class="comment">// çœŸå®å›æ–‡ä¸²çš„é•¿åº¦ä¸ºr[i] - 1;</span></span><br><span class="line">	<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, r = <span class="number">0</span>, c = <span class="number">0</span>, len; i &lt; n; i ++)&#123;</span><br><span class="line">		len = r &gt; i ? <span class="built_in">min</span>(r1[<span class="number">2</span> * c - i], r - i) : <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span>(i - len &gt;= <span class="number">0</span> &amp;&amp; i + len &lt; n &amp;&amp; ss[i - len] == ss[i + len])&#123;</span><br><span class="line">			len ++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(len + i &gt; r)&#123;</span><br><span class="line">			r = len + i;</span><br><span class="line">			c = i;</span><br><span class="line">		&#125;</span><br><span class="line">		r1[i] = len;</span><br><span class="line">		ans = <span class="built_in">max</span>(ans, len);</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; ans - <span class="number">1</span> &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">   </span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">	     <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Zå‡½æ•°"><a href="#Zå‡½æ•°" class="headerlink" title="Zå‡½æ•°"></a>Zå‡½æ•°</h3><p>å¯¹äºä¸€ä¸ªé•¿åº¦ä¸ºnçš„å­—ç¬¦ä¸²sï¼Œå®šä¹‰å‡½æ•°z[i]è¡¨ç¤ºså’Œs[i, n - 1]çš„æœ€é•¿å…¬å…±å‰ç¼€ï¼ˆLCPï¼‰çš„é•¿åº¦åˆ™zè¢«æˆä¸ºsçš„Zå‡½æ•°</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P5410</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long </span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Z1</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp; z, string s, <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	z[<span class="number">0</span>] = n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, c = <span class="number">1</span>, r = <span class="number">1</span>, len; i &lt; n; i ++)&#123;</span><br><span class="line">		len = r &gt; i ? <span class="built_in">min</span>(z[i - c], r - i) : <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(i + len &lt; n &amp;&amp; s[len] == s[i + len])&#123;</span><br><span class="line">			len ++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(i + len &gt; r)&#123;</span><br><span class="line">			r = i + len;</span><br><span class="line">			c = i;</span><br><span class="line">		&#125;</span><br><span class="line">		z[i] = len;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">E1</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp; e, vector&lt;<span class="type">int</span>&gt; &amp; z, string s1, string s2, <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, r = <span class="number">0</span>, c = <span class="number">0</span>, len; i &lt; n; i ++)&#123;</span><br><span class="line">		len = r &gt; i ? <span class="built_in">min</span>(z[i - c], r - i) : <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(i + len &lt; n &amp;&amp; s1[i + len] == s2[len])&#123;</span><br><span class="line">			len ++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(i + len &gt; r)&#123;</span><br><span class="line">			r = i + len;</span><br><span class="line">			c = i;</span><br><span class="line">		&#125;</span><br><span class="line">		e[i] = len;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	string s1, s2;</span><br><span class="line">	cin &gt;&gt; s1 &gt;&gt; s2;</span><br><span class="line">	<span class="comment">// æ±‚å¾—è¯¥å­—ç¬¦ä¸²çš„æœ€é•¿å‰ç¼€</span></span><br><span class="line">	<span class="type">int</span> n = s2.<span class="built_in">size</span>();</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">Z</span><span class="params">(n, <span class="number">0</span>)</span></span>;</span><br><span class="line">	<span class="built_in">Z1</span>(Z, s2, n);</span><br><span class="line">	<span class="comment">// æ±‚è¯¥ä¸²ä»¥æŸä¸€ä¸²ä¸ºåŸºå‡†çš„æœ€é•¿å‰ç¼€</span></span><br><span class="line">	<span class="type">int</span> m = s1.<span class="built_in">size</span>();</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">E</span><span class="params">(m + <span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="built_in">E1</span>(E, Z, s1, s2, m);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å‰ç¼€æ ‘"><a href="#å‰ç¼€æ ‘" class="headerlink" title="å‰ç¼€æ ‘"></a>å‰ç¼€æ ‘</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">//é™æ€æ•°ç»„ç‰ˆæœ¬</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">150001</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M2 = <span class="number">28</span>;</span><br><span class="line"><span class="type">int</span> cnt=<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> pass1[M];</span><br><span class="line"><span class="type">int</span> end1[M];</span><br><span class="line"><span class="type">int</span> t1[M][M2];</span><br><span class="line"><span class="type">int</span> op1;</span><br><span class="line">string op2;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">memset</span>(t1, <span class="number">0</span>, <span class="built_in">sizeof</span>(t1));</span><br><span class="line">    <span class="built_in">memset</span>(end1, <span class="number">0</span>, <span class="built_in">sizeof</span>(end1));</span><br><span class="line">    <span class="built_in">memset</span>(pass1, <span class="number">0</span>, <span class="built_in">sizeof</span>(pass1));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">const</span> string&amp; word)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> cur=<span class="number">1</span>;</span><br><span class="line">    pass1[cur]++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;word.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">        <span class="type">int</span> path = word[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(t1[cur][path]==<span class="number">0</span>)&#123;</span><br><span class="line">            t1[cur][path]=++cnt;</span><br><span class="line">        &#125;</span><br><span class="line">        cur=t1[cur][path];</span><br><span class="line">        pass1[cur]++;</span><br><span class="line">    &#125;end1[cur]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">search</span><span class="params">(<span class="type">const</span> string&amp; word)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> cur=<span class="number">1</span>;<span class="type">int</span> path;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;word.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">        path=word[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(t1[cur][path]==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cur=t1[cur][path];</span><br><span class="line">    &#125;<span class="keyword">return</span> end1[cur];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">erase</span><span class="params">(<span class="type">const</span> string&amp; word)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">search</span>(word)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="type">int</span> path;</span><br><span class="line">        <span class="type">int</span> cur=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;word.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            path = word[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span>(--pass1[t1[cur][path]]==<span class="number">0</span>)&#123;</span><br><span class="line">                t1[cur][path]=<span class="number">0</span>;</span><br><span class="line">                <span class="comment">//  ä¹‹åä¼šé‡æ–°åˆ†é…èŠ‚ç‚¹ï¼Œæ‰€ä»¥éå†ä¸åˆ°æœªå‡å‡çš„end</span></span><br><span class="line">                <span class="keyword">return</span> ;</span><br><span class="line">            &#125;cur=t1[cur][path];</span><br><span class="line">        &#125;</span><br><span class="line">        end1[cur]--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">prefixNumber</span><span class="params">(<span class="type">const</span> string&amp; pre)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> cur=<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> path;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;pre.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">        path = pre[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(t1[cur][path]==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cur=t1[cur][path];</span><br><span class="line">    &#125;<span class="keyword">return</span> pass1[cur];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123; </span><br><span class="line">    string line;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">getline</span>(cin, line)) &#123;</span><br><span class="line">        <span class="built_in">build</span>();</span><br><span class="line">        <span class="type">int</span> m = <span class="built_in">stoi</span>(line);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; ++i) &#123;</span><br><span class="line">            <span class="built_in">getline</span>(cin, line);</span><br><span class="line">            <span class="function">stringstream <span class="title">ss</span><span class="params">(line)</span></span>;</span><br><span class="line">            <span class="type">int</span> op;</span><br><span class="line">            string word;</span><br><span class="line">            ss &gt;&gt; op &gt;&gt; word;</span><br><span class="line">            <span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="built_in">insert</span>(word);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="built_in">erase</span>(word);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">3</span>) &#123;</span><br><span class="line">                cout &lt;&lt; (<span class="built_in">search</span>(word) &gt; <span class="number">0</span> ? <span class="string">&quot;YES&quot;</span> : <span class="string">&quot;NO&quot;</span>) &lt;&lt; endl;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">4</span>) &#123;</span><br><span class="line">                cout &lt;&lt; <span class="built_in">prefixNumber</span>(word) &lt;&lt; endl;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ACè‡ªåŠ¨æœº"><a href="#ACè‡ªåŠ¨æœº" class="headerlink" title="ACè‡ªåŠ¨æœº"></a>ACè‡ªåŠ¨æœº</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P3796</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e4</span>;</span><br><span class="line"><span class="type">int</span> cnt1;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">fail1</span><span class="params">(N)</span></span>;</span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">tree1</span>(N, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(<span class="number">26</span>,<span class="number">0</span>));</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">end1</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">times1</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(N)</span></span>; <span class="comment">// BFSé˜Ÿåˆ—å®ç°</span></span><br><span class="line"><span class="comment">//  é“¾å¼å‰å‘æ˜Ÿ</span></span><br><span class="line"><span class="type">int</span> cnt2;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">next1</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">to</span><span class="params">(N)</span></span>;</span><br><span class="line">string s1;</span><br><span class="line"><span class="comment">// æ„å»ºå‰ç¼€æ ‘</span></span><br><span class="line"><span class="function">vector&lt;string&gt; <span class="title">F1</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="function">vector&lt;string&gt; <span class="title">s1</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">	string temp1;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, x; i &lt;= n; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; temp1;</span><br><span class="line">        s1[i] = temp1; </span><br><span class="line">        x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>, y; j &lt; temp1.<span class="built_in">size</span>(); j ++)&#123;</span><br><span class="line">            y = temp1[j] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span>(tree1[x][y] == <span class="number">0</span>)&#123;</span><br><span class="line">                tree1[x][y] = ++cnt1;</span><br><span class="line">            &#125;</span><br><span class="line">            x = tree1[x][y];</span><br><span class="line">        &#125;</span><br><span class="line">        end1[i] = x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ„å»ºè‡ªåŠ¨æœº</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">F2</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">// BFSéå†</span></span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    l = r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i ++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(tree1[<span class="number">0</span>][i] != <span class="number">0</span>)&#123;</span><br><span class="line">            v1[r++] = tree1[<span class="number">0</span>][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> u;</span><br><span class="line">    <span class="keyword">while</span>(l &lt; r)&#123;</span><br><span class="line">        u = v1[l ++];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i ++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(tree1[u][i] == <span class="number">0</span>)&#123;</span><br><span class="line">                tree1[u][i] = tree1[fail1[u]][i];</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                fail1[tree1[u][i]] = tree1[fail1[u]][i];</span><br><span class="line">                v1[r ++] = tree1[u][i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åå‘å»ºå›¾</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">    next1[++cnt2] = head[u];</span><br><span class="line">    head[u] = cnt2;</span><br><span class="line">    to[cnt2] = v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç»Ÿè®¡æ¬¡æ•°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">F3</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e = head[x]; e &gt; <span class="number">0</span>; e = next1[e])&#123;</span><br><span class="line">        <span class="built_in">F3</span>(to[e]);</span><br><span class="line">        times1[x] += times1[to[e]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; i ++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">26</span>; j ++)&#123;</span><br><span class="line">			tree1[i][j] = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	cnt2 = cnt1 = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">fill</span>(head.<span class="built_in">begin</span>(), head.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">	<span class="built_in">fill</span>(times1.<span class="built_in">begin</span>(), times1.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">	<span class="built_in">fill</span>(fail1.<span class="built_in">begin</span>(), fail1.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">build</span>();</span><br><span class="line">    vector&lt;string&gt; ss = <span class="built_in">F1</span>();</span><br><span class="line">    <span class="built_in">F2</span>();</span><br><span class="line">    cin &gt;&gt; s1;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, u = <span class="number">0</span>; i &lt; s1.<span class="built_in">size</span>(); i ++)&#123;</span><br><span class="line">        u = tree1[u][s1[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        times1[u] ++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt1; i ++)&#123;</span><br><span class="line">        <span class="built_in">add1</span>(fail1[i], i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">F3</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> max1 = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(times1[end1[i]] &gt; max1)&#123;</span><br><span class="line">        	max1 = times1[end1[i]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; max1 &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    	<span class="keyword">if</span>(times1[end1[i]] == max1)&#123;</span><br><span class="line">    		cout &lt;&lt; ss[i] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">while</span>(n)&#123;</span><br><span class="line">    	<span class="built_in">solve</span>();</span><br><span class="line">    	cin &gt;&gt; n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å­—ç¬¦ä¸²å“ˆå¸Œ"><a href="#å­—ç¬¦ä¸²å“ˆå¸Œ" class="headerlink" title="å­—ç¬¦ä¸²å“ˆå¸Œ"></a>å­—ç¬¦ä¸²å“ˆå¸Œ</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P3370</span></span><br><span class="line"><span class="comment">// åˆ©ç”¨è´¨æ•°è¿›åˆ¶ä¿¡æ¯</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long </span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="type">int</span> base = <span class="number">39127</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">v</span><span class="params">(<span class="type">char</span> c)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ans;</span><br><span class="line">	<span class="keyword">if</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; <span class="string">&#x27;9&#x27;</span> &gt;= c)&#123;</span><br><span class="line">		ans = c - <span class="string">&#x27;0&#x27;</span> + <span class="number">1</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&#x27;a&#x27;</span> &lt;= c &amp;&amp; <span class="string">&#x27;z&#x27;</span> &gt;= c)&#123;</span><br><span class="line">		ans = c - <span class="string">&#x27;a&#x27;</span> + <span class="number">11</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		ans = c - <span class="string">&#x27;A&#x27;</span> + <span class="number">37</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åŠ é€Ÿè¿›åˆ¶</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F</span><span class="params">(string s)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ans = <span class="built_in">v</span>(s[<span class="number">0</span>]);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; s.<span class="built_in">size</span>(); i ++)&#123;</span><br><span class="line">		ans = ans * base + <span class="built_in">v</span>(s[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin &gt;&gt; n;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(n)</span></span>;</span><br><span class="line">	string s;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++)&#123;</span><br><span class="line">		cin &gt;&gt; s;</span><br><span class="line">		v1[i] = <span class="built_in">F</span>(s);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">sort</span>(v1.<span class="built_in">begin</span>(), v1.<span class="built_in">end</span>());</span><br><span class="line">	<span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i ++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(v1[i] != v1[i - <span class="number">1</span>])&#123;</span><br><span class="line">			ans ++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// https://www.luogu.com.cn/record/204776127</span></span><br><span class="line"><span class="comment">// è¦æ±‚ä¸€æ®µåŒºé—´å†…çš„hashå€¼ï¼Œç”¨å‰ç¼€å’Œ</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">H</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp; hash, vector&lt;<span class="type">int</span>&gt; &amp; power, <span class="type">int</span> l, <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(l &gt; <span class="number">0</span>)&#123;</span><br><span class="line">		l = hash[l - <span class="number">1</span>] * power[r - l + <span class="number">1</span>]; </span><br><span class="line">	&#125;</span><br><span class="line">	r = hash[r];</span><br><span class="line">	<span class="keyword">return</span> r - l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve2</span><span class="params">()</span></span>&#123;</span><br><span class="line">	string s1, s2;</span><br><span class="line">	cin &gt;&gt; s1 &gt;&gt; s2;	</span><br><span class="line">	<span class="type">int</span> n = s1.<span class="built_in">size</span>(), m = s2.<span class="built_in">size</span>();</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">hash1</span><span class="params">(n)</span>, <span class="title">hash2</span><span class="params">(m)</span>, <span class="title">power</span><span class="params">(max(n, m))</span></span>;</span><br><span class="line">	power[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; power.<span class="built_in">size</span>(); i ++)&#123;</span><br><span class="line">		power[i] = power[i - <span class="number">1</span>] * base;</span><br><span class="line">	&#125;	</span><br><span class="line">	hash1[<span class="number">0</span>] = s1[<span class="number">0</span>] - <span class="string">&#x27;A&#x27;</span> + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i ++)&#123;</span><br><span class="line">		hash1[i] = hash1[i - <span class="number">1</span>] * base + s1[i] - <span class="string">&#x27;A&#x27;</span> + <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	hash2[<span class="number">0</span>] = s2[<span class="number">0</span>] - <span class="string">&#x27;A&#x27;</span> + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; m; i ++)&#123;</span><br><span class="line">		hash2[i] = hash2[i - <span class="number">1</span>] * base + s2[i] - <span class="string">&#x27;A&#x27;</span> + <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> l1, l2, r1;</span><br><span class="line">	<span class="type">int</span> l, r, len, mid;</span><br><span class="line">	<span class="type">int</span> k;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n - m; i ++)&#123;</span><br><span class="line">		l1 = i, r1 = i + m - <span class="number">1</span>;</span><br><span class="line">		k = <span class="number">0</span>;</span><br><span class="line">		l2 = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(l1 &lt;= r1 &amp;&amp; k &lt;= <span class="number">3</span>)&#123;</span><br><span class="line">			l = l1, r = r1;</span><br><span class="line">			len = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">				mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">H</span>(hash1, power, l1, mid) == <span class="built_in">H</span>(hash2, power, l2, l2 + mid - l1))&#123;</span><br><span class="line">					len = mid - l1 + <span class="number">1</span>;</span><br><span class="line">					l = mid + <span class="number">1</span>;</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					r = mid - <span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(l1 + len &lt;= r1)&#123;</span><br><span class="line">				k ++;</span><br><span class="line">				l1 += len + <span class="number">1</span>;</span><br><span class="line">				l2 += len + <span class="number">1</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(k &lt;= <span class="number">3</span>)&#123;</span><br><span class="line">			ans ++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¼‚æˆ–å“ˆå¸Œ"><a href="#å¼‚æˆ–å“ˆå¸Œ" class="headerlink" title="å¼‚æˆ–å“ˆå¸Œ"></a>å¼‚æˆ–å“ˆå¸Œ</h3><p>é¢˜ç›®å¤§æ¦‚æè¿°ï¼šç»™å®šä¸€ä¸ªæ•°å­—åºåˆ—aï¼Œè¯·ä½ æ‰¾å‡ºæœ€é•¿çš„è¿ç»­å­åŒºé—´ï¼Œä½¿å¾—è¿™ä¸ªå­åŒºé—´å†…æ‰€æœ‰æ•°å­—çš„ä¹˜ç§¯æ˜¯ä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°ã€‚å¦‚æœå­˜åœ¨å¤šä¸ªé•¿åº¦ç›¸åŒçš„å­åŒºé—´ï¼Œé€‰æ‹©æœ€é å·¦çš„ä¸€ä¸ªã€‚</p>
<p>å®Œå…¨å¹³æ–¹æ•°å¯ä»¥å·®åˆ†ä¸ºè´¨å› æ•°ä¹˜ç§¯ï¼Œä¸”æ‰€æœ‰è´¨å› æ•°çš„ä¸ªæ•°å‡ä¸ºå¶æ•°ã€‚</p>
<p>æ•…æŠŠæ¯ä¸€ä¸ªæ•°çš„å€¼æ”¹ä¸ºè½å•è´¨å› æ•°çš„å“ˆå¸Œå€¼ï¼Œå¦‚æœæŸä¸€ä¸ªåŒºé—´çš„å¼‚æˆ–å€¼ä¸º0ï¼Œå°±è¯´æ˜è¯¥åŒºé—´çš„è´¨å› æ•°éƒ½æ˜¯å¶æ•°ï¼Œè¯´æ˜ä¹˜ç§¯æ˜¯ä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°ï¼Œåˆ©ç”¨å‰ç¼€å’Œæ€æƒ³å¯ä»¥åŠ é€Ÿè¿™ä¸€æŸ¥æ‰¾è¿‡ç¨‹ï¼ˆå½“ä¸€ä¸ªçŠ¶æ€ç¬¬ä¸€æ¬¡å‡ºç°æ—¶ï¼Œè®°å½•ä½ç½®ï¼Œä»¥åæ¯æ¬¡å‡ºç°éƒ½è¯´æ˜ä¸­é—´ä¸ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®çš„é—´éš”ä¸ºä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°ï¼‰ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> ull = <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="function">mt19937_64 <span class="title">rng</span><span class="params">(chrono::steady_clock::now().time_since_epoch().count())</span></span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1e6</span> + <span class="number">1</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">spf</span><span class="params">(N)</span></span>; <span class="comment">// æœ€å°è´¨å› å­</span></span><br><span class="line"><span class="function">vector&lt;ull&gt; <span class="title">prime_hash</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">init</span><span class="params">()</span> </span>= [&amp;]()&#123;</span><br><span class="line">	<span class="built_in">iota</span>(spf.<span class="built_in">begin</span>(), spf.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt; N; i ++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(spf[i] == i)&#123;</span><br><span class="line">            prime_hash[i] = <span class="built_in">rng</span>();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = i &lt;&lt; <span class="number">1</span>; j &lt; N; j += i)&#123;</span><br><span class="line">                <span class="keyword">if</span>(spf[j] == j)&#123;</span><br><span class="line">                    spf[j] = i;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ ¹æ®æœ€å°è´¨å› å­æ±‚æŸä¸€ä¸ªæ•°çš„hashå€¼</span></span><br><span class="line"><span class="keyword">auto</span> get_hash = [&amp;](<span class="type">int</span> x) -&gt; ull &#123;</span><br><span class="line">    ull ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(x &gt; <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="type">int</span> p = spf[x];</span><br><span class="line">        <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(x % p == <span class="number">0</span>)&#123;</span><br><span class="line">            x /= p;</span><br><span class="line">            cnt ^= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(cnt &amp; <span class="number">1</span>)&#123;</span><br><span class="line">            ans ^= prime_hash[p];		</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">cin &gt;&gt; t;</span><br><span class="line"><span class="keyword">while</span>(t --)&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;ull&gt; <span class="title">pref</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    pref[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; v1[i];</span><br><span class="line">        pref[i] = pref[i - <span class="number">1</span>] ^ <span class="built_in">get_hash</span>(v1[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    unordered_map&lt;ull,<span class="type">int</span>&gt; pos;</span><br><span class="line">    pos[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>, l = <span class="number">-1</span>, r = <span class="number">-1</span>;</span><br><span class="line">    ull x;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">        x = pref[i];</span><br><span class="line">        <span class="keyword">if</span>(pos.<span class="built_in">count</span>(x))&#123;</span><br><span class="line">            <span class="keyword">if</span>(i - pos[x] &gt; ans)&#123;</span><br><span class="line">                ans = i - pos[x];</span><br><span class="line">                l = pos[x] + <span class="number">1</span>, r = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            pos[x] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; l &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; r &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;   </span><br></pre></td></tr></table></figure>
<h3 id="è´¨æ•°-ç´ æ•°"><a href="#è´¨æ•°-ç´ æ•°" class="headerlink" title="è´¨æ•°/ç´ æ•°"></a>è´¨æ•°/ç´ æ•°</h3><h4 id="è´¨æ•°åˆ¤åˆ«"><a href="#è´¨æ•°åˆ¤åˆ«" class="headerlink" title="è´¨æ•°åˆ¤åˆ«"></a>è´¨æ•°åˆ¤åˆ«</h4><p>Miller Rabinçš„æ—¶é—´å¤æ‚åº¦ä¸º$O(log\ n)^{3}$.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// æ™®é€šåˆ¤åˆ«æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">p</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (n &lt;= <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> n &gt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n % <span class="number">6</span> != <span class="number">1</span> &amp;&amp; n % <span class="number">6</span> != <span class="number">5</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> sqrt1 = (<span class="type">int</span>) <span class="built_in">sqrt</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">5</span>; i &lt;= sqrt1; i += <span class="number">6</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span> || n % (i + <span class="number">2</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Miller Rabin Primeåˆ¤åˆ«æ³•</span></span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="comment">// å¤§æ•°çš„æ—¶å€™ç”¨</span></span><br><span class="line"><span class="comment">//typedef __int128 ll;</span></span><br><span class="line">vector&lt;ll&gt; primes = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">37</span>&#125;;</span><br><span class="line"><span class="function">ll <span class="title">power</span><span class="params">(ll base, ll exp, ll mod)</span> </span>&#123;</span><br><span class="line">    ll result = <span class="number">1</span>;</span><br><span class="line">    base %= mod;</span><br><span class="line">    <span class="keyword">while</span> (exp &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (exp &amp; <span class="number">1</span>) result = (result * base) % mod;</span><br><span class="line">        base = (base * base) % mod;</span><br><span class="line">        exp &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">witness</span><span class="params">(ll a, ll n)</span> </span>&#123;</span><br><span class="line">    ll u = n - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ((u &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        t++;</span><br><span class="line">        u &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll x = <span class="built_in">power</span>(a, u, n);</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="number">1</span> || x == n - <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; t - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        x = (x * x) % n;</span><br><span class="line">        <span class="keyword">if</span> (x == n - <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">millerRabin</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (n % <span class="number">2</span> == <span class="number">0</span>) <span class="keyword">return</span> n == <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> (ll p : primes) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p &gt;= n) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">witness</span>(p, n)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="çº¿æ€§è´¨æ•°ç­›"><a href="#çº¿æ€§è´¨æ•°ç­›" class="headerlink" title="çº¿æ€§è´¨æ•°ç­›"></a>çº¿æ€§è´¨æ•°ç­›</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è´¨æ•°ç­›</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">F1</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i * i &lt;= x; i ++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(x % i != <span class="number">0</span>)&#123;</span><br><span class="line">			v1.<span class="built_in">push_back</span>(i);</span><br><span class="line">			<span class="keyword">while</span>(x % i == <span class="number">0</span>) x /= i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">if</span>(x &gt; <span class="number">1</span>) v1.<span class="built_in">push_back</span>(x); </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ±‚æ•°å€¼å°äºç­‰äºnçš„è´¨æ•°çš„ä¸ªæ•°,</span></span><br><span class="line"><span class="comment">// è´¨æ•°ç­›-åŸƒæ°ç­›</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">  	cin &gt;&gt; n;</span><br><span class="line">  	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">	v[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  	<span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= <span class="built_in">sqrt</span>(n); i++)&#123;</span><br><span class="line">		<span class="keyword">if</span> (v[i] == <span class="number">0</span>)&#123;</span><br><span class="line">	    	<span class="keyword">for</span> (<span class="type">int</span> j = i + i; j &lt;= n; j += i) v[j] = <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">  	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    	<span class="keyword">if</span> (!v[i]) cnt++;</span><br><span class="line">  	&#125;</span><br><span class="line">  	cout &lt;&lt; cnt &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åªæ˜¯è®¡æ•°çš„è¯ï¼ŒåŸƒæ°ç­›è¿˜èƒ½æ”¹è¿›</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ehrlich2</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">visit</span><span class="params">(n + <span class="number">1</span>, <span class="literal">false</span>)</span></span>;</span><br><span class="line">    <span class="type">int</span> cnt = (n + <span class="number">1</span>) / <span class="number">2</span>; <span class="comment">// ä¼°è®¡è´¨æ•°æ•°é‡(å¥‡æ•°)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">3</span>; i * i &lt;= n; i += <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!visit[i]) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = i * i; j &lt;= n; j += <span class="number">2</span> * i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!visit[j]) &#123;</span><br><span class="line">                    visit[j] = <span class="literal">true</span>;</span><br><span class="line">                    cnt--;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä½¿ç”¨çº¿æ€§ç­›æ³•è®¡ç®—æ¯ä¸ªæ•°å­—çš„æœ€å°è´¨å› å­ `spf`ï¼ˆsmallest prime factorï¼‰</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1e6</span> + <span class="number">1</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">spf</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">init</span><span class="params">()</span> </span>= [&amp;]()&#123;</span><br><span class="line">	<span class="built_in">iota</span>(spf.<span class="built_in">begin</span>(), spf.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt; N; i ++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(spf[i] == i)&#123;</span><br><span class="line">            prime_hash[i] = <span class="built_in">rng</span>();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = i &lt;&lt; <span class="number">1</span>; j &lt; N; j += i)&#123;</span><br><span class="line">                <span class="keyword">if</span>(spf[j] == j)&#123;</span><br><span class="line">                    spf[j] = i;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¬§æ‹‰ç­›æ—¶é—´å¤æ‚åº¦O(n)</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">euler</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">visit</span><span class="params">(n + <span class="number">1</span>, <span class="literal">false</span>)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">prime</span><span class="params">(n / <span class="number">2</span> + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!visit[i]) &#123;</span><br><span class="line">            prime[cnt++] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; cnt; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i * prime[j] &gt; n) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            visit[i * prime[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % prime[j] == <span class="number">0</span>) &#123;</span><br><span class="line">    			<span class="comment">// ä¿è¯æ¯ä¸ªåˆæ•°åªè¢«æœ€å°çš„è´¨æ•°éå†ä¸€æ¬¡</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Pickå®šç†"><a href="#Pickå®šç†" class="headerlink" title="Pickå®šç†"></a>Pickå®šç†</h3><p><code>S = i + b / 2 - 1</code></p>
<p><code>S</code>ï¼šå›¾å½¢çš„é¢ç§¯ï¼ˆå¯ä»¥æ˜¯å®æ•°ï¼‰ï¼›</p>
<p><code>i</code>ï¼šå›¾å½¢å†…éƒ¨çš„æ ¼ç‚¹æ•°ï¼›</p>
<p><code>b</code>ï¼šå›¾å½¢è¾¹ç•Œä¸Šçš„æ ¼ç‚¹æ•°ï¼ˆåŒ…æ‹¬é¡¶ç‚¹ï¼‰ï¼›</p>
<p>ç»™å®šä¸¤ä¸ªæ•´æ•°ç‚¹<code>(x1, y1), (y1, y2)</code>,  ä¸¤ç‚¹é—´ï¼ˆåŒ…æ‹¬ç«¯ç‚¹)çš„æ ¼ç‚¹æ•°ä¸º<code>gcd(|x2 - x1|, |y2 - y1|) + 1</code></p>
<p>åˆ™æ±‚æŸåŒºåŸŸå†…çš„æ ¼ç‚¹æ•°çš„æ–¹æ³•ä¸º<code>i = S âˆ’ 2 / b + 1</code></p>
<h3 id="å·®åˆ†"><a href="#å·®åˆ†" class="headerlink" title="å·®åˆ†"></a>å·®åˆ†</h3><p>å¯¹åŒºé—´è¿›è¡Œå¿«é€ŸåŠ æ³•æ“ä½œ</p>
<h4 id="ä¸€ç»´-1"><a href="#ä¸€ç»´-1" class="headerlink" title="ä¸€ç»´"></a>ä¸€ç»´</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è‹¥æœ‰åŸæ•°ç»„åˆ™è¦åˆ†å¼€å¤„ç†ï¼Œæœ€ååŠ ä¸ŠåŸæ•°ç»„æˆ–è€…è¿›è¡Œä»¥ä¸‹å¤„ç†</span></span><br><span class="line">v[i] = original[i] - original[i - <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, vector&lt;<span class="type">int</span>&gt; &amp; v)</span></span>&#123;</span><br><span class="line">	v[l] += x;</span><br><span class="line">	v[r + <span class="number">1</span>] -= x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    v[i] += v[i - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="äºŒç»´-1"><a href="#äºŒç»´-1" class="headerlink" title="äºŒç»´"></a>äºŒç»´</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å’ŒåŸæ•°ç»„åˆ†å¼€å¤„ç†ï¼Œæœ€ååŠ ä¸ŠåŸæ•°ç»„ï¼Œæˆ–è€…è¿›è¡Œä»¥ä¸‹å¤„ç†</span></span><br><span class="line">v[i][j] = a[i][j] - a[i - <span class="number">1</span>][j] - a[i][j - <span class="number">1</span>] + a[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2, <span class="type">int</span> val, vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; v)</span></span>&#123;</span><br><span class="line">	v[x1][y1] += val;</span><br><span class="line">    v[x2 + <span class="number">1</span>][y1] -= val;</span><br><span class="line">    v[x1][y2 + <span class="number">1</span>] -= val;</span><br><span class="line">    v[x2 + <span class="number">1</span>][y2 + <span class="number">1</span>] += val;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ç‰¹æ®Šå·®åˆ†"><a href="#ç‰¹æ®Šå·®åˆ†" class="headerlink" title="ç‰¹æ®Šå·®åˆ†"></a>ç‰¹æ®Šå·®åˆ†</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">2</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(N)</span>, <span class="title">v2</span><span class="params">(N)</span>, <span class="title">v3</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// ios::sync_with_stdio(false);</span></span><br><span class="line">	<span class="comment">// cin.tie(nullptr);</span></span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>, &amp;t);</span><br><span class="line">	<span class="keyword">while</span>(t --) &#123;</span><br><span class="line">		<span class="type">int</span> n, m;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%lld %lld&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">		<span class="built_in">fill</span>(v1.<span class="built_in">begin</span>(), v1.<span class="built_in">begin</span>() + <span class="number">1</span> + n, <span class="number">0</span>);</span><br><span class="line">		<span class="built_in">fill</span>(v2.<span class="built_in">begin</span>(), v2.<span class="built_in">begin</span>() + <span class="number">1</span> + n, <span class="number">0</span>);</span><br><span class="line">		<span class="built_in">fill</span>(v3.<span class="built_in">begin</span>(), v3.<span class="built_in">begin</span>() + <span class="number">1</span> + n, <span class="number">0</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, op, st; i &lt;= m; i ++) &#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%lld %lld&quot;</span>, &amp;op, &amp;st);</span><br><span class="line">			<span class="comment">// add (1 1 1 1 1 1)</span></span><br><span class="line">			v1[st] ++;</span><br><span class="line">			<span class="comment">// add (1 2 3 4 5 6)</span></span><br><span class="line">			<span class="keyword">if</span>(op == <span class="number">2</span>) v2[st + <span class="number">1</span>] ++;</span><br><span class="line">			<span class="comment">// add (1 4 9 16 25 36)</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">3</span>) v2[st + <span class="number">1</span>] += <span class="number">3</span>, v3[st + <span class="number">2</span>] += <span class="number">2</span>; </span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line">			v3[i] = (v3[i - <span class="number">1</span>] + v3[i]) % mod;</span><br><span class="line">			v2[i] = (v2[i] + v2[i - <span class="number">1</span>] + v3[i]) % mod;</span><br><span class="line">			v1[i] = (v1[i] + v1[i - <span class="number">1</span>] + v2[i]) % mod;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>, v1[i]);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">  	<span class="keyword">return</span> <span class="number">0</span>; 	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="åºåˆ—-æ•°ç»„é—®é¢˜"><a href="#åºåˆ—-æ•°ç»„é—®é¢˜" class="headerlink" title="åºåˆ—/æ•°ç»„é—®é¢˜"></a>åºåˆ—/æ•°ç»„é—®é¢˜</h3><h4 id="æœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆLCSï¼‰"><a href="#æœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆLCSï¼‰" class="headerlink" title="æœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆLCSï¼‰"></a>æœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆLCSï¼‰</h4><p>é€’å½’/é€’æ¨+è·¯å¾„</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// é€’å½’ç‰ˆ</span></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">string s1, s2;</span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">dp</span>(<span class="number">1001</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(<span class="number">1001</span>, <span class="number">-1</span>));</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F1</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(i == n || j == n)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(dp[i][j] != <span class="number">-1</span>) <span class="keyword">return</span> dp[i][j];</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(s1[i] == s2[j])&#123;</span><br><span class="line">            ans = <span class="built_in">max</span>(&#123;<span class="built_in">F1</span>(i + <span class="number">1</span>, j + <span class="number">1</span>) + <span class="number">1</span>, <span class="built_in">F1</span>(i + <span class="number">1</span>, j), <span class="built_in">F1</span>(i , j + <span class="number">1</span>)&#125;);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            ans = <span class="built_in">max</span>(<span class="built_in">F1</span>(i + <span class="number">1</span>, j), <span class="built_in">F1</span>(i, j + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        dp[i][j] = ans;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é€’æ¨ç‰ˆ</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">F2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    string s1, s2;</span><br><span class="line">    cin &gt;&gt; s1 &gt;&gt; s2;</span><br><span class="line">    <span class="type">int</span> n = s1.<span class="built_in">size</span>(), m = s2.<span class="built_in">size</span>();</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">dp</span>(n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(m + <span class="number">1</span>, <span class="number">0</span>));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j ++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s1[i - <span class="number">1</span>] == s2[ j - <span class="number">1</span>])&#123;</span><br><span class="line">                dp[i][j] = dp[i - <span class="number">1</span>][j - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                dp[i][j] = <span class="built_in">max</span>(dp[i - <span class="number">1</span>][j], dp[i][ j - <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ±‚è·¯å¾„</span></span><br><span class="line">    string s;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = n, j = m; i &amp;&amp; j;)&#123;</span><br><span class="line">    	<span class="keyword">if</span>(s1[i - <span class="number">1</span>] == s2[j - <span class="number">1</span>])&#123;</span><br><span class="line">    		s += s1[i - <span class="number">1</span>];</span><br><span class="line">    		i --;</span><br><span class="line">    		j --;</span><br><span class="line">    	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    		<span class="keyword">if</span>(dp[i - <span class="number">1</span>][j] &gt; dp[i][j - <span class="number">1</span>]) i --;</span><br><span class="line">    		<span class="keyword">else</span> j --;</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(s.<span class="built_in">size</span>() == <span class="number">0</span>)&#123;</span><br><span class="line">    	cout &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, j = s.<span class="built_in">size</span>() - <span class="number">1</span>; i &lt; j; i ++, j --) <span class="built_in">swap</span>(s[i], s[j]);</span><br><span class="line">    cout &lt;&lt; s &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="æœ€é•¿é€’å¢å­åºåˆ—"><a href="#æœ€é•¿é€’å¢å­åºåˆ—" class="headerlink" title="æœ€é•¿é€’å¢å­åºåˆ—"></a>æœ€é•¿é€’å¢å­åºåˆ—</h4><p>ä¸¤ä¸ªåºåˆ—åŒ…å«å®Œå…¨ç›¸åŒçš„æ•°å­—ä½¿ï¼Œå¯ä»¥å°†ä¸€ä¸ªæ•°ç»„çš„é¡ºåºæ˜ å°„åˆ°å¦ä¸€ä¸ªæ•°ç»„ä¸Šï¼Œè¿™æ—¶å…¶æœ€é•¿å…¬å…±å­åºåˆ—å˜æˆæ±‚æœ€é•¿é€’å¢å­åºåˆ—é—®é¢˜ï¼ˆæˆ–è€…åå‘æ±‚æœ€é•¿é€’å‡å­åºåˆ—ï¼‰</p>
<h5 id="æ™®é€šç‰ˆ"><a href="#æ™®é€šç‰ˆ" class="headerlink" title="æ™®é€šç‰ˆ"></a>æ™®é€šç‰ˆ</h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F1</span><span class="params">(<span class="type">int</span> x, vector&lt;<span class="type">int</span>&gt; &amp; v)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> r = v.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">-1</span>;</span><br><span class="line">    <span class="type">int</span> mid;</span><br><span class="line">    <span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(x &lt; v[mid]) l = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            r = mid - <span class="number">1</span>;</span><br><span class="line">            ans = mid;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v2</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">temp</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, x; i &lt;= n; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">        temp[x] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n ; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; v2[i];  </span><br><span class="line">        v2[i] = temp[v2[i]];</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = n, x; i; i --)&#123;</span><br><span class="line">        x = <span class="built_in">F1</span>(v2[i], ans);</span><br><span class="line">        <span class="keyword">if</span>(x == <span class="number">-1</span>)&#123;</span><br><span class="line">            ans.<span class="built_in">push_back</span>(v2[i]);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            ans[x] = v2[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="å­—å…¸åºæœ€å°ç‰ˆ"><a href="#å­—å…¸åºæœ€å°ç‰ˆ" class="headerlink" title="å­—å…¸åºæœ€å°ç‰ˆ"></a>å­—å…¸åºæœ€å°ç‰ˆ</h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F1</span><span class="params">(<span class="type">int</span> x, vector&lt;<span class="type">int</span>&gt; &amp; v)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ans = <span class="number">-1</span>;</span><br><span class="line">	<span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> r = v.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">	<span class="type">int</span> mid;</span><br><span class="line">	<span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">		mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(x &lt; v[mid])&#123;</span><br><span class="line">			l = mid + <span class="number">1</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			r = mid - <span class="number">1</span>;</span><br><span class="line">			ans = mid;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">	cout.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin &gt;&gt; n;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span>&amp; x : v1) cin &gt;&gt; x;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v2;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dp</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = n - <span class="number">1</span>, ans; i &gt;= <span class="number">0</span>; i --)&#123;</span><br><span class="line">		ans = <span class="built_in">F1</span>(v1[i], v2);</span><br><span class="line">		<span class="keyword">if</span>(ans == <span class="number">-1</span>)&#123;</span><br><span class="line">			v2.<span class="built_in">push_back</span>(v1[i]);</span><br><span class="line">			dp[i] = v2.<span class="built_in">size</span>();</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			v2[ans] = v1[i];</span><br><span class="line">			dp[i] = ans + <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">int</span> m = v2.<span class="built_in">size</span>();</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">ans</span><span class="params">(m, <span class="number">1e9</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> x : dp) cout &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, x; i &lt; n; i ++)&#123;</span><br><span class="line">		x = dp[i];</span><br><span class="line">		<span class="keyword">if</span>(x == m) ans[<span class="number">0</span>] = v1[i];</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(ans[m - x - <span class="number">1</span>] &lt; v1[i])&#123;</span><br><span class="line">				ans[m - x] = v1[i];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i ++)&#123;</span><br><span class="line">		cout &lt;&lt; ans[i];</span><br><span class="line">		<span class="keyword">if</span>(i != m) cout &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ç´¯åŠ å’Œä¸å¤§äºkçš„æœ€é•¿å­æ•°ç»„"><a href="#ç´¯åŠ å’Œä¸å¤§äºkçš„æœ€é•¿å­æ•°ç»„" class="headerlink" title="ç´¯åŠ å’Œä¸å¤§äºkçš„æœ€é•¿å­æ•°ç»„"></a>ç´¯åŠ å’Œä¸å¤§äºkçš„æœ€é•¿å­æ•°ç»„</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="type">int</span> k;</span><br><span class="line">	cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(n, <span class="number">0</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> &amp; x : v1) cin &gt;&gt; x;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">min1</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">minend</span><span class="params">(n)</span></span>;</span><br><span class="line">	min1[n - <span class="number">1</span>] = v1[n - <span class="number">1</span>];</span><br><span class="line">	minend[n - <span class="number">1</span>] = n - <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = n - <span class="number">2</span>; i &gt;= <span class="number">0</span>; i --)&#123;</span><br><span class="line">		<span class="keyword">if</span>(min1[i + <span class="number">1</span>] &lt;= <span class="number">0</span>)&#123;</span><br><span class="line">			min1[i] = v1[i] + min1[i + <span class="number">1</span>];</span><br><span class="line">			minend[i] = minend[i + <span class="number">1</span>];</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			min1[i] = v1[i];</span><br><span class="line">			minend[i] = i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, sum1 = <span class="number">0</span>, r = <span class="number">0</span>; i &lt; n; i ++)&#123;</span><br><span class="line">		<span class="keyword">while</span>(r &lt; n  &amp;&amp; sum1 + min1[r] &lt;= k)&#123;</span><br><span class="line">			sum1 += min1[r];</span><br><span class="line">			r = minend[r] + <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(r &gt; i)&#123;</span><br><span class="line">			ans = <span class="built_in">max</span>(ans, r - i);</span><br><span class="line">			sum1 -= v1[i];</span><br><span class="line">		&#125;<span class="keyword">else</span> r = i + <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="DP"><a href="#DP" class="headerlink" title="DP"></a>DP</h3><h4 id="æ•°ä½DP"><a href="#æ•°ä½DP" class="headerlink" title="æ•°ä½DP"></a>æ•°ä½DP</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ•°ä½dp https://www.luogu.com.cn/problem/P2602</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> d)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> cur, temp = n, l, r = <span class="number">1</span>; temp; r *= <span class="number">10</span>, temp /= <span class="number">10</span>)&#123;</span><br><span class="line">        cur = temp % <span class="number">10</span>;</span><br><span class="line">        l = temp / <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">if</span>(d == <span class="number">0</span>) l --;</span><br><span class="line">        ans += l * r;</span><br><span class="line">        <span class="keyword">if</span>(d &lt; cur)&#123;</span><br><span class="line">            ans += r;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(d == cur)&#123;</span><br><span class="line">            ans += n % r + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i ++)&#123;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">F</span>(r, i) - <span class="built_in">F</span>(l - <span class="number">1</span>, i);</span><br><span class="line">        <span class="keyword">if</span>(i != <span class="number">9</span>) cout &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P3413</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">is</span><span class="params">(string s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, j; i &lt; s.<span class="built_in">size</span>(); i ++)&#123;</span><br><span class="line">        j = i - <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>((j &gt;= <span class="number">0</span> &amp;&amp; s[j] == s[i]) || s[i] == s[i - <span class="number">1</span>]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç»Ÿè®¡0-nä¸­æ‰€æœ‰ä¸æ˜¯å›æ–‡æ•°çš„æ•° f1è¡¨ç¤ºæ˜¯å¦é€‰è¿‡æ•° f2è¡¨ç¤ºæ˜¯å¦å¯ä»¥ä»»æ„é€‰</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F</span><span class="params">(<span class="type">int</span> i1, string s, <span class="type">int</span> l, <span class="type">int</span> ll, <span class="type">bool</span> f1, <span class="type">bool</span> f2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(i1 == s.<span class="built_in">size</span>()) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(!f1)&#123;</span><br><span class="line">        ans = (ans + <span class="built_in">F</span>(i1 + <span class="number">1</span>, s, <span class="number">-1</span>, <span class="number">-1</span>, <span class="literal">false</span>, <span class="literal">true</span>)) % mod;</span><br><span class="line">        <span class="keyword">if</span>(!f2)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; s[i1] - <span class="string">&#x27;0&#x27;</span>; i ++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i != l &amp;&amp; i != ll)&#123;</span><br><span class="line">                    ans = (ans + <span class="built_in">F</span>(i1 + <span class="number">1</span>, s, i, l, <span class="literal">true</span>, <span class="literal">true</span>)) % mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(s[i1] - <span class="string">&#x27;0&#x27;</span> != l &amp;&amp; s[i1] - <span class="string">&#x27;0&#x27;</span> != ll) ans = (ans + <span class="built_in">F</span>(i1 + <span class="number">1</span>, s, s[i1] - <span class="string">&#x27;0&#x27;</span>, l, <span class="literal">true</span>, <span class="literal">false</span>)) % mod;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> sum = <span class="number">9</span>;</span><br><span class="line">            <span class="keyword">if</span>(++i1 != s.<span class="built_in">size</span>()) sum *= <span class="number">9</span>;</span><br><span class="line">            <span class="keyword">while</span>(++i1 &lt; s.<span class="built_in">size</span>())&#123;</span><br><span class="line">                sum = (sum * <span class="number">8</span>) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">            ans = (ans + sum) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!f2)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s[i1] - <span class="string">&#x27;0&#x27;</span>; i ++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i != l &amp;&amp; i != ll)&#123;</span><br><span class="line">                    ans = (ans + <span class="built_in">F</span>(i1 + <span class="number">1</span>, s, i, l, <span class="literal">true</span>, <span class="literal">true</span>)) % mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(s[i1] - <span class="string">&#x27;0&#x27;</span> != l &amp;&amp; s[i1] - <span class="string">&#x27;0&#x27;</span> != ll) ans = (ans + <span class="built_in">F</span>(i1 + <span class="number">1</span>, s, s[i1] - <span class="string">&#x27;0&#x27;</span>, l, <span class="literal">true</span>, <span class="literal">false</span>)) % mod;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> sum;</span><br><span class="line">            <span class="keyword">if</span>(ll == <span class="number">-1</span>)&#123;</span><br><span class="line">                sum = <span class="number">9</span>;</span><br><span class="line">                <span class="keyword">while</span>(++ i1 &lt; s.<span class="built_in">size</span>())&#123;</span><br><span class="line">                    sum = (sum * <span class="number">8</span>) % mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                sum = <span class="number">8</span>;</span><br><span class="line">                <span class="keyword">while</span>(++ i1 &lt; s.<span class="built_in">size</span>())&#123;</span><br><span class="line">                    sum = (sum * <span class="number">8</span>) % mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ans = (ans + sum) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç»Ÿè®¡0-nä¸­çš„æ‰€æœ‰æ•° f1è¡¨ç¤ºæ˜¯å¦é€‰è¿‡æ•° f2è¡¨ç¤ºæ˜¯å¦å¯ä»¥ä»»æ„é€‰</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F2</span><span class="params">(<span class="type">int</span> i1, string s, <span class="type">bool</span> f1, <span class="type">bool</span> f2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(i1 == s.<span class="built_in">size</span>()) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(!f1)&#123;</span><br><span class="line">        ans = (ans + <span class="built_in">F2</span>(i1 + <span class="number">1</span>, s, <span class="literal">false</span>, <span class="literal">true</span>)) % mod;</span><br><span class="line">        <span class="keyword">if</span>(!f2)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; s[i1] - <span class="string">&#x27;0&#x27;</span>; i ++)&#123;</span><br><span class="line">                ans = (ans + <span class="built_in">F2</span>(i1 + <span class="number">1</span>, s, <span class="literal">true</span>, <span class="literal">true</span>)) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">            ans = (ans + <span class="built_in">F2</span>(i1 + <span class="number">1</span>, s, <span class="literal">true</span>, <span class="literal">false</span>)) % mod;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> sum = <span class="number">9</span>; <span class="comment">// ä¸èƒ½ä¸ºé›¶</span></span><br><span class="line">            <span class="keyword">while</span>(++ i1 &lt; s.<span class="built_in">size</span>())&#123;</span><br><span class="line">                sum = (sum * <span class="number">10</span>) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">            ans = (ans + sum) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!f2)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s[i1] - <span class="string">&#x27;0&#x27;</span>; i ++)&#123;</span><br><span class="line">                ans = (ans + <span class="built_in">F2</span>(i1 + <span class="number">1</span>, s, <span class="literal">true</span>, <span class="literal">true</span>)) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">            ans = (ans + <span class="built_in">F2</span>(i1 + <span class="number">1</span>, s, <span class="literal">true</span>, <span class="literal">false</span>)) % mod;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> sum = <span class="number">10</span>; <span class="comment">// èƒ½ä¸ºé›¶</span></span><br><span class="line">            <span class="keyword">while</span>(++ i1 &lt; s.<span class="built_in">size</span>())&#123;</span><br><span class="line">                sum = (sum * <span class="number">10</span>) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">            ans = (ans + sum) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    string s1, s2;</span><br><span class="line">    cin &gt;&gt; s1 &gt;&gt; s2;</span><br><span class="line">    <span class="type">int</span> n1 = <span class="built_in">F</span>(<span class="number">0</span>, s1, <span class="number">-1</span>, <span class="number">-1</span>, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> n2 = <span class="built_in">F</span>(<span class="number">0</span>, s2, <span class="number">-1</span>, <span class="number">-1</span>, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> ans1 = (n2 - n1  + <span class="built_in">is</span>(s1) + mod) % mod;</span><br><span class="line">    <span class="type">int</span> n3 = <span class="built_in">F2</span>(<span class="number">0</span>, s1, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> n4 = <span class="built_in">F2</span>(<span class="number">0</span>, s2, <span class="literal">false</span> ,<span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> ans2 = (n4 - n3 + <span class="number">1</span> + mod) % mod;</span><br><span class="line">    cout &lt;&lt; (ans2 - ans1 + mod) % mod &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ ‘å½¢DP-1"><a href="#æ ‘å½¢DP-1" class="headerlink" title="æ ‘å½¢DP"></a>æ ‘å½¢DP</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// https://pintia.cn/problem-sets/1859417373569925120/exam/problems/type/7?problemSetProblemId=1859417373590896646</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">my</span>&#123;</span><br><span class="line">	<span class="type">int</span> w, b;</span><br><span class="line">	priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;&gt;&gt; qw, qb;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>) -&gt; ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--)&#123;</span><br><span class="line">    	<span class="type">int</span> n;</span><br><span class="line">    	cin &gt;&gt; n;</span><br><span class="line">    	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">color</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">val</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">root</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    	<span class="function">vector <span class="title">adj</span><span class="params">(n + <span class="number">1</span>, vector&lt;<span class="type">int</span>&gt;())</span></span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    		<span class="type">int</span> m;</span><br><span class="line">    		cin &gt;&gt; color[i] &gt;&gt; val[i] &gt;&gt; m;</span><br><span class="line">    		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j ++)&#123;</span><br><span class="line">    			<span class="type">int</span> v;</span><br><span class="line">    			cin &gt;&gt; v;</span><br><span class="line">    			adj[i].<span class="built_in">push_back</span>(v);</span><br><span class="line">    			root[v] --;</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// ä¼ å›å¯ä»¥è¢«æ”¹è‰²çš„èŠ‚ç‚¹</span></span><br><span class="line">		<span class="keyword">auto</span> F = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> u) -&gt; my &#123;</span><br><span class="line">			<span class="type">int</span> w1 = <span class="number">0</span>, b1 = <span class="number">0</span>;</span><br><span class="line">			priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;&gt;&gt; qw1, qb1;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">auto</span> v : adj[u])&#123;</span><br><span class="line">				my temp = <span class="built_in">f</span>(f, v);</span><br><span class="line">				w1 += temp.w;</span><br><span class="line">				b1 += temp.b;</span><br><span class="line">				<span class="keyword">while</span>(!temp.qw.<span class="built_in">empty</span>())&#123;</span><br><span class="line">					qw1.<span class="built_in">push</span>(temp.qw.<span class="built_in">top</span>());</span><br><span class="line">					temp.qw.<span class="built_in">pop</span>();</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">while</span>(!temp.qb.<span class="built_in">empty</span>())&#123;</span><br><span class="line">					qb1.<span class="built_in">push</span>(temp.qb.<span class="built_in">top</span>());</span><br><span class="line">					temp.qb.<span class="built_in">pop</span>();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// cout &lt;&lt; u &lt;&lt; &quot; &quot; &lt;&lt; w1 &lt;&lt; &quot; &quot; &lt;&lt; b1 &lt;&lt;  &quot;\n&quot;;</span></span><br><span class="line">			<span class="comment">// priority_queue&lt;int, vector&lt;int&gt;, greater&lt;&gt;&gt; q11 = qw1, q22 = qb1;</span></span><br><span class="line">			<span class="comment">// cout &lt;&lt; &quot;w: &quot;;</span></span><br><span class="line">			<span class="comment">// while(!q11.empty())&#123;</span></span><br><span class="line">				<span class="comment">// cout &lt;&lt; q11.top() &lt;&lt; &quot; &quot;;</span></span><br><span class="line">				<span class="comment">// q11.pop();</span></span><br><span class="line">			<span class="comment">// &#125;cout &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">			<span class="comment">// cout &lt;&lt; &quot;b: &quot;;</span></span><br><span class="line">			<span class="comment">// while(!q22.empty())&#123;</span></span><br><span class="line">				<span class="comment">// cout &lt;&lt; q22.top() &lt;&lt; &quot; &quot;;</span></span><br><span class="line">				<span class="comment">// q22.pop();</span></span><br><span class="line">			<span class="comment">// &#125;cout &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">			my temp;</span><br><span class="line">			priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;&gt;&gt; q1, q2;</span><br><span class="line">			temp.w = temp.b = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">if</span>(color[u] == <span class="number">0</span>)&#123;</span><br><span class="line">				temp.w ++;</span><br><span class="line">				q1.<span class="built_in">push</span>(val[u]);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				temp.b ++;</span><br><span class="line">				q2.<span class="built_in">push</span>(val[u]);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(w1 != b1)&#123;</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">abs</span>(w1 - b1) == <span class="number">1</span>)&#123;</span><br><span class="line">					<span class="keyword">if</span>(w1 &gt; b1)&#123;</span><br><span class="line">						q1.<span class="built_in">push</span>(qw1.<span class="built_in">top</span>());</span><br><span class="line">					&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">						q2.<span class="built_in">push</span>(qb1.<span class="built_in">top</span>());</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					<span class="keyword">while</span>(<span class="built_in">abs</span>(w1 - b1) &gt;= <span class="number">2</span>)&#123;</span><br><span class="line">						<span class="keyword">if</span>(w1 &gt; b1)&#123;</span><br><span class="line">							ans += qw1.<span class="built_in">top</span>();</span><br><span class="line">							qw1.<span class="built_in">pop</span>();</span><br><span class="line">							w1 --, b1 ++;</span><br><span class="line">						&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">							ans += qb1.<span class="built_in">top</span>();</span><br><span class="line">							qb1.<span class="built_in">pop</span>();</span><br><span class="line">							w1 --, b1 ++;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			temp.qw = q1, temp.qb = q2;</span><br><span class="line">			temp.w += w1, temp.b += b1;</span><br><span class="line">			<span class="keyword">return</span> temp;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(root[i] == <span class="number">0</span>)&#123;</span><br><span class="line">				<span class="built_in">F</span>(F, i);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">    	cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="åŒºé—´DP"><a href="#åŒºé—´DP" class="headerlink" title="åŒºé—´DP"></a>åŒºé—´DP</h4><p>ä¸€èˆ¬çš„åŒºé—´DPæ˜¯$O(n^{4})$å¤æ‚åº¦ï¼Œä½†å¯ä»¥åœ¨ç¬¬ä¸‰å±‚æ—¶é€šè¿‡æœç´¢ä¼˜åŒ–è¾¾åˆ°$O(n^{3}log\ n)$.</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://ac.nowcoder.com/acm/contest/108298/I</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>)-&gt;ios_base::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">	<span class="keyword">while</span>(t --)&#123;</span><br><span class="line">		<span class="type">int</span> n;</span><br><span class="line">		cin &gt;&gt; n;</span><br><span class="line">		<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">pre</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">		pre[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) cin &gt;&gt; v1[i], pre[i] = pre[i - <span class="number">1</span>] + v1[i];</span><br><span class="line">		<span class="function">vector <span class="title">dp</span><span class="params">(n + <span class="number">1</span>, vector(n + <span class="number">1</span>, vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;()))</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) dp[i][i].<span class="built_in">push_back</span>(&#123;<span class="number">0ll</span>, <span class="number">0ll</span>&#125;);</span><br><span class="line">		<span class="keyword">auto</span> get = [&amp;](<span class="type">int</span> x, vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt; &amp; v) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="type">int</span> l = <span class="number">0</span>, r = v.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">			<span class="type">int</span> mid, ans = <span class="number">-1</span>;</span><br><span class="line">			<span class="keyword">while</span>(l &lt;= r) &#123;</span><br><span class="line">				mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">if</span>(v[mid].sc &lt;= x) &#123;</span><br><span class="line">					ans = v[mid].fr;</span><br><span class="line">					l = mid + <span class="number">1</span>;</span><br><span class="line">				&#125; <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> ans;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> len = <span class="number">2</span>, dif, val_l, val_r, cost, cost_l, cost_r; len &lt;= n; len ++) &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> l = <span class="number">1</span>, r = l + len - <span class="number">1</span>; r &lt;= n; l ++, r ++) &#123;</span><br><span class="line">                <span class="comment">// ä¼˜åŒ–ä½ç½®</span></span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> k = l; k &lt; r; k ++) &#123;</span><br><span class="line">					val_l = pre[k] - pre[l - <span class="number">1</span>], val_r = pre[r] - pre[k];</span><br><span class="line">					dif = <span class="built_in">abs</span>(val_l - val_r);</span><br><span class="line">					<span class="type">int</span> cost = <span class="built_in">min</span>(val_l, val_r) * <span class="built_in">ceil</span>(<span class="built_in">log2</span>(val_l + val_r));</span><br><span class="line">                    <span class="comment">// å¿«é€Ÿæœç´¢</span></span><br><span class="line">					cost_l = <span class="built_in">get</span>(dif, dp[l][k]), cost_r = <span class="built_in">get</span>(dif, dp[k + <span class="number">1</span>][r]);</span><br><span class="line">					<span class="keyword">if</span>(len == n) &#123;</span><br><span class="line">						<span class="keyword">if</span>(cost_l == <span class="number">-1</span> || cost_r == <span class="number">-1</span>) cout &lt;&lt; <span class="string">&quot;-1 &quot;</span>;</span><br><span class="line">						<span class="keyword">else</span> cout &lt;&lt; cost_l + cost + cost_r &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">						<span class="keyword">continue</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">if</span>(cost_l == <span class="number">-1</span> || cost_r == <span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line">					dp[l][r].<span class="built_in">push_back</span>(&#123;cost_l + cost + cost_r, dif&#125;);</span><br><span class="line">				&#125;</span><br><span class="line">                <span class="comment">// ä¼˜åŒ–ç­–ç•¥</span></span><br><span class="line">				<span class="built_in">sort</span>(dp[l][r].<span class="built_in">begin</span>(), dp[l][r].<span class="built_in">end</span>(), [&amp;](<span class="type">const</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &amp; a, <span class="type">const</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; &amp; b)&#123;</span><br><span class="line">					<span class="keyword">if</span>(a.sc == b.sc) <span class="keyword">return</span> a.fr &lt; b.fr;</span><br><span class="line">					<span class="keyword">return</span> a.sc &lt; b.sc;</span><br><span class="line">				&#125;);</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; dp[l][r].<span class="built_in">size</span>(); i ++) dp[l][r][i].fr = <span class="built_in">min</span>(dp[l][r][i].fr, dp[l][r][i - <span class="number">1</span>].fr);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="çŠ¶å‹DP"><a href="#çŠ¶å‹DP" class="headerlink" title="çŠ¶å‹DP"></a>çŠ¶å‹DP</h4><h5 id="äºŒè¿›åˆ¶"><a href="#äºŒè¿›åˆ¶" class="headerlink" title="äºŒè¿›åˆ¶"></a>äºŒè¿›åˆ¶</h5><p>å½“çŠ¶æ€æ•°ä¸º2çš„å¹‚ï¼Œbaseä¸º$2^{n - 1}$</p>
<p>äºŒçŠ¶æ€</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">auto</span> set = [](<span class="type">int</span> x, <span class="type">int</span> i, <span class="type">int</span> val) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span>  x &amp; (~(<span class="number">1</span> &lt;&lt; i)) | (val &lt;&lt; i);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">auto</span> get = [](<span class="type">int</span> x, <span class="type">int</span> i) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">    <span class="built_in">return</span> (x &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>å››çŠ¶æ€</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">auto</span> set = [](<span class="type">int</span> x, <span class="type">int</span> i, <span class="type">int</span> val) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x &amp; (~(<span class="number">3</span> &lt;&lt; (i &lt;&lt; <span class="number">1</span>))) | (val &lt;&lt; (i &lt;&lt; <span class="number">1</span>));</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">auto</span> get = [](<span class="type">int</span> x, <span class="type">int</span> i) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">    <span class="built_in">return</span> (x &gt;&gt; (i &lt;&lt; <span class="number">1</span>)) &amp; <span class="number">3</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h5 id="ä¸‰è¿›åˆ¶"><a href="#ä¸‰è¿›åˆ¶" class="headerlink" title="ä¸‰è¿›åˆ¶"></a>ä¸‰è¿›åˆ¶</h5><p>å¯æ‰©å±•è‡³æ‰€æœ‰è¿›åˆ¶ï¼ŒçŠ¶æ€æ•°ä¸º$3^{n}$ï¼Œè½¬ç§»è‡³ä¸‹ä¸€ä½æ—¶bitè¦ä¹˜ä¸Šè¿›åˆ¶</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> sta, <span class="type">int</span> bit)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> sta / bit % <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">set</span><span class="params">(<span class="type">int</span> sta, <span class="type">int</span> bit, <span class="type">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sta - <span class="built_in">get</span>(sta, bit) * bit + val * bit;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>é€‚ç”¨åœºæ™¯</strong></p>
<ul>
<li>çŠ¶æ€ç©ºé—´å°ï¼ˆn â‰¤ 20ï¼‰ï¼Œç”¨ä½æ©ç ï¼ˆmaskï¼Œintç±»å‹ï¼‰è¡¨ç¤ºå­é›†ï¼ˆ$2^n$ â‰¤ 1&lt;&lt;20 â‰ˆ 1e6ï¼‰ã€‚</li>
<li>å¸¸è§é—®é¢˜ï¼šTSPï¼ˆæ—…è¡Œå•†ï¼‰ã€å­é›†å’Œ/è¦†ç›–ã€èƒŒåŒ…å˜ç§ã€å›¾åŒ¹é…ç­‰ã€‚</li>
<li>æ—¶é—´å¤æ‚åº¦ï¼šO($2^n <em> n^2$) æˆ– O($3^n$)ï¼ˆå­é›†æšä¸¾ï¼‰ï¼Œç©ºé—´ O($2^n </em> n$)ã€‚</li>
</ul>
<p><strong>æ ¸å¿ƒæ€è·¯</strong></p>
<ul>
<li><strong>çŠ¶æ€å®šä¹‰</strong>ï¼šdp[mask] æˆ– dp[mask][i]ï¼ˆmaskè¡¨ç¤ºå·²ç”¨å­é›†ï¼Œiè¡¨ç¤ºå½“å‰çŠ¶æ€å¦‚ä½ç½®ï¼‰ã€‚</li>
<li><strong>åˆå§‹åŒ–</strong>ï¼šdp[0] = 0;ï¼ˆç©ºé›†èµ·ç‚¹ï¼‰ï¼Œå…¶ä½™INFã€‚</li>
<li><strong>è½¬ç§»</strong>ï¼š<ul>
<li>æšä¸¾å­é›†ï¼šå¯¹æ¯ä¸ªmaskï¼Œæšä¸¾å­maskï¼ˆ<code>for(int sub = mask; sub; sub = (sub-1)&amp;mask</code>ï¼‰ã€‚</li>
<li>æˆ–DPé¡ºåºï¼šä»å°maskåˆ°å¤§maskã€‚</li>
</ul>
</li>
<li><strong>ä¼˜åŒ–</strong>ï¼šFWTï¼ˆå¿«é€Ÿæ²ƒå°”ä»€å˜æ¢ï¼‰ç”¨äºå·ç§¯ï¼›SOS DPç”¨äºå­é›†å’ŒæŸ¥è¯¢ã€‚</li>
</ul>
<p><strong>åŸºç¡€æ¨¡æ¿ï¼šTSP-likeï¼ˆdp[mask][u]ï¼‰</strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">20</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">1e18</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> dp[<span class="number">1</span>&lt;&lt;N][N];  <span class="comment">// dp[mask][u]: è®¿é—®maskå­é›†ï¼Œç»“æŸäºuçš„æœ€ä¼˜å€¼</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>); cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="comment">// è¾“å…¥ï¼šdist[i][j] ä¸º iåˆ°jçš„è¾¹æƒï¼ˆå®Œæ•´å›¾ï¼‰</span></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(dp));  <span class="comment">// å…¨INF</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) dp[<span class="number">1</span>&lt;&lt;i][i] = <span class="number">0</span>;  <span class="comment">// èµ·ç‚¹æ¯ä¸ªç‚¹</span></span><br><span class="line">    <span class="comment">// DP</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> mask = <span class="number">0</span>; mask &lt; (<span class="number">1</span>&lt;&lt;n); mask++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> u = <span class="number">0</span>; u &lt; n; u++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(dp[mask][u] &gt;= INF) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> v = <span class="number">0</span>; v &lt; n; v++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(mask &amp; (<span class="number">1</span>&lt;&lt;v)) <span class="keyword">continue</span>;  <span class="comment">// å·²è®¿é—®</span></span><br><span class="line">                <span class="type">int</span> nmask = mask | (<span class="number">1</span>&lt;&lt;v);</span><br><span class="line">                dp[nmask][v] = <span class="built_in">min</span>(dp[nmask][v], dp[mask][u] + dist[u][v]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç­”æ¡ˆï¼šmin over u dp[(1&lt;&lt;n)-1][u] + back to start</span></span><br><span class="line">    <span class="type">int</span> ans = INF;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> u = <span class="number">0</span>; u &lt; n; u++) ans = <span class="built_in">min</span>(ans, dp[(<span class="number">1</span>&lt;&lt;n)<span class="number">-1</span>][u]);</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>å˜ç§</strong>ï¼šèµ·ç‚¹å›ºå®šdp[1&lt;&lt;0][0] = 0;ï¼Œmaskä»0å¼€å§‹ã€‚</li>
<li><strong>å¤æ‚åº¦</strong>ï¼šO($2^n * n^2$)ã€‚</li>
</ul>
<p><strong>å­é›†æšä¸¾æ¨¡æ¿ï¼ˆSOS DPï¼‰</strong></p>
<p>ç”¨äºè®¡ç®—æ¯ä¸ªmaskçš„å­é›†å’Œ/æˆ–ã€‚<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é¢„å¤„ç†ï¼šå­é›†DPï¼ˆO(n * 2^n)ï¼‰</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sos_dp</span><span class="params">(<span class="type">int</span> f[<span class="number">1</span>&lt;&lt;N])</span> </span>&#123;  <span class="comment">// f[mask] æ›´æ–°ä¸º sum over sub of f[sub]</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> mask = <span class="number">0</span>; mask &lt; (<span class="number">1</span>&lt;&lt;n); mask++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(mask &amp; (<span class="number">1</span>&lt;&lt;i)) f[mask] += f[mask ^ (<span class="number">1</span>&lt;&lt;i)];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æšä¸¾maskçš„æ‰€æœ‰å­é›†ï¼ˆO(3^n)æ€»ï¼‰</span></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> mask = <span class="number">0</span>; mask &lt; (<span class="number">1</span>&lt;&lt;n); mask++) &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> sub = mask; sub &gt; <span class="number">0</span>; sub = (sub<span class="number">-1</span>) &amp; mask) &#123;</span><br><span class="line">        <span class="comment">// ç”¨subä½œä¸ºå­é›†</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// sub=0å•ç‹¬å¤„ç†</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li><strong>é€†æ“ä½œ</strong>ï¼šå‡æ³•ä»£æ›¿åŠ æ³•ã€‚</li>
</ul>
<p><strong>å•ç»´dp[mask]æ¨¡æ¿ï¼ˆå­é›†è¦†ç›–/å’Œï¼‰</strong></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> dp[<span class="number">1</span>&lt;&lt;N];  <span class="comment">// dp[mask]: maskå­é›†çš„æœ€ä¼˜å€¼ï¼ˆå¦‚æœ€å°æˆæœ¬è¦†ç›–ï¼‰</span></span><br><span class="line"><span class="built_in">memset</span>(dp, <span class="number">0x3f</span>, <span class="built_in">sizeof</span>(dp));</span><br><span class="line">dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> mask = <span class="number">0</span>; mask &lt; (<span class="number">1</span>&lt;&lt;n); mask++) &#123;</span><br><span class="line">    <span class="keyword">if</span>(dp[mask] &gt;= INF) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="comment">// æšä¸¾æœªç”¨ä½k</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; n; k++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(mask &amp; (<span class="number">1</span>&lt;&lt;k)) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="type">int</span> nmask = mask | (<span class="number">1</span>&lt;&lt;k);  <span class="comment">// æˆ– | precomp[k]ï¼ˆé¢„è®¡ç®—å½±å“ä½ï¼‰</span></span><br><span class="line">        dp[nmask] = <span class="built_in">min</span>(dp[nmask], dp[mask] + cost[k]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> ans = dp[(<span class="number">1</span>&lt;&lt;n)<span class="number">-1</span>];</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>ä¼˜åŒ–</strong>ï¼šå¦‚æœè½¬ç§»æ˜¯å›ºå®šæ¨¡å¼ï¼Œç”¨å­é›†æšä¸¾åŠ é€Ÿã€‚</li>
</ul>
<p><strong>å¸¸è§æŠ€å·§</strong></p>
<ul>
<li><strong>ä½è¿ç®—</strong>ï¼š<ul>
<li>æ£€æŸ¥ä½ï¼š<code>(mask &amp; (1&lt;&lt;i))</code></li>
<li>è®¡æ•°ä½ï¼š<code>__builtin_popcount(mask)</code></li>
<li>ä½ä½/é«˜ä½ï¼š<code>mask &amp; -mask</code>ï¼ˆæœ€ä½ä½ï¼‰</li>
</ul>
</li>
<li><strong>åˆå§‹åŒ–</strong>ï¼š<code>fill(dp, dp+(1&lt;&lt;n), INF);</code> æˆ– <code>memset</code>ã€‚</li>
<li><strong>å¤šæµ‹è¯•</strong>ï¼šé¢„è®¡ç®—å…¨å±€DPï¼ˆå¦‚ä»£ç ä¸­ï¼‰ï¼Œæ¯ä¸ªtest O(1)æˆ–O(n)ã€‚</li>
<li><strong>ç©ºé—´ä¼˜åŒ–</strong>ï¼šå¦‚æœn=16ï¼Œç”¨<code>vector&lt;vector&lt;int&gt;&gt; dp(16, vector&lt;int&gt;(1&lt;&lt;16, INF));</code>ï¼ˆå¦‚ä»£ç ï¼‰ã€‚</li>
<li><strong>è°ƒè¯•</strong>ï¼šä»å°næµ‹è¯•ï¼›æ‰“å°maskäºŒè¿›åˆ¶<code>for(int i=0;i&lt;n;i++) if(mask&amp;(1&lt;&lt;i)) ...</code>ã€‚</li>
</ul>
<p><strong>æ‰©å±•ï¼šä»£ç ä¸­å˜ç§ï¼ˆdp[i][mask]ï¼Œiå›ºå®šèµ·ç‚¹ï¼‰</strong></p>
<p>å¦‚æä¾›çš„ä»£ç ï¼šdp2[x][sta] è¡¨ç¤ºä»xå¼€å§‹è¦†ç›–staçš„æœ€å°æˆæœ¬ã€‚</p>
<ul>
<li>åˆå§‹åŒ–å•ç‚¹ï¼š<code>dp[x][1&lt;&lt;x] = init_cost;</code></li>
<li>è½¬ç§»ï¼š<code>dp[x][sta] = min over y in sta, y!=x: dp[y][sta^(1&lt;&lt;x)] + dp_edge[y][x]</code></li>
<li>é¡ºåºï¼šæŒ‰staå¤§å°é€’å¢ï¼Œæˆ–ç”¨å­é›†DPã€‚</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://codeforces.com/gym/105578/problem/E</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1</span> &lt;&lt; <span class="number">16</span>;  <span class="comment">// 2^16 = 65536ï¼ŒçŠ¶æ€é›†å¤§å°</span></span><br><span class="line"><span class="function">vector <span class="title">dp2</span><span class="params">(<span class="number">16</span>, vector&lt;<span class="type">int</span>&gt;(N, <span class="number">1e18</span>))</span></span>;  <span class="comment">// dp2[x][sta]: è¦†ç›–staå­é›†ï¼ˆstaè¡¨ç¤ºéœ€è¦è¦†ç›–çš„å·®å€¼æ©ç é›†åˆï¼‰ï¼Œä»¥xç»“æŸçš„æœ€å°æˆæœ¬ï¼ˆxå±äºstaï¼‰</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	cin &gt;&gt; t;  <span class="comment">// è¯»å–æµ‹è¯•ç”¨ä¾‹æ•°T</span></span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">val</span><span class="params">(<span class="number">4</span>)</span></span>;  <span class="comment">// val[0..3]: å››ç§æ“ä½œæˆæœ¬ a0å•ç»†èƒ,a1æ•´è¡Œ,a2æ•´åˆ—,a3å…¨ç¿»</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> &amp; x : val) cin &gt;&gt; x;</span><br><span class="line">	<span class="comment">// ç¬¬ä¸€éƒ¨åˆ†ï¼šæ„å»ºçŠ¶æ€å›¾çš„APSPï¼Œdp[i][j]: ä»çŠ¶æ€iåˆ°jçš„æœ€å°éç©ºåºåˆ—æˆæœ¬ï¼ˆå‡€XORä¸ºi^jï¼‰</span></span><br><span class="line">	<span class="function">vector <span class="title">dp</span><span class="params">(<span class="number">16</span>, vector&lt;<span class="type">int</span>&gt;(<span class="number">16</span>, <span class="number">1e18</span>))</span></span>;  <span class="comment">// dp[16][16]: çŠ¶æ€é—´æœ€çŸ­è·¯å¾„</span></span><br><span class="line">	vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt; <span class="built_in">mid1</span>(<span class="number">9</span>);  <span class="comment">// 9ç§æ“ä½œï¼š4å•ç»†èƒ+2è¡Œ+2åˆ—+1å…¨</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i ++) mid1[i] = &#123;<span class="number">1</span> &lt;&lt; i, val[<span class="number">0</span>]&#125;;  <span class="comment">// å•ç»†èƒæ“ä½œæ©ç </span></span><br><span class="line">	mid1[<span class="number">4</span>] = &#123;<span class="number">3</span>, val[<span class="number">1</span>]&#125;;   <span class="comment">// ä¸Šè¡Œ: 0011b</span></span><br><span class="line">	mid1[<span class="number">5</span>] = &#123;<span class="number">12</span>, val[<span class="number">1</span>]&#125;;  <span class="comment">// ä¸‹è¡Œ: 1100b</span></span><br><span class="line">	mid1[<span class="number">6</span>] = &#123;<span class="number">5</span>, val[<span class="number">2</span>]&#125;;   <span class="comment">// å·¦åˆ—: 0101b</span></span><br><span class="line">	mid1[<span class="number">7</span>] = &#123;<span class="number">10</span>, val[<span class="number">2</span>]&#125;;  <span class="comment">// å³åˆ—: 1010b</span></span><br><span class="line">	mid1[<span class="number">8</span>] = &#123;<span class="number">15</span>, val[<span class="number">3</span>]&#125;;  <span class="comment">// å…¨ç¿»: 1111b</span></span><br><span class="line">	<span class="type">int</span> min1 = <span class="built_in">min</span>(&#123;val[<span class="number">0</span>], val[<span class="number">1</span>], val[<span class="number">2</span>], val[<span class="number">3</span>]&#125;);  <span class="comment">// æœ€ cheap æ“ä½œæˆæœ¬</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i ++) dp[i][i] = <span class="number">2</span> * min1;  <span class="comment">// å¯¹è§’çº¿ï¼šè¿”å›åŸçŠ¶æ€çš„æœ€å°éç©ºæˆæœ¬ï¼ˆä¸¤æ¬¡ç›¸åŒæœ€cheapæ“ä½œï¼‰</span></span><br><span class="line">	<span class="comment">// æ·»åŠ å•æ­¥è¾¹ï¼šä»iåˆ°i^maskï¼Œæˆæœ¬c</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i ++) &#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">9</span>; j ++) &#123;</span><br><span class="line">			dp[i][i ^ mid1[j].fr] = mid1[j].sc;  <span class="comment">// æ³¨æ„ï¼šå¯èƒ½è¦†ç›–å·²æœ‰è¾¹ï¼Œå–min</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// Floyd-Warshallï¼šè®¡ç®—æ‰€æœ‰iåˆ°jçš„æœ€å°éç©ºè·¯å¾„æˆæœ¬</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> mid = <span class="number">0</span>; mid &lt; <span class="number">16</span>; mid ++) &#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i ++) &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j ++) &#123;</span><br><span class="line">				dp[i][j] = <span class="built_in">min</span>(dp[i][j], dp[i][mid] + dp[mid][j]);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// ç¬¬äºŒéƒ¨åˆ†ï¼šTSP-like DP on subsets of required deltas</span></span><br><span class="line">	<span class="comment">// dp2[x][sta]: ä»0å¼€å§‹ï¼Œè®¿é—®è·¯å¾„è¦†ç›–staä¸­æ‰€æœ‰ç‚¹ï¼Œä»¥xç»“æŸçš„æœ€å°æˆæœ¬ï¼ˆä»…ä¿è¯staç‚¹è¢«è®¿é—®ï¼Œä¸­é—´å¯èƒ½å¤šï¼‰</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> sta = <span class="number">0</span>; sta &lt; N; sta ++) &#123;  <span class="comment">// æšä¸¾å­é›†staï¼ˆæŒ‰æ•°å€¼é€’å¢ï¼Œç¡®ä¿å­é—®é¢˜å·²è§£ï¼‰</span></span><br><span class="line">		vector&lt;<span class="type">int</span>&gt; v1;  <span class="comment">// staä¸­è®¾ç½®çš„ä½ï¼ˆéœ€è¦è¦†ç›–çš„deltaæ©ç ï¼‰</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i ++) &#123;</span><br><span class="line">			<span class="keyword">if</span>((sta &gt;&gt; i) &amp; <span class="number">1</span>) v1.<span class="built_in">push_back</span>(i); </span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(v1.<span class="built_in">size</span>() == <span class="number">1</span>) &#123;  <span class="comment">// åŸºå†µï¼šå•ä¸ªç‚¹kï¼Œä»0åˆ°kçš„æˆæœ¬</span></span><br><span class="line">			dp2[v1[<span class="number">0</span>]][sta] = <span class="built_in">min</span>(dp2[v1[<span class="number">0</span>]][sta], dp[<span class="number">0</span>][v1[<span class="number">0</span>]]);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;  <span class="comment">// è½¬ç§»ï¼šæœ€åä¸€ä¸ªç‚¹xï¼Œä»å‰ä¸€å­é›†sta\xçš„æŸä¸ªyåˆ°x</span></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">auto</span> &amp; x : v1) &#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">auto</span> &amp; y : v1) &#123;</span><br><span class="line">					<span class="keyword">if</span>(x == y) <span class="keyword">continue</span>;</span><br><span class="line">					<span class="type">int</span> sub_sta = sta ^ (<span class="number">1</span> &lt;&lt; x);  <span class="comment">// å­é›†å»æ‰x</span></span><br><span class="line">					dp2[x][sta] = <span class="built_in">min</span>(dp2[x][sta], dp2[y][sub_sta] + dp[y][x]);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// å¤„ç†Tä¸ªæµ‹è¯•ç”¨ä¾‹ï¼ˆé¢„è®¡ç®—å…¨å±€DPï¼Œæ¯ä¸ªtest O(m)ï¼‰</span></span><br><span class="line">	<span class="keyword">while</span>(t --) &#123;</span><br><span class="line">		<span class="type">int</span> n;  <span class="comment">// m: å¯èƒ½åˆå§‹ç½‘æ ¼æ•°</span></span><br><span class="line">		cin &gt;&gt; n;</span><br><span class="line">		vector&lt;<span class="type">int</span>&gt; v1;  <span class="comment">// æ¯ä¸ªç½‘æ ¼çš„éœ€è¦ç¿»è½¬æ©ç ï¼ˆ0-15ï¼‰</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++) &#123;</span><br><span class="line">			<span class="type">int</span> y = <span class="number">0</span>;  <span class="comment">// æ„å»º4ä½æ©ç ï¼šéœ€è¦ç¿»è½¬çš„ä½ç½®ï¼ˆoffä½ï¼‰</span></span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j ++) &#123;  <span class="comment">// è¯»å–4ä¸ªcharï¼šè¡Œ1 col1, è¡Œ1 col2, è¡Œ2 col1, è¡Œ2 col2</span></span><br><span class="line">				<span class="type">char</span> c;</span><br><span class="line">				cin &gt;&gt; c;</span><br><span class="line">				<span class="type">int</span> x = c - <span class="string">&#x27;0&#x27;</span>;  <span class="comment">// 0æˆ–1</span></span><br><span class="line">				x ^= <span class="number">1</span>;  <span class="comment">// ç¿»è½¬ï¼šoff(&#x27;0&#x27;)éœ€ç¿»-&gt;1, on(&#x27;1&#x27;)æ— éœ€-&gt;0</span></span><br><span class="line">				y = (y &lt;&lt; <span class="number">1</span>) + x;</span><br><span class="line">			&#125;</span><br><span class="line">			v1.<span class="built_in">push_back</span>(y);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">int</span> sta1 = <span class="number">0</span>;  <span class="comment">// sta: ä½å›¾ï¼Œè¡¨ç¤ºå“ªäº›deltaéœ€è¦è¦†ç›–ï¼ˆbit kè®¾è‹¥æœ‰åˆå§‹éœ€XOR kï¼‰</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">auto</span> &amp; x : v1) sta1 ^= (<span class="number">1</span> &lt;&lt; x);  <span class="comment">// XORç¡®ä¿å”¯ä¸€ï¼ˆdistinct gridsï¼‰</span></span><br><span class="line">		<span class="type">int</span> ans = <span class="number">1e18</span>;  <span class="comment">// æœ€å°æ€»æˆæœ¬</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">auto</span> &amp; x : v1) ans = <span class="built_in">min</span>(ans, dp2[x][sta1]);  <span class="comment">// min over å¯èƒ½çš„ç»“æŸç‚¹xï¼ˆåœ¨v1ä¸­ï¼‰</span></span><br><span class="line">		cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ç«èµ›Tips</strong>ï¼šå…ˆä¼°$2^n * n^2 $â‰¤ 1e8ï¼›n&gt;20è½¬å…¶ä»–ï¼ˆå¦‚åˆ†æ²»ï¼‰ã€‚å¤åˆ¶æ¨¡æ¿æ”¹çŠ¶æ€/è½¬ç§»ã€‚</p>
<h4 id="è½®å»“çº¿DP"><a href="#è½®å»“çº¿DP" class="headerlink" title="è½®å»“çº¿DP"></a>è½®å»“çº¿DP</h4><p>è§£å†³ä¸ç›¸é‚»æ”¾ç½®é—®é¢˜ã€‚</p>
<p>ä½è¿ç®—çš„å‡ ä¸ªç®€å•æ“ä½œï¼š</p>
<p>å¾—åˆ°çŠ¶æ€sç¬¬jä½çš„çŠ¶æ€ : (s &gt;&gt; j) &amp; 1</p>
<p>æŠŠçŠ¶æ€sç¬¬jä½çš„çŠ¶æ€è®¾ç½®æˆ1ï¼Œå…¶ä»–ä½ç½®çŠ¶æ€ä¸å˜ : s = s | (1 &lt;&lt; j)</p>
<p>æŠŠçŠ¶æ€sç¬¬jä½çš„çŠ¶æ€è®¾ç½®æˆ0ï¼Œå…¶ä»–ä½ç½®çŠ¶æ€ä¸å˜ : s = s &amp; (~(1 &lt;&lt; j))</p>
<blockquote>
<p>çŠ¶æ€å ä¸¤ä½æ—¶ï¼š</p>
<p>å¾—åˆ°çŠ¶æ€sç¬¬jä½çš„çŠ¶æ€ : (x &gt;&gt; (j &lt;&lt; 1)) &amp; 3;</p>
<p>æŠŠçŠ¶æ€sç¬¬jä½çš„çŠ¶æ€è®¾ç½®æˆval(0/1/2/3)ï¼Œå…¶ä»–ä½ç½®çŠ¶æ€ä¸å˜ : s = s &amp; (~(3 &lt;&lt; (j &lt;&lt; 1))) | (val &lt;&lt; (j &lt;&lt; 1));</p>
</blockquote>
<p>æœ‰é€’å½’ç‰ˆå’Œå‹ç¼©ç©ºé—´é€’æ¨ç‰ˆï¼Œåªè¦è®¡ç®—å‡ºç©ºé—´ä¸è¶…è¿‡1e7ï¼Œä¼˜å…ˆå†™é€’å½’ç‰ˆã€‚</p>
<p>è¦æ ¹æ®é€’å½’ç‰ˆæ¥åˆå§‹åŒ–preæ•°ç»„ï¼ˆç›¸å½“äºå‹ç¼©çš„ä¸Šä¸€å±‚çŠ¶æ€ï¼‰ï¼Œæœ‰æ—¶å€™ä¼šç¡®å®šåˆå§‹å’Œç»“å°¾çŠ¶æ€ï¼Œè¦å•ç‹¬å¤„ç†ã€‚</p>
<h5 id="åŸºç¡€ç‰ˆ"><a href="#åŸºç¡€ç‰ˆ" class="headerlink" title="åŸºç¡€ç‰ˆ"></a>åŸºç¡€ç‰ˆ</h5><p>ä¸Šä¸‹å·¦å³çŠ¶æ€ä¸èƒ½è¿ç»­ï¼Œä¸”å„è‡ªæœ¬èº«è¦å¯å–ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P1879</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1</span> &lt;&lt; <span class="number">14</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e8</span>;</span><br><span class="line"><span class="function">vector <span class="title">dp</span><span class="params">(N, vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;(<span class="number">13</span>, vector&lt;<span class="type">int</span>&gt;(<span class="number">13</span>, <span class="number">-1</span>)))</span></span>;</span><br><span class="line"><span class="function">vector <span class="title">dp2</span><span class="params">(N, vector&lt;<span class="type">int</span>&gt;(<span class="number">14</span>))</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">pre</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">	<span class="keyword">while</span>(t --) &#123;</span><br><span class="line">		<span class="type">int</span> n, m;</span><br><span class="line">		cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">		<span class="function">vector <span class="title">v1</span><span class="params">(n + <span class="number">1</span>, vector&lt;<span class="type">int</span>&gt;(m + <span class="number">1</span>))</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j ++) &#123;</span><br><span class="line">				cin &gt;&gt; v1[i][j];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; m1;</span><br><span class="line">		<span class="keyword">auto</span> set1 = [](<span class="type">int</span> sta, <span class="type">int</span> in) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> sta | (<span class="number">1</span> &lt;&lt; in);</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> set0 = [](<span class="type">int</span> sta, <span class="type">int</span> in) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> sta &amp; (~(<span class="number">1</span> &lt;&lt; in));</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> get = [](<span class="type">int</span> x, <span class="type">int</span> i) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="built_in">return</span> (x &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="comment">// é€’å½’ç‰ˆ</span></span><br><span class="line">		<span class="keyword">auto</span> dfs = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i1, <span class="type">int</span> sta, <span class="type">int</span> j1) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(j1 &gt; m) j1 = <span class="number">1</span>, i1 ++;</span><br><span class="line">			<span class="keyword">if</span>(i1 &gt; n) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">			&#125; 	</span><br><span class="line">			<span class="keyword">if</span>(dp[sta][i1][j1] != <span class="number">-1</span>) <span class="keyword">return</span> dp[sta][i1][j1];</span><br><span class="line">			<span class="type">int</span> ans = <span class="built_in">f</span>(f, i1, <span class="built_in">set0</span>(sta, j1), j1 + <span class="number">1</span>);</span><br><span class="line">			<span class="type">bool</span> l = (j1 == <span class="number">1</span> || <span class="built_in">get</span>(sta, j1 - <span class="number">1</span>) == <span class="number">0</span>);	</span><br><span class="line">			<span class="type">bool</span> r = <span class="built_in">get</span>(sta, j1) == <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">if</span>(l &amp;&amp; r &amp;&amp; v1[i1][j1]) ans = (ans + <span class="built_in">f</span>(f, i1, <span class="built_in">set1</span>(sta, j1), j1 + <span class="number">1</span>)) % mod;</span><br><span class="line">			dp[sta][i1][j1] = ans;</span><br><span class="line">			<span class="keyword">return</span> ans;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="type">int</span> ans = <span class="built_in">dfs</span>(dfs, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="comment">// ç©ºé—´å‹ç¼©ç‰ˆ</span></span><br><span class="line">		<span class="type">int</span> n1 = <span class="number">1</span> &lt;&lt; (m + <span class="number">1</span>);</span><br><span class="line">		<span class="built_in">fill</span>(pre.<span class="built_in">begin</span>(), pre.<span class="built_in">end</span>(), <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i1 = n; i1; i1 --) &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> sta = <span class="number">0</span>; sta &lt; n1; sta ++) &#123;</span><br><span class="line">				dp2[sta][m + <span class="number">1</span>] = pre[sta];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j1 = m; j1; j1 --) &#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> sta = <span class="number">0</span>; sta &lt; n1; sta ++) &#123;</span><br><span class="line">					<span class="type">bool</span> l = (j1 == <span class="number">1</span> || <span class="built_in">get</span>(sta, j1 - <span class="number">1</span>) == <span class="number">0</span>);	</span><br><span class="line">					<span class="type">bool</span> r = <span class="built_in">get</span>(sta, j1) == <span class="number">0</span>;</span><br><span class="line">					<span class="type">int</span> ans = dp2[<span class="built_in">set0</span>(sta, j1)][j1 + <span class="number">1</span>];</span><br><span class="line">					<span class="keyword">if</span>(l &amp;&amp; r &amp;&amp; v1[i1][j1]) ans = (ans + dp2[<span class="built_in">set1</span>(sta, j1)][j1 + <span class="number">1</span>]) % mod;</span><br><span class="line">					dp2[sta][j1] = ans;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> sta = <span class="number">0</span>; sta &lt; n1; sta ++) &#123;</span><br><span class="line">				pre[sta] = dp2[sta][<span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; dp2[<span class="number">0</span>][<span class="number">1</span>] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">		<span class="comment">// cout &lt;&lt; ans &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="è¿›é˜¶ç‰ˆ"><a href="#è¿›é˜¶ç‰ˆ" class="headerlink" title="è¿›é˜¶ç‰ˆ"></a>è¿›é˜¶ç‰ˆ</h5><p>å…«ä¸ªæ–¹å‘ä¸èƒ½è¿ç»­ï¼Œä¸”æ€»è®¾ç½®ç‚¹=kã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1</span> &lt;&lt; <span class="number">11</span> | <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> dp[N][<span class="number">10</span>][<span class="number">10</span>][<span class="number">2</span>][<span class="number">82</span>];</span><br><span class="line"><span class="type">int</span> dp2[N][<span class="number">11</span>][<span class="number">2</span>][<span class="number">82</span>];</span><br><span class="line"><span class="type">int</span> pre[N][<span class="number">82</span>];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">	<span class="keyword">while</span>(t --) &#123;</span><br><span class="line">		<span class="type">int</span> n, k;</span><br><span class="line">		cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">		<span class="keyword">auto</span> set0 = [](<span class="type">int</span> x, <span class="type">int</span> i) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> x &amp; (~(<span class="number">1</span> &lt;&lt; i));</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> set1 = [](<span class="type">int</span> x, <span class="type">int</span> i) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> x | (<span class="number">1</span> &lt;&lt; i);</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> get = [](<span class="type">int</span> x, <span class="type">int</span> i) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="built_in">return</span> (x &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="comment">// é€’å½’ç‰ˆ</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= (<span class="number">1</span> &lt;&lt; (n + <span class="number">1</span>)); i ++) &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> i1 = <span class="number">0</span>; i1 &lt;= n; i1 ++) &#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> i2 = <span class="number">0</span>; i2 &lt;= n; i2 ++) &#123;</span><br><span class="line">					<span class="keyword">for</span>(<span class="type">int</span> i3 = <span class="number">0</span>; i3 &lt; <span class="number">2</span>; i3 ++) &#123;</span><br><span class="line">						<span class="keyword">for</span>(<span class="type">int</span> i4 = <span class="number">0</span>; i4 &lt;= k; i4 ++) &#123;</span><br><span class="line">							dp[i][i1][i2][i3][i4] = <span class="number">-1</span>;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"> 		<span class="keyword">auto</span> dfs = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i1, <span class="type">int</span> j1, <span class="type">int</span> sta, <span class="type">int</span> last, <span class="type">int</span> cnt1) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(j1 &gt; n) &#123;</span><br><span class="line">				j1 = <span class="number">1</span>;</span><br><span class="line">				i1 ++;</span><br><span class="line">				last = <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(i1 &gt; n) &#123;</span><br><span class="line">				<span class="keyword">return</span> cnt1 == k;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(dp[sta][i1][j1][last][cnt1] != <span class="number">-1</span>) <span class="keyword">return</span> dp[sta][i1][j1][last][cnt1];</span><br><span class="line">			<span class="type">bool</span> l = <span class="built_in">get</span>(sta, j1 - <span class="number">1</span>);</span><br><span class="line">			<span class="type">bool</span> up = <span class="built_in">get</span>(sta, j1);</span><br><span class="line">			<span class="type">bool</span> r = <span class="built_in">get</span>(sta, j1 + <span class="number">1</span>);</span><br><span class="line">			<span class="type">int</span> ans = <span class="built_in">f</span>(f, i1, j1 + <span class="number">1</span>, <span class="built_in">set0</span>(sta, j1), up, cnt1);</span><br><span class="line">			<span class="keyword">if</span>((j1 == <span class="number">1</span> || !l) &amp;&amp; !r &amp;&amp; !up &amp;&amp; !last &amp;&amp; cnt1 &lt; k) ans += <span class="built_in">f</span>(f, i1, j1 + <span class="number">1</span>, <span class="built_in">set1</span>(sta, j1), up, cnt1 + <span class="number">1</span>);</span><br><span class="line">			dp[sta][i1][j1][last][cnt1] = ans;</span><br><span class="line">			<span class="keyword">return</span> ans;</span><br><span class="line">		&#125;;</span><br><span class="line">		cout &lt;&lt; <span class="built_in">dfs</span>(dfs, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">		<span class="comment">// ç©ºé—´å‹ç¼©ç‰ˆ	</span></span><br><span class="line">		<span class="type">int</span> n1 = <span class="number">1</span> &lt;&lt; (n + <span class="number">1</span>) ;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> sta = <span class="number">0</span>; sta &lt;= n1; sta ++) pre[sta][k] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i1 = n; i1; i1 --) &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> sta = <span class="number">0</span>; sta &lt; n1; sta ++) &#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> k1 = <span class="number">0</span>; k1 &lt;= k; k1 ++) &#123;</span><br><span class="line">					dp2[sta][n + <span class="number">1</span>][<span class="number">0</span>][k1] = dp2[sta][n + <span class="number">1</span>][<span class="number">1</span>][k1] = pre[sta][k1];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j1 = n; j1; j1 --) &#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> sta = <span class="number">0</span>; sta &lt; n1; sta ++) &#123;</span><br><span class="line">					<span class="keyword">for</span>(<span class="type">int</span> last = <span class="number">0</span>; last &lt; <span class="number">2</span>; last ++) &#123;</span><br><span class="line">						<span class="keyword">for</span>(<span class="type">int</span> k1 = <span class="number">0</span>; k1 &lt;= k; k1 ++) &#123;</span><br><span class="line">							<span class="type">bool</span> l = <span class="built_in">get</span>(sta, j1 - <span class="number">1</span>);</span><br><span class="line">							<span class="type">bool</span> up = <span class="built_in">get</span>(sta, j1);</span><br><span class="line">							<span class="type">bool</span> r = <span class="built_in">get</span>(sta, j1 + <span class="number">1</span>);</span><br><span class="line">							<span class="type">int</span> ans = dp2[<span class="built_in">set0</span>(sta, j1)][j1 + <span class="number">1</span>][up][k1];</span><br><span class="line">							<span class="keyword">if</span>((j1 == <span class="number">1</span> || !l) &amp;&amp; !r &amp;&amp; !up &amp;&amp; !last &amp;&amp; k1 &lt; k) ans += dp2[<span class="built_in">set1</span>(sta, j1)][j1 + <span class="number">1</span>][up][k1 + <span class="number">1</span>];</span><br><span class="line">							dp2[sta][j1][last][k1] = ans;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> sta = <span class="number">0</span>; sta &lt; n1; sta ++) &#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> k1 = <span class="number">0</span>; k1 &lt;= k; k1 ++) &#123;</span><br><span class="line">					pre[sta][k1] = dp2[sta][<span class="number">1</span>][<span class="number">0</span>][k1];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; </span><br><span class="line">		cout &lt;&lt; dp2[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆå§‹å’Œç»“å°¾çŠ¶æ€ç¡®å®šï¼Œä¸”çŠ¶æ€æœ‰4ç§</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P2435</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1</span> &lt;&lt; <span class="number">16</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">376544743</span>;</span><br><span class="line"><span class="type">int</span> dp[N][<span class="number">101</span>][<span class="number">9</span>];</span><br><span class="line"><span class="type">int</span> dp2[N][<span class="number">9</span>];</span><br><span class="line"><span class="type">int</span> pre[N];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">	<span class="keyword">while</span>(t --) &#123;</span><br><span class="line">		<span class="type">int</span> n, m, k;</span><br><span class="line">		cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">		<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(m)</span>, <span class="title">v2</span><span class="params">(m)</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">auto</span> &amp; x : v1) cin &gt;&gt; x;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">auto</span> &amp; x : v2) cin &gt;&gt; x;</span><br><span class="line">		<span class="keyword">if</span>(k == <span class="number">2</span>) &#123;</span><br><span class="line">			<span class="type">bool</span> f = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(n &amp; <span class="number">1</span>) &#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i ++) &#123;</span><br><span class="line">					<span class="keyword">if</span>(v1[i] != v2[i]) &#123;</span><br><span class="line">						f = <span class="number">0</span>;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;	</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i ++) &#123;</span><br><span class="line">					<span class="keyword">if</span>(v1[i] == v2[i]) &#123;</span><br><span class="line">						f = <span class="number">0</span>;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			cout &lt;&lt; f &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">auto</span> set = [](<span class="type">int</span> x, <span class="type">int</span> i, <span class="type">int</span> val) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> x &amp; (~(<span class="number">3</span> &lt;&lt; (i &lt;&lt; <span class="number">1</span>))) | (val &lt;&lt; (i &lt;&lt; <span class="number">1</span>));</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> get = [](<span class="type">int</span> x, <span class="type">int</span> i) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="built_in">return</span> (x &gt;&gt; (i &lt;&lt; <span class="number">1</span>)) &amp; <span class="number">3</span>;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="type">int</span> sta1 = <span class="number">0</span>, sta2 = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i ++) sta1 = <span class="built_in">set</span>(sta1, i, v1[i]);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i ++) sta2 = <span class="built_in">set</span>(sta2, i, v2[i]);</span><br><span class="line">		<span class="type">int</span> n1 = <span class="number">1</span> &lt;&lt; (m &lt;&lt; <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">auto</span> diff = [&amp;](<span class="type">int</span> sta) -&gt; <span class="type">bool</span> &#123;</span><br><span class="line">			<span class="type">bool</span> f = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i ++) &#123;</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">get</span>(sta, i) == <span class="built_in">get</span>(sta2, i)) &#123;</span><br><span class="line">					f = <span class="number">0</span>;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> f;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="comment">// é€’å½’ç‰ˆ</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> sta = <span class="number">0</span>; sta &lt; n1; sta ++) &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> i1 = <span class="number">0</span>; i1 &lt; n; i1 ++) &#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> j1 = <span class="number">0</span>; j1 &lt; m; j1 ++) &#123;</span><br><span class="line">					dp[sta][i1][j1] = <span class="number">-1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">auto</span> dfs = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i1, <span class="type">int</span> j1, <span class="type">int</span> sta) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(i1 == n - <span class="number">1</span>) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="built_in">diff</span>(sta);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(j1 == m) <span class="keyword">return</span> <span class="built_in">f</span>(f, i1 + <span class="number">1</span>, <span class="number">0</span>, sta);</span><br><span class="line">			<span class="keyword">if</span>(dp[sta][i1][j1] != <span class="number">-1</span>) <span class="keyword">return</span> dp[sta][i1][j1];</span><br><span class="line">			<span class="type">int</span> l = (j1 == <span class="number">0</span> ? <span class="number">-1</span> : <span class="built_in">get</span>(sta, j1 - <span class="number">1</span>));</span><br><span class="line">			<span class="type">int</span> up = <span class="built_in">get</span>(sta, j1);</span><br><span class="line">			<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> k1 = <span class="number">0</span>; k1 &lt; k; k1 ++) &#123;</span><br><span class="line">				<span class="keyword">if</span>(l != k1 &amp;&amp; up != k1) ans = (ans + <span class="built_in">f</span>(f, i1, j1 + <span class="number">1</span>, <span class="built_in">set</span>(sta, j1, k1))) % mod;</span><br><span class="line">			&#125;</span><br><span class="line">			dp[sta][i1][j1] = ans;</span><br><span class="line">			<span class="keyword">return</span> ans;</span><br><span class="line">		&#125;;</span><br><span class="line">		cout &lt;&lt; <span class="built_in">dfs</span>(dfs, <span class="number">1</span>, <span class="number">0</span>, sta1) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">		<span class="comment">// ç©ºé—´å‹ç¼©ç‰ˆ</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> sta = <span class="number">0</span>; sta &lt; n1; sta ++) pre[sta] = <span class="built_in">diff</span>(sta);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i1 = n - <span class="number">2</span>; i1 &gt;= <span class="number">0</span>; i1 --) &#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> sta = <span class="number">0</span>; sta &lt; n1; sta ++) dp2[sta][m] = pre[sta];</span><br><span class="line">			<span class="keyword">if</span>(i1 == <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> j1 = m - <span class="number">1</span>; j1 &gt;= <span class="number">0</span>; j1 --) &#123;</span><br><span class="line">					<span class="type">int</span> l = (j1 == <span class="number">0</span> ? <span class="number">-1</span> : <span class="built_in">get</span>(sta1, j1 - <span class="number">1</span>));</span><br><span class="line">					<span class="type">int</span> up = <span class="built_in">get</span>(sta1, j1);</span><br><span class="line">					<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">					<span class="keyword">for</span>(<span class="type">int</span> k1 = <span class="number">0</span>; k1 &lt; k; k1 ++) &#123;</span><br><span class="line">						<span class="keyword">if</span>(l != k1 &amp;&amp; up != k1) ans = (ans + dp2[<span class="built_in">set</span>(sta1, j1, k1)][j1 + <span class="number">1</span>]) % mod;</span><br><span class="line">					&#125;</span><br><span class="line">					dp2[sta1][j1] = ans;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j1 = m - <span class="number">1</span>; j1 &gt;= <span class="number">0</span>; j1 --) &#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> sta = <span class="number">0</span>; sta &lt; n1; sta ++) &#123;</span><br><span class="line">					<span class="type">int</span> l = (j1 == <span class="number">0</span> ? <span class="number">-1</span> : <span class="built_in">get</span>(sta, j1 - <span class="number">1</span>));</span><br><span class="line">					<span class="type">int</span> up = <span class="built_in">get</span>(sta, j1);</span><br><span class="line">					<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">					<span class="keyword">for</span>(<span class="type">int</span> k1 = <span class="number">0</span>; k1 &lt; k; k1 ++) &#123;</span><br><span class="line">						<span class="keyword">if</span>(l != k1 &amp;&amp; up != k1) ans = (ans + dp2[<span class="built_in">set</span>(sta, j1, k1)][j1 + <span class="number">1</span>]) % mod;</span><br><span class="line">					&#125;</span><br><span class="line">					dp2[sta][j1] = ans;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> sta = <span class="number">0</span>; sta &lt; n1; sta ++) pre[sta] = dp2[sta][<span class="number">0</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; dp2[sta1][<span class="number">0</span>] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Fliegelâ€“Van-Flandern-ç®—æ³•"><a href="#Fliegelâ€“Van-Flandern-ç®—æ³•" class="headerlink" title="Fliegelâ€“Van Flandern ç®—æ³•"></a>Fliegelâ€“Van Flandern ç®—æ³•</h3><p>è¿™ä¸ªç®—æ³•å¯ä»¥å°†ä»å…¬å…ƒå‰4713å¹´1æœˆ1æ—¥ï¼ˆå³å„’ç•¥æ—¥JD=0ï¼‰èµ·è®¡ç®—çš„<strong>å„’ç•¥æ—¥æ•°ï¼ˆJDï¼‰</strong>è½¬æ¢ä¸ºå…¬å†æ—¥æœŸï¼ˆå¹´ã€æœˆã€æ—¥ï¼‰ï¼Œå¹¶è‡ªåŠ¨åˆ¤æ–­æ˜¯åœ¨å„’ç•¥å†è¿˜æ˜¯æ ¼é‡Œå†ä¸­ï¼ˆ1582å¹´10æœˆ15æ—¥ä¸ºåˆ‡æ¢ç‚¹ï¼‰ã€‚</p>
<ul>
<li>JD â‰¥ 2299161ï¼šé‡‡ç”¨<strong>æ ¼é‡Œå†</strong>ï¼ˆå³1582å¹´10æœˆ15æ—¥ä¹‹åï¼‰</li>
<li>JD &lt; 2299161ï¼šé‡‡ç”¨<strong>å„’ç•¥å†</strong></li>
</ul>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Fliegelâ€“Van Flandern ç®—æ³•</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">julianDayToDate</span><span class="params">(ll JD, ll &amp;day, ll &amp;month, ll &amp;year, <span class="type">bool</span> &amp;isBC)</span> </span>&#123;</span><br><span class="line">    ll A, B, C, D, E;</span><br><span class="line">    <span class="keyword">if</span> (JD &gt;= <span class="number">2299161</span>) &#123; </span><br><span class="line">        <span class="type">double</span> alpha = <span class="built_in">floor</span>((JD - <span class="number">1867216.25</span>) / <span class="number">36524.25</span>);</span><br><span class="line">        A = JD + <span class="number">1</span> + alpha - <span class="built_in">floor</span>(alpha / <span class="number">4.0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123; </span><br><span class="line">        A = JD;</span><br><span class="line">    &#125;</span><br><span class="line">    B = A + <span class="number">1524</span>;</span><br><span class="line">    C = <span class="built_in">floor</span>((<span class="type">double</span>)(B - <span class="number">122.1</span>) / <span class="number">365.25</span>);</span><br><span class="line">    D = <span class="built_in">floor</span>(<span class="number">365.25</span> * (<span class="type">double</span>)C);</span><br><span class="line">    E = <span class="built_in">floor</span>((<span class="type">double</span>)(B - D) / <span class="number">30.6001</span>);</span><br><span class="line">    day = B - D - <span class="built_in">floor</span>(<span class="number">30.6001</span> * E);</span><br><span class="line">    <span class="keyword">if</span> (E &lt; <span class="number">14</span>)</span><br><span class="line">        month = E - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        month = E - <span class="number">13</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (month &gt; <span class="number">2</span>)</span><br><span class="line">        year = C - <span class="number">4716</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        year = C - <span class="number">4715</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (year &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        isBC = <span class="literal">true</span>;</span><br><span class="line">        day = day;</span><br><span class="line">        month = month;</span><br><span class="line">        year = -(year) + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        isBC = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    ll Q;</span><br><span class="line">    cin &gt;&gt; Q;</span><br><span class="line">    <span class="keyword">while</span>(Q--)&#123;</span><br><span class="line">        ll JD;</span><br><span class="line">        cin &gt;&gt; JD;</span><br><span class="line">        ll day, month, year;</span><br><span class="line">        <span class="type">bool</span> isBC = <span class="literal">false</span>;</span><br><span class="line">        <span class="built_in">julianDayToDate</span>(JD, day, month, year, isBC);</span><br><span class="line">        <span class="keyword">if</span>(isBC)&#123;</span><br><span class="line">            cout &lt;&lt; day &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; month &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; year &lt;&lt; <span class="string">&quot; BC\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            cout &lt;&lt; day &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; month &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; year &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="é€†æ³¢å…°å¼"><a href="#é€†æ³¢å…°å¼" class="headerlink" title="é€†æ³¢å…°å¼"></a>é€†æ³¢å…°å¼</h3><p>é€†æ³¢å…°è¡¨è¾¾å¼ï¼ˆReverse Polish Notationï¼Œç®€ç§° <code>RPN</code>ï¼‰ï¼Œä¹Ÿç§°ä¸ºåç¼€è¡¨è¾¾å¼ï¼Œæ˜¯ä¸€ç§å°†è¿ç®—ç¬¦æ”¾åœ¨æ“ä½œæ•°ä¹‹åçš„æ•°å­¦è¡¨è¾¾æ–¹å¼ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mod1 1000000007</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">3e5</span> + <span class="number">1</span>;</span><br><span class="line"><span class="function">vector&lt;ll&gt; <span class="title">stack1</span><span class="params">(N,<span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="type">int</span> size1;</span><br><span class="line">ll a;</span><br><span class="line">ll b;</span><br><span class="line">ll ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    size1 = <span class="number">0</span>;</span><br><span class="line">    string s;</span><br><span class="line">    <span class="built_in">getline</span>(cin,s);</span><br><span class="line">    <span class="function">istringstream <span class="title">ios</span><span class="params">(s)</span></span>;</span><br><span class="line">    string token;</span><br><span class="line">    <span class="keyword">while</span>(ios &gt;&gt; token)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">isdigit</span>(token[<span class="number">0</span>]))&#123;</span><br><span class="line">            stack1[size1++] = <span class="built_in">stoll</span>(token);</span><br><span class="line">            <span class="comment">// cout &lt;&lt; stoll(token) &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            b = stack1[--size1];</span><br><span class="line">            a = stack1[--size1];</span><br><span class="line">            <span class="comment">// cout &lt;&lt; a &lt;&lt; &quot; &quot; &lt;&lt; b &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">            <span class="keyword">if</span>(token == <span class="string">&quot;+&quot;</span>)&#123;</span><br><span class="line">                ans = (a + b) % mod1;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(token == <span class="string">&quot;-&quot;</span>)&#123;</span><br><span class="line">                ans = (a - b) % mod1;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(token == <span class="string">&quot;*&quot;</span>)&#123;</span><br><span class="line">                ans = (a * b) % mod1;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                ans = (a / b) % mod1;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// cout &lt;&lt; ans &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">            stack1[size1++] = ans;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; stack1[size1 - <span class="number">1</span>] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="çº¦ç‘Ÿå¤«ç¯"><a href="#çº¦ç‘Ÿå¤«ç¯" class="headerlink" title="çº¦ç‘Ÿå¤«ç¯"></a>çº¦ç‘Ÿå¤«ç¯</h3><p>çº¦ç‘Ÿå¤«ç¯é—®é¢˜æè¿°çš„æ˜¯ä¸€ç¾¤äººå›´æˆä¸€åœˆï¼Œæ¯éš”å›ºå®šäººæ•°ï¼ˆå³ç¬¬ k ä¸ªäººï¼‰è¢«æ·˜æ±°ï¼Œç›´åˆ°æœ€åå‰©ä¸‹ä¸€ä¸ªäººã€‚æœ€åå­˜æ´»çš„äººçš„ä½ç½®å¯ä»¥é€šè¿‡ä¸‹é¢çš„é€’æ¨å¼æ¥æ±‚è§£ï¼š</p>
<p>å‡è®¾åªæœ‰ 1 ä¸ªäººæ—¶ï¼Œå­˜æ´»çš„ä½ç½®ä¸º 0ï¼ˆæ³¨æ„ï¼šè¿™é‡Œç”¨ 0 è¡¨ç¤ºç¼–å·ï¼Œä» 0 å¼€å§‹ï¼‰ï¼›å½“æœ‰ i ä¸ªäººæ—¶ï¼Œå¯ä»¥åˆ©ç”¨ i-1 ä¸ªäººçš„ç»“æœé€’æ¨å‡º i ä¸ªäººçš„æƒ…å†µã€‚<br>é€’æ¨å…¬å¼ä¸ºï¼š</p>
<p>f(i) = (f(iâˆ’1) + k ) modâ€‰â€‰i</p>
<p>å…¶ä¸­ï¼Œf(i)è¡¨ç¤º i ä¸ªäººæ—¶æœ€åå­˜æ´»è€…çš„ç¼–å·ã€‚</p>
<p>i = 1 æ—¶ï¼Œf[i]æ˜¾ç„¶ç­‰äº0</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">josephus</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> result = <span class="number">0</span>; <span class="comment">// åˆå§‹åªæœ‰ä¸€ä¸ªäººæ—¶ï¼Œä½ç½®æ˜¯ 0</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        result = (result + k) % i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç¦»æ•£åŒ–-1"><a href="#ç¦»æ•£åŒ–-1" class="headerlink" title="ç¦»æ•£åŒ–"></a>ç¦»æ•£åŒ–</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>) -&gt; ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--)&#123;</span><br><span class="line">    	<span class="type">int</span> n;</span><br><span class="line">    	cin &gt;&gt; n;</span><br><span class="line">    	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">ord</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    		cin &gt;&gt; v1[i];</span><br><span class="line">    		ord[i] = v1[i];</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="built_in">sort</span>(ord.<span class="built_in">begin</span>() + <span class="number">1</span>, ord.<span class="built_in">end</span>());</span><br><span class="line">    	<span class="type">int</span> m = <span class="number">1</span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    		<span class="keyword">if</span>(ord[m] != ord[i])&#123;</span><br><span class="line">    			ord[++ m] = ord[i];</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">auto</span> find = [&amp;](<span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">    		<span class="type">int</span> l = <span class="number">1</span>, r = m;</span><br><span class="line">    		<span class="type">int</span> mid, ans;</span><br><span class="line">    		<span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">    			mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    			<span class="keyword">if</span>(x &gt;= ord[mid])&#123;</span><br><span class="line">    				ans = mid;</span><br><span class="line">    				l = mid + <span class="number">1</span>;</span><br><span class="line">    			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    				r = mid - <span class="number">1</span>;</span><br><span class="line">    			&#125;</span><br><span class="line">    		&#125;</span><br><span class="line">    		<span class="keyword">return</span> ans;</span><br><span class="line">    	&#125;;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;after: &quot;</span> &lt;&lt; <span class="built_in">find</span>(v1[i]) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Nçš‡åé—®é¢˜"><a href="#Nçš‡åé—®é¢˜" class="headerlink" title="Nçš‡åé—®é¢˜"></a>Nçš‡åé—®é¢˜</h3><h4 id="ä½è¿ç®—ç‰ˆæœ¬"><a href="#ä½è¿ç®—ç‰ˆæœ¬" class="headerlink" title="ä½è¿ç®—ç‰ˆæœ¬"></a>ä½è¿ç®—ç‰ˆæœ¬</h4><p>æ¯æ¬¡å°†çŠ¶æ€è¿›è¡Œå·¦ç§»å’Œå³ç§»ä¸€ä½æ¨¡æ‹Ÿå¯¹è§’çº¿ç§»åŠ¨ï¼Œè€Œä¸”åˆ©ç”¨ä½è¿ç®—å¿«é€Ÿå¾—åˆ°æ­¤è¡Œèƒ½å¤Ÿæ”¾ç½®çš„ä½ç½®</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">vector&lt;array&lt;<span class="type">int</span>,11&gt;&gt; sols;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> colMask, <span class="type">int</span> d1Mask, <span class="type">int</span> d2Mask, array&lt;<span class="type">int</span>,<span class="number">11</span>&gt;&amp; col)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (row == n) &#123;</span><br><span class="line">        sols.<span class="built_in">push_back</span>(col);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> avail = ((<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>) &amp; ~(colMask | d1Mask | d2Mask); </span><br><span class="line">    <span class="keyword">while</span> (avail) &#123;</span><br><span class="line">        <span class="type">int</span> p = avail &amp; -avail; </span><br><span class="line">        <span class="type">int</span> c = __builtin_ctz(p);</span><br><span class="line">        col[row] = c;</span><br><span class="line">        <span class="built_in">dfs</span>(row + <span class="number">1</span>,</span><br><span class="line">            colMask | p,</span><br><span class="line">            (d1Mask | p) &lt;&lt; <span class="number">1</span>,</span><br><span class="line">            (d2Mask | p) &gt;&gt; <span class="number">1</span>,</span><br><span class="line">            col);</span><br><span class="line">        avail ^= p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">	cin &gt;&gt; n;</span><br><span class="line">    array&lt;<span class="type">int</span>,11&gt; col&#123;&#125;;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, col);</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> S = sols.<span class="built_in">size</span>();</span><br><span class="line">    cout &lt;&lt; S &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å‡¸åŒ…"><a href="#å‡¸åŒ…" class="headerlink" title="å‡¸åŒ…"></a>å‡¸åŒ…</h3><h4 id="ä¸‹å‡¸åŒ…"><a href="#ä¸‹å‡¸åŒ…" class="headerlink" title="ä¸‹å‡¸åŒ…"></a>ä¸‹å‡¸åŒ…</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://ac.nowcoder.com/acm/contest/108299/H</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// ä½¿ç”¨ long long é˜²æ­¢æº¢å‡º</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="comment">// æœ€å¤§èŠ‚ç‚¹æ•°å’Œæœ€å¤§è¾¹æ•°ï¼Œæ ¹æ®é¢˜ç›®é™åˆ¶è°ƒæ•´</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1e5</span>, M = <span class="number">3e5</span>;</span><br><span class="line"><span class="comment">// é‚»æ¥è¡¨å­˜å‚¨</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">next1</span><span class="params">(M + <span class="number">1</span>)</span>, <span class="title">to</span><span class="params">(M + <span class="number">1</span>)</span>, <span class="title">weight</span><span class="params">(M + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="comment">// å­˜å‚¨ä» 1 å‡ºå‘çš„æœ€çŸ­è·ç¦»ã€åˆ° n çš„æœ€çŸ­è·ç¦»</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">d1</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">d2</span><span class="params">(N + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="comment">// åŸå§‹è¾¹ä¿¡æ¯</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">u</span><span class="params">(M + <span class="number">1</span>)</span>, <span class="title">v</span><span class="params">(M + <span class="number">1</span>)</span>, <span class="title">w</span><span class="params">(M + <span class="number">1</span>)</span>, <span class="title">t1</span><span class="params">(M + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="comment">// Dijkstra æ ‡è®°ç”¨</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">has</span><span class="params">(N + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="comment">// ç›´çº¿ç»“æ„ y = k*x + b</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">line</span> &#123;</span><br><span class="line">    <span class="type">int</span> k, b;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// ç”¨äºç»´æŠ¤ä¸‹å‡¸åŒ…çš„ç›´çº¿æ•°ç»„</span></span><br><span class="line"><span class="function">vector&lt;line&gt; <span class="title">l1</span><span class="params">(M + <span class="number">1</span>)</span>, <span class="title">ans1</span><span class="params">(M + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> T;</span><br><span class="line">    cin &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="type">int</span> n, m;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">        <span class="comment">// è¯»å…¥æ‰€æœ‰è¾¹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">            cin &gt;&gt; u[i] &gt;&gt; v[i] &gt;&gt; w[i] &gt;&gt; t1[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> cnt1 = <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// é‚»æ¥è¡¨æ’å…¥å‡½æ•°</span></span><br><span class="line">        <span class="keyword">auto</span> add = [&amp;](<span class="type">int</span> uu, <span class="type">int</span> vv, <span class="type">int</span> ww) &#123;</span><br><span class="line">            next1[cnt1] = head[uu];</span><br><span class="line">            to[cnt1] = vv;</span><br><span class="line">            weight[cnt1] = ww;</span><br><span class="line">            head[uu] = cnt1++;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// Dijkstra æ¨¡æ¿ï¼Œin è¡¨ç¤ºèµ·ç‚¹</span></span><br><span class="line">        <span class="keyword">auto</span> dj = [&amp;](vector&lt;<span class="type">int</span>&gt; &amp;d, <span class="type">int</span> in) &#123;</span><br><span class="line">            <span class="comment">// é‡ç½®å›¾å’Œè·ç¦»</span></span><br><span class="line">            <span class="built_in">fill</span>(head.<span class="built_in">begin</span>() + <span class="number">1</span>, head.<span class="built_in">begin</span>() + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="built_in">fill</span>(has.<span class="built_in">begin</span>() + <span class="number">1</span>, has.<span class="built_in">begin</span>() + n + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="built_in">fill</span>(d.<span class="built_in">begin</span>() + <span class="number">1</span>, d.<span class="built_in">begin</span>() + n + <span class="number">1</span>, (<span class="type">int</span>)<span class="number">1e18</span>);</span><br><span class="line">            cnt1 = <span class="number">1</span>;</span><br><span class="line">            <span class="comment">// é‡æ–°æ’å…¥è¾¹</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">                <span class="built_in">add</span>(u[i], v[i], w[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æœ€å°å †</span></span><br><span class="line">            priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;, vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;, greater&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;&gt; pq;</span><br><span class="line">            d[in] = <span class="number">0</span>;</span><br><span class="line">            pq.<span class="built_in">push</span>(&#123;<span class="number">0</span>, in&#125;);</span><br><span class="line">            <span class="keyword">while</span> (!pq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">                <span class="keyword">auto</span> [dist, u0] = pq.<span class="built_in">top</span>();</span><br><span class="line">                pq.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">if</span> (has[u0]) <span class="keyword">continue</span>;</span><br><span class="line">                has[u0] = <span class="number">1</span>;</span><br><span class="line">                <span class="comment">// æ¾å¼›æ“ä½œ</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> ei = head[u0]; ei; ei = next1[ei]) &#123;</span><br><span class="line">                    <span class="type">int</span> v0 = to[ei], wt = weight[ei];</span><br><span class="line">                    <span class="keyword">if</span> (d[u0] + wt &lt; d[v0]) &#123;</span><br><span class="line">                        d[v0] = d[u0] + wt;</span><br><span class="line">                        pq.<span class="built_in">push</span>(&#123;d[v0], v0&#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// è®¡ç®—ä» 1 åˆ°å„ç‚¹çš„æœ€çŸ­è·¯</span></span><br><span class="line">        <span class="built_in">dj</span>(d1, <span class="number">1</span>);</span><br><span class="line">        <span class="comment">// åå‘å›¾ï¼šäº¤æ¢ u å’Œ v</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++) <span class="built_in">swap</span>(u[i], v[i]);</span><br><span class="line">        <span class="comment">// è®¡ç®—ä» n åˆ°å„ç‚¹çš„æœ€çŸ­è·¯ï¼ˆå³åŸå›¾å„ç‚¹åˆ° n çš„æœ€çŸ­è·¯ï¼‰</span></span><br><span class="line">        <span class="built_in">dj</span>(d2, n);</span><br><span class="line">        <span class="comment">// æ¢å¤åŸå‘è¾¹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++) <span class="built_in">swap</span>(u[i], v[i]);</span><br><span class="line">        <span class="comment">// æ„é€ æ¯æ¡è¾¹å¯¹åº”çš„ä¸€æ¡ç›´çº¿ l: y = -t1*x + (d1[u]+d2[v]+w)</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">            l1[i] = line&#123;-t1[i], d1[u[i]] + d2[v[i]] + w[i]&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æŒ‰æ–œç‡ k é™åºæ’åºï¼Œè‹¥ k ç›¸åŒï¼ŒæŒ‰æˆªè· b é™åº</span></span><br><span class="line">        <span class="built_in">sort</span>(l1.<span class="built_in">begin</span>() + <span class="number">1</span>, l1.<span class="built_in">begin</span>() + m + <span class="number">1</span>, [](<span class="keyword">auto</span> &amp;A, <span class="keyword">auto</span> &amp;B) &#123;</span><br><span class="line">            <span class="keyword">if</span> (A.k == B.k) <span class="keyword">return</span> A.b &gt; B.b;</span><br><span class="line">            <span class="keyword">return</span> A.k &gt; B.k;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// è®¡ç®—ä¸¤æ¡ç›´çº¿ç›¸äº¤çš„ x åæ ‡ï¼ˆå‘ä¸‹å–æ•´ï¼‰</span></span><br><span class="line">        <span class="keyword">auto</span> getX = [&amp;](<span class="type">const</span> line &amp;A, <span class="type">const</span> line &amp;B) &#123;</span><br><span class="line">            <span class="comment">// A.k &gt; B.k ä¿è¯åˆ†æ¯éè´Ÿ</span></span><br><span class="line">            <span class="built_in">return</span> (B.b - A.b) / (A.k - B.k);</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// ç»´æŠ¤ä¸‹å‡¸åŒ…</span></span><br><span class="line">        <span class="type">int</span> len = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">            <span class="comment">// å»æ‰å¤±æ•ˆçš„æˆ–ä¸å¿…è¦çš„ç›´çº¿</span></span><br><span class="line">            <span class="keyword">while</span> (len &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœæ–°çº¿åœ¨ä¸Šä¸€æ¡çº¿ä¹‹ä¸Šï¼Œåˆ™ä¸Šä¸€æ¡çº¿æ— æ•ˆ</span></span><br><span class="line">                <span class="keyword">if</span> (l1[i].b &lt;= ans1[len<span class="number">-1</span>].b) len--;</span><br><span class="line">                <span class="comment">// æˆ–è€…ç›¸äº¤ç‚¹ä¸é€’å¢ï¼Œä¹Ÿè¦å»æ‰ä¸Šä¸€æ¡</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (len &gt; <span class="number">1</span> &amp;&amp; <span class="built_in">getX</span>(l1[i], ans1[len<span class="number">-1</span>]) &lt;= <span class="built_in">getX</span>(ans1[len<span class="number">-1</span>], ans1[len<span class="number">-2</span>])) len--;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            ans1[len++] = l1[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¤„ç†æŸ¥è¯¢</span></span><br><span class="line">        <span class="type">int</span> q; cin &gt;&gt; q;</span><br><span class="line">        <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">            <span class="type">int</span> x; cin &gt;&gt; x;</span><br><span class="line">            <span class="comment">// äºŒåˆ†æ‰¾åœ¨å‡¸åŒ…ä¸Šå¯¹åº” x çš„æœ€ä½³ç›´çº¿</span></span><br><span class="line">            <span class="type">int</span> l = <span class="number">0</span>, r = len - <span class="number">2</span>, best = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">                <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">getX</span>(ans1[mid], ans1[mid+<span class="number">1</span>]) &lt; x) &#123;</span><br><span class="line">                    best = mid + <span class="number">1</span>;</span><br><span class="line">                    l = mid + <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// è¾“å‡ºç­”æ¡ˆ</span></span><br><span class="line">            cout &lt;&lt; ans1[best].k * x + ans1[best].b &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="FFT"><a href="#FFT" class="headerlink" title="FFT"></a>FFT</h3><h4 id="æ ¸å¿ƒæ€æƒ³"><a href="#æ ¸å¿ƒæ€æƒ³" class="headerlink" title="æ ¸å¿ƒæ€æƒ³"></a>æ ¸å¿ƒæ€æƒ³</h4><p>FFTï¼ˆå¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼‰çš„ç›®æ ‡æ˜¯é«˜æ•ˆè®¡ç®—ä¸¤ä¸ªå¤šé¡¹å¼çš„å·ç§¯ã€‚<br>è®¾</p>
<script type="math/tex; mode=display">
C(x) = A(x)B(x),\quad A(x)=\sum_{i=0}^n a_i x^i,\quad B(x)=\sum_{j=0}^m b_j x^j</script><p>é‚£ä¹ˆå·ç§¯çš„ç³»æ•°æ˜¯ï¼š</p>
<script type="math/tex; mode=display">
c_k = \sum_{i+j=k} a_i b_j</script><p>æœ´ç´ ç®—æ³•æ˜¯æšä¸¾ $i,j$ï¼Œå¤æ‚åº¦ $O(n^2)$ã€‚FFT çš„ä½œç”¨æ˜¯åˆ©ç”¨ <strong>ç¦»æ•£å‚…é‡Œå¶å˜æ¢ï¼ˆDFTï¼‰</strong> çš„æ€§è´¨ï¼ŒæŠŠè¿™ä¸ªå·ç§¯é—®é¢˜é™åˆ° $O(n\log n)$ã€‚</p>
<h4 id="ç¦»æ•£å‚…é‡Œå¶å˜æ¢ï¼ˆDFTï¼‰ä¸é€†å˜æ¢"><a href="#ç¦»æ•£å‚…é‡Œå¶å˜æ¢ï¼ˆDFTï¼‰ä¸é€†å˜æ¢" class="headerlink" title="ç¦»æ•£å‚…é‡Œå¶å˜æ¢ï¼ˆDFTï¼‰ä¸é€†å˜æ¢"></a>ç¦»æ•£å‚…é‡Œå¶å˜æ¢ï¼ˆDFTï¼‰ä¸é€†å˜æ¢</h4><p>ç»™å®šåºåˆ— $a<em>0,a_1,\dots,a</em>{n-1}$ï¼Œå®šä¹‰ DFTï¼š</p>
<script type="math/tex; mode=display">
A_k = \sum_{j=0}^{n-1} a_j \cdot \omega_n^{jk}, \quad k=0,\dots,n-1</script><p>å…¶ä¸­</p>
<script type="math/tex; mode=display">
\omega_n = e^{2\pi i / n}</script><p>æ˜¯ $n$ æ¬¡å•ä½æ ¹ã€‚</p>
<p>é€†å˜æ¢å…¬å¼ä¸ºï¼š</p>
<script type="math/tex; mode=display">
a_j = \frac{1}{n} \sum_{k=0}^{n-1} A_k \cdot \omega_n^{-jk}</script><p>æ€§è´¨ï¼š</p>
<ul>
<li>åœ¨ç‚¹å€¼è¡¨ç¤ºä¸‹ï¼Œå¤šé¡¹å¼ä¹˜æ³•ç­‰ä»·äºå·ç§¯ã€‚</li>
<li>å³ï¼šåœ¨é¢‘åŸŸåšä¹˜æ³•ï¼Œç­‰ä»·äºæ—¶åŸŸåšå·ç§¯ã€‚</li>
</ul>
<h4 id="å·ç§¯å®šç†"><a href="#å·ç§¯å®šç†" class="headerlink" title="å·ç§¯å®šç†"></a>å·ç§¯å®šç†</h4><ol>
<li><p>æŠŠ $A(x),B(x)$ å˜æ¢åˆ°é¢‘åŸŸï¼š<br>å¾—åˆ° ${A(\omega_n^k)}, {B(\omega_n^k)}$</p>
</li>
<li><p>ç‚¹å€¼ç›¸ä¹˜ï¼š</p>
<script type="math/tex; mode=display">
C(\omega_n^k) = A(\omega_n^k) \cdot B(\omega_n^k)</script></li>
<li><p>é€†å˜æ¢ï¼š<br>å¾—åˆ° $C(x)$ çš„ç³»æ•°ã€‚</p>
</li>
</ol>
<p>å› æ­¤ï¼Œå·ç§¯è¿‡ç¨‹å°±æ˜¯ï¼š<br>FFT(A) â†’ FFT(B) â†’ ç‚¹ä¹˜ â†’ IFFTã€‚<br>æ€»å¤æ‚åº¦ $O(n\log n)$ã€‚</p>
<h4 id="FFT-åŠ é€Ÿ"><a href="#FFT-åŠ é€Ÿ" class="headerlink" title="FFT åŠ é€Ÿ"></a>FFT åŠ é€Ÿ</h4><p>å¦‚æœç›´æ¥ç®— DFTï¼Œéœ€è¦ $O(n^2)$ã€‚<br>FFT åˆ©ç”¨äº†<strong>åˆ†æ²»æ€æƒ³</strong>ï¼š</p>
<script type="math/tex; mode=display">
A(x) = A_{even}(x^2) + x A_{odd}(x^2)</script><p>ä»£å…¥ $\omega_n^k$ å¾—åˆ°ï¼š</p>
<script type="math/tex; mode=display">
A(\omega_n^k) = A_{even}(\omega_{n/2}^k) + \omega_n^k A_{odd}(\omega_{n/2}^k)</script><p>è¿™è¯´æ˜ä¸€ä¸ª $n$ ç‚¹ DFT å¯ä»¥åˆ†è§£ä¸ºä¸¤ä¸ª $n/2$ ç‚¹ DFTï¼Œå†åŠ ä¸Šåˆå¹¶æ—¶çš„è‹¥å¹²ä¹˜æ³•ã€‚<br>é€’å½’å±•å¼€ï¼Œå¤æ‚åº¦é™ä¸º $O(n\log n)$ã€‚</p>
<p>åœ¨ä»£ç å±‚é¢ï¼Œåˆ†æ²»è¢«è½¬åŒ–ä¸º<strong>è¿­ä»£å½¢å¼</strong>ï¼š</p>
<ol>
<li><strong>ä½é€†åºé‡æ’</strong>ï¼šå…ˆå°†æ•°ç»„ä¸‹æ ‡æŒ‰äºŒè¿›åˆ¶åè½¬æ’åºã€‚</li>
<li><strong>é€å±‚è´è¶æ“ä½œ</strong>ï¼šä»é•¿åº¦ 2 çš„å°æ®µå¼€å§‹ï¼Œä¸æ–­å€å¢ï¼Œæ¯ä¸€å±‚éƒ½ç”¨æ—‹è½¬å› å­ $\omega$ åšåˆå¹¶ã€‚</li>
</ol>
<p>è´è¶æ“ä½œå½¢å¼ä¸ºï¼š</p>
<script type="math/tex; mode=display">
u = a[i],\quad v = w \cdot a[i+mid]</script><script type="math/tex; mode=display">
a[i] = u+v,\quad a[i+mid] = u-v</script><p>è¿™å°±æ˜¯ä»£ç ä¸­å¾ªç¯çš„æ ¸å¿ƒã€‚</p>
<h4 id="ä»£ç å…³é”®ç‚¹å¯¹åº”æ•°å­¦"><a href="#ä»£ç å…³é”®ç‚¹å¯¹åº”æ•°å­¦" class="headerlink" title="ä»£ç å…³é”®ç‚¹å¯¹åº”æ•°å­¦"></a>ä»£ç å…³é”®ç‚¹å¯¹åº”æ•°å­¦</h4><ul>
<li><code>for (int i = 0; i &lt; tot; i++)</code>ï¼šéå† FFT é•¿åº¦ï¼ˆtot ä¸ºæœ€è¿‘çš„ 2 æ¬¡å¹‚ï¼‰ã€‚</li>
<li>ä½é€†åºæ•°ç»„ <code>rev[i]</code>ï¼šä¿è¯æ¯ä¸€å±‚åˆ†æ²»åˆå¹¶æ—¶é¡ºåºæ­£ç¡®ã€‚</li>
<li>æ¯ä¸€å±‚é•¿åº¦ <code>len</code> ç¿»å€ï¼Œæ—‹è½¬å› å­ <code>wn = exp(Â±2Ï€i/len)</code>ã€‚</li>
<li><code>if (op == 1)</code> æ­£å˜æ¢ï¼ˆFFTï¼‰ï¼Œ<code>if (op == -1)</code> é€†å˜æ¢ï¼ˆIFFTï¼‰ã€‚</li>
<li>é€†å˜æ¢æœ€åè¦é™¤ä»¥ <code>tot</code>ï¼Œå¯¹åº”å…¬å¼é‡Œçš„ $1/n$ã€‚</li>
<li><code>&lt;tot</code> è€Œä¸æ˜¯ <code>&lt;=tot</code>ï¼šå› ä¸ºæ•°ç»„ä¸‹æ ‡ä» 0 åˆ° tot-1ï¼Œæ€»å…± tot ä¸ªç‚¹ã€‚</li>
</ul>
<h4 id="åœ¨é¢˜ç›®ä¸­çš„ä½œç”¨"><a href="#åœ¨é¢˜ç›®ä¸­çš„ä½œç”¨" class="headerlink" title="åœ¨é¢˜ç›®ä¸­çš„ä½œç”¨"></a>åœ¨é¢˜ç›®ä¸­çš„ä½œç”¨</h4><p>åœ¨è¿™é“é¢˜é‡Œï¼Œç»™å®šä¸¤ä¸ªå¤šé¡¹å¼ï¼ˆæˆ– 01 ä¸²æ˜ å°„ä¸ºç³»æ•°æ•°ç»„ï¼‰ï¼Œéœ€è¦å¿«é€Ÿè®¡ç®—å·ç§¯ã€‚<br>FFT çš„æµç¨‹æ˜¯ï¼š</p>
<ol>
<li>è¯»å…¥åºåˆ—ï¼Œæ‰©å……åˆ° 2 æ¬¡å¹‚é•¿åº¦ã€‚</li>
<li>FFT å˜æ¢ã€‚</li>
<li>ç‚¹å€¼ç›¸ä¹˜ã€‚</li>
<li>IFFT è¿˜åŸï¼Œå¾—åˆ°å·ç§¯ç»“æœã€‚</li>
<li>å†åšé¢˜ç›®æ‰€éœ€çš„â€œè¿›åˆ¶å½’çº¦â€ï¼ˆä¾‹å¦‚ $\sqrt{-2}$ è¿›ä½ï¼‰ã€‚</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://ac.nowcoder.com/acm/contest/108305/J</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long </span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">3e5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="comment">// ç®€å•å¤æ•°ç»“æ„ï¼Œæ”¯æŒ +,-,*</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Complex</span>&#123;</span><br><span class="line">    <span class="type">double</span> x, y;</span><br><span class="line">    Complex <span class="keyword">operator</span> +(<span class="type">const</span> Complex &amp;t) <span class="type">const</span> &#123; <span class="keyword">return</span> &#123;x + t.x, y + t.y&#125;; &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> -(<span class="type">const</span> Complex &amp;t) <span class="type">const</span> &#123; <span class="keyword">return</span> &#123;x - t.x, y - t.y&#125;; &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> *(<span class="type">const</span> Complex &amp;t) <span class="type">const</span> &#123; <span class="keyword">return</span> &#123;x * t.x - y * t.y, x * t.y + y * t.x&#125;; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// å·¥ä½œæ•°ç»„</span></span><br><span class="line"><span class="function">vector&lt;Complex&gt; <span class="title">a</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">b</span><span class="params">(N + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">rev</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">res</span><span class="params">(N &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="type">int</span> bit, tot; <span class="comment">// FFT é•¿åº¦ä¿¡æ¯</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>)-&gt;ios_base::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    <span class="comment">// FFTï¼šinv=1 æ­£å˜æ¢, inv=-1 é€†å˜æ¢</span></span><br><span class="line">    <span class="keyword">auto</span> FFT = [&amp;](vector&lt;Complex&gt; &amp; v, <span class="type">int</span> inv) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; tot; i ++) <span class="keyword">if</span>(i &lt; rev[i]) <span class="built_in">swap</span>(v[i], v[rev[i]]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> mid = <span class="number">1</span>; mid &lt; tot; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            Complex w1 = &#123;<span class="built_in">cos</span>(PI / mid), inv * <span class="built_in">sin</span>(PI / mid)&#125;;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; tot; i += (mid &lt;&lt; <span class="number">1</span>)) &#123;</span><br><span class="line">                Complex wk = &#123;<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; mid; j ++, wk = wk * w1) &#123;</span><br><span class="line">                    Complex x = v[i + j], y = wk * v[i + j + mid];</span><br><span class="line">                    v[i + j] = x + y;</span><br><span class="line">                    v[i + j + mid] = x - y;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">while</span>(t --) &#123; </span><br><span class="line">        string s1, s2;</span><br><span class="line">        cin &gt;&gt; s1 &gt;&gt; s2;</span><br><span class="line">        <span class="type">int</span> n1 = s1.<span class="built_in">size</span>(), n2 = s2.<span class="built_in">size</span>();</span><br><span class="line">        <span class="comment">// ä½ä½åœ¨å‰å­˜å‚¨</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n1; i ++) a[i] = &#123;<span class="built_in">double</span>(s1[n1 - i - <span class="number">1</span>] - <span class="string">&#x27;0&#x27;</span>), <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n2; i ++) b[i] = &#123;<span class="built_in">double</span>(s2[n2 - i - <span class="number">1</span>] - <span class="string">&#x27;0&#x27;</span>), <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="comment">// å–æœ€è¿‘ 2 æ¬¡å¹‚é•¿åº¦</span></span><br><span class="line">        bit = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>((<span class="number">1</span> &lt;&lt; bit) &lt; n1 + n2 - <span class="number">1</span>) bit ++;</span><br><span class="line">        tot = <span class="number">1</span> &lt;&lt; bit;</span><br><span class="line">        <span class="comment">// è¡¥ 0</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = n1; i &lt; tot; i ++) a[i] = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = n2; i &lt; tot; i ++) b[i] = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="comment">// ä½é€†åºè¡¨</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; tot; i ++)</span><br><span class="line">            rev[i] = (rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">        <span class="comment">// FFT â†’ é€ç‚¹ç›¸ä¹˜ â†’ IFFT</span></span><br><span class="line">        <span class="built_in">FFT</span>(a, <span class="number">1</span>), <span class="built_in">FFT</span>(b, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; tot; i ++) a[i] = a[i] * b[i];</span><br><span class="line">        <span class="built_in">FFT</span>(a, <span class="number">-1</span>);</span><br><span class="line">        <span class="comment">// å·ç§¯ç»“æœï¼ˆæœªè¿›ä½ï¼‰</span></span><br><span class="line">        <span class="type">int</span> len = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n1 + n2 - <span class="number">1</span>; ++i)</span><br><span class="line">            res[i] = (<span class="type">int</span>)(a[i].x / tot + <span class="number">0.5</span>);</span><br><span class="line">        <span class="comment">// âˆš-2 è¿›åˆ¶è¿›ä½å½’çº¦</span></span><br><span class="line">        <span class="keyword">for</span>(len = <span class="number">0</span>; len &lt; n1 + n2 - <span class="number">1</span> || res[len + <span class="number">1</span>] || res[len]; len ++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(res[len] &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                res[len] = -res[len];</span><br><span class="line">                res[len + <span class="number">2</span>] += res[len];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(res[len] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                res[len + <span class="number">2</span>] -= res[len] &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                res[len] %= <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å»æ‰å‰å¯¼ 0</span></span><br><span class="line">        <span class="keyword">while</span>(len &gt; <span class="number">1</span> &amp;&amp; !res[len - <span class="number">1</span>]) len --;</span><br><span class="line">        <span class="comment">// è¾“å‡ºï¼ˆé«˜ä½åœ¨å‰ï¼‰</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --) cout &lt;&lt; <span class="built_in">char</span>(<span class="string">&#x27;0&#x27;</span> + res[i]);</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="comment">// æ¸…ç†</span></span><br><span class="line">        <span class="built_in">fill</span>(res.<span class="built_in">begin</span>(), res.<span class="built_in">begin</span>() + len + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¡ç‰¹å…°æ•°"><a href="#å¡ç‰¹å…°æ•°" class="headerlink" title="å¡ç‰¹å…°æ•°"></a>å¡ç‰¹å…°æ•°</h3><p>å¯¹äºä¾æ¬¡å‹æ ˆéšæ„å‡ºæ ˆï¼Œè§„èŒƒæ‹¬å·ï¼ˆï¼ˆï¼‰ï¼ˆï¼‰ï¼‰â€¦ï¼Œæ–œæ–¹çŸ©é˜µä»å·¦ä¸Šè§’åˆ°å³ä¸‹è§’æ–¹æ¡ˆæ•°ï¼Œå…¶ç­”æ¡ˆæ•°å‡ä¸ºå¡ç‰¹å…°æ•°ï¼š</p>
<script type="math/tex; mode=display">
f(n) = \frac{(2n)!}{n!(n +1)!}</script><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://www.nowcoder.com/practice/44a2fc12a92a4eccb13a78eabfb67063?channelPut=w251acm</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">2e5</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">fac</span><span class="params">(N &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">inv</span><span class="params">(N + <span class="number">1</span>)</span>, <span class="title">ans1</span><span class="params">(N + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	cin &gt;&gt; t;</span><br><span class="line">	<span class="type">int</span> in1 = <span class="number">1</span>;</span><br><span class="line">	fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= (N &lt;&lt; <span class="number">1</span>); i ++) fac[i] = fac[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">	<span class="keyword">auto</span> power = [&amp;](<span class="type">int</span> x, <span class="type">int</span> n) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">		<span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span>(n) &#123;</span><br><span class="line">			<span class="keyword">if</span>(n &amp; <span class="number">1</span>) ans = ans * x % mod;</span><br><span class="line">			x = x * x % mod;</span><br><span class="line">			n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line">	&#125;;</span><br><span class="line">	inv[N] = <span class="built_in">power</span>(fac[N], mod - <span class="number">2</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = N - <span class="number">1</span>; i &gt;= <span class="number">1</span>; i --) inv[i] = inv[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % mod;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= N; i ++) &#123;</span><br><span class="line">		ans1[i] = fac[i &lt;&lt; <span class="number">1</span>] * inv[i] % mod * inv[i + <span class="number">1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span>(t --) &#123;</span><br><span class="line">		<span class="type">int</span> n;</span><br><span class="line">		cin &gt;&gt; n;</span><br><span class="line">		<span class="keyword">if</span>(n == <span class="number">1</span>) &#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;Case #&quot;</span> &lt;&lt; in1 &lt;&lt; <span class="string">&quot;: 0\n&quot;</span>;</span><br><span class="line">			in1 ++;</span><br><span class="line">			<span class="keyword">continue</span>; </span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Case #&quot;</span> &lt;&lt; in1 &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; ((ans1[n] - ans1[n - <span class="number">1</span>]) % mod + mod) % mod &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">		in1 ++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Tarjanï¼ˆå¼ºè¿é€š-å‰²ç‚¹-åŒè¿é€šåˆ†é‡ï¼‰"><a href="#Tarjanï¼ˆå¼ºè¿é€š-å‰²ç‚¹-åŒè¿é€šåˆ†é‡ï¼‰" class="headerlink" title="Tarjanï¼ˆå¼ºè¿é€š/å‰²ç‚¹/åŒè¿é€šåˆ†é‡ï¼‰"></a>Tarjanï¼ˆå¼ºè¿é€š/å‰²ç‚¹/åŒè¿é€šåˆ†é‡ï¼‰</h3><p> <strong>é€‚ç”¨åœºæ™¯</strong></p>
<ul>
<li>æ±‚è§£æœ‰å‘å›¾å¼ºè¿é€šåˆ†é‡ (SCC)ã€æ— å‘å›¾å‰²ç‚¹/æ¡¥ã€åŒè¿é€šåˆ†é‡ (BCC)ã€‚</li>
<li>å›¾è§„æ¨¡ï¼šn â‰¤ 5e5, m â‰¤ 2e6ï¼ˆéœ€ä¼˜åŒ–å¦‚é“¾å¼å‰å‘æ˜Ÿï¼‰ã€‚</li>
<li>å¸¸è§é—®é¢˜ï¼šæ‹“æ‰‘æ’åºå‰å¤„ç†ã€ç¼©ç‚¹DAGã€è¿é€šæ€§æ£€æŸ¥ã€å…³é”®ç‚¹/è¾¹æ£€æµ‹ã€‚</li>
<li>æ—¶é—´å¤æ‚åº¦ï¼šO(n + m)ï¼Œå•æ¬¡DFSéå†ã€‚</li>
<li>æ³¨æ„ï¼šæœ‰å‘å›¾ç”¨SCCï¼Œæ— å‘å›¾ç”¨å‰²ç‚¹/BCCï¼›å¸¦æƒéœ€é¢å¤–å¤„ç†ã€‚</li>
</ul>
<p><strong>æ ¸å¿ƒæ€è·¯</strong></p>
<ul>
<li><strong>DFSæ—¶åº</strong>ï¼šdfn[u] = è®¿é—®æ—¶é—´ï¼Œlow[u] = uå­æ ‘æœ€å°dfnï¼ˆå›æº¯æ—¶æ›´æ–°ï¼‰ã€‚</li>
<li><strong>æ ˆæœºåˆ¶</strong>ï¼ˆSCC/BCCï¼‰ï¼šå…¥æ ˆè®°å½•è·¯å¾„ï¼Œå‡ºæ ˆpopåˆ†é‡ã€‚</li>
<li><strong>åˆ†é‡åˆ¤æ–­</strong>ï¼š<ul>
<li>SCCï¼šdfn[u] == low[u] æ—¶popæ ˆè‡³uä¸ºä¸€SCCã€‚</li>
<li>å‰²ç‚¹ï¼šå­æ ‘low[v] &gt;= dfn[u]ï¼ˆéæ ¹ï¼‰æˆ–æ ¹å­æ ‘&gt;=2ã€‚</li>
<li>BCCï¼šlow[v] &gt;= dfn[u] æ—¶popæ ˆè‡³vä¸ºä¸€BCCã€‚</li>
</ul>
</li>
<li><strong>ç¼©ç‚¹</strong>ï¼šåŸç‚¹bel[u] = åˆ†é‡IDï¼›å»ºDAGå¤„ç†åç»­ï¼ˆå¦‚æ‹“æ‰‘/æœ€é•¿è·¯ï¼‰ã€‚</li>
<li><strong>ä¼˜åŒ–</strong>ï¼šé“¾å¼å‰å‘æ˜Ÿå­˜è¾¹ï¼›å¤šç»„ä»¶ä»1..n DFSã€‚</li>
</ul>
<p><strong>åŸºç¡€æ¨¡æ¿ï¼šå¼ºè¿é€šåˆ†é‡ (SCC) + ç¼©ç‚¹DAG</strong></p>
<p>é€‚ç”¨äºP2341/P3387-likeï¼ˆè®¡æ•°/æœ€é•¿è·¯ï¼‰ã€‚<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e4</span> + <span class="number">10</span>, M = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">val</span><span class="params">(N)</span></span>;  <span class="comment">// ç‚¹æƒï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line"><span class="type">int</span> cnt = <span class="number">1</span>;  <span class="comment">// è¾¹ç´¢å¼•</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head</span><span class="params">(N)</span>, <span class="title">nxt</span><span class="params">(M)</span>, <span class="title">to</span><span class="params">(M)</span></span>;</span><br><span class="line"><span class="type">int</span> tot = <span class="number">0</span>, Stop = <span class="number">0</span>, bcnt = <span class="number">0</span>;  <span class="comment">// tot: dfnæ—¶é’Ÿ, Stop: æ ˆé¡¶, bcnt: SCCæ•°</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dfn</span><span class="params">(N)</span>, <span class="title">low</span><span class="params">(N)</span>, <span class="title">Sta</span><span class="params">(N)</span>, <span class="title">bel</span><span class="params">(N)</span>, <span class="title">bsum</span><span class="params">(N)</span></span>;  <span class="comment">// bel: æ‰€å±SCC, bsum: SCCå¤§å°/æƒå’Œ</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">inSta</span><span class="params">(N)</span></span>;</span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">badj</span>(N);  <span class="comment">// SCCé—´DAG</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dp</span><span class="params">(N, <span class="number">-1</span>)</span></span>;  <span class="comment">// DAG DPï¼ˆå¦‚æœ€é•¿è·¯ï¼‰</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span> </span>&#123;  <span class="comment">// é“¾å¼å‰å‘æ˜Ÿ</span></span><br><span class="line">    nxt[cnt] = head[u]; to[cnt] = v; head[u] = cnt++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Tarjan</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">    dfn[u] = low[u] = ++tot;</span><br><span class="line">    inSta[u] = <span class="literal">true</span>;</span><br><span class="line">    Sta[Stop++] = u;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> ei = head[u], v; ei; ei = nxt[ei]) &#123;</span><br><span class="line">        v = to[ei];</span><br><span class="line">        <span class="keyword">if</span> (!dfn[v]) &#123;</span><br><span class="line">            <span class="built_in">Tarjan</span>(v);</span><br><span class="line">            low[u] = <span class="built_in">min</span>(low[u], low[v]);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (inSta[v]) &#123;</span><br><span class="line">            low[u] = <span class="built_in">min</span>(low[u], dfn[v]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dfn[u] == low[u]) &#123;  <span class="comment">// uä¸ºSCCæ ¹</span></span><br><span class="line">        bcnt++;</span><br><span class="line">        <span class="type">int</span> q;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            q = Sta[--Stop];</span><br><span class="line">            inSta[q] = <span class="literal">false</span>;</span><br><span class="line">            bel[q] = bcnt;</span><br><span class="line">            bsum[bcnt] += val[q];  <span class="comment">// æˆ– ++bsum[bcnt]ï¼ˆè®¡æ•°ï¼‰</span></span><br><span class="line">        &#125; <span class="keyword">while</span> (q != u);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs_dp</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;  <span class="comment">// DAGæœ€é•¿è·¯ï¼ˆP3387å˜ç§ï¼‰</span></span><br><span class="line">    <span class="keyword">if</span> (dp[u] != <span class="number">-1</span>) <span class="keyword">return</span> dp[u];</span><br><span class="line">    dp[u] = bsum[u];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> v : badj[u]) &#123;</span><br><span class="line">        dp[u] = <span class="built_in">max</span>(dp[u], bsum[u] + <span class="built_in">dfs_dp</span>(v));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[u];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>); cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; val[i];  <span class="comment">// ç‚¹æƒï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="type">int</span> u, v; cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">        <span class="built_in">add</span>(u, v);  <span class="comment">// æœ‰å‘è¾¹</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span> (!dfn[i]) <span class="built_in">Tarjan</span>(i);  <span class="comment">// å¤šç»„ä»¶</span></span><br><span class="line">    <span class="comment">// å»ºDAGï¼ˆå»é‡è¾¹å¯é€‰ï¼Œç”¨setï¼‰</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> u = <span class="number">1</span>; u &lt;= n; u++) &#123;</span><br><span class="line">        <span class="type">int</span> bu = bel[u];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> ei = head[u], v; ei; ei = nxt[ei]) &#123;</span><br><span class="line">            v = to[ei]; <span class="type">int</span> bv = bel[v];</span><br><span class="line">            <span class="keyword">if</span> (bu != bv) badj[bu].<span class="built_in">push_back</span>(bv);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç¤ºä¾‹è¾“å‡ºï¼šSCCå¤§å°</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= bcnt; i++) cout &lt;&lt; bsum[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="comment">// ç¤ºä¾‹ï¼šæœ€é•¿è·¯ï¼ˆP3387ï¼‰</span></span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= bcnt; i++) ans = <span class="built_in">max</span>(ans, <span class="built_in">dfs_dp</span>(i));</span><br><span class="line">    cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="comment">// ç¤ºä¾‹ï¼šå…¥åº¦0 SCCçš„sumï¼Œè‹¥å¤šåˆ™0ï¼ˆP2341æ±‡èšæ‰€æœ‰ç‚¹çš„è¿é€šåˆ†é‡çš„ç‚¹ï¼‰</span></span><br><span class="line">    <span class="comment">// vector&lt;int&gt; du(bcnt + 1);</span></span><br><span class="line">    <span class="comment">// for (int u = 1; u &lt;= bcnt; u++) for (int v : badj[u]) du[v]++;</span></span><br><span class="line">    <span class="comment">// int res = 0, cnt0 = 0;</span></span><br><span class="line">    <span class="comment">// for (int i = 1; i &lt;= bcnt; i++) if (!du[i]) &#123; res = bsum[i]; cnt0++; if (cnt0 &gt; 1) res = 0; &#125;</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; res &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li><strong>å˜ç§</strong>ï¼šèµ·ç‚¹å›ºå®šTarjan(1)ï¼›æ— æƒç”¨bsum[bcnt]++ã€‚</li>
<li><strong>å¤æ‚åº¦</strong>ï¼šO(n + m)ã€‚</li>
</ul>
<p><strong>å˜ç§æ¨¡æ¿1ï¼šå‰²ç‚¹ (Articulation Points)</strong></p>
<p>é€‚ç”¨äºP3388ï¼ˆæ— å‘å›¾å…³é”®ç‚¹ï¼‰ã€‚<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ... åŸºç¡€å¤´ï¼ˆæ— å‘ï¼šadd(u,v); add(v,u);ï¼‰</span></span><br><span class="line"><span class="type">int</span> root; <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">iscut</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Tarjan</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tot = <span class="number">0</span>;  <span class="comment">// å…¨å±€</span></span><br><span class="line">    dfn[u] = low[u] = ++tot;</span><br><span class="line">    <span class="type">int</span> child = <span class="number">0</span>;  <span class="comment">// å­æ ‘æ•°</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> ei = head[u], v; ei; ei = nxt[ei]) &#123;</span><br><span class="line">        v = to[ei];</span><br><span class="line">        <span class="keyword">if</span> (!dfn[v]) &#123;</span><br><span class="line">            child++;</span><br><span class="line">            <span class="built_in">Tarjan</span>(v, u);</span><br><span class="line">            low[u] = <span class="built_in">min</span>(low[u], low[v]);</span><br><span class="line">            <span class="keyword">if</span> (low[v] &gt;= dfn[u] &amp;&amp; fa != u) iscut[u] = <span class="number">1</span>;  <span class="comment">// éæ ¹ï¼šå­æ ‘æ— æ³•å›æº¯</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            low[u] = <span class="built_in">min</span>(low[u], dfn[v]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (u == root &amp;&amp; child &gt;= <span class="number">2</span>) iscut[u] = <span class="number">1</span>;  <span class="comment">// æ ¹ï¼š&gt;=2å­æ ‘</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ... è¾“å…¥åŒå‘è¾¹</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span> (!dfn[i]) &#123;</span><br><span class="line">        root = i; <span class="built_in">Tarjan</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span> (iscut[i]) ans.<span class="built_in">push_back</span>(i);</span><br><span class="line">    cout &lt;&lt; ans.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot;\n&quot;</span>; <span class="keyword">for</span> (<span class="type">int</span> x : ans) cout &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>; cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p><strong>æ¡¥å˜ç§</strong>ï¼šè®°å½•low[v] &gt;= dfn[u]çš„è¾¹(u,v)ä¸ºæ¡¥ã€‚</p>
<p><strong>å˜ç§æ¨¡æ¿2ï¼šåŒè¿é€šåˆ†é‡ (BCC)</strong></p>
</li>
</ul>
<p>æ˜¯æå¤§è”é€šå­å›¾ä¸”æ— å‰²ç‚¹</p>
<p>é€‚ç”¨äºP8435ï¼ˆæ— å‘å›¾å—+å¤§å°ï¼‰ã€‚<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ... åŸºç¡€å¤´ï¼ˆæ— å‘åŒè¾¹ï¼‰</span></span><br><span class="line"><span class="type">int</span> bcnt = <span class="number">0</span>; vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">badj</span>(N);  <span class="comment">// badj[i]: ç¬¬iå—çš„ç‚¹</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Tarjan</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> tot = <span class="number">0</span>;</span><br><span class="line">    dfn[u] = low[u] = ++tot;</span><br><span class="line">    Sta[Stop++] = u;  <span class="comment">// å…¥æ ˆ</span></span><br><span class="line">    <span class="type">int</span> child = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> ei = head[u], v; ei; ei = nxt[ei]) &#123;</span><br><span class="line">        v = to[ei];</span><br><span class="line">        <span class="keyword">if</span> (!dfn[v]) &#123;</span><br><span class="line">            child++;</span><br><span class="line">            <span class="built_in">Tarjan</span>(v, u);</span><br><span class="line">            low[u] = <span class="built_in">min</span>(low[u], low[v]);</span><br><span class="line">            <span class="keyword">if</span> (low[v] &gt;= dfn[u]) &#123;  <span class="comment">// BCCç»“æŸ</span></span><br><span class="line">                bcnt++;</span><br><span class="line">                <span class="type">int</span> q;</span><br><span class="line">                <span class="keyword">do</span> &#123;</span><br><span class="line">                    q = Sta[--Stop];</span><br><span class="line">                    badj[bcnt].<span class="built_in">push_back</span>(q);</span><br><span class="line">                &#125; <span class="keyword">while</span> (q != v);</span><br><span class="line">                <span class="keyword">if</span> (badj[bcnt].<span class="built_in">size</span>() == <span class="number">1</span> || dfn[u] == low[v]) badj[bcnt].<span class="built_in">push_back</span>(u);  <span class="comment">// å­¤ç‚¹æˆ–åŠ u</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> low[u] = <span class="built_in">min</span>(low[u], dfn[v]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (fa == <span class="number">0</span> &amp;&amp; Stop) &#123;  <span class="comment">// æ ¹å­¤ç‚¹</span></span><br><span class="line">        bcnt++; badj[bcnt] = &#123;u&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ... è¾“å…¥</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span> (!dfn[i]) <span class="built_in">Tarjan</span>(i);</span><br><span class="line">    cout &lt;&lt; bcnt &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= bcnt; i++) &#123;</span><br><span class="line">        cout &lt;&lt; badj[i].<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> x : badj[i]) cout &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>; cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li><strong>å˜ç§</strong>ï¼šè¾¹åŒè¿é€šç”¨è¾¹æ ˆï¼›è¾“å‡ºå—IDè€Œéç‚¹ã€‚</li>
</ul>
<p><strong>å˜ç§æ¨¡æ¿3ï¼šSCC + å†…éƒ¨æ£€æŸ¥ + ä¼ æ’­ (å¤æ‚å˜ç§)</strong></p>
<p>é€‚ç”¨äºTarjan.cppï¼ˆSCCå†…ä¸€è‡´æ€§æ£€æŸ¥ + å½±å“ä¼ æ’­ï¼‰ã€‚<br><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://codeforces.com/gym/105578/problem/M</span></span><br><span class="line"><span class="comment">// ... SCCåŸºç¡€ + é¢å¤–</span></span><br><span class="line">vector&lt;vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;&gt; <span class="built_in">g</span>(N);  <span class="comment">// &#123;v, w&#125; å¸¦æƒè¾¹</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dep</span><span class="params">(N)</span></span>; <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">vis</span><span class="params">(N)</span>, <span class="title">bad</span><span class="params">(N)</span></span>;  <span class="comment">// bad: åSCC</span></span><br><span class="line"><span class="type">bool</span> ok;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">check_scc</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> bid)</span> </span>&#123;  <span class="comment">// DFSæ£€æŸ¥SCCå†…è¾¹ä¸€è‡´ï¼ˆè·ç¦»ï¼‰</span></span><br><span class="line">    vis[u] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> [v, w] : g[u]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (bel[v] != bid) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (vis[v]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dep[v] != dep[u] + w) ok = <span class="literal">false</span>;  <span class="comment">// ä¸ä¸€è‡´</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            dep[v] = dep[u] + w;</span><br><span class="line">            <span class="built_in">check_scc</span>(v, bid);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ... SCCå</span></span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;  <span class="comment">// å‡è®¾0..n-1</span></span><br><span class="line">        <span class="keyword">if</span> (vis[bel[i]]) <span class="keyword">continue</span>;</span><br><span class="line">        vis[bel[i]] = <span class="literal">true</span>; ok = <span class="literal">true</span>;</span><br><span class="line">        dep[i] = <span class="number">0</span>; <span class="built_in">check_scc</span>(i, bel[i]);</span><br><span class="line">        <span class="keyword">if</span> (!ok) &#123; q.<span class="built_in">push</span>(bel[i]); bad[bel[i]] = <span class="literal">true</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å»ºåå‘DAG v2[bel[v]].push_back(bel[u]) è‹¥å½±å“è¾¹u-&gt;v</span></span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="type">int</span> b = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> pre : v2[b]) &#123;  <span class="comment">// åå‘ä¼ æ’­</span></span><br><span class="line">            <span class="keyword">if</span> (!bad[pre]) &#123; q.<span class="built_in">push</span>(pre); bad[pre] = <span class="literal">true</span>; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æŸ¥è¯¢ï¼šbad[bel[x]] ? &quot;Yes&quot; : &quot;No&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p><strong>æŠ€å·§</strong>ï¼šå¸¦æƒéœ€modæˆ–æ£€æŸ¥ä¸€è‡´ï¼›ä¼ æ’­ç”¨BFSã€‚</p>
<p><strong>å¸¸è§æŠ€å·§</strong></p>
</li>
<li><p><strong>åˆå§‹åŒ–</strong>ï¼šmemset(dfn, 0, sizeof(dfn)); æˆ–vectorå…¨0ã€‚</p>
</li>
<li><strong>å¤šæµ‹</strong>ï¼šæ¸…ç©ºhead/nxt/dfn/lowç­‰ï¼›tå¾ªç¯å†…é‡ç½®ã€‚</li>
<li><strong>æ— å‘å›¾</strong>ï¼šåŒåŠ è¾¹ï¼›faé˜²å›çˆ¶ã€‚</li>
<li><strong>æ ˆæº¢å‡º</strong>ï¼šnå¤§ç”¨iteræ ˆæˆ–è°ƒæ ˆå¤§å°ã€‚</li>
<li><strong>å»é‡DAG</strong>ï¼šç”¨setæ’å…¥badj[u]ã€‚</li>
<li><strong>è°ƒè¯•</strong>ï¼šæ‰“å°dfn/low/belï¼›ä»å°å›¾æµ‹ã€‚</li>
<li><strong>æ‰©å±•</strong>ï¼šKosarajuå¤‡é€‰ï¼ˆä¸¤æ¬¡DFSï¼‰ï¼›æ¡¥ç”¨low[v] &gt; dfn[u]ã€‚</li>
</ul>
<p><strong>ç«èµ›Tips</strong>ï¼šå…ˆåˆ¤æœ‰å‘/æ— å‘ï¼›SCCåå¿…ç¼©ç‚¹ï¼›O(n+m)ç¨³ï¼Œä¼˜å…ˆTarjanã€‚å¤åˆ¶æ¨¡æ¿æ”¹Tarjan/ifæ¡ä»¶/åç»­DPã€‚</p>
<h3 id="é«˜æ–¯æ¶ˆå…ƒï¼ˆGaussï¼‰"><a href="#é«˜æ–¯æ¶ˆå…ƒï¼ˆGaussï¼‰" class="headerlink" title="é«˜æ–¯æ¶ˆå…ƒï¼ˆGaussï¼‰"></a>é«˜æ–¯æ¶ˆå…ƒï¼ˆGaussï¼‰</h3><h4 id="åŠ æ³•æ–¹ç¨‹ç»„"><a href="#åŠ æ³•æ–¹ç¨‹ç»„" class="headerlink" title="åŠ æ³•æ–¹ç¨‹ç»„"></a>åŠ æ³•æ–¹ç¨‹ç»„</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P2455</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">50</span> + <span class="number">3</span>;</span><br><span class="line"><span class="function">vector <span class="title">v1</span><span class="params">(N, vector&lt;<span class="type">double</span>&gt;(N))</span></span>;</span><br><span class="line"><span class="keyword">auto</span> Gauss_add = [&amp;]() -&gt; <span class="type">void</span> &#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line">        <span class="type">int</span> max1 = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j ++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(j &lt; i &amp;&amp; <span class="built_in">abs</span>(v1[j][j]) &gt;= <span class="number">1e-7</span>) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">abs</span>(v1[j][i]) &gt; <span class="built_in">abs</span>(v1[max1][i])) max1 = j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">swap</span>(v1[i], v1[max1]);</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">abs</span>(v1[i][i]) &gt;= <span class="number">1e-7</span>) &#123;</span><br><span class="line">            <span class="type">double</span> temp = v1[i][i];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n + <span class="number">1</span>; j ++) v1[i][j] /= temp;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j ++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(i == j) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="type">double</span> rate = v1[j][i] / v1[i][i];</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k = i; k &lt;= n + <span class="number">1</span>; k ++) v1[j][k] -= rate * v1[i][k];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="å¼‚æˆ–æ–¹ç¨‹ç»„"><a href="#å¼‚æˆ–æ–¹ç¨‹ç»„" class="headerlink" title="å¼‚æˆ–æ–¹ç¨‹ç»„"></a>å¼‚æˆ–æ–¹ç¨‹ç»„</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long lon</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">50</span> + <span class="number">3</span>;</span><br><span class="line"><span class="function">vector <span class="title">v1</span><span class="params">(N, vector&lt;<span class="type">int</span>&gt;(N))</span></span>;</span><br><span class="line"><span class="keyword">auto</span> Gauss_xor = [&amp;]() -&gt; <span class="type">void</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (j &lt; i &amp;&amp; v1[j][j] == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (v1[j][i] == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="built_in">swap</span>(i, j);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (v1[i][i] != <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i == j || v1[j][i] != <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = i; k &lt;= n + <span class="number">1</span>; k++) v1[j][k] ^= v1[i][k];	</span><br><span class="line">        &#125;		</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="åŒä½™æ–¹ç¨‹ç»„"><a href="#åŒä½™æ–¹ç¨‹ç»„" class="headerlink" title="åŒä½™æ–¹ç¨‹ç»„"></a>åŒä½™æ–¹ç¨‹ç»„</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="comment">// é¢˜ç›®ä¼šä¿è¯å–æ¨¡çš„æ•°å­—ä¸ºè´¨æ•°</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">7</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">101</span>;</span><br><span class="line"><span class="type">int</span> v1[MAXN][MAXN];</span><br><span class="line"><span class="type">int</span> invTbl[MOD];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">buildInv</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    invTbl[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt; MOD; i++) &#123;</span><br><span class="line">        invTbl[i] = (MOD - invTbl[MOD % i] * (MOD / i) % MOD);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// é«˜æ–¯æ¶ˆå…ƒè§£å†³åŒä½™æ–¹ç¨‹ç»„æ¨¡ç‰ˆï¼Œä¿è¯åˆå§‹ç³»æ•°æ²¡æœ‰è´Ÿæ•°</span></span><br><span class="line"><span class="comment">// ((ç³»æ•° % MOD) + MOD) % MOD</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">gauss</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (j &lt; i &amp;&amp; v1[j][j] != <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (v1[j][i] != <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="built_in">swap</span>(v1[i], v1[j]);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (v1[i][i] != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">            	<span class="keyword">if</span>(i == j || !v1[j][i]) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="type">int</span> g = <span class="built_in">gcd</span>(v1[j][i], v1[i][i]);</span><br><span class="line">                <span class="type">int</span> a = v1[i][i] / g;</span><br><span class="line">                <span class="type">int</span> b = v1[j][i] / g;</span><br><span class="line">                <span class="keyword">if</span> (j &lt; i &amp;&amp; v1[j][j] != <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="comment">// å¦‚æœjè¡Œæœ‰ä¸»å…ƒï¼Œé‚£ä¹ˆä»jåˆ—åˆ°i-1åˆ—çš„æ‰€æœ‰ç³»æ•° * a</span></span><br><span class="line">                    <span class="comment">// æ­£ç¡®æ›´æ–°ä¸»å…ƒå’Œè‡ªç”±å…ƒä¹‹é—´çš„å…³ç³»</span></span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> k = j; k &lt; i; k++) v1[j][k] = v1[j][k] * a % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// æ­£å¸¸æ¶ˆå…ƒ</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = i; k &lt;= n + <span class="number">1</span>; k++) &#123;</span><br><span class="line">                    <span class="type">int</span> val = (v1[j][k] * a - v1[i][k] * b) % MOD;</span><br><span class="line">                    v1[j][k] = (val + MOD) % MOD;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v1[i][i] != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// æ£€æŸ¥å½“å‰ä¸»å…ƒæ˜¯å¦è¢«è‹¥å¹²è‡ªç”±å…ƒå½±å“</span></span><br><span class="line">            <span class="comment">// å¦‚æœå½“å‰ä¸»å…ƒä¸å—è‡ªç”±å…ƒå½±å“ï¼Œé‚£ä¹ˆå¯ä»¥ç¡®å®šå½“å‰ä¸»å…ƒçš„å€¼</span></span><br><span class="line">            <span class="comment">// å¦åˆ™ä¿ç•™è¿™ç§å½±å“ï¼Œæ­£ç¡®æ˜¾ç¤ºä¸»å…ƒå’Œè‡ªç”±å…ƒçš„å…³ç³»</span></span><br><span class="line">            <span class="type">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = i + <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (v1[i][j] != <span class="number">0</span>) &#123;</span><br><span class="line">                    flag = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">                <span class="comment">// æœ¬æ¥åº”è¯¥æ˜¯ï¼Œv1[i][n + 1] = v1[i][n + 1] / v1[i][i]</span></span><br><span class="line">                <span class="comment">// ä½†æ˜¯åœ¨æ¨¡æ„ä¹‰ä¸‹åº”è¯¥æ±‚é€†å…ƒï¼Œ(a / b) % MOD = (a * bçš„é€†å…ƒ) % MOD</span></span><br><span class="line">                v1[i][n + <span class="number">1</span>] = (v1[i][n + <span class="number">1</span>] * invTbl[v1[i][i]] % MOD);</span><br><span class="line">                v1[i][i] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="çº¿æ€§åŸº"><a href="#çº¿æ€§åŸº" class="headerlink" title="çº¿æ€§åŸº"></a>çº¿æ€§åŸº</h3><p>çº¿æ€§åŸºï¼ˆLinear Basisï¼Œåˆç§°å¼‚æˆ–åŸºã€XOR Basisï¼‰æ˜¯ä¸€ä¸ª<strong>ç”¨äºå¤„ç†é›†åˆä¸­æ•°çš„å¼‚æˆ–æ€§è´¨</strong>çš„é«˜æ•ˆæ•°å­¦ç»“æ„ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ç”¨ä¸€ç»„â€œçº¿æ€§æ— å…³â€çš„æ•°ï¼Œè¡¨ç¤ºåŸé›†åˆä¸­æ‰€æœ‰å¯èƒ½çš„å¼‚æˆ–ç»“æœã€‚</p>
<p>æ ¸å¿ƒæ€æƒ³ï¼š</p>
<p>åœ¨äºŒè¿›åˆ¶æ„ä¹‰ä¸‹ï¼Œå¼‚æˆ–è¿ç®—ç›¸å½“äº<strong>æ¨¡ 2 åŠ æ³•</strong>ã€‚<br> å› æ­¤ï¼Œä¸€ä¸ªæ•°é›† <code>&#123;aâ‚, aâ‚‚, â€¦, aâ‚™&#125;</code> å¯ä»¥çœ‹ä½œæ˜¯ç”±è‹¥å¹²ä¸ªäºŒè¿›åˆ¶å‘é‡ç»„æˆçš„å‘é‡ç©ºé—´ã€‚<br> çº¿æ€§åŸºå°±æ˜¯<strong>è¯¥ç©ºé—´çš„ä¸€ç»„æœ€å°ç”Ÿæˆå‘é‡ï¼ˆbasisï¼‰</strong>ï¼Œå³æ»¡è¶³ï¼š</p>
<ul>
<li>ä»»æ„é›†åˆä¸­çš„æ•°éƒ½èƒ½ç”±è¿™äº›åŸºå‘é‡å¼‚æˆ–å¾—åˆ°ï¼›</li>
<li>åŸºå‘é‡ä¹‹é—´ä¸¤ä¸¤çº¿æ€§æ— å…³ï¼ˆæ— æ³•ç”±å…¶ä»–å¼‚æˆ–å¾—åˆ°ï¼‰ã€‚</li>
</ul>
<p>åŸºæœ¬æ€§è´¨ï¼š</p>
<p>è®¾çº¿æ€§åŸºä¸º <code>&#123;bâ‚, bâ‚‚, â€¦, bâ‚–&#125;</code>ï¼Œåˆ™ï¼š</p>
<ol>
<li><strong>å¯è¡¨ç¤ºæ€§</strong>ï¼š<br>  åŸé›†åˆä¸­ä»»æ„æ•°éƒ½å¯ç”±åŸºå‘é‡å¼‚æˆ–å¾—åˆ°ã€‚<br>  æ¯”å¦‚ï¼š<code>x = bâ‚‚ ^ bâ‚… ^ bâ‚‡</code>ã€‚</li>
<li><strong>å”¯ä¸€æ€§</strong>ï¼š<br>  æ¯ä¸ªæ•°å¯¹åº”çš„åŸºå‘é‡ç»„åˆæ˜¯å”¯ä¸€çš„ã€‚</li>
<li><strong>åŸºçš„ç§©ï¼ˆrankï¼‰</strong>ï¼š<br>  <code>k</code> æ˜¯çº¿æ€§åŸºçš„å¤§å°ï¼Œè¯´æ˜é›†åˆèƒ½ç”Ÿæˆ <code>2^k</code> ä¸ªä¸åŒçš„å¼‚æˆ–ç»“æœã€‚</li>
<li><strong>æœ€å¤§å¼‚æˆ–å€¼</strong>ï¼š<br>  ä»é«˜ä½åˆ°ä½ä½ä¾æ¬¡å°è¯•ç”¨åŸºå‘é‡â€œæŠ¬é«˜â€ç»“æœå³å¯è´ªå¿ƒå¾—åˆ°æœ€å¤§å€¼ã€‚</li>
</ol>
<p>åœºæ™¯ï¼š</p>
<p><strong>æœ€å¤§å¼‚æˆ–å­é›†å’Œ</strong>ï¼ˆLuogu P3812ã€æ´›è°·æ¨¡æ¿é¢˜ï¼‰<br> åœ¨é›†åˆä¸­é€‰è‹¥å¹²ä¸ªæ•°ï¼Œä½¿å¼‚æˆ–å’Œæœ€å¤§ã€‚</p>
<p><strong>åˆ¤æ–­å¼‚æˆ–å¯è¾¾æ€§</strong><br> ç»™å®šå¤šä¸ªæ•°ä¸ç›®æ ‡å€¼ <code>x</code>ï¼Œåˆ¤æ–­æ˜¯å¦èƒ½å¼‚æˆ–å‡º <code>x</code>ã€‚</p>
<p><strong>ç¬¬ k å°å¼‚æˆ–å€¼</strong><br> æ±‚é›†åˆä¸­æ‰€æœ‰å¯èƒ½å¼‚æˆ–ç»“æœçš„ç¬¬ <code>k</code> å°å€¼ã€‚</p>
<p><strong>åˆå¹¶å¤šä¸ªé›†åˆçš„å¼‚æˆ–æ€§è´¨</strong><br> åœ¨å›¾è®ºã€æ ‘ä¸Šé—®é¢˜ä¸­ç”¨äºå¤„ç†è·¯å¾„å¼‚æˆ–å€¼ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P3812</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">50</span> + <span class="number">3</span>, BIT = <span class="number">50</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(N)</span>, <span class="title">basis</span><span class="params">(N)</span></span>; <span class="comment">// v1: è¾“å…¥æ•°ç»„, basis: çº¿æ€§åŸº</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span> (t--) &#123;</span><br><span class="line">		<span class="type">int</span> n;</span><br><span class="line">		cin &gt;&gt; n;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; v1[i];</span><br><span class="line">		<span class="comment">// æ’å…¥å‡½æ•°ï¼šå°è¯•å°† x æ’å…¥çº¿æ€§åŸº</span></span><br><span class="line">		<span class="keyword">auto</span> insert = [&amp;](<span class="type">int</span> x) -&gt; <span class="type">bool</span> &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> i = BIT; i &gt;= <span class="number">0</span>; i--) &#123;     <span class="comment">// ä»é«˜ä½åˆ°ä½ä½æšä¸¾</span></span><br><span class="line">				<span class="keyword">if</span> ((x &gt;&gt; i) &amp; <span class="number">1</span>) &#123;              <span class="comment">// è‹¥ç¬¬ i ä½ä¸º 1</span></span><br><span class="line">					<span class="keyword">if</span> (!basis[i]) &#123;             <span class="comment">// è‹¥è¯¥ä½å°šæ— åŸºåº•</span></span><br><span class="line">						basis[i] = x;            <span class="comment">// è®°å½•ä¸ºæ–°çš„åŸºåº•</span></span><br><span class="line">						<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					x ^= basis[i];               <span class="comment">// å¦åˆ™æ¶ˆå»è¯¥ä½</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// è‹¥æœ€åä¸º 0ï¼Œè¯´æ˜çº¿æ€§ç›¸å…³</span></span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="comment">// Gauss version</span></span><br><span class="line">		<span class="keyword">auto</span> compute2 = [&amp;]() -&gt; <span class="type">void</span> &#123;</span><br><span class="line">			vector&lt;<span class="type">int</span>&gt; <span class="built_in">basis2</span>(N);</span><br><span class="line">			<span class="type">int</span> len = <span class="number">0</span>;</span><br><span class="line">			<span class="type">bool</span> zero2;</span><br><span class="line">			len = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> i = BIT; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="type">int</span> j = len; j &lt;= n; j++) &#123;</span><br><span class="line">					<span class="keyword">if</span> ((basis2[j] &amp; (<span class="number">1LL</span> &lt;&lt; i)) != <span class="number">0</span>) &#123;</span><br><span class="line">						<span class="built_in">swap</span>(j, len);</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> ((basis2[len] &amp; (<span class="number">1LL</span> &lt;&lt; i)) != <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">						<span class="keyword">if</span> (j != len &amp;&amp; (basis2[j] &amp; (<span class="number">1LL</span> &lt;&lt; i)) != <span class="number">0</span>)</span><br><span class="line">							basis2[j] ^= basis2[len];</span><br><span class="line">					&#125;</span><br><span class="line">					len++;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			len--;</span><br><span class="line">			zero2 = len != n;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="comment">// æ„å»ºçº¿æ€§åŸº</span></span><br><span class="line">		<span class="type">bool</span> zero1 = <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">insert</span>(v1[i])) zero1 = <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// æ±‚æœ€å¤§å¼‚æˆ–å’Œ</span></span><br><span class="line">		<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = BIT; i &gt;= <span class="number">0</span>; i--) ans = <span class="built_in">max</span>(ans, ans ^ basis[i]);</span><br><span class="line">		cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="å·®åˆ†çº¦æŸ"><a href="#å·®åˆ†çº¦æŸ" class="headerlink" title="å·®åˆ†çº¦æŸ"></a>å·®åˆ†çº¦æŸ</h3><p>å·®åˆ†çº¦æŸç³»ç»Ÿæ˜¯ä¸€ç»„å…³äºå˜é‡çš„çº¿æ€§ä¸ç­‰å¼ï¼Œ<strong>æ¯ä¸ªä¸ç­‰å¼éƒ½å½¢å¦‚ï¼š</strong>$ x_i - x_j \leq c_k$,å…¶ä¸­ï¼š</p>
<ul>
<li>( $x_1, x_2, \dots, x_n$ ) æ˜¯æœªçŸ¥å˜é‡ï¼›</li>
<li>( $c_k$ ) æ˜¯å¸¸æ•°ï¼›</li>
<li>æ¯æ¡çº¦æŸ ( $x_i - x_j \leq c_k$ ) é™åˆ¶äº†ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„â€œç›¸å¯¹å¤§å°â€ã€‚</li>
</ul>
<p>ç³»ç»Ÿç›®æ ‡ï¼šåˆ¤æ–­è¿™äº›ä¸ç­‰å¼æ˜¯å¦<strong>æœ‰è§£</strong>ï¼Œè‹¥æœ‰åˆ™æ±‚å‡º<strong>ä¸€ç»„å¯è¡Œè§£</strong>ã€‚</p>
<p>å›¾è®ºå»ºæ¨¡:</p>
<p>å°†æ¯ä¸ªå˜é‡ ( $x_i$ ) çœ‹ä½œå›¾çš„ä¸€ä¸ªé¡¶ç‚¹ã€‚æ¯æ¡çº¦æŸ ( $x_i - x_j \leq c_k$ ) è½¬æ¢ä¸ºä¸€æ¡<strong>æœ‰å‘è¾¹</strong>ï¼š$ j \rightarrow i,\quad æƒå€¼ = c_k$</p>
<p>è§£é‡Šï¼š</p>
<ul>
<li>è‹¥å­˜åœ¨è·¯å¾„ ($ j \to i$ ) æƒå€¼å’Œä¸º ( w )ï¼Œ åˆ™æ„å‘³ç€ ( $x_i - x_j \leq w$ ).</li>
<li>æ‰€ä»¥è¦è®©æ‰€æœ‰ä¸ç­‰å¼æˆç«‹ï¼Œå¿…é¡»å­˜åœ¨ä¸€ç»„ ( x )ï¼Œä½¿å¾—å¯¹æ¯æ¡è¾¹ ( (u,v,w) )ï¼š $x_v \leq x_u + w$</li>
</ul>
<p>è¿™å…¶å®æ˜¯<strong>å•æºæœ€çŸ­è·¯çº¦æŸ</strong>çš„å½¢å¼ã€‚</p>
<p>å·®åˆ†çº¦æŸçš„è§£å¯é€šè¿‡æœ€çŸ­è·¯æ¨¡å‹æ±‚å‡ºï¼š</p>
<ol>
<li>æ–°å¢ä¸€ä¸ª<strong>è¶…çº§æºç‚¹ 0</strong>ï¼›</li>
<li>ä» 0 å‘æ¯ä¸ªç‚¹ ( i ) è¿ä¸€æ¡è¾¹ ( (0,i,0) )ï¼Œç¡®ä¿å›¾è¿é€šï¼›</li>
<li>ä½¿ç”¨ <strong>Bellman-Ford</strong> æˆ– <strong>SPFA</strong> ç®—æ³•æ±‚æœ€çŸ­è·¯ï¼›</li>
<li>è‹¥å›¾ä¸­å­˜åœ¨<strong>è´Ÿæƒç¯</strong>ï¼Œåˆ™ç³»ç»Ÿ<strong>æ— è§£</strong>ï¼›</li>
<li>è‹¥æ— è´Ÿç¯ï¼Œ<code>dist[i]</code> å³ä¸ºä¸€ç»„æ»¡è¶³æ‰€æœ‰ä¸ç­‰å¼çš„å¯è¡Œè§£ã€‚</li>
</ol>
<blockquote>
<p>ç›´è§‚ç†è§£ï¼šè´Ÿç¯æ„å‘³ç€å­˜åœ¨ä¸€ç³»åˆ—ä¸ç­‰å¼ç›¸äº’çŸ›ç›¾ï¼Œå¯¼è‡´ â€œè¶Šèµ°è¶Šå°â€ï¼Œå³æ— è§£ã€‚</p>
</blockquote>
<p>å¯è¡Œè§£çš„å«ä¹‰:</p>
<p>å¾—åˆ°çš„ <code>dist[i]</code> å¹¶ä¸æ˜¯å”¯ä¸€è§£ï¼Œå®ƒåªæ˜¯æŸä¸ªæ»¡è¶³æ¡ä»¶çš„ç›¸å¯¹å€¼æ–¹æ¡ˆã€‚<br> äº‹å®ä¸Šï¼Œè‹¥ç³»ç»Ÿæœ‰è§£ï¼Œåˆ™æ‰€æœ‰è§£é›†åˆæ„æˆä¸€ä¸ªå‡¸å¤šé¢ä½“ï¼š$ { x \mid x_i - x_j \leq c_k }$</p>
<p>åˆ¤æ— è§£æ¡ä»¶ï¼ˆè´Ÿç¯ï¼‰:</p>
<p>å‡è®¾å­˜åœ¨ä¸€ä¸ªç¯ ( $x_1 - x_2 \leq c_1, x_2 - x_3 \leq c_2, \dots, x_k - x_1 \leq c_k )$</p>
<p>æŠŠå®ƒä»¬åŠ èµ·æ¥å¾—ï¼š$ 0 \leq c_1 + c_2 + \dots + c_k$</p>
<p>å¦‚æœå­˜åœ¨ä¸€ä¸ªç¯ä½¿å¾— ( $c_1 + c_2 + \dots + c_k &lt; 0$ )ï¼Œè¯´æ˜è¯¥ç³»ç»Ÿæ— è§£ â€”â€” å› ä¸ºæ²¿ç¯ä¸æ–­æ¾å¼›ä¼šè®©å€¼æ— é™å‡å°ã€‚</p>
<p>ç®—æ³•å¤æ‚åº¦:</p>
<ul>
<li><strong>Bellman-Ford</strong>ï¼š( O(nm) )</li>
<li><strong>SPFAï¼ˆé˜Ÿåˆ—ä¼˜åŒ–ï¼‰</strong>ï¼šå‡æ‘Šå¿«å¾ˆå¤šï¼Œç«èµ›å¸¸ç”¨ã€‚</li>
<li>( $n, m \le 5 \times 10^3$ ) æ—¶å¯è½»æ¾é€šè¿‡ã€‚</li>
</ul>
<p>ä¸¤ç§å¸¸è§å†™æ³•å¯¹æ¯”:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>åˆ¤æ–­æ¡ä»¶</th>
<th>æ¾å¼›æ–¹å¼</th>
<th>è¡¨ç¤ºå«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>æœ€çŸ­è·¯å‹</strong></td>
<td><code>dist[v] &gt; dist[u] + w</code></td>
<td>å–æ›´å°å€¼</td>
<td>åˆ¤<strong>è´Ÿç¯</strong></td>
</tr>
<tr>
<td><strong>æœ€é•¿è·¯å‹</strong></td>
<td><code>dist[v] &lt; dist[u] + w</code></td>
<td>å–æ›´å¤§å€¼</td>
<td>åˆ¤<strong>æ­£ç¯</strong>ï¼ˆæ— é™å¢å¤§ï¼‰</td>
</tr>
</tbody>
</table>
</div>
<p>ä¸¤è€…ç­‰ä»·ï¼Œåªæ˜¯æ–¹å‘ç›¸åã€‚<br> ç«èµ›ä¸­æ¨è<strong>ç»Ÿä¸€ä½¿ç”¨æœ€çŸ­è·¯å‹ï¼ˆè´Ÿç¯ï¼‰ç‰ˆ</strong>ï¼Œæ›´å¸¸è§ã€ç¨³å®šã€‚</p>
<h4 id="å½¢å¼1ï¼šç›´æ¥å»ºè¾¹-X-i-X-j-â‰¤-C-â‡’-j-â†’-i-æƒC-ï¼ˆæœ€çŸ­è·¯-åˆ¤è´Ÿç¯ï¼‰"><a href="#å½¢å¼1ï¼šç›´æ¥å»ºè¾¹-X-i-X-j-â‰¤-C-â‡’-j-â†’-i-æƒC-ï¼ˆæœ€çŸ­è·¯-åˆ¤è´Ÿç¯ï¼‰" class="headerlink" title="å½¢å¼1ï¼šç›´æ¥å»ºè¾¹ X_i - X_j â‰¤ C  â‡’  j â†’ i (æƒC)ï¼ˆæœ€çŸ­è·¯/åˆ¤è´Ÿç¯ï¼‰"></a>å½¢å¼1ï¼šç›´æ¥å»ºè¾¹ <code>X_i - X_j â‰¤ C  â‡’  j â†’ i (æƒC)</code>ï¼ˆæœ€çŸ­è·¯/åˆ¤è´Ÿç¯ï¼‰</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// P5960 / å·®åˆ†çº¦æŸ å½¢å¼1ï¼šXi - Xj &lt;= C  =&gt; edge j-&gt;i (C)</span></span><br><span class="line"><span class="comment">// æœ‰è§£åˆ™è¾“å‡ºä¸€ç»„æ»¡è¶³è§£ï¼›æ— è§£è¾“å‡º NO</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">long</span> <span class="type">long</span> INF = (<span class="number">1LL</span>&lt;&lt;<span class="number">60</span>);</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> n, m; </span><br><span class="line">    <span class="keyword">if</span> (!(cin &gt;&gt; n &gt;&gt; m)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// æ€»è¾¹æ•° = çº¦æŸm + è¶…çº§æº0åˆ°æ¯ä¸ªç‚¹n</span></span><br><span class="line">    <span class="type">int</span> E = m + n + <span class="number">5</span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head</span><span class="params">(n+<span class="number">1</span>, <span class="number">-1</span>)</span>, <span class="title">nxt</span><span class="params">(E)</span>, <span class="title">to</span><span class="params">(E)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">cntIn</span><span class="params">(n+<span class="number">1</span>, <span class="number">0</span>)</span></span>;          <span class="comment">// å…¥é˜Ÿæ¾å¼›è®¡æ•°</span></span><br><span class="line">    <span class="function">vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; <span class="title">w</span><span class="params">(E)</span>, <span class="title">dist</span><span class="params">(n+<span class="number">1</span>, INF)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">char</span>&gt; <span class="title">inq</span><span class="params">(n+<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="type">int</span> ec = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">auto</span> add = [&amp;](<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">long</span> <span class="type">long</span> ww)&#123;</span><br><span class="line">        to[ec] = v; w[ec] = ww; nxt[ec] = head[u]; head[u] = ec++;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// è¶…çº§æº0 -&gt; i (0)ï¼Œä¿è¯å¯è¾¾</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">add</span>(<span class="number">0</span>, i, <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// è¯»å…¥ Xi - Xj &lt;= C   =&gt;   j -&gt; i (C)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, x, y; i &lt; m; ++i) &#123;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> c; </span><br><span class="line">        cin &gt;&gt; x &gt;&gt; y &gt;&gt; c;</span><br><span class="line">        <span class="built_in">add</span>(y, x, c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// SPFA åˆ¤è´Ÿç¯ï¼ˆæœ€çŸ­è·¯ï¼‰</span></span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    dist[<span class="number">0</span>] = <span class="number">0</span>; inq[<span class="number">0</span>] = <span class="number">1</span>; q.<span class="built_in">push</span>(<span class="number">0</span>); cntIn[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">auto</span> hasNegCycle = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>() &amp;&amp; !hasNegCycle) &#123;</span><br><span class="line">        <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">        inq[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> e = head[u]; e != <span class="number">-1</span>; e = nxt[e]) &#123;</span><br><span class="line">            <span class="type">int</span> v = to[e];</span><br><span class="line">            <span class="type">long</span> <span class="type">long</span> nv = dist[u] + w[e];</span><br><span class="line">            <span class="keyword">if</span> (dist[u] != INF &amp;&amp; dist[v] &gt; nv) &#123;</span><br><span class="line">                dist[v] = nv;</span><br><span class="line">                <span class="keyword">if</span> (!inq[v]) &#123;</span><br><span class="line">                    inq[v] = <span class="number">1</span>;</span><br><span class="line">                    q.<span class="built_in">push</span>(v);</span><br><span class="line">                    <span class="keyword">if</span> (++cntIn[v] &gt; n) &#123; <span class="comment">// æ³¨æ„æ˜¯&gt;nï¼ˆå«è¶…çº§æº0ï¼‰</span></span><br><span class="line">                        hasNegCycle = <span class="literal">true</span>; <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (hasNegCycle) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;NO\n&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            cout &lt;&lt; (dist[i]==INF? <span class="number">0</span> : dist[i]) &lt;&lt; (i==n?<span class="string">&#x27;\n&#x27;</span>:<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¯´æ˜ï¼š<code>dist[i]==INF</code> çš„ç‚¹åœ¨æœ¬é¢˜æ¨¡å‹ä¸‹ä¸ä¼šå‡ºç°ï¼ˆå› æœ‰è¶…çº§æºè¿åˆ°æ‰€æœ‰ç‚¹ï¼‰ï¼Œä½†ç¨³å¦¥èµ·è§åšäº†ä¿æŠ¤ï¼Œç½® 0 è¾“å‡ºã€‚</p>
</blockquote>
<h4 id="å½¢å¼2ï¼šæ”¹å†™ä¸º-X-j-X-i-â‰¥-Cï¼ˆæœ€é•¿è·¯-åˆ¤â€œæ— é™å¢å¤§ç¯â€ï¼‰"><a href="#å½¢å¼2ï¼šæ”¹å†™ä¸º-X-j-X-i-â‰¥-Cï¼ˆæœ€é•¿è·¯-åˆ¤â€œæ— é™å¢å¤§ç¯â€ï¼‰" class="headerlink" title="å½¢å¼2ï¼šæ”¹å†™ä¸º X_j - X_i â‰¥ -Cï¼ˆæœ€é•¿è·¯/åˆ¤â€œæ— é™å¢å¤§ç¯â€ï¼‰"></a>å½¢å¼2ï¼šæ”¹å†™ä¸º <code>X_j - X_i â‰¥ -C</code>ï¼ˆæœ€é•¿è·¯/åˆ¤â€œæ— é™å¢å¤§ç¯â€ï¼‰</h4><p>å°†çº¦æŸ <code>X_i - X_j â‰¤ C</code> æ”¹å†™ä¸º <code>X_j â‰¥ X_i - C</code>ï¼Œå†å†™æˆ<strong>æœ€é•¿è·¯</strong>é£æ ¼ <code>dist[v] &lt; dist[u] + w</code> çš„æ¾å¼›å¼ï¼Œå¯å– <code>u=i, v=j, w=-C</code>ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// P5960 / å·®åˆ†çº¦æŸ å½¢å¼2ï¼šXi - Xj &lt;= C  =&gt;  edge i-&gt;j (-C)</span></span><br><span class="line"><span class="comment">// æœ‰è§£åˆ™è¾“å‡ºä¸€ç»„æ»¡è¶³è§£ï¼›æ— è§£è¾“å‡º NO</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">long</span> <span class="type">long</span> NINF = -(<span class="number">1LL</span>&lt;&lt;<span class="number">60</span>);</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> n, m; </span><br><span class="line">    <span class="keyword">if</span> (!(cin &gt;&gt; n &gt;&gt; m)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> E = m + n + <span class="number">5</span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head</span><span class="params">(n+<span class="number">1</span>, <span class="number">-1</span>)</span>, <span class="title">nxt</span><span class="params">(E)</span>, <span class="title">to</span><span class="params">(E)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">cntIn</span><span class="params">(n+<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; <span class="title">w</span><span class="params">(E)</span>, <span class="title">dist</span><span class="params">(n+<span class="number">1</span>, NINF)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">char</span>&gt; <span class="title">inq</span><span class="params">(n+<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="type">int</span> ec = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">auto</span> add = [&amp;](<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">long</span> <span class="type">long</span> ww)&#123;</span><br><span class="line">        to[ec] = v; w[ec] = ww; nxt[ec] = head[u]; head[u] = ec++;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// è¶…çº§æº0 -&gt; i (0)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">add</span>(<span class="number">0</span>, i, <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// è¯»å…¥ Xi - Xj &lt;= C   =&gt;   i -&gt; j (-C)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, x, y; i &lt; m; ++i) &#123;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> c; </span><br><span class="line">        cin &gt;&gt; x &gt;&gt; y &gt;&gt; c;</span><br><span class="line">        <span class="built_in">add</span>(x, y, -c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// SPFA åˆ¤â€œå¯æ— é™å¢å¤§â€çš„æ­£ç¯ï¼ˆå¯¹åº”åŸæ¨¡å‹æ— è§£ï¼‰</span></span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    dist[<span class="number">0</span>] = <span class="number">0</span>; inq[<span class="number">0</span>] = <span class="number">1</span>; q.<span class="built_in">push</span>(<span class="number">0</span>); cntIn[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">auto</span> hasPosCycle = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>() &amp;&amp; !hasPosCycle) &#123;</span><br><span class="line">        <span class="type">int</span> u = q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">        inq[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> e = head[u]; e != <span class="number">-1</span>; e = nxt[e]) &#123;</span><br><span class="line">            <span class="type">int</span> v = to[e];</span><br><span class="line">            <span class="type">long</span> <span class="type">long</span> nv = dist[u] + w[e];</span><br><span class="line">            <span class="keyword">if</span> (dist[v] &lt; nv) &#123;</span><br><span class="line">                dist[v] = nv;</span><br><span class="line">                <span class="keyword">if</span> (!inq[v]) &#123;</span><br><span class="line">                    inq[v] = <span class="number">1</span>;</span><br><span class="line">                    q.<span class="built_in">push</span>(v);</span><br><span class="line">                    <span class="keyword">if</span> (++cntIn[v] &gt; n) &#123; <span class="comment">// æ³¨æ„æ˜¯&gt;nï¼ˆå«è¶…çº§æº0ï¼‰</span></span><br><span class="line">                        hasPosCycle = <span class="literal">true</span>; <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (hasPosCycle) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;NO\n&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            cout &lt;&lt; (dist[i]==NINF? <span class="number">0</span> : dist[i]) &lt;&lt; (i==n?<span class="string">&#x27;\n&#x27;</span>:<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å…¨æ’åˆ—"><a href="#å…¨æ’åˆ—" class="headerlink" title="å…¨æ’åˆ—"></a>å…¨æ’åˆ—</h3><p>å¦‚ä½•éšæ„è·å–æŸä¸€ä¸ªæ’åˆ—çš„å­—å…¸åºåæ¬¡å’Œç»™å®šå­—å…¸åºåæ¬¡æ„é€ æ’åˆ—ã€‚</p>
<p>æœ¬è´¨ä¸ºä»å‰å¾€åéå†ï¼Œå¦‚æœæŸä¸€ä½ä¸æ˜¯å½“å‰å‰©ä½™æ•°å­—çš„æœ€å°å€¼ï¼Œåˆ™å…¶è´¡çŒ®ä¸º:$d * n^{â€˜}!$ï¼Œå…¶ä¸­ï¼Œdä¸ºå½“å‰æ•°å­—ä¸æœ€å°å€¼çš„åæ¬¡å·®ï¼Œ$n_{â€˜}$ä¸ºnä¸å½“å‰ä½ç½®çš„å·®å€¼ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">20</span> + <span class="number">2</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">base</span><span class="params">(N)</span>, <span class="title">bit</span><span class="params">(N)</span>, <span class="title">tar</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">	<span class="keyword">while</span> (t--) &#123;</span><br><span class="line">		<span class="type">int</span> n, q;</span><br><span class="line">		cin &gt;&gt; n &gt;&gt; q;</span><br><span class="line">		bit[n] = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = n - <span class="number">1</span>, b = <span class="number">1</span>; i; i --) &#123;</span><br><span class="line">			bit[i] = b;</span><br><span class="line">			b *= n - i + <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">char</span> op;</span><br><span class="line">		<span class="type">int</span> x, r;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; q; i ++) &#123;</span><br><span class="line">			cin &gt;&gt; op;</span><br><span class="line">			r = n;</span><br><span class="line">			<span class="built_in">iota</span>(base.<span class="built_in">begin</span>() + <span class="number">1</span>, base.<span class="built_in">begin</span>() + <span class="number">1</span> + n, <span class="number">1</span>);</span><br><span class="line">            <span class="comment">// ç»´æŠ¤å‰©ä½™æ•°å­—å…³ç³»</span></span><br><span class="line">			<span class="keyword">auto</span> rem = [&amp;](<span class="type">int</span> l) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> i = l; i &lt; r; i ++) <span class="built_in">swap</span>(base[i], base[i + <span class="number">1</span>]);</span><br><span class="line">				r --;</span><br><span class="line">			&#125;;</span><br><span class="line">            <span class="comment">// æ„é€ æ’åˆ—</span></span><br><span class="line">			<span class="keyword">if</span>(op == <span class="string">&#x27;P&#x27;</span>) &#123;</span><br><span class="line">				cin &gt;&gt; x;</span><br><span class="line">				<span class="keyword">auto</span> make = [&amp;](<span class="type">int</span> x) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">					<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i ++) &#123;</span><br><span class="line">						<span class="type">int</span> need = x / bit[i];</span><br><span class="line">						tar[i] = base[need + <span class="number">1</span>];</span><br><span class="line">						<span class="built_in">rem</span>(need + <span class="number">1</span>);</span><br><span class="line">						x -= need * bit[i];</span><br><span class="line">					&#125;</span><br><span class="line">					tar[n] = base[<span class="number">1</span>];</span><br><span class="line">				&#125;;</span><br><span class="line">				<span class="built_in">make</span>(x - <span class="number">1</span>);</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) cout &lt;&lt; tar[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// è®¡ç®—æ’åˆ—åæ¬¡    </span></span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) cin &gt;&gt; tar[i];</span><br><span class="line">				<span class="keyword">auto</span> get = [&amp;]() -&gt; <span class="type">int</span> &#123;</span><br><span class="line">					<span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">					<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line">						<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= r; j ++) &#123;</span><br><span class="line">							<span class="keyword">if</span>(base[j] == tar[i]) &#123;</span><br><span class="line">								ans += (j - <span class="number">1</span>) * bit[i];</span><br><span class="line">								<span class="built_in">rem</span>(j);</span><br><span class="line">								<span class="keyword">break</span>;</span><br><span class="line">							&#125;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">return</span> ans;</span><br><span class="line">				&#125;;</span><br><span class="line">				cout &lt;&lt; <span class="built_in">get</span>() &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;			</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="STL"><a href="#STL" class="headerlink" title="STL"></a>STL</h2><h3 id="set"><a href="#set" class="headerlink" title="set"></a>set</h3><p>åŸºäºçº¢é»‘æ ‘å®ç°çš„è‡ªåŠ¨æ’åºã€æ— é‡å¤å…ƒç´ çš„å…³è”å®¹å™¨</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">set&lt;<span class="type">int</span>&gt; s;                  <span class="comment">// å‡åºï¼Œé»˜è®¤ less&lt;int&gt;</span></span><br><span class="line">set&lt;string&gt; names;</span><br><span class="line">set&lt;<span class="type">int</span>, greater&lt;<span class="type">int</span>&gt;&gt; s2;   <span class="comment">// é™åºæ’åˆ—</span></span><br><span class="line">s.<span class="built_in">insert</span>(<span class="number">5</span>);    <span class="comment">// æ’å…¥ 5ï¼Œè‹¥å·²å­˜åœ¨åˆ™æ— æ•ˆ</span></span><br><span class="line">s.<span class="built_in">erase</span>(<span class="number">5</span>);       <span class="comment">// åˆ é™¤å€¼ä¸º5çš„å…ƒç´ </span></span><br><span class="line">s.<span class="built_in">erase</span>(it);      <span class="comment">// é€šè¿‡è¿­ä»£å™¨åˆ é™¤</span></span><br><span class="line">s.<span class="built_in">erase</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">end</span>()); <span class="comment">// æ¸…ç©º</span></span><br><span class="line"><span class="keyword">auto</span> it = s.<span class="built_in">find</span>(<span class="number">5</span>);     <span class="comment">// æ‰¾åˆ°è¿”å›è¿­ä»£å™¨ï¼Œå¦åˆ™ä¸º s.end()</span></span><br><span class="line"><span class="keyword">if</span> (it != s.<span class="built_in">end</span>()) cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; found\n&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (s.<span class="built_in">count</span>(<span class="number">5</span>)) cout &lt;&lt; <span class="string">&quot;å­˜åœ¨&quot;</span>;</span><br><span class="line">s.<span class="built_in">size</span>();</span><br><span class="line">s.<span class="built_in">empty</span>();</span><br><span class="line">s.<span class="built_in">clear</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> it = s.<span class="built_in">begin</span>(); it != s.<span class="built_in">end</span>(); ++it)</span><br><span class="line">    cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> x : s)</span><br><span class="line">    cout &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line"><span class="keyword">auto</span> it1 = s.<span class="built_in">lower_bound</span>(<span class="number">5</span>); <span class="comment">// è¿”å› â‰¥ 5 çš„ç¬¬ä¸€ä¸ªå…ƒç´ è¿­ä»£å™¨</span></span><br><span class="line"><span class="keyword">auto</span> it2 = s.<span class="built_in">upper_bound</span>(<span class="number">5</span>); <span class="comment">// è¿”å› &gt; 5 çš„ç¬¬ä¸€ä¸ªå…ƒç´ è¿­ä»£å™¨</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cmp</span> &#123;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&amp; a, <span class="type">const</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&amp; b)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a.first &lt; b.first;  <span class="comment">// å¯å®šä¹‰å¤åˆæ’åºè§„åˆ™</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">set&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;, cmp&gt; s;</span><br></pre></td></tr></table></figure>
<p>æ’å…¥/åˆ é™¤/æŸ¥æ‰¾éƒ½æ˜¯O(log n)</p>
<h3 id="ordered-set"><a href="#ordered-set" class="headerlink" title="ordered_set"></a>ordered_set</h3><p>è§£é‡Šå„ä¸ªéƒ¨åˆ†çš„ä½œç”¨</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>ä»£ç éƒ¨åˆ†</th>
<th>åŠŸèƒ½</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>s.insert(5)</code></td>
<td>æ’å…¥å…ƒç´ </td>
<td><code>ordered_set</code> è‡ªåŠ¨å»é‡</td>
</tr>
<tr>
<td><code>s.erase(7)</code></td>
<td>åˆ é™¤å…ƒç´ </td>
<td>éœ€å…ˆæ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨</td>
</tr>
<tr>
<td><code>find_by_order(k)</code></td>
<td>è·å–ç¬¬ k å°å…ƒç´ </td>
<td><code>0-based</code>ï¼Œéœ€å…ˆæ£€æŸ¥æ˜¯å¦ä¸ºç©º</td>
</tr>
<tr>
<td><code>order_of_key(10)</code></td>
<td>è·å–å°äºæŸä¸ªå€¼çš„å…ƒç´ æ•°é‡</td>
<td><code>O(log n)</code> å¤æ‚åº¦</td>
</tr>
<tr>
<td><code>find(5)</code></td>
<td>æŸ¥æ‰¾å…ƒç´ </td>
<td>ç›´æ¥è¿”å›è¿­ä»£å™¨</td>
</tr>
<tr>
<td><code>s.size()</code></td>
<td>è·å–é›†åˆå¤§å°</td>
<td><code>O(1)</code> å¤æ‚åº¦</td>
</tr>
<tr>
<td><code>s.clear()</code></td>
<td>æ¸…ç©ºé›†åˆ</td>
<td>ç›´æ¥æ¸…ç©º</td>
</tr>
</tbody>
</table>
</div>
<p>æ—¶é—´å¤æ‚åº¦</p>
<ul>
<li>æ’å…¥ï¼š<code>O(log n)</code></li>
<li>åˆ é™¤ï¼š<code>O(log n)</code></li>
<li>æŸ¥æ‰¾ï¼š<code>O(log n)</code></li>
<li>è·å–ç¬¬ k å°å…ƒç´ ï¼š<code>O(log n)</code></li>
<li>è·å–å°äº x çš„å…ƒç´ æ•°é‡ï¼š<code>O(log n)</code></li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ext/pb_ds/assoc_container.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ext/pb_ds/tree_policy.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_pbds;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> tree&lt;</span><br><span class="line">    <span class="type">int</span>, </span><br><span class="line">    null_type, </span><br><span class="line">    less&lt;<span class="type">int</span>&gt;, </span><br><span class="line">    rb_tree_tag, </span><br><span class="line">    tree_order_statistics_node_update</span><br><span class="line">&gt; ordered_set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ordered_set s;</span><br><span class="line">    s.<span class="built_in">insert</span>(<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">if</span> (s.<span class="built_in">find</span>(<span class="number">7</span>) != s.<span class="built_in">end</span>()) s.<span class="built_in">erase</span>(<span class="number">7</span>);</span><br><span class="line">    <span class="keyword">if</span> (s.<span class="built_in">size</span>() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;The 2nd smallest element is: &quot;</span> &lt;&lt; *s.<span class="built_in">find_by_order</span>(<span class="number">1</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (s.<span class="built_in">find</span>(<span class="number">5</span>) != s.<span class="built_in">end</span>()) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;5 exists in the set\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!s.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Minimum element: &quot;</span> &lt;&lt; *s.<span class="built_in">find_by_order</span>(<span class="number">0</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Maximum element: &quot;</span> &lt;&lt; *s.<span class="built_in">find_by_order</span>(s.<span class="built_in">size</span>() - <span class="number">1</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    s.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="string"><a href="#string" class="headerlink" title="string"></a>string</h3><h4 id="æ•°å€¼ä¸å­—ç¬¦ä¸²è½¬åŒ–"><a href="#æ•°å€¼ä¸å­—ç¬¦ä¸²è½¬åŒ–" class="headerlink" title="æ•°å€¼ä¸å­—ç¬¦ä¸²è½¬åŒ–"></a>æ•°å€¼ä¸å­—ç¬¦ä¸²è½¬åŒ–</h4><div class="table-container">
<table>
<thead>
<tr>
<th>å‡½æ•°ç­¾å</th>
<th>ä½œç”¨è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>to_string(val)</code></td>
<td>æŠŠ <code>val</code> è½¬æ¢æˆ <code>string</code></td>
</tr>
<tr>
<td><code>stoi(s, p, b)</code></td>
<td>æŠŠå­—ç¬¦ä¸² <code>s</code> ä»ä¸‹æ ‡ <code>p</code> å¼€å§‹è½¬æ¢æˆ <code>b</code> è¿›åˆ¶çš„ <code>int</code></td>
</tr>
<tr>
<td><code>stol(s, p, b)</code></td>
<td>è½¬æ¢æˆ <code>long</code></td>
</tr>
<tr>
<td><code>stoul(s, p, b)</code></td>
<td>è½¬æ¢æˆ <code>unsigned long</code></td>
</tr>
<tr>
<td><code>stoll(s, p, b)</code></td>
<td>è½¬æ¢æˆ <code>long long</code></td>
</tr>
<tr>
<td><code>stoull(s, p, b)</code></td>
<td>è½¬æ¢æˆ <code>unsigned long long</code></td>
</tr>
<tr>
<td><code>stof(s, p, b)</code></td>
<td>è½¬æ¢æˆ <code>float</code></td>
</tr>
<tr>
<td><code>stod(s, p, b)</code></td>
<td>è½¬æ¢æˆ <code>double</code></td>
</tr>
<tr>
<td><code>stold(s, p, b)</code></td>
<td>è½¬æ¢æˆ <code>long double</code></td>
</tr>
</tbody>
</table>
</div>
<p><code>p</code> å’Œ <code>b</code>å¯çœï¼Œé»˜è®¤ä¸ºåè¿›åˆ¶</p>
<h4 id="å­—ç¬¦ä¸²è¾“å…¥ä¸åˆ†å‰²"><a href="#å­—ç¬¦ä¸²è¾“å…¥ä¸åˆ†å‰²" class="headerlink" title="å­—ç¬¦ä¸²è¾“å…¥ä¸åˆ†å‰²"></a>å­—ç¬¦ä¸²è¾“å…¥ä¸åˆ†å‰²</h4><p><code>getline(cin, s)</code></p>
<p><code>stringstream s(ss)</code></p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">string s1;</span><br><span class="line"><span class="built_in">getline</span>(cin, s1);</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line"><span class="function">stringstream <span class="title">ss</span><span class="params">(s1)</span></span>;</span><br><span class="line">string temp;</span><br><span class="line"><span class="comment">// while(ss &gt;&gt; temp) æŒ‰ç©ºæ ¼è¯»å–</span></span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">getline</span>(ss, temp, <span class="string">&#x27;,&#x27;</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(temp[<span class="number">0</span>] == <span class="string">&#x27;-&#x27;</span>)&#123;</span><br><span class="line">        temp = temp.<span class="built_in">substr</span>(<span class="number">1</span>);</span><br><span class="line">        v1.<span class="built_in">push_back</span>(-<span class="built_in">stoi</span>(temp));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="built_in">stoi</span>(temp));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ”¹å˜å¤§å°å†™"><a href="#æ”¹å˜å¤§å°å†™" class="headerlink" title="æ”¹å˜å¤§å°å†™"></a>æ”¹å˜å¤§å°å†™</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">transform</span>(èµ·ç‚¹, ç»ˆç‚¹, è¾“å‡ºä½ç½®, å¤„ç†å‡½æ•°)</span><br><span class="line"><span class="comment">// å˜å°å†™</span></span><br><span class="line"><span class="built_in">transform</span>(s1.<span class="built_in">begin</span>(), s1.<span class="built_in">end</span>(), s1.<span class="built_in">begin</span>(), ::tolower);</span><br><span class="line"><span class="comment">// å˜å¤§å†™</span></span><br><span class="line"><span class="built_in">transform</span>(s1.<span class="built_in">begin</span>(), s1.<span class="built_in">end</span>(), s1.<span class="built_in">begin</span>(), ::toupper);</span><br><span class="line"><span class="comment">// è½¬æ¢åˆ°å¦ä¸€ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line">string src = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">string dest;</span><br><span class="line">dest.<span class="built_in">resize</span>(src.<span class="built_in">size</span>());</span><br><span class="line"><span class="built_in">transform</span>(src.<span class="built_in">begin</span>(), src.<span class="built_in">end</span>(), dest.<span class="built_in">begin</span>(), ::tolower);</span><br><span class="line"><span class="comment">// dest ç°åœ¨æ˜¯ &quot;hello&quot;ï¼ŒåŸå§‹ src ä¸å˜</span></span><br></pre></td></tr></table></figure>
<h4 id="å­ä¸²substr"><a href="#å­ä¸²substr" class="headerlink" title="å­ä¸²substr"></a>å­ä¸²<code>substr</code></h4><p><code>substr(st, len)</code></p>
<p><code>len</code>çœç•¥æ—¶è¡¨ç¤ºåˆ°en</p>
<h4 id="æŸ¥æ‰¾"><a href="#æŸ¥æ‰¾" class="headerlink" title="æŸ¥æ‰¾"></a>æŸ¥æ‰¾</h4><h5 id="find"><a href="#find" class="headerlink" title="find"></a><code>find</code></h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="function">std::string <span class="title">str</span> <span class="params">(<span class="string">&quot;There are two needles in this haystack with needles.&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">std::string <span class="title">str2</span> <span class="params">(<span class="string">&quot;needle&quot;</span>)</span></span>;</span><br><span class="line">    <span class="comment">//åœ¨strå½“ä¸­æŸ¥æ‰¾ç¬¬ä¸€ä¸ªå‡ºç°çš„needleï¼Œæ‰¾åˆ°åˆ™è¿”å›å‡ºç°çš„ä½ç½®ï¼Œå¦åˆ™è¿”å›ç»“å°¾</span></span><br><span class="line">    std::<span class="type">size_t</span> found = str.<span class="built_in">find</span>(str2);</span><br><span class="line">    <span class="keyword">if</span> (found!=std::string::npos) <span class="comment">// ç»“å°¾</span></span><br><span class="line">    <span class="comment">//åœ¨strå½“ä¸­ï¼Œä»ç¬¬found+1çš„ä½ç½®å¼€å§‹æŸ¥æ‰¾å‚æ•°å­—ç¬¦ä¸²çš„å‰6ä¸ªå­—ç¬¦</span></span><br><span class="line">    found = str.<span class="built_in">find</span>(<span class="string">&quot;needles are small&quot;</span>,found+<span class="number">1</span>,<span class="number">6</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="rfind"><a href="#rfind" class="headerlink" title="rfind"></a><code>rfind</code></h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//rfindæ˜¯æ‰¾æœ€åä¸€ä¸ªå‡ºç°çš„åŒ¹é…å­—ç¬¦ä¸²</span></span><br><span class="line">std::<span class="type">size_t</span> found = str.<span class="built_in">rfind</span>(str2);</span><br></pre></td></tr></table></figure>
<h5 id="find-of"><a href="#find-of" class="headerlink" title="find_...of"></a><code>find_...of</code></h5><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">find_first_of</span>(args) <span class="comment">// **æŸ¥æ‰¾argsä¸­ä»»ä½•ä¸€ä¸ªå­—ç¬¦ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®**</span></span><br><span class="line"><span class="built_in">find_last_of</span>(args) <span class="comment">// **æœ€åä¸€ä¸ªå‡ºç°çš„ä½ç½®**</span></span><br><span class="line"><span class="built_in">find_fist_not_of</span>(args) <span class="comment">// **æŸ¥æ‰¾ç¬¬ä¸€ä¸ªä¸åœ¨argsä¸­çš„å­—ç¬¦**</span></span><br><span class="line">find_last_not_of <span class="comment">// **æŸ¥æ‰¾æœ€åä¸€ä¸ªä¸åœ¨argsä¸­å‡ºç°çš„å­—ç¬¦**</span></span><br></pre></td></tr></table></figure>
<h4 id="æ’å…¥insert"><a href="#æ’å…¥insert" class="headerlink" title="æ’å…¥insert"></a>æ’å…¥insert</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    string str=<span class="string">&quot;to be question&quot;</span>;</span><br><span class="line">    string str2=<span class="string">&quot;the &quot;</span>;</span><br><span class="line">    string str3=<span class="string">&quot;or not to be&quot;</span>;</span><br><span class="line">    string::iterator it;</span><br><span class="line">    <span class="comment">//s.insert(pos,str)//åœ¨sçš„posä½ç½®æ’å…¥str</span></span><br><span class="line">    str.<span class="built_in">insert</span>(<span class="number">6</span>,str2); </span><br><span class="line">    <span class="comment">//s.insert(pos,str,a,n)åœ¨sçš„posä½ç½®æ’å…¥strä¸­æ’å…¥ä½ç½®aåˆ°åé¢çš„nä¸ªå­—ç¬¦</span></span><br><span class="line">    str.<span class="built_in">insert</span>(<span class="number">6</span>,str3,<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line">    <span class="comment">//s.insert(pos,cstr,n)//åœ¨posä½ç½®æ’å…¥cstrå­—ç¬¦ä¸²ä»å¼€å§‹åˆ°åé¢çš„nä¸ªå­—ç¬¦</span></span><br><span class="line">    str.<span class="built_in">insert</span>(<span class="number">10</span>,<span class="string">&quot;that is cool&quot;</span>,<span class="number">8</span>); </span><br><span class="line">    <span class="comment">//s.insert(pos,n,ch)åœ¨s.posä½ç½®ä¸Šé¢æ’å…¥nä¸ªch</span></span><br><span class="line">    str.<span class="built_in">insert</span>(<span class="number">15</span>,<span class="number">1</span>,<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">    <span class="comment">//s.insert(s.it,ch)åœ¨sçš„itæŒ‡å‘ä½ç½®å‰é¢æ’å…¥ä¸€ä¸ªå­—ç¬¦chï¼Œè¿”å›æ–°æ’å…¥çš„ä½ç½®çš„è¿­ä»£å™¨</span></span><br><span class="line">    it = str.<span class="built_in">insert</span>(str.<span class="built_in">begin</span>()+<span class="number">5</span>,<span class="string">&#x27;,&#x27;</span>); <span class="comment">// to be, not to be: that is the question</span></span><br><span class="line">    <span class="comment">//s.insert(s.it,n,ch)//åœ¨sçš„itæ‰€æŒ‡å‘ä½ç½®çš„å‰é¢æ’å…¥nä¸ªch</span></span><br><span class="line">    str.<span class="built_in">insert</span> (str.<span class="built_in">end</span>(),<span class="number">3</span>,<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">    <span class="comment">//s.insert(it,str.ita,str.itb)åœ¨itæ‰€æŒ‡å‘çš„ä½ç½®çš„å‰é¢æ’å…¥[ita,itb)çš„å­—ç¬¦ä¸²</span></span><br><span class="line">    str.<span class="built_in">insert</span> (it+<span class="number">2</span>,str3.<span class="built_in">begin</span>(),str3.<span class="built_in">begin</span>()+<span class="number">3</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="map-amp-unordered-map"><a href="#map-amp-unordered-map" class="headerlink" title="map  &amp; unordered_map"></a>map  &amp; unordered_map</h3><p>mapåŸºäºçº¢é»‘æ ‘ï¼ˆæˆ–å…¶ä»–å¹³è¡¡äºŒå‰æ ‘ï¼‰å®ç°ï¼Œæ‰€æœ‰å…ƒç´ æŒ‰ç…§keyçš„å¤§å°æœ‰åºå­˜å‚¨ã€‚</p>
<p>unordered_mapåŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œå…ƒç´ æŒ‰ç…§å“ˆå¸Œæ¡¶æ— åºå­˜å‚¨ã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>map</th>
<th>unordered_map</th>
</tr>
</thead>
<tbody>
<tr>
<td>æŸ¥æ‰¾/æ’å…¥/åˆ é™¤</td>
<td>O(logN)ï¼ˆä¸¥æ ¼ï¼‰</td>
<td>å¹³å‡O(1),æœ€åO(N)ï¼ˆå“ˆå¸Œå†²çªï¼‰</td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<p>å¦‚æœå¯¹ key çš„é¡ºåºæœ‰éœ€æ±‚ï¼Œæˆ–æ•°æ®é‡ä¸æç«¯ã€æ€§èƒ½è¦æ±‚ä¸¥æ ¼ç¨³å®šï¼Œå°±ç”¨ <code>map</code>ã€‚</p>
<p>å¦‚æœæ•°æ®éšæœºåˆ†å¸ƒã€å¯¹éå†é¡ºåºæ— è¦æ±‚ï¼Œå¸Œæœ›è·å¾—æå¿«çš„å¹³å‡æŸ¥æ‰¾é€Ÿåº¦ï¼Œå¯ç”¨ <code>unordered_map</code>ï¼Œä½†è¦æ³¨æ„ï¼š</p>
<ol>
<li><strong>é€‚å½“ <code>reserve</code></strong>ï¼šæå‰ <code>reserve(bucket_count)</code> æˆ– <code>max_load_factor</code> æ¥å‡å°‘æ‰©å®¹ï¼›</li>
<li><strong>è‡ªå®šä¹‰å“ˆå¸Œ</strong>ï¼šåœ¨ CF ç­‰å¹³å°ä¸Šå¯ç”¨ <code>splitmix64</code> ç­‰æ›´å®‰å…¨çš„å“ˆå¸Œå‡½æ•°ï¼Œé˜²æ­¢ç¢°æ’æ”»å‡»ã€‚</li>
</ol>
</blockquote>
<h3 id="cout"><a href="#cout" class="headerlink" title="cout"></a>cout</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> num = <span class="number">255</span>;</span><br><span class="line">    <span class="type">double</span> pi = <span class="number">3.1415926</span>;</span><br><span class="line">    <span class="type">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">// å¸ƒå°”è¾“å‡º</span></span><br><span class="line">    cout &lt;&lt; boolalpha &lt;&lt; <span class="string">&quot;bool: &quot;</span> &lt;&lt; flag &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; <span class="literal">false</span> &lt;&lt; endl;</span><br><span class="line">    <span class="comment">// è¿›åˆ¶</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;dec: &quot;</span> &lt;&lt; dec &lt;&lt; num </span><br><span class="line">         &lt;&lt; <span class="string">&quot; hex: &quot;</span> &lt;&lt; hex &lt;&lt; num </span><br><span class="line">         &lt;&lt; <span class="string">&quot; oct: &quot;</span> &lt;&lt; oct &lt;&lt; num &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; dec; <span class="comment">// æ¢å¤åè¿›åˆ¶</span></span><br><span class="line">    <span class="comment">// æµ®ç‚¹æ•°æ ¼å¼</span></span><br><span class="line">    cout &lt;&lt; fixed &lt;&lt; <span class="built_in">setprecision</span>(<span class="number">2</span>) &lt;&lt; <span class="string">&quot;fixed: &quot;</span> &lt;&lt; pi &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; scientific &lt;&lt; <span class="built_in">setprecision</span>(<span class="number">3</span>) &lt;&lt; <span class="string">&quot;sci: &quot;</span> &lt;&lt; pi &lt;&lt; endl;</span><br><span class="line">    cout.<span class="built_in">unsetf</span>(ios::floatfield);</span><br><span class="line">    <span class="comment">// å®½åº¦ã€å¯¹é½ã€å¡«å……</span></span><br><span class="line">    cout &lt;&lt; <span class="built_in">setfill</span>(<span class="string">&#x27;-&#x27;</span>) &lt;&lt; left &lt;&lt; <span class="built_in">setw</span>(<span class="number">10</span>) &lt;&lt; <span class="string">&quot;Left&quot;</span> &lt;&lt; right &lt;&lt; <span class="built_in">setw</span>(<span class="number">10</span>) &lt;&lt; <span class="string">&quot;Right&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="built_in">setfill</span>(<span class="string">&#x27;_&#x27;</span>) &lt;&lt; right &lt;&lt; <span class="built_in">setw</span>(<span class="number">10</span>) &lt;&lt; <span class="string">&quot;hello\n&quot;</span>;</span><br><span class="line">    <span class="comment">// æ˜¾ç¤ºæ­£å·</span></span><br><span class="line">    cout &lt;&lt; showpos &lt;&lt; <span class="number">123</span> &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; <span class="number">-123</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h2><h3 id="é‡è½½è¿ç®—ç¬¦å·ï¼ˆæ¯”è¾ƒï¼‰"><a href="#é‡è½½è¿ç®—ç¬¦å·ï¼ˆæ¯”è¾ƒï¼‰" class="headerlink" title="é‡è½½è¿ç®—ç¬¦å·ï¼ˆæ¯”è¾ƒï¼‰"></a>é‡è½½è¿ç®—ç¬¦å·ï¼ˆæ¯”è¾ƒï¼‰</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç»“æ„ä½“</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">my</span>&#123;</span><br><span class="line">    <span class="type">int</span> l, r, index;</span><br><span class="line">    <span class="built_in">my</span>(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)&#123;</span><br><span class="line">        l = a, r = b, index = c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> my x) <span class="type">const</span> &#123;  </span><br><span class="line">            <span class="comment">// ä¼˜å…ˆé˜Ÿåˆ—ä¸­æ¯”è¾ƒå…³ç³»åç€æ¥</span></span><br><span class="line">            <span class="keyword">return</span> l &gt; x.l;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// lambdaï¼ˆç¤ºä¾‹ä¸ºå°æ ¹å †ï¼‰</span></span><br><span class="line"><span class="keyword">auto</span> cmp = [](pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; x, pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; y) &#123;</span><br><span class="line">    <span class="keyword">return</span> x.second &gt; y.second;</span><br><span class="line">&#125;;</span><br><span class="line">priority_queue&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;, vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt;, <span class="keyword">decltype</span>(cmp)&gt; <span class="built_in">q</span>(cmp); </span><br></pre></td></tr></table></figure>
<h3 id="æ±‚æœ€å¤§çš„æœ€å°æˆ–è€…æœ€å°çš„æœ€å¤§é—®é¢˜"><a href="#æ±‚æœ€å¤§çš„æœ€å°æˆ–è€…æœ€å°çš„æœ€å¤§é—®é¢˜" class="headerlink" title="æ±‚æœ€å¤§çš„æœ€å°æˆ–è€…æœ€å°çš„æœ€å¤§é—®é¢˜"></a>æ±‚æœ€å¤§çš„æœ€å°æˆ–è€…æœ€å°çš„æœ€å¤§é—®é¢˜</h3><p>å¤§æ¦‚ç‡æ˜¯ç”¨äºŒåˆ†æ¥æŸ¥è¯¢æœ€åˆé€‚çš„ç­”æ¡ˆï¼Œå…·ä½“ç®—æ³•çœ‹é¢˜</p>
<h3 id="åœ†å‘¨ç‡-960"><a href="#åœ†å‘¨ç‡-960" class="headerlink" title="åœ†å‘¨ç‡&#960;"></a>åœ†å‘¨ç‡&#960;</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">double</span> pi  =  <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br></pre></td></tr></table></figure>
<h3 id="æ±‚å®¹å™¨æœ€å¤§å€¼"><a href="#æ±‚å®¹å™¨æœ€å¤§å€¼" class="headerlink" title="æ±‚å®¹å™¨æœ€å¤§å€¼"></a>æ±‚å®¹å™¨æœ€å¤§å€¼</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">*<span class="built_in">max_element</span>(vec.<span class="built_in">begin</span>(), vec.<span class="built_in">end</span>());</span><br></pre></td></tr></table></figure>
<h3 id="å…¨æ’åˆ—-1"><a href="#å…¨æ’åˆ—-1" class="headerlink" title="å…¨æ’åˆ—"></a>å…¨æ’åˆ—</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">std::string s = <span class="string">&quot;aba&quot;</span>; </span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">    std::cout &lt;&lt; s &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;<span class="keyword">while</span> (std::<span class="built_in">next_permutation</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">end</span>()));</span><br><span class="line">std::cout &lt;&lt; s &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h3 id="éšæœºæ•°"><a href="#éšæœºæ•°" class="headerlink" title="éšæœºæ•°"></a>éšæœºæ•°</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="built_in">srand</span>((<span class="type">unsigned</span>)<span class="built_in">time</span>(<span class="literal">NULL</span>));</span><br><span class="line">cout &lt;&lt; (<span class="built_in">rand</span>()) % <span class="number">17</span>;</span><br></pre></td></tr></table></figure>
<h3 id="å®Œå…¨å¹³æ–¹æ•°"><a href="#å®Œå…¨å¹³æ–¹æ•°" class="headerlink" title="å®Œå…¨å¹³æ–¹æ•°"></a>å®Œå…¨å¹³æ–¹æ•°</h3><p>ä¸€ä¸ªæ•°ä¸ºå®Œå…¨å¹³æ–¹æ•°å½“ä¸”ä»…å½“è¯¥åˆ†è§£åè¯¥æ•°æ‰€æœ‰è´¨å› æ•°ä¸ªæ•°å‡ä¸ºå¶æ•°</p>
<h3 id="éšæœºå“ˆå¸Œç¼–ç "><a href="#éšæœºå“ˆå¸Œç¼–ç " class="headerlink" title="éšæœºå“ˆå¸Œç¼–ç "></a>éšæœºå“ˆå¸Œç¼–ç </h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">mt19937_64 <span class="title">rng</span><span class="params">(chrono::steady_clock::now().time_since_epoch().count())</span></span>;</span><br><span class="line"><span class="type">int</span> a_hash = <span class="built_in">rng</span>();</span><br></pre></td></tr></table></figure>
<h3 id="æ‰¹é‡æ“ä½œ"><a href="#æ‰¹é‡æ“ä½œ" class="headerlink" title="æ‰¹é‡æ“ä½œ"></a>æ‰¹é‡æ“ä½œ</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> a[<span class="number">5</span>];</span><br><span class="line"><span class="comment">// è¿ç»­å¡«å……</span></span><br><span class="line"><span class="built_in">iota</span>(a, a + <span class="number">5</span>, <span class="number">1</span>);  <span class="comment">// a = &#123;1, 2, 3, 4, 5&#125;</span></span><br><span class="line"><span class="comment">// é€‚åˆè®¾ç½®ä¸º0ã€-1ã€255ï¼ˆå³æ‰€æœ‰å­—èŠ‚ä¸€è‡´çš„å€¼ï¼‰</span></span><br><span class="line"><span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a));  <span class="comment">// å°†æ•°ç»„ a ä¸­çš„æ‰€æœ‰å­—èŠ‚è®¾ä¸º 0</span></span><br><span class="line"><span class="comment">// æ”¯æŒæ‰€æœ‰åŸºç¡€ç±»å‹å’ŒSTLå®¹å™¨</span></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line"><span class="built_in">fill</span>(a, a + <span class="number">5</span>, <span class="number">42</span>);  <span class="comment">// a = &#123;42, 42, 42, 42, 42&#125;</span></span><br><span class="line"><span class="built_in">fill</span>(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>(), <span class="number">42</span>);</span><br></pre></td></tr></table></figure>
<h3 id="lower-bound-amp-upper-bound"><a href="#lower-bound-amp-upper-bound" class="headerlink" title="lower_bound &amp; upper_bound"></a>lower_bound &amp; upper_bound</h3><p>ower_bound( )å’Œupper_bound( )éƒ½æ˜¯åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾çš„æ–¹æ³•åœ¨ä¸€ä¸ªæ’å¥½åºçš„æ•°ç»„ä¸­è¿›è¡ŒæŸ¥æ‰¾çš„ã€‚</p>
<p>åœ¨ä»å°åˆ°å¤§çš„æ’åºæ•°ç»„ä¸­ï¼Œ</p>
<ul>
<li><p><code>lower_bound(begin, end, value)</code></p>
<p>  è¿”å›<strong>ç¬¬ä¸€ä¸ª â‰¥ value çš„ä½ç½®</strong></p>
</li>
<li><p><code>upper_bound(begin, end, value)</code><br>  è¿”å›<strong>ç¬¬ä¸€ä¸ª &gt; value çš„ä½ç½®</strong></p>
</li>
</ul>
<p>åœ¨ä»å°åˆ°å¤§çš„æ’åºæ•°ç»„ä¸­ï¼Œ</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; v = &#123;<span class="number">-1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">34</span>&#125;;</span><br><span class="line">    <span class="built_in">sort</span>(v.<span class="built_in">begin</span>() + <span class="number">1</span>, v.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> pos1 = <span class="built_in">lower_bound</span>(v.<span class="built_in">begin</span>() + <span class="number">1</span>, v.<span class="built_in">end</span>(), <span class="number">7</span>) - v.<span class="built_in">begin</span>();</span><br><span class="line">    <span class="type">int</span> pos2 = <span class="built_in">upper_bound</span>(v.<span class="built_in">begin</span>() + <span class="number">1</span>, v.<span class="built_in">end</span>(), <span class="number">7</span>) - v.<span class="built_in">begin</span>();</span><br><span class="line">    cout &lt;&lt; pos1 &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; v[pos1] &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; pos2 &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; v[pos2] &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">sort</span>(v.<span class="built_in">begin</span>() + <span class="number">1</span>, v.<span class="built_in">end</span>(), <span class="built_in">greater</span>&lt;<span class="type">int</span>&gt;());</span><br><span class="line">    <span class="type">int</span> pos3 = <span class="built_in">lower_bound</span>(v.<span class="built_in">begin</span>() + <span class="number">1</span>, v.<span class="built_in">end</span>(), <span class="number">7</span>, <span class="built_in">greater</span>&lt;<span class="type">int</span>&gt;()) - v.<span class="built_in">begin</span>();</span><br><span class="line">    <span class="type">int</span> pos4 = <span class="built_in">upper_bound</span>(v.<span class="built_in">begin</span>() + <span class="number">1</span>, v.<span class="built_in">end</span>(), <span class="number">7</span>, <span class="built_in">greater</span>&lt;<span class="type">int</span>&gt;()) - v.<span class="built_in">begin</span>();</span><br><span class="line">    cout &lt;&lt; pos3 &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; v[pos3] &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; pos4 &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; v[pos4] &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æŠ˜å°ºå®šç†"><a href="#æŠ˜å°ºå®šç†" class="headerlink" title="æŠ˜å°ºå®šç†"></a>æŠ˜å°ºå®šç†</h3><p>ä¸€å †æœ‰å„è‡ªé•¿åº¦($a<em>{1},a</em>{2},a<em>{3} \dots$)æœ¨æ£èƒ½å¦è¿æ¥åœ¨ä¸¤ä¸ªç‚¹ä¸Šï¼Œå–å†³äºæ˜¯å¦$L</em>{\min}\le D\le L<em>{\max}$,å…¶ä¸­ï¼Œ$L</em>{\max} = \sum<em>{i = 1}^{n}a</em>{i} $ ,$L<em>{\min} = max(0, 2 * a</em>{\max} - L_{\max})$ï¼ŒDä¸ºä¸¤ç‚¹é—´è·ç¦»</p>
<h3 id="ä¸¤ä¸¤ç»å¯¹å€¼æ±‚å’Œ"><a href="#ä¸¤ä¸¤ç»å¯¹å€¼æ±‚å’Œ" class="headerlink" title="ä¸¤ä¸¤ç»å¯¹å€¼æ±‚å’Œ"></a>ä¸¤ä¸¤ç»å¯¹å€¼æ±‚å’Œ</h3><p>å½“ä½ æŠŠä¸€ç»„æ•°æ’åºåï¼Œå¯¹æ‰€æœ‰ã€Œä¸¤ä¸¤å·®çš„ç»å¯¹å€¼ä¹‹å’Œã€$\sum_{0\le p&lt;q\le n} |a_q - a_p|$ æœ‰ä¸€ä¸ªç»å…¸ç»“è®ºï¼š</p>
<p>$\sum<em>{0 \le p &lt; q \le n} (a_q - a_p)= \sum</em>{k=0}^n a_k (k - (n-k))$</p>
<p>è¿™æ˜¯å› ä¸ºï¼š</p>
<ul>
<li><p>å¯¹äºå›ºå®šçš„$a<em>k$ï¼Œå®ƒä½œä¸ºâ€œå³ç«¯â€ $q</em>{q}$ çš„æ—¶å€™ï¼Œä¼šå’Œå‰é¢æ‰€æœ‰ k ä¸ªæ›´å°çš„æ•° $a<em>0,\dots,a</em>{k-1}$ ç›¸å‡ï¼Œç´¯è®¡è´¡çŒ®</p>
<p>  $\displaystyle +\,a_k\times k$ã€‚</p>
</li>
<li><p>åŒæ—¶å®ƒä¹Ÿä¼šä½œä¸ºâ€œå·¦ç«¯â€ $a<em>p$ è¢«åé¢æ‰€æœ‰ (nâˆ’k) ä¸ªæ›´å¤§çš„æ•° $a</em>{k+1},\dots,a_n$ç›¸å‡ï¼Œè´¡çŒ®</p>
<p>  $-\,a_k\times (n - k)$ã€‚</p>
</li>
<li><p>åˆå¹¶èµ·æ¥ï¼Œå°±æ˜¯</p>
<p>  $a_k(kâˆ’(nâˆ’k))=a_k(2kâˆ’n).$</p>
</li>
</ul>
<p>æ³¨æ„è¿™é‡Œä¸éœ€è¦å†å†™ç»å¯¹å€¼äº†ï¼Œå› ä¸ºæ’åºä¿è¯äº†â€œåè€…å‡å‰è€…â€æ€»æ˜¯éè´Ÿçš„ã€‚</p>
<h3 id="ASCII-Table"><a href="#ASCII-Table" class="headerlink" title="ASCII Table"></a>ASCII Table</h3><p><img src="/algorithm/ASCII_Table.png" alt="ASCII_Table"></p>
<h3 id="ä¼˜å…ˆçº§"><a href="#ä¼˜å…ˆçº§" class="headerlink" title="ä¼˜å…ˆçº§"></a>ä¼˜å…ˆçº§</h3><p><img src="/algorithm/priority.jpg" alt="priority"></p>
<h3 id="è§„æ¨¡"><a href="#è§„æ¨¡" class="headerlink" title="è§„æ¨¡"></a>è§„æ¨¡</h3><p><img src="/algorithm/è§„æ¨¡.png" alt="guimo"></p>
<h3 id="æ›¼å“ˆé¡¿è·ç¦»è½¬æ¢ï¼ˆè±å½¢è½¬çŸ©å½¢ï¼‰"><a href="#æ›¼å“ˆé¡¿è·ç¦»è½¬æ¢ï¼ˆè±å½¢è½¬çŸ©å½¢ï¼‰" class="headerlink" title="æ›¼å“ˆé¡¿è·ç¦»è½¬æ¢ï¼ˆè±å½¢è½¬çŸ©å½¢ï¼‰"></a>æ›¼å“ˆé¡¿è·ç¦»è½¬æ¢ï¼ˆè±å½¢è½¬çŸ©å½¢ï¼‰</h3><p>åŸè±å½¢è¦†ç›–ï¼ˆæ›¼å“ˆé¡¿è·ç¦»$\le$ï¼‰åœ¨ï¼ˆi,jï¼‰å¹³é¢ä¸Šéš¾ä»¥ç›´æ¥åˆ¤æ–­ï¼Œå¦u = i + j, v = i - j, åˆ™è±å½¢åœ¨(u, v)ç©ºé—´æŠ•å½±ä¸ºè½´å¯¹é½çŸ©å½¢</p>
<h3 id="é€†åºå¯¹"><a href="#é€†åºå¯¹" class="headerlink" title="é€†åºå¯¹"></a>é€†åºå¯¹</h3><p>ä¸€ä¸ªæ’åˆ—ä¸­ï¼Œäº¤æ¢ä»»æ„ä¸¤ä¸ªæ•°ï¼Œä¼šå¯¼è‡´æ•´ä¸ªæ’åˆ—çš„é€†åºå¯¹ä¸ªæ•°å¥‡å¶æ€§æ”¹å˜</p>
<blockquote>
<p>è¯æ˜: äº¤æ¢ä»»æ„ä¸¤ä¸ªæ•°Lå’ŒRï¼ˆL &lt; Rï¼Œå½“Læ¯”Rå¤§æ—¶è¯æ˜æ€è·¯ä¸€è‡´ï¼‰,ï¼ŒLå·¦è¾¹çš„å’ŒRå³è¾¹çš„æ•°å¯¹[L,R]å†…çš„æ•°çš„è´¡çŒ®ã€(L,R)å†…çš„æ•°ç›¸äº’ä¹‹é—´çš„è´¡çŒ®ä¸å‘ç”Ÿæ”¹å˜ï¼Œå†çœ‹(L,R)å†…ï¼Œå¯¹äºå…¶ä¸­ä»»æ„ä¸€ä¸ªæ•°ï¼Œå¦‚æœè¿™ä¸ªæ•°åœ¨Lå’ŒRä¸­é—´ï¼Œäº¤æ¢ä¹‹å‰çš„è¯¥æ•°ä¸Lå’ŒRçš„è´¡çŒ®å€¼ä¹‹å’Œä¸º0,é‚£ä¹ˆLå’ŒRäº¤æ¢åï¼Œå…¶è´¡çŒ®å€¼è¿˜æ˜¯2ï¼Œè‹¥æ¯”Lå’ŒRéƒ½å°æˆ–è€…éƒ½å¤§ï¼Œäº¤æ¢å‰åçš„è´¡çŒ®å€¼éƒ½æ˜¯1ï¼Œæ•…ä¸ç®¡ä¸‰ä¸ªæ•°ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Œæ”¹å˜éƒ½æ˜¯å¶æ•°ï¼Œéƒ½ä¸æ”¹å˜æ€»ä½“å¥‡å¶æ€§ï¼Œè€ŒLå’ŒRçš„äº¤æ¢æœ¬èº«ä¼šå¸¦æ¥ç»å¯¹å€¼ä¸º1çš„æ”¹å˜ï¼Œæ•…æ€»ä½“å¥‡å¶æ€§æœ€åæ”¹å˜</p>
</blockquote>
<p>ä¸€ä¸ªæ’åˆ—ä¸­ï¼Œå¯¹ä»»æ„åŒºé—´è¿›è¡Œå¾ªç¯å•å‘ç§»åŠ¨æ—¶ï¼Œå½“ç§»åŠ¨åŒºé—´çš„é•¿åº¦ä¸ºå¥‡æ•°æ—¶ï¼Œæ¯æ¬¡ç§»åŠ¨çš„æ”¹å˜éƒ½æ˜¯å¶æ•°ï¼Œä¸æ”¹å˜å¥‡å¶ï¼Œé•¿åº¦å¶æ•°æ—¶ï¼Œæ¯æ¬¡ç§»åŠ¨çš„æ”¹å˜éƒ½æ˜¯å¥‡æ•°ï¼Œæ•…æ¯æ¬¡ç§»åŠ¨éƒ½ä¼šæ”¹å˜å¥‡å¶ï¼Œ</p>
<blockquote>
<p>è¯æ˜ï¼šå¯¹äºä»»ä½•ä¸€ä¸ªæ•°ï¼Œåœ¨é•¿åº¦ä¸ºdçš„åŒºé—´ä¸­ï¼Œæœ‰aä¸ªæ•°æ¯”ä»–å¤§ï¼Œæœ‰bä¸ªæ•°æ¯”ä»–å°ï¼Œa + b = d - 1ï¼Œä¸¤ä¸ªæ•°çš„å’Œä¸ºå¶æ•°ï¼Œé‚£ä¹ˆä¸¤ä¸ªæ•°çš„å·®ä¹Ÿä¸ºå¶æ•°ï¼Œè€Œå°†ä¸€ä¾§çš„æ•°å¾ªç¯ç§»åŠ¨åˆ°å¦ä¸€ä¾§æ—¶ï¼Œåœ¨å¾ªç¯å·¦ç§»æ—¶ï¼Œå…¶è´¡çŒ®å°±æ˜¯b - aï¼Œå› æ­¤ï¼Œå…¶å¥‡å¶æ€§ç¡®å®š</p>
</blockquote>
<h3 id="åˆ†å±‚è¡¥é½é«˜åº¦é—®é¢˜"><a href="#åˆ†å±‚è¡¥é½é«˜åº¦é—®é¢˜" class="headerlink" title="åˆ†å±‚è¡¥é½é«˜åº¦é—®é¢˜"></a>åˆ†å±‚è¡¥é½é«˜åº¦é—®é¢˜</h3><p>è¦æŠŠä¸€ä¸ªåŒºé—´é€šè¿‡å­åŒºé—´åŠ ä¸€çš„æ“ä½œå°†åŒºé—´ç»Ÿä¸€é«˜åº¦ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•</p>
<ul>
<li>è‹¥iä¸ºç¬¬ä¸€ä¸ªæ•°ï¼Œå…¶ä»£ä»·ä¸ºmax - val[i]</li>
<li>å¦åˆ™ï¼Œå½“iè¦è¢«å¡«è¡¥çš„é«˜åº¦å¤§äºi - 1æ—¶ï¼Œæ‰è¿›è¡Œé«˜åº¦å·®è·çš„è¡¥å……ï¼Œç±»ä¼¼ä¸åªæœ‰ä¸Šæ¥¼æ¢¯æ‰æœ‰æ¶ˆè€—ï¼Œä¸‹æ¥¼æ¢¯æ²¡æœ‰æ¶ˆè€—ï¼Œä»£ä»·ä¸º(max - val[i]) - (max - val[i - 1])</li>
</ul>
<p>è€ŒåŒºé—´å¯å®¹çº³ä¸¤ç§æœ€ç»ˆé«˜åº¦æ—¶ï¼Œå¯dpæ¯ä¸ªç‚¹å˜ä¸ºæœ€ç»ˆä¸¤ä¸ªå€¼ä¸­çš„æŸä¸€ä¸ªçš„ä»£ä»·ï¼Œå‡è®¾æœ€ç»ˆé«˜åº¦ä¸ºx,y,å¯å‚è€ƒä»¥ä¸‹ä»£ç </p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">400</span>;</span><br><span class="line"><span class="comment">// dp[i][0/1]ï¼šå¤„ç†åˆ°ä¸‹æ ‡ iï¼ˆ0-basedï¼‰ï¼Œå¹¶ä¸”æŠŠ v1[i] æå‡åˆ°â€œé«˜ä½ x(=0)â€æˆ–â€œä½ä½ y(=1)â€æ—¶ï¼Œ</span></span><br><span class="line"><span class="comment">//             ä½¿å¾—å‰ç¼€ 0..i è¾¾åˆ°ç›®æ ‡é«˜åº¦åºåˆ—æ‰€éœ€çš„æœ€å°â€œæ“ä½œä»£ä»·â€</span></span><br><span class="line"><span class="function">vector <span class="title">dp</span><span class="params">(N + <span class="number">1</span>, vector&lt;<span class="type">int</span>&gt;(<span class="number">2</span>))</span></span>;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>)-&gt;ios_base::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">   	<span class="keyword">while</span>(t --)&#123;</span><br><span class="line">		<span class="type">int</span> n, m;</span><br><span class="line">		cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">		<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(n)</span></span>;</span><br><span class="line">		<span class="type">int</span> max1 = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">auto</span> &amp; x : v1) cin &gt;&gt; x, max1 = <span class="built_in">max</span>(max1, x);</span><br><span class="line">		<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(m == <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="comment">// åªå…è®¸é€‰æ‹© 1 ä¸ªâ€œç›®æ ‡é«˜åº¦â€æ—¶ï¼Œæœ€ä¼˜å³å– H = max(v1)</span></span><br><span class="line">			<span class="comment">// ä¸‹é¢è¿™æ®µç­‰ä»·äºï¼šæŠŠæ‰€æœ‰ä½ç½®éƒ½â€œè¡¥åˆ°â€ H çš„æœ€å°‘â€œå‰ç¼€åŠ ä¸€â€æ“ä½œæ¬¡æ•°ã€‚</span></span><br><span class="line">			<span class="comment">// ä»¤ delta[i] = H - v1[i]ï¼Œåˆ™</span></span><br><span class="line">			<span class="comment">// ä»£ä»· = delta[0] + Î£_&#123;i=1..n-1&#125; max(0, delta[i] - delta[i-1])</span></span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++) &#123;</span><br><span class="line">				<span class="keyword">if</span>(i == <span class="number">0</span>) ans += max1 - v1[i];</span><br><span class="line">				<span class="keyword">else</span> ans += <span class="built_in">max</span>(<span class="number">0ll</span>, (max1 - v1[i]) - (max1 - v1[i - <span class="number">1</span>]));</span><br><span class="line">				<span class="comment">//               â†‘â†‘â†‘           å³ delta[i] - delta[i-1]</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		    <span class="comment">// å…è®¸é€‰æ‹© 2 ä¸ªâ€œç›®æ ‡é«˜åº¦â€ï¼šé«˜ä½ x ä¸ä½ä½ yï¼ˆå¹¶çº¦æŸ y &lt;= xï¼‰</span></span><br><span class="line">		    <span class="comment">// æˆ‘ä»¬è¦åœ¨æ¯ä¸ªä½ç½®è‡ªç”±é€‰æ‹© x æˆ– yï¼Œä½¿å¾— h[i] &gt;= v1[i] ä¸”æ€»ä»£ä»·æœ€å°ã€‚</span></span><br><span class="line">		    <span class="keyword">auto</span> get = [&amp;](<span class="type">int</span> x, <span class="type">int</span> y) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">		    	<span class="comment">// åˆå§‹åŒ– DP ä¸º +âˆ</span></span><br><span class="line">		    	<span class="built_in">fill</span>(dp.<span class="built_in">begin</span>(), dp.<span class="built_in">begin</span>() + <span class="number">1</span> + n, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(<span class="number">2</span>, <span class="number">1e18</span>));</span><br><span class="line">		    	<span class="comment">// i = 0 çš„è½¬ç§»ï¼šè‹¥ v1[0] ä¸è¶…è¿‡ç›®æ ‡ä½ï¼Œåˆ™ä»£ä»·ä¸ºè¡¥åˆ°è¯¥ä½çš„â€œæ–°å¼€å±‚æ•°â€</span></span><br><span class="line">		    	<span class="keyword">if</span>(v1[<span class="number">0</span>] &lt;= x) dp[<span class="number">0</span>][<span class="number">0</span>] = x - v1[<span class="number">0</span>];  <span class="comment">// delta[0] = x - v1[0]</span></span><br><span class="line">		    	<span class="keyword">if</span>(v1[<span class="number">0</span>] &lt;= y) dp[<span class="number">0</span>][<span class="number">1</span>] = y - v1[<span class="number">0</span>];  <span class="comment">// delta[0] = y - v1[0]</span></span><br><span class="line">		    	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i ++) &#123;</span><br><span class="line">		    		<span class="comment">// è‹¥å½“å‰ä½ç½®é€‰æ‹©â€œé«˜ä½ xâ€</span></span><br><span class="line">		    		<span class="keyword">if</span>(v1[i] &lt;= x) &#123;</span><br><span class="line">		    			<span class="comment">// ä»ä¸Šä¸€ä½ä¹Ÿæ˜¯ x è½¬æ¥ï¼š</span></span><br><span class="line">		    			<span class="comment">//  éœ€è¦é¢å¤–ä»˜å‡º max(0, (x - v[i]) - (x - v[i-1])) = max(0, delta[i]-delta[i-1])</span></span><br><span class="line">		    			dp[i][<span class="number">0</span>] = <span class="built_in">min</span>(&#123;</span><br><span class="line">		    				dp[i][<span class="number">0</span>],</span><br><span class="line">		    				dp[i - <span class="number">1</span>][<span class="number">0</span>] + <span class="built_in">max</span>(<span class="number">0ll</span>, (x - v1[i]) - (x - v1[i - <span class="number">1</span>])),</span><br><span class="line">		    				<span class="comment">// ä»ä¸Šä¸€ä½æ˜¯ y è½¬æ¥ï¼š</span></span><br><span class="line">		    				<span class="comment">//  æ¯”è¾ƒ delta[i]=x-v[i] ä¸ å‰ä¸€ä½çš„ delta[i-1]=y-v[i-1]</span></span><br><span class="line">		    				dp[i - <span class="number">1</span>][<span class="number">1</span>] + <span class="built_in">max</span>(<span class="number">0ll</span>, (x - v1[i]) - (y - v1[i - <span class="number">1</span>]))</span><br><span class="line">		    			&#125;);</span><br><span class="line">		    		&#125;</span><br><span class="line">		    		<span class="comment">// è‹¥å½“å‰ä½ç½®é€‰æ‹©â€œä½ä½ yâ€</span></span><br><span class="line">		    		<span class="keyword">if</span>(v1[i] &lt;= y) &#123;</span><br><span class="line">		    			dp[i][<span class="number">1</span>] = <span class="built_in">min</span>(&#123;</span><br><span class="line">		    				dp[i][<span class="number">1</span>],</span><br><span class="line">		    				dp[i - <span class="number">1</span>][<span class="number">0</span>] + <span class="built_in">max</span>(<span class="number">0ll</span>, (y - v1[i]) - (x - v1[i - <span class="number">1</span>])),</span><br><span class="line">		    				dp[i - <span class="number">1</span>][<span class="number">1</span>] + <span class="built_in">max</span>(<span class="number">0ll</span>, (y - v1[i]) - (y - v1[i - <span class="number">1</span>]))</span><br><span class="line">		    			&#125;);</span><br><span class="line">		    		&#125;</span><br><span class="line">		    	&#125;</span><br><span class="line">		    	<span class="keyword">return</span> <span class="built_in">min</span>(dp[n - <span class="number">1</span>][<span class="number">0</span>], dp[n - <span class="number">1</span>][<span class="number">1</span>]);</span><br><span class="line">		    &#125;;</span><br><span class="line">		    <span class="comment">// ç©·ä¸¾æ‰€æœ‰ (x, y)ï¼ˆ0..200 ä¸” y&lt;=xï¼‰å–æœ€å°å€¼</span></span><br><span class="line">		    <span class="comment">// æ³¨ï¼šèŒƒå›´ 200 æ¥è‡ªé¢˜é¢ï¼ˆæˆ–æ•°æ®èŒƒå›´ï¼‰å‡è®¾</span></span><br><span class="line">		    ans = <span class="number">1e18</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">200</span>; i ++)</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt;= i; j ++)</span><br><span class="line">					ans = <span class="built_in">min</span>(ans, <span class="built_in">get</span>(i, j));</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="è¡Œåˆ—å–æ¨¡æ„é€ "><a href="#è¡Œåˆ—å–æ¨¡æ„é€ " class="headerlink" title="è¡Œåˆ—å–æ¨¡æ„é€ "></a>è¡Œåˆ—å–æ¨¡æ„é€ </h3><p>å¯¹äºç»™å®šçš„è¡Œnå’Œåˆ—m,å¦‚æœéœ€è¦ç»™å®šnä¸ªå€¼aå’Œmä¸ªå€¼bï¼Œé‚£ä¹ˆæ‰€æ„æˆçš„n<em>mçŸ©é˜µMä¸­,$M<em>{ij}=a</em>{i}b_{j} \mod nm, 1 &lt;= i &lt;= n,1 &lt;= j &lt;= m$ï¼Œæ¯ä¸ªæ•°éƒ½ä¸ä¸€æ ·ï¼Œä¸”æ‰€æœ‰çš„aå’Œbéƒ½å¤„äº[0, n </em> m - 1]ä¸­ï¼Œåº”è¯¥å¦‚ä½•ç»™å®šæ¯ä¸€ä¸ªaå’Œbçš„å€¼ã€‚</p>
<p>ç­”æ¡ˆä¸ºï¼šæ„é€  <strong>$a_i = (i \ast m + 1) \mod n \ast m ,(1 â‰¤ i â‰¤ n) å’Œ b_j = (j \ast m + 1) \mod n \ ast m ,(1 â‰¤ j â‰¤ m)$ã€‚</strong></p>
<p>è¯æ˜ï¼šå¯¹äº $i=1$ åˆ° $n$ï¼Œ$a<em>i = (i \ast m + 1) \mod n \ast m$ï¼›å¯¹äº $j=1$ åˆ° $m$ï¼Œ$b_j = (j \ast n + 1) \mod n \ast m$ã€‚è¿™æ ·äº§ç”Ÿçš„ $n \times m$ ä¸ªå€¼ $c</em>{i,j} = a_i \ast b_j \mod (n \ast m)$ã€‚ä¸ºç®€ä¾¿èµ·è§ï¼Œä»¤ $N = n \ast m$ã€‚</p>
<p>é¢˜è§£ä¸­çš„è¯æ˜æ˜¾ç¤ºï¼Œå¦‚æœ $a<em>i b_j \equiv a</em>{iâ€™} b<em>{jâ€™} \pmod{N}$ï¼Œåˆ™ $m(i - iâ€™) \equiv n(jâ€™ - j) \pmod{N}$ã€‚é‡æ–°æ•´ç†åï¼Œå¯å¾— $m(i - iâ€™ - k n) = n(jâ€™ - j)$ å¯¹äºæŸä¸ªæ•´æ•° $k$ã€‚ç”±äº $\gcd(m, n) = 1$ï¼Œç”±æ­¤å¯çŸ¥ $m$ æ•´é™¤ $(jâ€™ - j)$ã€‚ä½† $|jâ€™ - j| &lt; m$ï¼Œå› æ­¤å”¯ä¸€å¯èƒ½çš„æ˜¯ $jâ€™ = j$ï¼Œè¿›è€Œ $iâ€™ = i$ã€‚ä»è€Œï¼Œæ‰€æœ‰ $c</em>{i,j}$ åœ¨æ¨¡ $N$ ä¸‹ä¸¤ä¸¤ä¸åŒã€‚</p>
<p>å…±æœ‰æ°å¥½ $N$ ä¸ªè¿™æ ·çš„ $c<em>{i,j}$ å€¼ï¼ˆå¯¹åº” $n \times m = N$ ä¸ª $(i, j)$ å¯¹ï¼‰ï¼Œä¸”å®ƒä»¬å‡ä¸º ${0, 1, \dots, N-1}$ ä¸­çš„ä¸åŒæ•´æ•°ã€‚å› æ­¤ï¼Œé›†åˆ ${c</em>{i,j}}$ å¿…é¡»æ°å¥½æ˜¯ ${0, 1, \dots, N-1}$ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªä»å¤§å°ä¸º $N$ çš„é›†åˆåˆ°å¤§å°ä¸º $N$ çš„é›†åˆçš„å•å°„æ˜ å°„ï¼ˆæ¨¡ $N$ ä¸‹ï¼‰ã€‚</p>
<h2 id="æ•°å­¦"><a href="#æ•°å­¦" class="headerlink" title="æ•°å­¦"></a>æ•°å­¦</h2><p>è¿™ä¸ªéƒ¨åˆ†æ¶‰åŠæ•°å­¦ä¸­å‡ ä½•ï¼Œå¾®ç§¯åˆ†ç­‰çš„ä¸€èˆ¬çŸ¥è¯†</p>
<h3 id="å¸¸è§æœŸæœ›è®¡ç®—"><a href="#å¸¸è§æœŸæœ›è®¡ç®—" class="headerlink" title="å¸¸è§æœŸæœ›è®¡ç®—"></a>å¸¸è§æœŸæœ›è®¡ç®—</h3><p>ä¸‹é¢æ˜¯ <strong>æœŸæœ›è®¡ç®—ä¸­æœ€å¸¸è§</strong> çš„å‡ ç±»çº§æ•°åŠå…¶ <strong>å°é—­å½¢å¼ç»“æœ</strong>ï¼ˆé—­åˆè¡¨è¾¾å¼ï¼‰,æ‰€æœ‰çº§æ•°éƒ½å‡è®¾ ( |r| &lt; 1 )ï¼Œå¦åˆ™å‘æ•£ã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>#</th>
<th>çº§æ•°å½¢å¼</th>
<th>å°é—­å½¢å¼ï¼ˆæ±‚å’Œç»“æœï¼‰</th>
<th>å¸¸è§åº”ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>$(\sum_{k=0}^{\infty} r^k )$</td>
<td>$(\dfrac{1}{1-r})$</td>
<td>æ™®é€šå‡ ä½•çº§æ•°ï¼Œæ¦‚ç‡å½’ä¸€åŒ–</td>
</tr>
<tr>
<td>2</td>
<td>$(\sum_{k=1}^{\infty} r^k )$</td>
<td>$(\dfrac{r}{1-r})$</td>
<td>ä»ç¬¬ 1 é¡¹å¼€å§‹çš„å‡ ä½•çº§æ•°</td>
</tr>
<tr>
<td>3</td>
<td>$(\sum_{k=0}^{\infty} k r^{k} )$</td>
<td>$(\dfrac{r}{(1-r)^2})$</td>
<td>å¸¸ç”¨äºâ€œå¤±è´¥ k æ¬¡â€çš„è´¡çŒ®</td>
</tr>
<tr>
<td>4</td>
<td>$(\sum_{k=1}^{\infty} k r^{k-1} )$</td>
<td>$(\dfrac{1}{(1-r)^2})$</td>
<td><strong>å‡ ä½•åˆ†å¸ƒæœŸæœ›çš„æ ¸å¿ƒ</strong></td>
</tr>
<tr>
<td>5</td>
<td>$(\sum_{k=1}^{\infty} k r^{k} )$</td>
<td>$(\dfrac{r}{(1-r)^2})$</td>
<td>åŒä¸Šï¼ŒæŒ‡æ•°å°‘ 1</td>
</tr>
<tr>
<td>6</td>
<td>$(\sum_{k=1}^{\infty} k(k-1) r^{k} )$</td>
<td>$(\dfrac{2r^2}{(1-r)^3})$</td>
<td>äºŒé˜¶çŸ©ã€æ–¹å·®è®¡ç®—æ—¶å‡ºç°</td>
</tr>
<tr>
<td>7</td>
<td>$(\sum_{k=2}^{\infty} k(k-1) r^{k-2} )$</td>
<td>$(\dfrac{2}{(1-r)^3})$</td>
<td>æå–äºŒé˜¶å¯¼æ•°æ—¶ç”¨</td>
</tr>
<tr>
<td>8</td>
<td>$(\sum_{k=0}^{\infty} \binom{k+n-1}{n-1} r^k )$</td>
<td>$(\dfrac{1}{(1-r)^n})$</td>
<td>è´ŸäºŒé¡¹åˆ†å¸ƒå½’ä¸€åŒ–ï¼ˆn é‡å‡ ä½•ï¼‰</td>
</tr>
<tr>
<td>9</td>
<td>$(\sum_{k=1}^{\infty} k \binom{k+n-2}{n-1} r^k )$</td>
<td>$(\dfrac{n r}{(1-r)^{n+1}})$</td>
<td>è´ŸäºŒé¡¹æœŸæœ›ï¼ˆç­‰å¾… n æ¬¡æˆåŠŸï¼‰</td>
</tr>
</tbody>
</table>
</div>
<p>æœ€å¸¸ç”¨çš„ 3 ä¸ªâ€œèƒŒå£è¯€â€ç‰ˆæœ¬ï¼ˆç›´æ¥å¥—ï¼‰</p>
<ol>
<li><p><strong>æ™®é€šå‡ ä½•åˆ†å¸ƒï¼ˆç¬¬ä¸€æ¬¡æˆåŠŸéœ€è¦çš„è¯•éªŒæ¬¡æ•°ï¼‰</strong><br>$E[X] = \sum_{i=1}^{\infty} i q^{i-1} p = \frac{1}{p}$</p>
</li>
<li><p><strong>ä» 0 å¼€å§‹è®¡æ•°å¤±è´¥æ¬¡æ•°</strong>ï¼ˆå¤±è´¥äº† k æ¬¡å†æˆåŠŸï¼‰<br>$E[\text{å¤±è´¥æ¬¡æ•°}] = \sum_{k=0}^{\infty} k q^k p = \frac{q}{p}$</p>
</li>
<li><p><strong>è´ŸäºŒé¡¹ï¼ˆç­‰åˆ°ç¬¬ r æ¬¡æˆåŠŸéœ€è¦çš„æ€»è¯•éªŒæ¬¡æ•°ï¼‰</strong><br>$E[X] = \frac{r}{p}$</p>
</li>
</ol>
<p>å¸¸ç”¨å˜å½¢é€Ÿç®—è¡¨ï¼ˆç›´æ¥ä»£å…¥ï¼‰</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>é¢˜ç›®ç»™çš„ p</th>
<th>å¯¹åº”çš„æœŸæœ›</th>
</tr>
</thead>
<tbody>
<tr>
<td>$(p = \dfrac{1}{n})$</td>
<td>$(E = n)$</td>
</tr>
<tr>
<td>$(p = \dfrac{a}{b})$</td>
<td>$(E = \dfrac{b}{a})$</td>
</tr>
<tr>
<td>$(p = 0.01)$</td>
<td>$(E = 100)$</td>
</tr>
<tr>
<td>$(p = \dfrac{1}{100})$</td>
<td>$(E = 100)$</td>
</tr>
<tr>
<td>$(p = \dfrac{m}{n})$</td>
<td>$(E = \dfrac{n}{m})$</td>
</tr>
</tbody>
</table>
</div>
<p>æ–¹å·®å¿«é€Ÿè®¡ç®—</p>
<p>å‡ ä½•åˆ†å¸ƒæ–¹å·®ï¼š<br>$\text{Var}(X) = \frac{q}{p^2} = \frac{1-p}{p^2}$</p>
<h3 id="ç»„åˆæ•°æ±‚å’Œ"><a href="#ç»„åˆæ•°æ±‚å’Œ" class="headerlink" title="ç»„åˆæ•°æ±‚å’Œ"></a>ç»„åˆæ•°æ±‚å’Œ</h3><p>$\sum_{i = 1}^{n} \frac{i <em> (i + 1)}{2}$çš„å€¼ä¸º(n </em> (n + 1) * (n + 2)) / 6.</p>
<h3 id="æ•°ä½å’Œä¹‹å’Œ"><a href="#æ•°ä½å’Œä¹‹å’Œ" class="headerlink" title="æ•°ä½å’Œä¹‹å’Œ"></a>æ•°ä½å’Œä¹‹å’Œ</h3><p>æ•°ä½å’Œçš„æ„æ€æ˜¯å¯¹äºf(100), å…¶å€¼ä¸ºæ¯ä¸€ä½ä¸Šçš„æ•°ä¹‹å’Œï¼Œå€¼ä¸º1+0+0=1,è€Œå¯¹äºf(123),å…¶å€¼åŒç†ä¸º1+2+3=6.</p>
<p>è‹¥è¦æ±‚$zh$ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼Œå°†è§†è§’è½¬ç§»è‡³æ•°ä½ä¸Šï¼ŒæŠŠæ‰€æœ‰æ•°çš„æ•°ä½ä»¥è¡¥é›¶çš„æ–¹å¼ä¸nçš„æ•°ä½å¯¹é½ï¼Œç„¶ååˆ†ä¸‰éƒ¨åˆ†è¿›è¡Œå€¼çš„è®¡ç®—ï¼š</p>
<p>è®¡ç®—ä¹‹å‰è¦æŒ‡å‡ºï¼Œå¯¹äº$10^{l}$æ¬¡æ–¹ä»¥å‰çš„æ•°ï¼Œæ¯ä¸€ä¸ª$10^{l}$éƒ½å¯¹åº”ç€$l * 10^{l - 1}$ä¸ª45ï¼Œå¯è‡ªè¡Œæšä¸¾å†ç¨åŠ æ€è€ƒå‘ç°è§„å¾‹</p>
<ol>
<li>å½“å‰æ•°å­—ä»¥å‰çš„æ‰€æœ‰æ•°å­—æ‰€å¯¹åº”çš„45çš„ç»„æ•°</li>
<li>å½“å‰ä½çš„å½“å‰æ•°å­—ä»¥å‰çš„å€¼ä¹‹å’Œ</li>
<li>å½“å‰ä½çš„å½“å‰æ•°å­—çš„å’Œ </li>
</ol>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">// https://codeforces.com/contest/2132/problem/D</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>)-&gt;ios_base::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    cin &gt;&gt; t;   <span class="comment">// è¾“å…¥æµ‹è¯•ç”¨ä¾‹æ•°é‡</span></span><br><span class="line">    <span class="keyword">while</span>(t --)&#123;</span><br><span class="line">        <span class="type">int</span> n;</span><br><span class="line">        cin &gt;&gt; n;   <span class="comment">// è¾“å…¥ kï¼ˆä¿ç•™çš„æ€»ä½æ•°ï¼‰</span></span><br><span class="line">        <span class="comment">// get(x): è®¡ç®—ä» 1 æ‹¼åˆ° x ä¸€å…±ç”¨äº†å¤šå°‘ä½æ•°å­—</span></span><br><span class="line">        <span class="keyword">auto</span> get = [&amp;](<span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">            <span class="type">int</span> len1 = <span class="number">0</span>;   <span class="comment">// è®°å½•æ€»é•¿åº¦</span></span><br><span class="line">            <span class="type">int</span> p = <span class="number">1</span>;      <span class="comment">// å½“å‰åŒºé—´çš„èµ·å§‹æ•°ï¼š1, 10, 100, ...</span></span><br><span class="line">            <span class="type">int</span> d = <span class="number">1</span>;      <span class="comment">// å½“å‰åŒºé—´çš„ä½æ•°ï¼ˆ1 ä½æ•°ï¼Œ2 ä½æ•°ï¼Œ...ï¼‰</span></span><br><span class="line">            <span class="comment">// å…ˆå¤„ç†å®Œæ•´åŒºé—´ï¼ˆä¾‹å¦‚ 1~9, 10~99, ...ï¼‰</span></span><br><span class="line">            <span class="keyword">while</span>(p * <span class="number">10</span> &lt;= x) &#123;</span><br><span class="line">                len1 += <span class="number">9</span> * p * d;  <span class="comment">// è¯¥åŒºé—´ä¸€å…±çš„ä½æ•° = æ•°å­—ä¸ªæ•° * ä½æ•°</span></span><br><span class="line">                d ++;</span><br><span class="line">                p *= <span class="number">10</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// æœ€åå‰©ä½™åŒºé—´ï¼ˆp..xï¼‰</span></span><br><span class="line">            len1 += (x - p + <span class="number">1</span>) * d;</span><br><span class="line">            <span class="keyword">return</span> len1;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// äºŒåˆ†æŸ¥æ‰¾ï¼šæ‰¾åˆ°æœ€å°çš„ ans ä½¿å¾—å†™åˆ° ans çš„ä½æ•° â‰¥ n</span></span><br><span class="line">        <span class="type">int</span> l = <span class="number">1</span>, r = <span class="number">1e15</span>, mid, ans;</span><br><span class="line">        <span class="keyword">while</span>(l &lt;= r) &#123;</span><br><span class="line">            mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">get</span>(mid) &gt;= n) ans = mid, r = mid - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> l = mid + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> val = <span class="number">0</span>; <span class="comment">// ç»“æœï¼šæ•°ä½å’Œ</span></span><br><span class="line">        <span class="comment">// å¦‚æœ get(ans) &gt; nï¼Œè¯´æ˜ ans çš„æœ€åä¸€ä¸ªæ•°å¯èƒ½å¤šå–äº†å‡ ä½ï¼Œéœ€è¦å›é€€</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">get</span>(ans) &gt; n) &#123;</span><br><span class="line">            <span class="type">int</span> x = ans;</span><br><span class="line">            <span class="type">int</span> len2 = <span class="built_in">get</span>(ans --); <span class="comment">// å…ˆé€€åˆ° ans-1</span></span><br><span class="line">            <span class="comment">// ç»§ç»­é€€æ‰å¤šä½™çš„ä½</span></span><br><span class="line">            <span class="keyword">while</span>(len2 &gt; n) len2 --, x /= <span class="number">10</span>;</span><br><span class="line">            <span class="comment">// æŠŠä¿ç•™ä¸‹æ¥çš„ x çš„æ¯ä¸€ä½åŠ åˆ°ç­”æ¡ˆ</span></span><br><span class="line">            <span class="keyword">while</span>(x) val += x % <span class="number">10</span>, x /= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¤„ç†å®Œæ•´çš„éƒ¨åˆ†ï¼ˆ1 åˆ° ansï¼‰</span></span><br><span class="line">        <span class="keyword">if</span>(ans) &#123;</span><br><span class="line">            string s = <span class="built_in">to_string</span>(ans); <span class="comment">// æŠŠ ans è½¬æˆå­—ç¬¦ä¸²</span></span><br><span class="line">            <span class="type">int</span> l = <span class="number">1</span>;    <span class="comment">// å½“å‰å¤„ç†çš„ä½æ•°</span></span><br><span class="line">            <span class="type">int</span> base = <span class="number">1</span>; <span class="comment">// ä½æƒ</span></span><br><span class="line">            <span class="type">int</span> sum = <span class="number">0</span>;  <span class="comment">// å‰ç¼€å’Œï¼ˆç”¨æ¥ç®—è´¡çŒ®ï¼‰   </span></span><br><span class="line">            <span class="comment">// ä»ä½ä½åˆ°é«˜ä½æšä¸¾ ans çš„æ¯ä¸€ä½</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">auto</span> i = s.<span class="built_in">rbegin</span>(); i &lt; s.<span class="built_in">rend</span>(); i ++, base *= <span class="number">10</span>, l ++) &#123;</span><br><span class="line">                <span class="type">int</span> x = *i - <span class="string">&#x27;0&#x27;</span>;  <span class="comment">// å½“å‰ä½çš„æ•°å€¼</span></span><br><span class="line">                sum += x * base;</span><br><span class="line">                <span class="comment">// å¤æ‚çš„å…¬å¼ï¼šè®¡ç®—è¯¥ä½å¯¹æ•°ä½å’Œçš„è´¡çŒ®</span></span><br><span class="line">                val += x * (x - <span class="number">1</span>) / <span class="number">2</span> * base              <span class="comment">// å½“å‰ä½å– 0..(x-1) çš„è´¡çŒ®</span></span><br><span class="line">                    + <span class="number">45</span> * base / <span class="number">10</span> * (l - <span class="number">1</span>) * x         <span class="comment">// ä½ä½çš„å¾ªç¯è´¡çŒ®</span></span><br><span class="line">                    + x * (sum - x * base + <span class="number">1</span>);            <span class="comment">// é«˜ä½å›ºå®šæ—¶çš„è´¡çŒ®</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; val &lt;&lt; <span class="string">&quot;\n&quot;</span>; <span class="comment">// è¾“å‡ºç»“æœ</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="éš”æ¿æ³•ï¼ˆStars-and-Barsï¼‰"><a href="#éš”æ¿æ³•ï¼ˆStars-and-Barsï¼‰" class="headerlink" title="éš”æ¿æ³•ï¼ˆStars and Barsï¼‰"></a>éš”æ¿æ³•ï¼ˆStars and Barsï¼‰</h3><p><strong>æ— ç•Œéè´Ÿæ•´æ•°ç»„åˆ</strong></p>
<ul>
<li>é¢˜å‹ï¼šæ±‚éè´Ÿæ•´æ•°è§£ â€…â€Š$x_1+\cdots+x_k=N$ çš„æ–¹æ¡ˆæ•°</li>
<li>ç­”æ¡ˆï¼š$\binom{N+k-1}{k-1}$</li>
<li>å«ä¹‰ï¼šæŠŠ N ä¸ªã€Œæ˜Ÿæ˜Ÿã€æ”¾å…¥ kkä¸ªã€Œç›’å­ã€ï¼Œç›’å­é—´ç”¨ kâˆ’1é“éš”æ¿åˆ†éš”ã€‚  </li>
</ul>
<p><strong>å•è°ƒåºåˆ—å·®åˆ†</strong></p>
<p>éå¢/éå‡åºåˆ—ï¼ˆ$a<em>1 \ge a_2 \ge \dots \ge a_k \ge 0$ï¼‰å¯è½¬ä¸ºå·®åˆ†$d_i = a_i - a</em>{i - 1}$,å†ç”¨éš”æ¿æ³•ç®—$\sum di = a_k - a_1$</p>
<h3 id="æ™®é€šç”Ÿæˆå‡½æ•°ï¼ˆOGFï¼‰"><a href="#æ™®é€šç”Ÿæˆå‡½æ•°ï¼ˆOGFï¼‰" class="headerlink" title="æ™®é€šç”Ÿæˆå‡½æ•°ï¼ˆOGFï¼‰"></a>æ™®é€šç”Ÿæˆå‡½æ•°ï¼ˆOGFï¼‰</h3><p>å®šä¹‰</p>
<ul>
<li>ç»™å®šåºåˆ— ${a_n}$ï¼Œå…¶ OGF ä¸º<script type="math/tex; mode=display">
  A(t)=\sum_{n\ge0}a_n\,t^n.</script></li>
</ul>
<p>ä¹˜æ³•å¯¹åº”ã€Œç‹¬ç«‹äº‹ä»¶çš„å·ç§¯ã€</p>
<ul>
<li>è‹¥è¦æŠŠä¸¤ç±»ç»“æ„ç‹¬ç«‹æ‹¼æ¥ï¼Œæ€»æ–¹æ¡ˆæ•°çš„åºåˆ—æ˜¯ä¸¤ç”Ÿæˆå‡½æ•°ç›¸ä¹˜ï¼š<script type="math/tex; mode=display">
  A(t)\times B(t)\;\Longrightarrow\;  [t^n]\bigl(A(t)B(t)\bigr)\;=\;\sum_{i+j=n}a_i\,b_j.</script></li>
</ul>
<p>å¹‚è¿ç®—</p>
<ul>
<li>$A(t)^k$ è¡¨ç¤ºç‹¬ç«‹é€‰å– k ä»½ç›¸åŒç»“æ„å¹¶è”ã€‚</li>
</ul>
<h3 id="å¹¿ä¹‰äºŒé¡¹å¼ä¸ç³»æ•°æå–"><a href="#å¹¿ä¹‰äºŒé¡¹å¼ä¸ç³»æ•°æå–" class="headerlink" title="å¹¿ä¹‰äºŒé¡¹å¼ä¸ç³»æ•°æå–"></a>å¹¿ä¹‰äºŒé¡¹å¼ä¸ç³»æ•°æå–</h3><p><strong>å¹¿ä¹‰äºŒé¡¹å¼å®šç†</strong></p>
<script type="math/tex; mode=display">
(1 - t)^{-\alpha}  = \sum_{n=0}^\infty      \binom{\alpha+n-1}{n}\,t^n, \quad \binom{\alpha+n-1}{n} = \frac{\alpha(\alpha+1)\cdots(\alpha+n-1)}{n!}.</script><p><strong>ç³»æ•°æå–</strong></p>
<ul>
<li><p>å¯¹äºå·²çŸ¥é—­å¼ G(t)ï¼Œå¸¸ç”¨ï¼š</p>
<p>  $[t^n]\,G(t) \quad\text{æˆ–}\quad  \text{å‰ç¼€å’Œ }\sum_{i=0}^n [t^i]G(t).$</p>
</li>
</ul>
<p><strong>ç´¯åŠ æ’ç­‰å¼</strong></p>
<script type="math/tex; mode=display">
\sum_{i=0}^m \binom{i+r}{r}  = \binom{m+r+1}{r+1},  \quad  \sum_{i=0}^m \binom{r}{i}  = \binom{r}{0}+\cdots+\binom{r}{m}.</script><h3 id="æ±‚äºŒç»´å¹³é¢ä¸Šçš„ä¸‰è§’å½¢é¢ç§¯"><a href="#æ±‚äºŒç»´å¹³é¢ä¸Šçš„ä¸‰è§’å½¢é¢ç§¯" class="headerlink" title="æ±‚äºŒç»´å¹³é¢ä¸Šçš„ä¸‰è§’å½¢é¢ç§¯"></a>æ±‚äºŒç»´å¹³é¢ä¸Šçš„ä¸‰è§’å½¢é¢ç§¯</h3><h4 id="ç»™å®šä¸‰ä¸ªé¡¶ç‚¹"><a href="#ç»™å®šä¸‰ä¸ªé¡¶ç‚¹" class="headerlink" title="ç»™å®šä¸‰ä¸ªé¡¶ç‚¹"></a>ç»™å®šä¸‰ä¸ªé¡¶ç‚¹</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">S = <span class="built_in">abs</span>(x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2)) / <span class="number">2</span>;</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line">S = <span class="built_in">abs</span>((x2 - x1) * (y3 - y1) - (x3 - x1) * (y2 - y1)) / <span class="number">2</span>;</span><br><span class="line"><span class="comment">// ä¸¤ä¸ªå‚æ•°ç›¸è¾ƒäºä¸‰ä¸ªå‚æ•°ï¼Œæœ‰å¦‚ä¸‹ä¼˜åŠ¿ï¼Œå¯ä»¥å–ä¸€ä¸ªåæ ‡ä¸ºåŸºå‡†ï¼ˆ2åæ ‡ä¸1åæ ‡ï¼Œ3åæ ‡ä¸1åæ ‡ï¼Œæ¯ä¸ªå‚æ•°éƒ½è¿›è¡Œäº†ä¸€æ¬¡ç¢°é¢ï¼‰ï¼Œè¿›è¡Œç‚¹ä¸ç‚¹ä¹‹é—´çš„é€»è¾‘å¤„ç†ï¼Œå¦‚åˆ¤æ–­å¤„åæ ‡å¼‚æˆ–å€¼</span></span><br></pre></td></tr></table></figure>
<h4 id="ç»™å®šä¸‰æ¡è¾¹"><a href="#ç»™å®šä¸‰æ¡è¾¹" class="headerlink" title="ç»™å®šä¸‰æ¡è¾¹"></a>ç»™å®šä¸‰æ¡è¾¹</h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">p = (a + b + c) / <span class="number">2</span>;</span><br><span class="line">S = <span class="built_in">sqrt</span>(p * (p -a ) * (p - b) * (p - c));</span><br></pre></td></tr></table></figure>
<h3 id="æ±‚ä¸‰ç»´ç©ºé—´ä¸­ä¸¤æ¡ç›´çº¿æœ€çŸ­è·ç¦»"><a href="#æ±‚ä¸‰ç»´ç©ºé—´ä¸­ä¸¤æ¡ç›´çº¿æœ€çŸ­è·ç¦»" class="headerlink" title="æ±‚ä¸‰ç»´ç©ºé—´ä¸­ä¸¤æ¡ç›´çº¿æœ€çŸ­è·ç¦»"></a>æ±‚ä¸‰ç»´ç©ºé—´ä¸­ä¸¤æ¡ç›´çº¿æœ€çŸ­è·ç¦»</h3><p><code>L1</code>ç»è¿‡<code>A(x1,  y1,  z1)</code>, <code>B(x2,  y2,  z2)</code></p>
<p><code>L2</code>ç»è¿‡<code>C(x3,  y3,  z3)</code>, <code>D(x4,  y4,  z4)</code></p>
<p><code>L1</code>çš„æ–¹å‘å‘é‡<code>d1 = B - A</code>, <code>L2</code>çš„æ–¹å‘å‘é‡<code>d2 = D - C</code></p>
<p><code>n = d1 * d2</code></p>
<p>å¦‚æœnä¸º0,åˆ™ä¸¤ç›´çº¿å¹³è¡Œ</p>
<p>ä»»é€‰<code>L1</code>ä¸Šçš„ç‚¹Aå’Œ<code>L2</code>ä¸Šçš„ç‚¹Cï¼Œè®¡ç®—<code>AC = C - A</code></p>
<p>ä¸å¹³è¡Œæ—¶ï¼Œä¸¤ç›´çº¿æœ€çŸ­è·ç¦»<code>d = |AC  .*  n| / |n|</code></p>
<p>å¹³è¡Œæ—¶ï¼Œ<code>d = |AC * d1| / |d1|</code></p>
<hr>
<p>ä¸å¹³è¡Œæƒ…å†µ</p>
<script type="math/tex; mode=display">
è‹¥ \vec{d_1} \times \vec{d_2} \neq 0ï¼Œåˆ™æœ€çŸ­è·ç¦»å…¬å¼ä¸º</script><script type="math/tex; mode=display">
d = \frac{\left| (C - A) \cdot \bigl(\vec{d_1} \times \vec{d_2}\bigr) \right|}{\|\vec{d_1} \times \vec{d_2}\|}.</script><p>å…¶ä¸­ï¼š</p>
<script type="math/tex; mode=display">
(C - A) è¡¨ç¤ºå‘é‡ï¼Œ
\cdot ä¸ºç‚¹ä¹˜ï¼Œ
\times ä¸ºå‰ä¹˜ã€‚</script><script type="math/tex; mode=display">
è¯¥å…¬å¼çš„å‡ ä½•æ„ä¹‰æ˜¯ï¼š\vec{d_1} \times \vec{d_2} å‚ç›´äºä¸¤æ¡ç›´çº¿ï¼Œ(C - A) åœ¨æ­¤å‚ç›´æ–¹å‘ä¸Šçš„æŠ•å½±é•¿åº¦å³ä¸ºä¸¤æ¡ç›´çº¿çš„æœ€çŸ­è·ç¦»ã€‚</script><p>å¹³è¡Œæƒ…å†µ</p>
<script type="math/tex; mode=display">
è‹¥ \vec{d_1} \times \vec{d_2} = 0ï¼Œåˆ™è¯´æ˜ä¸¤æ¡ç›´çº¿å¹³è¡Œæˆ–é‡åˆã€‚æ­¤æ—¶æœ€çŸ­è·ç¦»å¯ä»¥ç”±ä¸‹å¼ç»™å‡ºï¼š</script><script type="math/tex; mode=display">
d = \frac{\|(C - A) \times \vec{d_1}\|}{\|\vec{d_1}\|}.</script><p>å¦‚æœå‡ºç°é€€åŒ–æƒ…å†µï¼ˆä¾‹å¦‚ A=B æˆ– C=Dï¼‰ï¼Œéœ€è¦è¿›ä¸€æ­¥åšç‰¹æ®Šå¤„ç†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="comment">// baidu 14 2</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">point</span>&#123;</span><br><span class="line">	<span class="type">double</span> x, y, z;</span><br><span class="line">	<span class="built_in">point</span>(<span class="type">double</span> x1 = <span class="number">0</span>, <span class="type">double</span> y1 = <span class="number">0</span>, <span class="type">double</span> z1 = <span class="number">0</span>): <span class="built_in">x</span>(x1), <span class="built_in">y</span>(y1), <span class="built_in">z</span>(z1) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>) -&gt; ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    <span class="keyword">while</span> (t--)&#123;</span><br><span class="line">    	<span class="type">double</span> x1, x2, x3, x4, y1, y2, y3, y4, z1, z2, z3, z4;</span><br><span class="line">    	cin &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; z1 &gt;&gt; x2 &gt;&gt; y2 &gt;&gt; z2 &gt;&gt; x3 &gt;&gt; y3 &gt;&gt; z3 &gt;&gt; x4 &gt;&gt; y4 &gt;&gt; z4;</span><br><span class="line">    	point a = point&#123;x1, y1, z1&#125;, b = &#123;x2, y2, z2&#125;, c = &#123;x3, y3, z3&#125;, d = &#123;x4, y4, z4&#125;;</span><br><span class="line">    	<span class="comment">// å‘é‡å‡æ³•ï¼šè¿”å› b - a</span></span><br><span class="line">    	<span class="keyword">auto</span> vecSub = [](<span class="type">const</span> point &amp; a, <span class="type">const</span> point &amp; b) -&gt; point &#123;</span><br><span class="line">    		point temp = <span class="built_in">point</span>(b.x - a.x, b.y - a.y, b.z - a.z);</span><br><span class="line">    		<span class="keyword">return</span> temp;</span><br><span class="line">    	&#125;;</span><br><span class="line">    	<span class="comment">// å‘é‡å‰ä¹˜ (ä»…é€‚ç”¨äº 3D)</span></span><br><span class="line">    	<span class="keyword">auto</span> crossProduct = [](<span class="type">const</span> point &amp; a, <span class="type">const</span> point &amp; b) -&gt; point&#123;</span><br><span class="line">    		point temp = <span class="built_in">point</span>(a.y * b.z - a.z * b.y, a.z * b.x - a.x * b.z, a.x * b.y - a.y * b.x);</span><br><span class="line">    		<span class="keyword">return</span> temp;</span><br><span class="line">    	&#125;;</span><br><span class="line">    	<span class="comment">// å‘é‡ç‚¹ä¹˜</span></span><br><span class="line">    	<span class="keyword">auto</span> dotProduct = [](<span class="type">const</span> point &amp; a, <span class="type">const</span> point &amp; b) -&gt; <span class="type">double</span> &#123;</span><br><span class="line">    		<span class="keyword">return</span> a.x * b.x + a.y * b.y + a.z * b.z;</span><br><span class="line">    	&#125;;</span><br><span class="line">    	<span class="comment">// å‘é‡çš„æ¨¡é•¿</span></span><br><span class="line">    	<span class="keyword">auto</span> norm = [](<span class="type">const</span> point &amp; a) -&gt; <span class="type">double</span> &#123;</span><br><span class="line">    		<span class="keyword">return</span> <span class="built_in">sqrt</span>(a.x * a.x + a.y * a.y + a.z * a.z);</span><br><span class="line">    	&#125;;</span><br><span class="line">    	point d1 = <span class="built_in">vecSub</span>(a, b), d2 = <span class="built_in">vecSub</span>(c, d); </span><br><span class="line">    	point n = <span class="built_in">crossProduct</span>(d1, d2);</span><br><span class="line">    	<span class="type">double</span> norm_n = <span class="built_in">norm</span>(n);</span><br><span class="line">    	point AC = <span class="built_in">vecSub</span>(c, a);</span><br><span class="line">    	<span class="type">double</span> distance = <span class="number">0.0</span>;</span><br><span class="line">    	<span class="comment">// å¦‚æœ n != 0ï¼Œè¯´æ˜ä¸¤æ¡ç›´çº¿ä¸å¹³è¡Œ</span></span><br><span class="line">    	<span class="keyword">if</span>(<span class="built_in">fabs</span>(norm_n) &gt; <span class="number">1e-12</span>)&#123;</span><br><span class="line">    		<span class="comment">// æœ€çŸ­è·ç¦»å…¬å¼: |(C - A) Â· (d1 x d2)| / ||d1 x d2||</span></span><br><span class="line">    		distance = <span class="built_in">fabs</span>(<span class="built_in">dotProduct</span>(AC, n)) / norm_n;</span><br><span class="line">    	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    		<span class="comment">// n = 0ï¼Œè¯´æ˜ä¸¤æ¡ç›´çº¿å¹³è¡Œæˆ–å…±çº¿</span></span><br><span class="line">		    <span class="comment">// ä½¿ç”¨å¹³è¡Œç›´çº¿è·ç¦»å…¬å¼: ||(C - A) x d1|| / ||d1||</span></span><br><span class="line">		    point temp1 = <span class="built_in">crossProduct</span>(AC, d1);</span><br><span class="line">		    <span class="type">double</span> norm_temp1 = <span class="built_in">norm</span>(temp1), norm_d1 = <span class="built_in">norm</span>(d1);</span><br><span class="line">		    <span class="keyword">if</span>(<span class="built_in">fabs</span>(norm_d1) &lt; <span class="number">1e-12</span>)&#123;</span><br><span class="line">		    	<span class="comment">// è‹¥ d1Norm=0ï¼Œè¯´æ˜ Aã€B æ˜¯åŒä¸€ç‚¹ï¼›è‹¥ d2Norm=0ï¼ŒCã€D åŒç†ã€‚æ­¤æ—¶éœ€ç‰¹æ®Šå¤„ç†</span></span><br><span class="line">		    	<span class="type">double</span> norm_d2 = <span class="built_in">norm</span>(d2);</span><br><span class="line">		    	<span class="keyword">if</span>(<span class="built_in">fabs</span>(norm_d2) &lt; <span class="number">1e-12</span>)&#123;</span><br><span class="line">		    		<span class="comment">// ä¸¤æ¡â€œç›´çº¿â€éƒ½æ˜¯ç‚¹ï¼Œè®¡ç®— A åˆ° C çš„è·ç¦»</span></span><br><span class="line">		    		distance = <span class="built_in">sqrt</span>(<span class="built_in">pow</span>(a.x - c.x, <span class="number">2</span>) + <span class="built_in">pow</span>(a.y - c.y, <span class="number">2</span>) + <span class="built_in">pow</span>(a.z - c.z, <span class="number">2</span>));</span><br><span class="line">;		    	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		    		<span class="comment">// åªéœ€è®¡ç®—ç‚¹ A åˆ°ç›´çº¿ CD çš„è·ç¦»</span></span><br><span class="line">	                <span class="comment">// è·ç¦» = ||(C - A) x d2|| / ||d2||</span></span><br><span class="line">	                point temp2 = <span class="built_in">crossProduct</span>(AC, d2);</span><br><span class="line">	                distance = <span class="built_in">norm</span>(temp2) / <span class="built_in">norm</span>(d2);</span><br><span class="line">		    	&#125;</span><br><span class="line">		    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		    	distance = <span class="built_in">norm</span>(temp1) / <span class="built_in">norm</span>(d1);</span><br><span class="line">		    &#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">&quot;%.3lf\n&quot;</span>, distance);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç‚¹åˆ°ç›´çº¿çš„è·ç¦»å…¬å¼-amp-å…³ç³»ï¼ˆä¸‰ç‚¹ä¹‹é—´ï¼‰"><a href="#ç‚¹åˆ°ç›´çº¿çš„è·ç¦»å…¬å¼-amp-å…³ç³»ï¼ˆä¸‰ç‚¹ä¹‹é—´ï¼‰" class="headerlink" title="ç‚¹åˆ°ç›´çº¿çš„è·ç¦»å…¬å¼ &amp; å…³ç³»ï¼ˆä¸‰ç‚¹ä¹‹é—´ï¼‰"></a>ç‚¹åˆ°ç›´çº¿çš„è·ç¦»å…¬å¼ &amp; å…³ç³»ï¼ˆä¸‰ç‚¹ä¹‹é—´ï¼‰</h3><p>è®¾$P(x_0,\,y_0)$ä¸ºå¹³é¢ä¸Šä¸€ç‚¹ï¼Œ  ç›´çº¿ L çš„æ–¹ç¨‹ä¸º  </p>
<script type="math/tex; mode=display">
A x + B y + C = 0.</script><p>åˆ™Påˆ°ç›´çº¿Lçš„è·ç¦»dä¸º  </p>
<script type="math/tex; mode=display">
d = \frac{|\,A x_0 + B y_0 + C\,|}{\sqrt{A^2 + B^2}}.</script><p>å¹³é¢ä¸Šä¸‰ä¸ªç‚¹A()x1, y1), B(x2, y2), C(x3, y3), åˆ¤æ–­ç‚¹Cä¸$\overrightarrow{AB}$çš„ä½ç½®å…³ç³»</p>
<p>S(A, B, C) = $\frac{(x1-x3)(y2-y3)-(y1-y3)(x2-x3)}{2}$</p>
<p>è‹¥Så¤§äº0ï¼Œåˆ™Cåœ¨çŸ¢é‡ABçš„å·¦ä¾§</p>
<p>è‹¥Så°äº0ï¼Œåˆ™Cåœ¨çŸ¢é‡ABçš„å³ä¾§</p>
<p>è‹¥Sç­‰äº0ï¼Œåˆ™Cåœ¨ç›´çº¿ABä¸Šã€‚</p>
<h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><p><a href="https://blog.csdn.net/tengfei461807914/article/details/52203202">å­—ç¬¦ä¸² CSDN</a></p>
<p><a href="https://github.com/algorithmzuo/algorithm-journey">å·¦ç¨‹äº‘</a></p>
<p><a href="https://blog.csdn.net/duiwangxiaomi/article/details/104288351">ä¸‰è§’å½¢é¢ç§¯</a></p>
<p><a href="https://blog.csdn.net/qq_40160605/article/details/80150252">lower_bound &amp; upper_bound</a></p>
<p><a href="https://c-cpp.com/cpp">C++ å‚è€ƒæ‰‹å†Œ</a></p>
<p><a href="https://en.wikipedia.org/wiki/ASCII">ASCII WIKI</a></p>
<p><a href="https://blog.csdn.net/weixin_43983431/article/details/107432456">åˆ¤æ–­ç‚¹ä¸ç›´çº¿çš„ä½ç½®å…³ç³»</a></p>
<p><a href="https://zh.wikipedia.org/wiki/%E6%AF%8D%E5%87%BD%E6%95%B0">æ¯å‡½æ•°</a></p>
<p><a href="https://oi-wiki.org/math/poly/fft/">å‚…é‡Œå¶å˜æ¢</a></p>
<p><a href="https://zh.wikipedia.org/wiki/AVL%E6%A0%91">AVLæ ‘</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/101321696">Morriséå†æ–‡æ¡ˆ</a>.</p>
<p><a href="https://blog.csdn.net/qq_40279192/article/details/107292156?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522df834af3111baf8fa93481f376c5de7d%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=df834af3111baf8fa93481f376c5de7d&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-2-107292156-null-null.nonecase&amp;utm_term=DES&amp;spm=1018.2226.3001.4450">CSDN_DES</a></p>
<p><a href="https://blog.csdn.net/qq_40279192/article/details/107420773?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522c9530f4b9b0bee46780fc323086fca0e%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=c9530f4b9b0bee46780fc323086fca0e&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-107420773-null-null.nonecase&amp;utm_term=IDEA&amp;spm=1018.2226.3001.4450">CSDN_IDEA</a></p>
]]></content>
      <categories>
        <category>Learn</category>
      </categories>
      <tags>
        <tag>Algorithm</tag>
        <tag>Data_Structure</tag>
      </tags>
  </entry>
  <entry>
    <title>Kernel</title>
    <url>/Kernel.html</url>
    <content><![CDATA[<h1 id="æ›´æ¢Kernel"><a href="#æ›´æ¢Kernel" class="headerlink" title="æ›´æ¢Kernel"></a>æ›´æ¢Kernel</h1><p>å½“bootç©ºé—´ä¸è¶³æ—¶ï¼Œæˆ‘ä»¬ä¸å¾—ä¸åˆ é™¤å¤šä½™çš„å¤‡ç”¨linuxæ ¸ã€‚</p>
<h2 id="åˆ é™¤å¤šä½™kernel"><a href="#åˆ é™¤å¤šä½™kernel" class="headerlink" title="åˆ é™¤å¤šä½™kernel"></a>åˆ é™¤å¤šä½™kernel</h2><p>ç¡®è®¤å½“å‰å†…æ ¸</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">uname</span> -r</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æˆ‘çš„ç»“æœä¸º</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">6.12.57+deb13-amd64</span><br></pre></td></tr></table></figure>
</blockquote>
<p>åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„å†…æ ¸åŒ…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dpkg --list | grep linux-image</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æˆ‘çš„ç»“æœä¸º</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ii  linux-image-6.12.48+deb13-amd64                     6.12.48-1                            amd64        Linux 6.12 <span class="keyword">for</span> 64-bit PCs (signed)</span><br><span class="line">ii  linux-image-6.12.57+deb13-amd64                     6.12.57-1                            amd64        Linux 6.12 <span class="keyword">for</span> 64-bit PCs (signed)</span><br><span class="line">ii  linux-image-amd64                                   6.12.57-1                            amd64        Linux <span class="keyword">for</span> 64-bit PCs (meta-package)</span><br></pre></td></tr></table></figure>
</blockquote>
<p>è¿™ä¸ªæ—¶å€™æˆ‘å°±è¦åˆ é™¤6.12.48</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt remove linux-image-6.12.48+deb13-amd64 </span><br></pre></td></tr></table></figure>
<p>æ¸…ç†æ®‹ç•™</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt autoremove --purge</span><br></pre></td></tr></table></figure>
<p>æ£€æŸ¥/bootç©ºé—´</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">df</span> -h /boot</span><br></pre></td></tr></table></figure>
<h2 id="æ¢æ ¸"><a href="#æ¢æ ¸" class="headerlink" title="æ¢æ ¸"></a>æ¢æ ¸</h2><p>ç›´æ¥update+upgradeä¸¤ä»¶å¥—</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt upgrade</span><br></pre></td></tr></table></figure>
<p>ä¸‹å¥½äº†æ–°çš„å†…æ ¸åï¼Œè®°å¾—æ›´æ–°gtub</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo update-grub2</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Learn</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Kernel</tag>
      </tags>
  </entry>
  <entry>
    <title>TexLive_VScode</title>
    <url>/TexLive-VScode.html</url>
    <content><![CDATA[<h1 id="Texlive-in-Vscode"><a href="#Texlive-in-Vscode" class="headerlink" title="Texlive in Vscode"></a>Texlive in Vscode</h1><h1 id="Texlive"><a href="#Texlive" class="headerlink" title="Texlive"></a>Texlive</h1><p>ä½¿ç”¨ TeX Live å®˜æ–¹å®‰è£…è„šæœ¬</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">wget https://mirror.ctan.org/systems/texlive/tlnet/install-tl-unx.tar.gz</span><br></pre></td></tr></table></figure>
<p>è§£å‹</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo zcat &lt; install-tl-unx.tar.gz | sudo tar xf -</span><br></pre></td></tr></table></figure>
<blockquote>
<p>lsçš„ç»“æœ<br><strong>install-tl-20251209</strong>  install-tl-unx.tar.gz</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd install-tl-20251209</span><br></pre></td></tr></table></figure>
</blockquote>
<p>è¿›å…¥è§£å‹ç›®å½•åæ‰§è¡Œå®‰è£…è„šæœ¬</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo perl ./install-tl --no-interaction</span><br></pre></td></tr></table></figure>
<p>â€¦.a few moments later</p>
<p>é…ç½®ç¯å¢ƒå˜é‡</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim ~/.zshrc</span><br><span class="line"><span class="comment"># æ ¹æ®è‡ªå·±çš„shellæ¥</span></span><br></pre></td></tr></table></figure>
<p>åŠ å…¥ä»¥ä¸‹å†…å®¹ï¼ˆæ³¨æ„ä¸€ä¸‹å¹´ä»½çš„åŒ¹é…ï¼‰</p>
<blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># LaTeX</span></span><br><span class="line"><span class="built_in">export</span> MANPATH=<span class="variable">$&#123;MANPATH&#125;</span>:/usr/local/texlive/2025/texmf-dist/doc/man</span><br><span class="line"><span class="built_in">export</span> INFOPATH=<span class="variable">$&#123;INFOPATH&#125;</span>:/usr/local/texlive/2025/texmf-dist/doc/info</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$&#123;PATH&#125;</span>:/usr/local/texlive/2025/bin/x86_64-linux</span><br></pre></td></tr></table></figure>
</blockquote>
<p>éªŒè¯å®‰è£…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tex --version</span><br><span class="line">latex --version</span><br></pre></td></tr></table></figure>
<p>å†å®‰è£…Perlæ¨¡å—ï¼ˆåè¾¹æ ¼å¼åŒ–ä»£ç æ—¶éœ€è¦ç”¨åˆ°ï¼‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update &amp;&amp; sudo apt install cpanminus</span><br><span class="line">sudo cpanm YAML::Tiny</span><br><span class="line">sudo cpanm File::HomeDir</span><br><span class="line">sudo cpanm Unicode::GCString</span><br><span class="line">sudo cpanm Log::Log4perl</span><br><span class="line">sudo cpanm Log::Dispatch</span><br></pre></td></tr></table></figure>
<p>å®‰è£…tex-fmt</p>
<p>ç”¨å®˜æ–¹è„šæœ¬è£…rustup</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install -y curl build-essential pkg-config libssl-dev</span><br><span class="line">curl --proto <span class="string">&#x27;=https&#x27;</span> --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y</span><br></pre></td></tr></table></figure>
<p>åœ¨å½“å‰ç»ˆç«¯æŠŠç¯å¢ƒåŠ è½½è¿›æ¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">source</span> <span class="string">&quot;<span class="variable">$HOME</span>/.cargo/env&quot;</span></span><br></pre></td></tr></table></figure>
<p>åˆ‡æ¢åˆ°stableå¹¶æ›´æ–°</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rustup update stable</span><br><span class="line">rustup default stable</span><br></pre></td></tr></table></figure>
<p>é…ç½®cratesé•œåƒ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p <span class="string">&quot;<span class="variable">$HOME</span>/.cargo&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &gt; <span class="string">&quot;<span class="variable">$HOME</span>/.cargo/config.toml&quot;</span> &lt;&lt; <span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">[source.crates-io]</span><br><span class="line">replace-with = <span class="string">&#x27;hustmirror&#x27;</span></span><br><span class="line"></span><br><span class="line">[source.hustmirror]</span><br><span class="line">registry = <span class="string">&quot;sparse+https://mirrors.hust.edu.cn/crates.io-index/&quot;</span></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
<p>å®‰è£…tex-fmt</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cargo install tex-fmt</span><br></pre></td></tr></table></figure>
<p>é…ç½®ç¯å¢ƒ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;export PATH=&quot;$HOME/.cargo/bin:$PATH&quot;&#x27;</span> &gt;&gt; ~/.zshrc</span><br><span class="line"><span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure>
<blockquote>
<p>è¡¥å……ä¸€äº›æ‰©å±•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install texlive-xetex texlive-latex-recommended texlive-latex-extra texlive-fonts-recommended</span><br></pre></td></tr></table></figure>
</blockquote>
<h1 id="VScode"><a href="#VScode" class="headerlink" title="VScode"></a>VScode</h1><p>ä¸‹è½½ä»¥ä¸‹ä¸¤ä¸ªæ’ä»¶</p>
<p><img src="/TexLive-VScode/latex.png" alt="cahjian"></p>
<p>åœ¨settingçš„jsonä¸­åŠ å…¥ä»¥ä¸‹é…ç½®</p>
<p><img src="/TexLive-VScode/latex2.png" alt></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="attr">&quot;files.autoSave&quot;</span><span class="punctuation">:</span> <span class="string">&quot;afterDelay&quot;</span><span class="punctuation">,</span> <span class="comment">// è‡ªåŠ¨ä¿å­˜</span></span><br><span class="line"><span class="attr">&quot;editor.formatOnPaste&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span> <span class="comment">// ç²˜è´´åè‡ªåŠ¨æ ¼å¼åŒ–</span></span><br><span class="line"><span class="attr">&quot;editor.formatOnType&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span> <span class="comment">// é”®å…¥åè‡ªåŠ¨æ ¼å¼åŒ–</span></span><br><span class="line"><span class="attr">&quot;editor.formatOnSave&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span> <span class="comment">// ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–</span></span><br><span class="line"><span class="comment">// LaTeX</span></span><br><span class="line"><span class="attr">&quot;latex-workshop.latex.recipes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;xelatex&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pdflatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;pdflatex&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;latexmk&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;latexmk&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xelatex -&gt; bibtex -&gt; xelatex*2&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;bibtex&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;xelatex&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;latex-workshop.latex.tools&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;latexmk&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;latexmk&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;--shell-escape&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-synctex=1&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-interaction=nonstopmode&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-file-line-error&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-pdf&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;%DOC%&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xelatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;--shell-escape&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-synctex=1&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-interaction=nonstopmode&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-file-line-error&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;%DOC%&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pdflatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pdflatex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;--shell-escape&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-synctex=1&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-interaction=nonstopmode&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;-file-line-error&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;%DOC%&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bibtex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bibtex&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;%DOCFILE%&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;latex-workshop.latex.clean.fileTypes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="string">&quot;*.acn&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.acr&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.alg&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.aux&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.bbl&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.blg&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.fdb_latexmk&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.fls&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.glg&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.glo&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.gls&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.idx&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.ind&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.ist&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.lof&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.log&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.lot&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.nav&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.out&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.pdfsync&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.pre&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.rubbercache&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.snm&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.synctex&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.synctex(busy)&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.synctex.gz&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.synctex.gz(busy)&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.toc&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;*.vrb&quot;</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">// æ¸…ç†ä¸Šè¿°åç¼€åçš„æ–‡ä»¶</span></span><br><span class="line"><span class="attr">&quot;latex-workshop.latex.clean.method&quot;</span><span class="punctuation">:</span> <span class="string">&quot;glob&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">// è¯­æ³•æ£€æŸ¥</span></span><br><span class="line"><span class="attr">&quot;latex.linter.enabled&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">// texæ–‡ä»¶æµè§ˆå™¨ï¼Œå¯é€‰é¡¹ä¸º&quot;none&quot; &quot;browser&quot; &quot;tab&quot; &quot;external&quot;</span></span><br><span class="line"><span class="attr">&quot;latex-workshop.view.pdf.viewer&quot;</span><span class="punctuation">:</span> <span class="string">&quot;tab&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">// è‡ªåŠ¨ç¼–è¯‘texæ–‡ä»¶</span></span><br><span class="line"><span class="attr">&quot;latex-workshop.latex.autoBuild.run&quot;</span><span class="punctuation">:</span> <span class="string">&quot;onSave&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">// æ˜¾ç¤ºå†…å®¹èœå•ï¼šï¼ˆ1ï¼‰ç¼–è¯‘æ–‡ä»¶ï¼›ï¼ˆ2ï¼‰å®šä½æ¸¸æ ‡</span></span><br><span class="line"><span class="attr">&quot;latex-workshop.showContextMenu&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">// æ˜¾ç¤ºé”™è¯¯</span></span><br><span class="line"><span class="attr">&quot;latex-workshop.message.error.show&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">// æ˜¾ç¤ºè­¦å‘Š</span></span><br><span class="line"><span class="attr">&quot;latex-workshop.message.warning.show&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">// ä»ä½¿ç”¨çš„åŒ…ä¸­è‡ªåŠ¨è¡¥å…¨å‘½ä»¤å’Œç¯å¢ƒ</span></span><br><span class="line"><span class="attr">&quot;latex-workshop.intellisense.package.enabled&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">// æ¸…é™¤è¾…åŠ©æ–‡ä»¶</span></span><br><span class="line"><span class="attr">&quot;latex-workshop.latex.autoClean.run&quot;</span><span class="punctuation">:</span> <span class="string">&quot;never&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">// è®¾ç½®vscodeç¼–è¯‘texæ–‡æ¡£æ—¶çš„é»˜è®¤ç¼–è¯‘é“¾</span></span><br><span class="line"><span class="attr">&quot;latex-workshop.latex.recipe.default&quot;</span><span class="punctuation">:</span> <span class="string">&quot;lastUsed&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">// ç”¨äºåå‘åŒæ­¥çš„å†…éƒ¨æŸ¥çœ‹å™¨çš„é”®ç»‘å®šã€‚ctrl/cmd + ç‚¹å‡»ï¼ˆé»˜è®¤ï¼‰æˆ–åŒå‡»</span></span><br><span class="line"><span class="attr">&quot;latex-workshop.view.pdf.internal.synctex.keybinding&quot;</span><span class="punctuation">:</span> <span class="string">&quot;double-click&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>éšä¾¿åœ¨ä¸€ä¸ª.texæ–‡ä»¶ä¸­å³é”®ï¼Œç„¶åç‚¹å‡»<code>ä½¿ç”¨æ ¼å¼åŒ–æ–‡æ¡£</code>ï¼Œç„¶åé€‰æ‹©Latex Workhop</p>
<p>ç¼–è¯‘è®°å¾—ç‚¹å‡»</p>
<p><img src="/TexLive-VScode/latex3.png" alt></p>
<blockquote>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2></blockquote>
<p><a href="https://blog.csdn.net/M0rtzz/article/details/136026129">VScode config</a>.</p>
<p><a href="https://blog.csdn.net/rear_queue/article/details/131126256">Texlive</a>.</p>
]]></content>
      <categories>
        <category>â€” Learn</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Latex</tag>
        <tag>VScode</tag>
      </tags>
  </entry>
  <entry>
    <title>Anoconda</title>
    <url>/Anoconda-setup.html</url>
    <content><![CDATA[<h1 id="Anaconda"><a href="#Anaconda" class="headerlink" title="Anaconda"></a>Anaconda</h1><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>ä¸‹è½½ä¸€ä¸ªåˆé€‚ç‰ˆæœ¬çš„å®‰è£…è„šæœ¬</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">curl -O https://repo.anaconda.com/archive/Anaconda3-2024.06-1-Linux-x86_64.sh</span><br></pre></td></tr></table></figure>
<p>æ‰§è¡Œå®‰è£…è„šæœ¬</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">bash Anaconda3-2024.06-1-Linux-x86_64.sh</span><br></pre></td></tr></table></figure>
<p>æŒ‰ Enter é”®æŸ¥çœ‹è®¸å¯åè®®ï¼ŒæŒ‰qç»“æŸå¿«é€Ÿç»“æŸå†…å®¹ï¼Œæœ€åè¾“å…¥ yesåŒæ„åè®®ï¼Œç„¶åæŒ‰ Enter æ¥å—é»˜è®¤å®‰è£…ä½ç½®<code>/home/&lt;USER&gt;/anaconda3</code> ã€‚</p>
<p>æœ€åä¼šé—®ä½ è¦ä¸è¦æ¯æ¬¡å¯åŠ¨éƒ½é»˜è®¤æ¿€æ´»condaç¯å¢ƒ</p>
<blockquote>
<p>Do you wish to update your shell profile to automatically initialize conda?<br>This will activate conda on startup and change the command prompt when activated.<br>If youâ€™d prefer that condaâ€™s base environment not be activated on startup,<br>   run the following command when conda is activated:</p>
<p>conda config â€”set auto_activate_base false</p>
<p>You can undo this by running <code>conda init --reverse $SHELL</code>? [yes|no]<br>[no] &gt;&gt;&gt;</p>
</blockquote>
<p>æˆ‘çš„é€‰æ‹©æ˜¯é»˜è®¤çš„no(Enter)</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda config --set auto_activate_base false</span><br></pre></td></tr></table></figure>
<p>éšä¹‹è€Œæ¥çš„æ˜¯è‡ªå·±å®Œæˆåˆå§‹åŒ–</p>
<blockquote>
<p>You have chosen to not have conda modify your shell scripts at all.<br>To activate condaâ€™s base environment in your current shell session:</p>
<p><strong>eval â€œ$(/home/<username>/anaconda3/bin/conda shell.YOUR_SHELL_NAME hook)â€</username></strong></p>
<p>To install condaâ€™s shell functions for easier access, first activate, then:</p>
<p><strong>conda init</strong></p>
<p>Thank you for installing Anaconda3!</p>
</blockquote>
<p>ä¾‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">eval &quot;$(/home/user1/anaconda3/bin/conda shell.zsh hook)</span><br></pre></td></tr></table></figure>
<p>æœ€åinit</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda init &lt;zsh&gt;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">zshæ˜¯æˆ‘è‡ªå·±çš„shell,é»˜è®¤çš„æ˜¯bash</span></span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda -V</span><br></pre></td></tr></table></figure>
<blockquote>
<p>conda 24.5.0</p>
</blockquote>
<p>å®Œæˆï¼</p>
<h2 id="æ¢æº"><a href="#æ¢æº" class="headerlink" title="æ¢æº"></a>æ¢æº</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim ~/.condarc</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">channels:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">defaults</span></span><br><span class="line"></span><br><span class="line"><span class="attr">default_channels:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2</span></span><br><span class="line"></span><br><span class="line"><span class="attr">custom_channels:</span></span><br><span class="line">  <span class="attr">conda-forge:</span> <span class="string">https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span></span><br><span class="line">  <span class="attr">msys2:</span> <span class="string">https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span></span><br><span class="line"></span><br><span class="line"><span class="attr">show_channel_urls:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
</blockquote>
<p>ä¿å­˜åé€€å‡ºå¹¶æ‰§è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">conda clean -i</span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>æ£€æŸ¥è™šæ‹Ÿç¯å¢ƒ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda env list</span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æœ‰ç¯å¢ƒåŒ…æ—¶</span></span><br><span class="line">conda env create -f env_name.yml</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ™®é€š</span></span><br><span class="line">conda create -n env_name python=3.6</span><br></pre></td></tr></table></figure>
<p>æ¿€æ´»</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda activate env_name</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å–æ¶ˆæ¿€æ´»å½“å‰ç¯å¢ƒå¯</span></span><br><span class="line">conda deactivate</span><br></pre></td></tr></table></figure>
<p>åˆ é™¤è™šæ‹Ÿç¯å¢ƒ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">conda remove -n env_name --all</span><br></pre></td></tr></table></figure>
<h2 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda install anaconda-clean</span><br><span class="line">anaconda-clean</span><br><span class="line">rm -rf anaconda3</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æœ€ååˆ æ‰ .bashrc ä¸­çš„ conda</span></span><br></pre></td></tr></table></figure>
<blockquote>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2></blockquote>
<p><a href="https://www.cnblogs.com/moonout/p/18334292">åšå®¢å›­</a>.</p>
]]></content>
      <categories>
        <category>Learn</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Anaconda</tag>
      </tags>
  </entry>
  <entry>
    <title>Liveç›˜åˆ¶ä½œ</title>
    <url>/Live%E7%9B%98%E5%88%B6%E4%BD%9C.html</url>
    <content><![CDATA[<h1 id="Liveç›˜åˆ¶ä½œ"><a href="#Liveç›˜åˆ¶ä½œ" class="headerlink" title="Liveç›˜åˆ¶ä½œ"></a>Liveç›˜åˆ¶ä½œ</h1><p>ä¸€ä¸ªå¸¦æœ‰æ“ä½œç³»ç»Ÿçš„Uç›˜å°±å«åšliveç›˜ï¼Œæ­¤ç›˜å¯ç”¨äºä¿®å¤ä¸»æœºï¼Œé‡è£…ç³»ç»Ÿç­‰ã€‚</p>
<p>å…¶åœ¨Linuxç¯å¢ƒä¸‹çš„åˆ¶ä½œä¹Ÿæ˜¯éå¸¸ç®€å•çš„ï¼Œåªç”¨ä¸¤ä¸ªæ­¥éª¤ï¼š</p>
<ul>
<li><p><em>æŒ‘é€‰åˆé€‚çš„ISOé•œåƒ</em></p>
</li>
<li><p><em>å°†å…¶çƒ§å½•è‡³Uç›˜</em></p>
</li>
</ul>
<h2 id="ISOé•œåƒ"><a href="#ISOé•œåƒ" class="headerlink" title="ISOé•œåƒ"></a>ISOé•œåƒ</h2><p>è¿™é‡Œæˆ‘ä¸‹è½½çš„æ˜¯<a href="https://www.debian.org/CD/live/">debian-live-13.2.0-amd64-kde.iso</a>ï¼Œå¯é€‰æ‹©è‡ªå·±å–œæ¬¢çš„ç³»ç»Ÿå’Œç‰ˆæœ¬ã€‚</p>
<p><a href="ä¸‹è½½è¿æ¥">ä¸‹è½½è¿æ¥</a>.</p>
<h2 id="Uç›˜"><a href="#Uç›˜" class="headerlink" title="Uç›˜"></a>Uç›˜</h2><p>å‡†å¤‡ä¸€ä¸ªå†…å­˜å¤§äºISOé•œåƒçš„Uç›˜ï¼Œæ’å…¥ç”µè„‘ã€‚</p>
<blockquote>
<p>âš ï¸ æ“ä½œå‰è¯·åŠ¡å¿…ç¡®è®¤ <strong>U ç›˜è®¾å¤‡å</strong>ï¼Œå¦åˆ™ä¼šæŠŠé”™è¯¯çš„ç£ç›˜è¦†ç›–ï¼</p>
</blockquote>
<h3 id="ç¡®å®šUç›˜è®¾å¤‡å"><a href="#ç¡®å®šUç›˜è®¾å¤‡å" class="headerlink" title="ç¡®å®šUç›˜è®¾å¤‡å"></a>ç¡®å®šUç›˜è®¾å¤‡å</h3><p>æ’å…¥ U ç›˜åæ‰§è¡Œï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lsblk</span><br></pre></td></tr></table></figure>
<p><img src="/Live%E7%9B%98%E5%88%B6%E4%BD%9C/ISO1.png" alt></p>
<p>ä½ ä¼šçœ‹åˆ°ç±»ä¼¼ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS</span><br><span class="line">sda           8:0    1  58.6G  0 disk  # â† è¿™é€šå¸¸æ˜¯ä½ çš„ U ç›˜</span><br><span class="line">â”œâ”€sda1        8:1    1   3.9G  0 part </span><br><span class="line">â””â”€sda2        8:2    1   3.2M  0 part </span><br><span class="line">nvme1n1     259:0    0 238.5G  0 disk </span><br><span class="line">â”œâ”€nvme1n1p1 259:1    0   100M  0 part </span><br><span class="line">â”œâ”€nvme1n1p2 259:2    0    16M  0 part </span><br><span class="line">â”œâ”€nvme1n1p3 259:3    0     3G  0 part </span><br><span class="line">â”œâ”€nvme1n1p4 259:4    0   608M  0 part </span><br><span class="line">â”œâ”€nvme1n1p5 259:5    0   488M  0 part /boot</span><br><span class="line">â””â”€nvme1n1p6 259:6    0 149.5G  0 part /</span><br><span class="line">nvme0n1     259:7    0 476.9G  0 disk </span><br><span class="line">â”œâ”€nvme0n1p1 259:8    0   260M  0 part /boot/efi</span><br><span class="line">â”œâ”€nvme0n1p2 259:9    0    16M  0 part </span><br><span class="line">â”œâ”€nvme0n1p3 259:10   0   200G  0 part </span><br><span class="line">â”œâ”€nvme0n1p4 259:11   0 274.7G  0 part </span><br><span class="line">â””â”€nvme0n1p5 259:12   0     2G  0 part</span><br></pre></td></tr></table></figure>
<h3 id="å¸è½½-U-ç›˜åˆ†åŒº"><a href="#å¸è½½-U-ç›˜åˆ†åŒº" class="headerlink" title="å¸è½½ U ç›˜åˆ†åŒº"></a>å¸è½½ U ç›˜åˆ†åŒº</h3><p>å¦‚æœç³»ç»Ÿè‡ªåŠ¨æŒ‚è½½äº† U ç›˜ï¼Œå…ˆå¸è½½ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo umount /dev/sda*</span><br></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨-dd-çƒ§å½•"><a href="#ä½¿ç”¨-dd-çƒ§å½•" class="headerlink" title="ä½¿ç”¨ dd çƒ§å½•"></a>ä½¿ç”¨ dd çƒ§å½•</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo dd if=ä½ çš„é•œåƒ.iso of=/dev/sda bs=4M status=progress oflag=sync</span><br></pre></td></tr></table></figure>
<p>å‚æ•°:</p>
<ul>
<li><code>if=</code> è¾“å…¥æ–‡ä»¶ï¼ˆä½ çš„ ISOï¼‰</li>
<li><code>of=</code> è¾“å‡ºè®¾å¤‡ï¼ˆæ•´ä¸ªç£ç›˜ï¼Œä¸è¦å†™æˆ sdb1ï¼‰</li>
<li><code>bs=4M</code> åŠ å¿«å†™å…¥é€Ÿåº¦</li>
<li><code>status=progress</code> æ˜¾ç¤ºè¿›åº¦</li>
<li><code>oflag=sync</code> ç¡®ä¿æ•°æ®å®æ—¶å†™å…¥</li>
</ul>
<p>çƒ§å½•å®Œæˆåå³å¯ä½¿ç”¨ã€‚</p>
<h1 id="Liveç›˜æ¢å¤ä¸ºå­˜å‚¨Uç›˜"><a href="#Liveç›˜æ¢å¤ä¸ºå­˜å‚¨Uç›˜" class="headerlink" title="Liveç›˜æ¢å¤ä¸ºå­˜å‚¨Uç›˜"></a>Liveç›˜æ¢å¤ä¸ºå­˜å‚¨Uç›˜</h1><p>å‡è®¾ä½ çš„ U ç›˜æ˜¯ <code>/dev/sda</code>ï¼Œè¯·ç”¨ <code>lsblk</code> ç¡®è®¤ï¼</p>
<blockquote>
<p> åœ¨å–æ¶ˆæŒ‚è½½æƒ…æ™¯ä¸‹è¿›è¡Œæ“ä½œã€‚</p>
</blockquote>
<h2 id="æ¸…ç©ºåˆ†åŒºè¡¨ï¼ˆæ¢å¤ä¸ºå…¨æ–°è£¸ç›˜ï¼‰"><a href="#æ¸…ç©ºåˆ†åŒºè¡¨ï¼ˆæ¢å¤ä¸ºå…¨æ–°è£¸ç›˜ï¼‰" class="headerlink" title="æ¸…ç©ºåˆ†åŒºè¡¨ï¼ˆæ¢å¤ä¸ºå…¨æ–°è£¸ç›˜ï¼‰"></a>æ¸…ç©ºåˆ†åŒºè¡¨ï¼ˆæ¢å¤ä¸ºå…¨æ–°è£¸ç›˜ï¼‰</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo wipefs -a /dev/sda</span><br><span class="line">sudo dd if=/dev/zero of=/dev/sda bs=1M count=10</span><br></pre></td></tr></table></figure>
<h2 id="ç”¨-fdisk-é‡å»ºåˆ†åŒº"><a href="#ç”¨-fdisk-é‡å»ºåˆ†åŒº" class="headerlink" title="ç”¨ fdisk é‡å»ºåˆ†åŒº"></a>ç”¨ fdisk é‡å»ºåˆ†åŒº</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo fdisk /dev/sda</span><br></pre></td></tr></table></figure>
<p>è¿›å…¥åæŒ‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">g     åˆ›å»ºå…¨æ–°çš„ GPT åˆ†åŒºè¡¨</span><br><span class="line">n     åˆ›å»ºåˆ†åŒº</span><br><span class="line">å›è½¦  é»˜è®¤åˆ†åŒºå·</span><br><span class="line">å›è½¦  é»˜è®¤èµ·å§‹</span><br><span class="line">å›è½¦  é»˜è®¤ç»“æŸ</span><br><span class="line">w     ä¿å­˜å¹¶é€€å‡º</span><br></pre></td></tr></table></figure>
<h2 id="æ ¼å¼åŒ–ä¸º-FAT32"><a href="#æ ¼å¼åŒ–ä¸º-FAT32" class="headerlink" title="æ ¼å¼åŒ–ä¸º FAT32"></a>æ ¼å¼åŒ–ä¸º FAT32</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo mkfs.vfat -F 32 /dev/sda1</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Learn</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Liveç›˜</tag>
      </tags>
  </entry>
  <entry>
    <title>DESå’ŒIDEAçš„CPPå®ç°</title>
    <url>/DES%E5%92%8CIDEA%E7%9A%84CPP%E5%AE%9E%E7%8E%B0.html</url>
    <content><![CDATA[<!--more-->
<p>åœ¨stdç‰ˆæœ¬ä¸­ï¼Œå½“è¾“å…¥çš„æ–‡æœ¬ä»¥<code>@</code>å¼€å¤´ä¸”åé¢è·Ÿçš„æ˜¯ç»å¯¹åœ°å€æ—¶ï¼Œå¯ä»¥è¯»å–æ–‡æ¡£ã€‚</p>
<h2 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h2><p>æ•°æ®åŠ å¯†æ ‡å‡†ï¼ˆData Encryption Standardï¼ŒDESï¼‰èƒ½å¤Ÿä¾èµ–64ä½å¯†é’¥åŠ å¯†64ä½æ˜æ–‡ï¼Œå°†64ä½å¯†æ–‡åå‘ä½¿ç”¨64ä½å¯†é’¥ç”Ÿæˆçš„å­å¯†é’¥å¯ä»¥æŒ‰ç…§å®Œå…¨ç›¸åŒçš„æ­¥éª¤æŠŠå¯†æ–‡è§£å¯†ä¸ºæ˜æ–‡ï¼ŒåŠ å¯†æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>è¾“å…¥å‡†å¤‡</li>
</ol>
<ul>
<li>æ˜æ–‡ï¼š64 ä½åˆ†ç»„ï¼ˆè‹¥ä¸è¶³64ä½åˆ™è¿›è¡Œå¡«å……ï¼‰ã€‚ (<a href="https://www.cnblogs.com/idreamo/p/9333753.html?utm_source=chatgpt.com">cnblogs.com</a>)</li>
<li>å¯†é’¥ï¼š64 ä½ï¼ˆå…¶ä¸­æœ‰æ•ˆ56 ä½ï¼Œ8 ä½ç”¨äºå¥‡å¶æ ¡éªŒï¼‰ç”¨äºç”Ÿæˆå­å¯†é’¥ã€‚ (<a href="https://zh.wikipedia.org/wiki/è³‡æ–™åŠ å¯†æ¨™æº–?utm_source=chatgpt.com">ç»´åŸºç™¾ç§‘</a>)</li>
</ul>
<ol>
<li>åˆå§‹ç½®æ¢ï¼ˆInitial Permutationï¼ŒIPï¼‰</li>
</ol>
<ul>
<li>å°†64 ä½æ˜æ–‡æŒ‰ç…§å›ºå®šè¡¨è¿›è¡Œé‡æ’ï¼Œå¾—åˆ°ä¸€ä¸ªç½®æ¢åçš„64 ä½æ•°æ®ã€‚ (<a href="https://blog.csdn.net/Demonslzh/article/details/129129493?utm_source=chatgpt.com">CSDNåšå®¢</a>)</li>
<li>å°†ç½®æ¢ç»“æœåˆ†æˆå·¦å³ä¸¤ä¸ª32 ä½éƒ¨åˆ†ï¼šLâ‚€ å’Œ Râ‚€ã€‚ (<a href="https://houbb.github.io/2020/06/17/althgorim-cryptograph-05-des?utm_source=chatgpt.com">Echo Blog</a>)</li>
</ul>
<ol>
<li>å­å¯†é’¥ç”Ÿæˆï¼ˆå¯†é’¥è°ƒåº¦ï¼‰</li>
</ol>
<ul>
<li>å¯¹ä¸»å¯†é’¥æ‰§è¡Œã€Œé€‰æ‹©ç½®æ¢ PC-1ã€ä»64 ä½ä¸­é€‰å‡º56 ä½ã€‚ (<a href="https://www.ruanx.net/des/?utm_source=chatgpt.com">Pion1eer</a>)</li>
<li>å°†56 ä½åˆ†ä¸ºä¸¤ä¸ª28 ä½åŠå¯†é’¥ï¼Œåˆ†åˆ«å·¦æ—‹ç§»ä½ï¼ˆæ¯è½®ç§»ä½é‡ç”±è½®æ¬¡å†³å®šï¼‰ã€‚ (<a href="https://zh.wikipedia.org/wiki/è³‡æ–™åŠ å¯†æ¨™æº–?utm_source=chatgpt.com">ç»´åŸºç™¾ç§‘</a>)</li>
<li>å†é€šè¿‡ã€Œé€‰æ‹©ç½®æ¢ PC-2ã€ä»ç§»ä½åçš„56 ä½ä¸­é€‰å‡º48 ä½ï¼Œä½œä¸ºç¬¬1è½®å­å¯†é’¥ Kâ‚ã€‚é‡å¤å…±ç”Ÿæˆ16 ä¸ªå­å¯†é’¥ Kâ‚â€¦Kâ‚â‚†ã€‚ (<a href="https://www.ruanx.net/des/?utm_source=chatgpt.com">Pion1eer</a>)</li>
</ul>
<ol>
<li>16 è½® Feistel ç»“æ„è¿­ä»£</li>
</ol>
<p>å¯¹äº i = 1 åˆ° 16 è½®ï¼Œè¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<ul>
<li>$L<em>{i}$= $R</em>{i - 1}$</li>
<li>$R<em>{i}$ = $L</em>{i - 1} \bigoplus f(R<em>{i - 1}, K</em>{i}) $ (<a href="https://houbb.github.io/2020/06/17/althgorim-cryptograph-05-des?utm_source=chatgpt.com">Echo Blog1</a>)<br>   å…¶ä¸­ f å‡½æ•°åŒ…å«ï¼š<ol>
<li>æ‰©å±•ç½®æ¢ Eï¼šå°†32 ä½ $R_{i - 1}$ æ‰©å±•è‡³48 ä½ã€‚ (<a href="https://www.cnblogs.com/idreamo/p/9333753.html?utm_source=chatgpt.com">cnblogs.com</a>)</li>
<li>ä¸å­å¯†é’¥ Káµ¢ åš XORã€‚ (<a href="https://zhuanlan.zhihu.com/p/650839499?utm_source=chatgpt.com">çŸ¥ä¹ä¸“æ </a>)</li>
<li>åˆ†ä¸º8å—ï¼Œæ¯å—6 ä½ï¼Œè¾“å…¥å„è‡ª Sâ€ç›’ï¼Œè¾“å‡º4 ä½ã€‚æ€»è¾“å‡º32 ä½ã€‚ (<a href="https://www.ruanx.net/des/?utm_source=chatgpt.com">Pion1eer</a>)</li>
<li>æœ€åé€šè¿‡å›ºå®š P ç½®æ¢å°†32 ä½å†é‡æ’ã€‚ (<a href="https://houbb.github.io/2020/06/17/althgorim-cryptograph-05-des?utm_source=chatgpt.com">Echo Blog</a>)</li>
</ol>
</li>
</ul>
<ol>
<li>è½®ç»“æŸåçš„äº¤æ¢ä¸æœ«ç½®æ¢</li>
</ol>
<ul>
<li>å®Œæˆç¬¬16è½®åï¼Œå°† Lâ‚â‚† å’Œ Râ‚â‚† äº¤æ¢ï¼Œå¾—åˆ°æ–° Lâ‚â‚‡ = Râ‚â‚†ï¼Œ Râ‚â‚‡ = Lâ‚â‚†ã€‚ (<a href="https://houbb.github.io/2020/06/17/althgorim-cryptograph-05-des?utm_source=chatgpt.com">Echo Blog</a>)</li>
<li>å°† Lâ‚â‚‡ âˆ¥ Râ‚â‚‡ ï¼ˆåˆå¹¶æˆ64 ä½ï¼‰è¾“å…¥ã€Œæœ€ç»ˆç½®æ¢ FP ï¼ˆIPâ»Â¹ï¼‰ã€è¿›è¡Œé‡æ’ï¼Œè¾“å‡ºå¯†æ–‡ã€‚ (<a href="https://www.cnblogs.com/luogi/p/15508933.html?utm_source=chatgpt.com">cnblogs.com</a>)</li>
</ul>
<ol>
<li>è§£å¯†æµç¨‹</li>
</ol>
<ul>
<li>è§£å¯†æ—¶æµç¨‹ä¸åŠ å¯†ç›¸åŒï¼Œä½†å­å¯†é’¥çš„ä½¿ç”¨é¡ºåºä¸º Kâ‚â‚† â†’ Kâ‚â‚… â†’ â€¦ â†’ Kâ‚ï¼›å…¶ä½™æ­¥éª¤ä¸€è‡´ã€‚ (<a href="https://www.cnblogs.com/idreamo/p/9333753.html?utm_source=chatgpt.com">cnblogs.com</a>)</li>
</ul>
<h3 id="base"><a href="#base" class="headerlink" title="base"></a>base</h3><p>åªæ¥å—16è¿›åˆ¶çš„16ä½å¯†é’¥è¾“å‡ºå’Œ16è¿›åˆ¶çš„16ä½æ˜æ–‡è¾“å…¥</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function">vector&lt;string&gt; <span class="title">Key0</span><span class="params">(<span class="number">16</span>)</span></span>;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; LS = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>&#125;,</span><br><span class="line">			EX_K1 = &#123;<span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>,</span><br><span class="line">			   <span class="number">1</span>, <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>,</span><br><span class="line">			  <span class="number">10</span>,  <span class="number">2</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>,</span><br><span class="line">			  <span class="number">19</span>, <span class="number">11</span>,  <span class="number">3</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>,</span><br><span class="line">			  <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>,</span><br><span class="line">			   <span class="number">7</span>, <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>,</span><br><span class="line">			  <span class="number">14</span>,  <span class="number">6</span>, <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>,</span><br><span class="line">			  <span class="number">21</span>, <span class="number">13</span>,  <span class="number">5</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>&#125;,</span><br><span class="line">		    EX_K2 = &#123;<span class="number">14</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">24</span>, <span class="number">1</span>, <span class="number">5</span>,</span><br><span class="line">			   <span class="number">3</span>, <span class="number">28</span>, <span class="number">15</span>,  <span class="number">6</span>, <span class="number">21</span>, <span class="number">10</span>,</span><br><span class="line">			  <span class="number">23</span>, <span class="number">19</span>, <span class="number">12</span>,  <span class="number">4</span>, <span class="number">26</span>,  <span class="number">8</span>,</span><br><span class="line">			  <span class="number">16</span>,  <span class="number">7</span>, <span class="number">27</span>, <span class="number">20</span>, <span class="number">13</span>,  <span class="number">2</span>,</span><br><span class="line">			  <span class="number">41</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">47</span>, <span class="number">55</span>,</span><br><span class="line">			  <span class="number">30</span>, <span class="number">40</span>, <span class="number">51</span>, <span class="number">45</span>, <span class="number">33</span>, <span class="number">48</span>,</span><br><span class="line">			  <span class="number">44</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">56</span>, <span class="number">34</span>, <span class="number">53</span>,</span><br><span class="line">			  <span class="number">46</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">36</span>, <span class="number">29</span>, <span class="number">32</span>&#125;,</span><br><span class="line">			IP = &#123; <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>,</span><br><span class="line">			 <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>,</span><br><span class="line">			 <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">6</span>,</span><br><span class="line">			 <span class="number">64</span>, <span class="number">56</span>, <span class="number">48</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">8</span>,</span><br><span class="line">			 <span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>,  <span class="number">1</span>,</span><br><span class="line">			 <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>,</span><br><span class="line">			 <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>,</span><br><span class="line">			 <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span> &#125;,</span><br><span class="line">			IPR = &#123;<span class="number">40</span>, <span class="number">8</span>, <span class="number">48</span>, <span class="number">16</span>, <span class="number">56</span>, <span class="number">24</span>, <span class="number">64</span>, <span class="number">32</span>,</span><br><span class="line">			  <span class="number">39</span>, <span class="number">7</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">55</span>, <span class="number">23</span>, <span class="number">63</span>, <span class="number">31</span>,</span><br><span class="line">			  <span class="number">38</span>, <span class="number">6</span>, <span class="number">46</span>, <span class="number">14</span>, <span class="number">54</span>, <span class="number">22</span>, <span class="number">62</span>, <span class="number">30</span>,</span><br><span class="line">			  <span class="number">37</span>, <span class="number">5</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">53</span>, <span class="number">21</span>, <span class="number">61</span>, <span class="number">29</span>,</span><br><span class="line">			  <span class="number">36</span>, <span class="number">4</span>, <span class="number">44</span>, <span class="number">12</span>, <span class="number">52</span>, <span class="number">20</span>, <span class="number">60</span>, <span class="number">28</span>,</span><br><span class="line">			  <span class="number">35</span>, <span class="number">3</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">51</span>, <span class="number">19</span>, <span class="number">59</span>, <span class="number">27</span>,</span><br><span class="line">			  <span class="number">34</span>, <span class="number">2</span>, <span class="number">42</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">18</span>, <span class="number">58</span>, <span class="number">26</span>,</span><br><span class="line">			  <span class="number">33</span>, <span class="number">1</span>, <span class="number">41</span>,  <span class="number">9</span>, <span class="number">49</span>, <span class="number">17</span>, <span class="number">57</span>, <span class="number">25</span>&#125;,</span><br><span class="line">			E = &#123;<span class="number">32</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>,</span><br><span class="line">				<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>,</span><br><span class="line">				<span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>,</span><br><span class="line">			    <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>,</span><br><span class="line">			    <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>,</span><br><span class="line">			    <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>,</span><br><span class="line">			    <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>,</span><br><span class="line">			    <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">1</span>&#125;,</span><br><span class="line">		    P = &#123;<span class="number">16</span>, <span class="number">7</span>, <span class="number">20</span>, <span class="number">21</span>,</span><br><span class="line">			    <span class="number">29</span>, <span class="number">12</span>, <span class="number">28</span>, <span class="number">17</span>,</span><br><span class="line">				<span class="number">1</span>, <span class="number">15</span>, <span class="number">23</span>, <span class="number">26</span>,</span><br><span class="line">				<span class="number">5</span>, <span class="number">18</span>, <span class="number">31</span>, <span class="number">10</span>,</span><br><span class="line">				<span class="number">2</span>, <span class="number">8</span>, <span class="number">24</span>, <span class="number">14</span>,</span><br><span class="line">			    <span class="number">32</span>, <span class="number">27</span>, <span class="number">3</span>, <span class="number">9</span>,</span><br><span class="line">			    <span class="number">19</span>, <span class="number">13</span>, <span class="number">30</span>, <span class="number">6</span>,</span><br><span class="line">			    <span class="number">22</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">25</span>&#125;;</span><br><span class="line"><span class="type">int</span> SBOX[<span class="number">8</span>][<span class="number">4</span>][<span class="number">16</span>] = &#123;</span><br><span class="line">	&#123;&#123;<span class="number">14</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">7</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">0</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">8</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">4</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">0</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">15</span>,<span class="number">12</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">13</span>&#125;&#125;,</span><br><span class="line">	&#123;&#123;<span class="number">15</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">10</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">3</span>,<span class="number">13</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">15</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">11</span>,<span class="number">5</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">0</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">15</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">9</span>&#125;&#125;,</span><br><span class="line">	&#123;&#123;<span class="number">10</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">8</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">13</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">1</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">13</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">7</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">1</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">12</span>&#125;&#125;,</span><br><span class="line">	&#123;&#123;<span class="number">7</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">15</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">13</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">9</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">3</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">14</span>&#125;&#125;,</span><br><span class="line">	&#123;&#123;<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">14</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">6</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">14</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">11</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">3</span>&#125;&#125;,</span><br><span class="line">	&#123;&#123;<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">10</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">8</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">9</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">11</span>,<span class="number">6</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">14</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>&#125;&#125;,</span><br><span class="line">	&#123;&#123;<span class="number">4</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">1</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">13</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">12</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">8</span>,<span class="number">6</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">1</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">2</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">6</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">12</span>&#125;&#125;,</span><br><span class="line">	&#123;&#123;<span class="number">13</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">7</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">1</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">2</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">8</span>&#125;,</span><br><span class="line">	 &#123;<span class="number">2</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>&#125;&#125;</span><br><span class="line">&#125;;		 </span><br><span class="line"><span class="function">string <span class="title">EX</span><span class="params">(string s, vector&lt;<span class="type">int</span>&gt; &amp; ex)</span> </span>&#123;</span><br><span class="line">	string s2;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> &amp; x : ex) s2 += s[x - <span class="number">1</span>];</span><br><span class="line">	<span class="keyword">return</span> s2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">string <span class="title">movel</span><span class="params">(string s, <span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> s.<span class="built_in">substr</span>(LS[i]) + s.<span class="built_in">substr</span>(<span class="number">0</span>, LS[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">make_key</span><span class="params">(string key)</span> </span>&#123;</span><br><span class="line">	string key2 = <span class="built_in">EX</span>(key, EX_K1);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i ++) &#123;</span><br><span class="line">		string l = key2.<span class="built_in">substr</span>(<span class="number">0</span>, <span class="number">28</span>), r = key2.<span class="built_in">substr</span>(<span class="number">28</span>);</span><br><span class="line">		l = <span class="built_in">movel</span>(l, i);</span><br><span class="line">		r = <span class="built_in">movel</span>(r, i);</span><br><span class="line">		key2 = l + r;</span><br><span class="line">		Key0[i] = <span class="built_in">EX</span>(key2, EX_K2);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">string <span class="title">XOR</span><span class="params">(string s1, string s2)</span> </span>&#123;</span><br><span class="line">	string s;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; (<span class="type">int</span>)s1.<span class="built_in">size</span>(); i ++) s += <span class="string">&#x27;0&#x27;</span> + (s1[i] != s2[i]);</span><br><span class="line">	<span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">string <span class="title">S</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">	string s2;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">48</span>; i += <span class="number">6</span>) &#123;</span><br><span class="line">		<span class="type">int</span> x = ((s[i] - <span class="string">&#x27;0&#x27;</span>) &lt;&lt; <span class="number">1</span>) + (s[i + <span class="number">5</span>] - <span class="string">&#x27;0&#x27;</span>), y = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = i + <span class="number">4</span>, base = <span class="number">1</span>; j &gt; i; j --, base *= <span class="number">2</span>) y += (s[j] - <span class="string">&#x27;0&#x27;</span>) * base;</span><br><span class="line">		<span class="type">int</span> z = SBOX[i / <span class="number">6</span>][x][y];</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">3</span>; j &gt;= <span class="number">0</span>; j --) s2 += <span class="string">&#x27;0&#x27;</span> + ((z &gt;&gt; j) &amp; <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> s2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">string <span class="title">F</span><span class="params">(string s, string key)</span> </span>&#123;</span><br><span class="line">	s = <span class="built_in">EX</span>(s, E);</span><br><span class="line">	s = <span class="built_in">XOR</span>(s, key);</span><br><span class="line">	s = <span class="built_in">S</span>(s);</span><br><span class="line">	s = <span class="built_in">EX</span>(s, P);</span><br><span class="line">	<span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">string <span class="title">DES</span><span class="params">(string con, <span class="type">bool</span> f)</span> </span>&#123;</span><br><span class="line">	con = <span class="built_in">EX</span>(con, IP);</span><br><span class="line">	string l0 = con.<span class="built_in">substr</span>(<span class="number">0</span>, <span class="number">32</span>), r0 = con.<span class="built_in">substr</span>(<span class="number">32</span>), mid;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i ++) &#123;</span><br><span class="line">		mid = r0;</span><br><span class="line">		<span class="keyword">if</span>(f) r0 = <span class="built_in">XOR</span>(l0, <span class="built_in">F</span>(r0, Key0[i]));</span><br><span class="line">		<span class="keyword">else</span> r0 = <span class="built_in">XOR</span>(l0, <span class="built_in">F</span>(r0, Key0[<span class="number">15</span> - i]));</span><br><span class="line">		l0 = mid;</span><br><span class="line">	&#125;</span><br><span class="line">	con = <span class="built_in">EX</span>(r0 + l0, IPR);</span><br><span class="line">	<span class="keyword">return</span> con;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">string <span class="title">H2B</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">	string s2 = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	vector&lt;string&gt; base = &#123;<span class="string">&quot;0000&quot;</span>,<span class="string">&quot;0001&quot;</span>,<span class="string">&quot;0010&quot;</span>,<span class="string">&quot;0011&quot;</span>,<span class="string">&quot;0100&quot;</span>,<span class="string">&quot;0101&quot;</span>,<span class="string">&quot;0110&quot;</span>,<span class="string">&quot;0111&quot;</span>,<span class="string">&quot;1000&quot;</span>,<span class="string">&quot;1001&quot;</span>,<span class="string">&quot;1010&quot;</span>,<span class="string">&quot;1011&quot;</span>,<span class="string">&quot;1100&quot;</span>,<span class="string">&quot;1101&quot;</span>,<span class="string">&quot;1110&quot;</span>,<span class="string">&quot;1111&quot;</span> &#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; (<span class="type">int</span>)s.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (s[i] &gt;= <span class="string">&#x27;A&#x27;</span> &amp;&amp; s[i] &lt;= <span class="string">&#x27;F&#x27;</span>) s2 += base[s[i] - <span class="string">&#x27;A&#x27;</span> + <span class="number">10</span>];</span><br><span class="line">		<span class="keyword">else</span> s2 += base[s[i] - <span class="string">&#x27;0&#x27;</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> s2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">string <span class="title">B2H</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">	string s2 = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="type">int</span> temp = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (s.<span class="built_in">size</span>() % <span class="number">4</span> != <span class="number">0</span>) s = <span class="string">&quot;0&quot;</span> + s;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; (<span class="type">int</span>)s.<span class="built_in">size</span>(); i += <span class="number">4</span>) &#123;</span><br><span class="line">		temp = (s[i] - <span class="string">&#x27;0&#x27;</span>) * <span class="number">8</span> + (s[i + <span class="number">1</span>] - <span class="string">&#x27;0&#x27;</span>) * <span class="number">4</span> + (s[i + <span class="number">2</span>] - <span class="string">&#x27;0&#x27;</span>) * <span class="number">2</span> + (s[i + <span class="number">3</span>] - <span class="string">&#x27;0&#x27;</span>) * <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (temp &lt; <span class="number">10</span>) s2 += <span class="string">&#x27;0&#x27;</span> + temp;</span><br><span class="line">		<span class="keyword">else</span> s2 += <span class="string">&#x27;A&#x27;</span> + (temp - <span class="number">10</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> s2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">	string key, con;</span><br><span class="line">	cin &gt;&gt; key &gt;&gt; con;</span><br><span class="line">	string key1 = <span class="built_in">H2B</span>(key), con1 = <span class="built_in">H2B</span>(con);</span><br><span class="line">	<span class="built_in">make_key</span>(key1);</span><br><span class="line">	string mi = <span class="built_in">DES</span>(con1, <span class="number">1</span>);</span><br><span class="line">	string con2 = <span class="built_in">DES</span>(mi, <span class="number">0</span>);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;key: &quot;</span> &lt;&lt; key &lt;&lt; <span class="string">&quot;\n&quot;</span> &lt;&lt; <span class="string">&quot;content: &quot;</span> &lt;&lt; con &lt;&lt; <span class="string">&quot;\n&quot;</span> &lt;&lt; <span class="string">&quot;content_key: &quot;</span> &lt;&lt; <span class="built_in">B2H</span>(mi) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;content: &quot;</span> &lt;&lt; <span class="built_in">B2H</span>(con2) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="std"><a href="#std" class="headerlink" title="std"></a>std</h3><p>ç¤ºä¾‹è¾“å…¥ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">enc</span></span><br><span class="line"><span class="comment">jielycat</span></span><br><span class="line"><span class="comment">Hello! DES!</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p>ç¨‹åºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> u64 = <span class="type">uint64_t</span>;</span><br><span class="line"><span class="keyword">using</span> u32 = <span class="type">uint32_t</span>;</span><br><span class="line"><span class="keyword">using</span> u8  = <span class="type">uint8_t</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---- å¸¸é‡ä¸ç½®æ¢è¡¨ ----</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">int</span> LS[<span class="number">16</span>] = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>&#125;; <span class="comment">// æ¯è½®å·¦ç§»ä½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯†é’¥ç½®æ¢ PC-1ï¼ˆ64-&gt;56ï¼Œå»å¥‡å¶æ ¡éªŒä½ï¼‰</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">int</span> PC1[<span class="number">56</span>] = &#123;</span><br><span class="line">    <span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>,</span><br><span class="line">    <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>,</span><br><span class="line">    <span class="number">14</span>, <span class="number">6</span>, <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>&#125;;</span><br><span class="line"><span class="comment">// å‹ç¼©ç½®æ¢ PC-2ï¼ˆ56-&gt;48ï¼‰</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">int</span> PC2[<span class="number">48</span>] = &#123;</span><br><span class="line">    <span class="number">14</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">24</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">28</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">21</span>, <span class="number">10</span>, <span class="number">23</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">26</span>, <span class="number">8</span>,</span><br><span class="line">    <span class="number">16</span>, <span class="number">7</span>, <span class="number">27</span>, <span class="number">20</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">41</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">47</span>, <span class="number">55</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">51</span>, <span class="number">45</span>, <span class="number">33</span>, <span class="number">48</span>, <span class="number">44</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">56</span>, <span class="number">34</span>, <span class="number">53</span>, <span class="number">46</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">36</span>, <span class="number">29</span>, <span class="number">32</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹/é€†åˆå§‹ç½®æ¢</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">int</span> IP[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">6</span>,</span><br><span class="line">    <span class="number">64</span>, <span class="number">56</span>, <span class="number">48</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">8</span>, <span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>,</span><br><span class="line">    <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span>&#125;;</span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">int</span> FP[<span class="number">64</span>] = &#123;</span><br><span class="line">    <span class="number">40</span>, <span class="number">8</span>, <span class="number">48</span>, <span class="number">16</span>, <span class="number">56</span>, <span class="number">24</span>, <span class="number">64</span>, <span class="number">32</span>, <span class="number">39</span>, <span class="number">7</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">55</span>, <span class="number">23</span>, <span class="number">63</span>, <span class="number">31</span>, <span class="number">38</span>, <span class="number">6</span>, <span class="number">46</span>, <span class="number">14</span>, <span class="number">54</span>, <span class="number">22</span>, <span class="number">62</span>, <span class="number">30</span>,</span><br><span class="line">    <span class="number">37</span>, <span class="number">5</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">53</span>, <span class="number">21</span>, <span class="number">61</span>, <span class="number">29</span>, <span class="number">36</span>, <span class="number">4</span>, <span class="number">44</span>, <span class="number">12</span>, <span class="number">52</span>, <span class="number">20</span>, <span class="number">60</span>, <span class="number">28</span>, <span class="number">35</span>, <span class="number">3</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">51</span>, <span class="number">19</span>, <span class="number">59</span>, <span class="number">27</span>,</span><br><span class="line">    <span class="number">34</span>, <span class="number">2</span>, <span class="number">42</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">18</span>, <span class="number">58</span>, <span class="number">26</span>, <span class="number">33</span>, <span class="number">1</span>, <span class="number">41</span>, <span class="number">9</span>, <span class="number">49</span>, <span class="number">17</span>, <span class="number">57</span>, <span class="number">25</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// E æ‰©å±•ï¼ˆ32-&gt;48ï¼‰</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">int</span> E_tab[<span class="number">48</span>] = &#123;</span><br><span class="line">    <span class="number">32</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>,</span><br><span class="line">    <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>,</span><br><span class="line">    <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// P ç½®æ¢ï¼ˆF å‡½æ•°è¾“å‡ºç½®æ¢ï¼‰</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">int</span> P_tab[<span class="number">32</span>] = &#123;</span><br><span class="line">    <span class="number">16</span>, <span class="number">7</span>, <span class="number">20</span>, <span class="number">21</span>, <span class="number">29</span>, <span class="number">12</span>, <span class="number">28</span>, <span class="number">17</span>, <span class="number">1</span>, <span class="number">15</span>, <span class="number">23</span>, <span class="number">26</span>, <span class="number">5</span>, <span class="number">18</span>, <span class="number">31</span>, <span class="number">10</span>,</span><br><span class="line">    <span class="number">2</span>, <span class="number">8</span>, <span class="number">24</span>, <span class="number">14</span>, <span class="number">32</span>, <span class="number">27</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">19</span>, <span class="number">13</span>, <span class="number">30</span>, <span class="number">6</span>, <span class="number">22</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">25</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 8 ä¸ª S ç›’</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="type">int</span> SBOX[<span class="number">8</span>][<span class="number">4</span>][<span class="number">16</span>] = &#123;</span><br><span class="line">    &#123;&#123;<span class="number">14</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">7</span>&#125;,</span><br><span class="line">     &#123;<span class="number">0</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>&#125;,</span><br><span class="line">     &#123;<span class="number">4</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">0</span>&#125;,</span><br><span class="line">     &#123;<span class="number">15</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">13</span>&#125;&#125;,</span><br><span class="line">    &#123;&#123;<span class="number">15</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>&#125;,</span><br><span class="line">     &#123;<span class="number">3</span>, <span class="number">13</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">5</span>&#125;,</span><br><span class="line">     &#123;<span class="number">0</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">15</span>&#125;,</span><br><span class="line">     &#123;<span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">9</span>&#125;&#125;,</span><br><span class="line">    &#123;&#123;<span class="number">10</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>&#125;,</span><br><span class="line">     &#123;<span class="number">13</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">1</span>&#125;,</span><br><span class="line">     &#123;<span class="number">13</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">7</span>&#125;,</span><br><span class="line">     &#123;<span class="number">1</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">12</span>&#125;&#125;,</span><br><span class="line">    &#123;&#123;<span class="number">7</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">15</span>&#125;,</span><br><span class="line">     &#123;<span class="number">13</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">9</span>&#125;,</span><br><span class="line">     &#123;<span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>&#125;,</span><br><span class="line">     &#123;<span class="number">3</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">14</span>&#125;&#125;,</span><br><span class="line">    &#123;&#123;<span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>&#125;,</span><br><span class="line">     &#123;<span class="number">14</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">6</span>&#125;,</span><br><span class="line">     &#123;<span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">14</span>&#125;,</span><br><span class="line">     &#123;<span class="number">11</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">3</span>&#125;&#125;,</span><br><span class="line">    &#123;&#123;<span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>&#125;,</span><br><span class="line">     &#123;<span class="number">10</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">8</span>&#125;,</span><br><span class="line">     &#123;<span class="number">9</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">6</span>&#125;,</span><br><span class="line">     &#123;<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span>&#125;&#125;,</span><br><span class="line">    &#123;&#123;<span class="number">4</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">1</span>&#125;,</span><br><span class="line">     &#123;<span class="number">13</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">6</span>&#125;,</span><br><span class="line">     &#123;<span class="number">1</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">2</span>&#125;,</span><br><span class="line">     &#123;<span class="number">6</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">12</span>&#125;&#125;,</span><br><span class="line">    &#123;&#123;<span class="number">13</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">7</span>&#125;,</span><br><span class="line">     &#123;<span class="number">1</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">2</span>&#125;,</span><br><span class="line">     &#123;<span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>&#125;,</span><br><span class="line">     &#123;<span class="number">2</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>&#125;&#125;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---- é€šç”¨ç½®æ¢ï¼šæŒ‰è¡¨æŠ½å–ä½ ----</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="type">int</span> N&gt;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> u64 <span class="title">permute</span><span class="params">(u64 input, <span class="type">const</span> <span class="type">int</span> (&amp;tbl)[N])</span> </span>&#123;</span><br><span class="line">    u64 out = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> src = tbl[i] - <span class="number">1</span>;                     <span class="comment">// è¡¨ç´¢å¼•ä» 1 å¼€å§‹</span></span><br><span class="line">        u64 bit = (input &gt;&gt; (<span class="number">64</span> - <span class="number">1</span> - src)) &amp; <span class="number">1u</span>; <span class="comment">// ç»Ÿä¸€æŒ‰ 64 ä½è§†è§’å–ä½</span></span><br><span class="line">        out = (out &lt;&lt; <span class="number">1</span>) | bit;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‡å®šè¾“å…¥å®½åº¦çš„ç½®æ¢ï¼ˆE/PC2/P ä½¿ç”¨ï¼‰</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> u64 <span class="title">permute_n</span><span class="params">(u64 input, <span class="type">const</span> <span class="type">int</span> *tbl, <span class="type">int</span> n, <span class="type">int</span> in_width)</span> </span>&#123;</span><br><span class="line">    u64 out = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="type">int</span> src = tbl[i] - <span class="number">1</span>;</span><br><span class="line">        u64 bit = (input &gt;&gt; (in_width - <span class="number">1</span> - src)) &amp; <span class="number">1u</span>;</span><br><span class="line">        out = (out &lt;&lt; <span class="number">1</span>) | bit;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 28 ä½å¾ªç¯å·¦ç§»ï¼ˆä»…ä½ 28 ä½æœ‰æ•ˆï¼‰</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> u32 <span class="title">rol28</span><span class="params">(u32 v, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    v &amp;= <span class="number">0x0FFFFFFF</span>u;</span><br><span class="line">    <span class="keyword">return</span> ((v &lt;&lt; r) | (v &gt;&gt; (<span class="number">28</span> - r))) &amp; <span class="number">0x0FFFFFFF</span>u;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 8 å­—èŠ‚å¤§ç«¯è£…è½½/å­˜å‚¨</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> u64 <span class="title">load64_be</span><span class="params">(<span class="type">const</span> u8 *b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ((u64)b[<span class="number">0</span>] &lt;&lt; <span class="number">56</span>) | ((u64)b[<span class="number">1</span>] &lt;&lt; <span class="number">48</span>) | ((u64)b[<span class="number">2</span>] &lt;&lt; <span class="number">40</span>) | ((u64)b[<span class="number">3</span>] &lt;&lt; <span class="number">32</span>) |</span><br><span class="line">           ((u64)b[<span class="number">4</span>] &lt;&lt; <span class="number">24</span>) | ((u64)b[<span class="number">5</span>] &lt;&lt; <span class="number">16</span>) | ((u64)b[<span class="number">6</span>] &lt;&lt; <span class="number">8</span>) | ((u64)b[<span class="number">7</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">void</span> <span class="title">store64_be</span><span class="params">(u64 v, u8 *b)</span> </span>&#123;</span><br><span class="line">    b[<span class="number">0</span>] = (u8)(v &gt;&gt; <span class="number">56</span>);</span><br><span class="line">    b[<span class="number">1</span>] = (u8)(v &gt;&gt; <span class="number">48</span>);</span><br><span class="line">    b[<span class="number">2</span>] = (u8)(v &gt;&gt; <span class="number">40</span>);</span><br><span class="line">    b[<span class="number">3</span>] = (u8)(v &gt;&gt; <span class="number">32</span>);</span><br><span class="line">    b[<span class="number">4</span>] = (u8)(v &gt;&gt; <span class="number">24</span>);</span><br><span class="line">    b[<span class="number">5</span>] = (u8)(v &gt;&gt; <span class="number">16</span>);</span><br><span class="line">    b[<span class="number">6</span>] = (u8)(v &gt;&gt; <span class="number">8</span>);</span><br><span class="line">    b[<span class="number">7</span>] = (u8)(v);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---- å¯†é’¥å®‰æ’ï¼šç”Ÿæˆ 16 è½® 48 ä½å­å¯†é’¥ ----</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">void</span> <span class="title">des_key_schedule</span><span class="params">(<span class="type">const</span> u8 key8[<span class="number">8</span>], u64 subkey[<span class="number">16</span>])</span> </span>&#123;</span><br><span class="line">    u64 key64 = <span class="built_in">load64_be</span>(key8);              <span class="comment">// åŸå§‹ 64 ä½å¯†é’¥</span></span><br><span class="line">    u64 k56 = <span class="built_in">permute</span>&lt;<span class="number">56</span>&gt;(key64, PC1);        <span class="comment">// PC-1 å»æ ¡éªŒä½</span></span><br><span class="line">    u32 C = (u32)((k56 &gt;&gt; <span class="number">28</span>) &amp; <span class="number">0x0FFFFFFF</span>u); <span class="comment">// å·¦ 28 ä½</span></span><br><span class="line">    u32 D = (u32)(k56 &amp; <span class="number">0x0FFFFFFF</span>u);         <span class="comment">// å³ 28 ä½</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> r = <span class="number">0</span>; r &lt; <span class="number">16</span>; ++r) &#123;</span><br><span class="line">        C = <span class="built_in">rol28</span>(C, LS[r]); <span class="comment">// å·¦ç§»</span></span><br><span class="line">        D = <span class="built_in">rol28</span>(D, LS[r]);</span><br><span class="line">        u64 CD = (((u64)C) &lt;&lt; <span class="number">28</span>) | (u64)D;   <span class="comment">// åˆå¹¶ 56 ä½</span></span><br><span class="line">        u64 k48 = <span class="built_in">permute_n</span>(CD, PC2, <span class="number">48</span>, <span class="number">56</span>); <span class="comment">// å‹ç¼©åˆ° 48 ä½</span></span><br><span class="line">        subkey[r] = k48;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---- è½®å‡½æ•° F(R, K) ----</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> u32 <span class="title">des_f</span><span class="params">(u32 R, u64 k48)</span> </span>&#123;</span><br><span class="line">    u64 ER = <span class="built_in">permute_n</span>((u64)R, E_tab, <span class="number">48</span>, <span class="number">32</span>); <span class="comment">// æ‰©å±• 32-&gt;48</span></span><br><span class="line">    u64 x  = ER ^ k48;                         <span class="comment">// ä¸å­å¯†é’¥å¼‚æˆ–</span></span><br><span class="line">    u32 out32 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i) &#123; <span class="comment">// 8 ä¸ª S ç›’</span></span><br><span class="line">        <span class="type">int</span> shift = <span class="number">42</span> - <span class="number">6</span> * i;</span><br><span class="line">        u8 six = (u8)((x &gt;&gt; shift) &amp; <span class="number">0x3F</span>u);</span><br><span class="line">        <span class="type">int</span> row = ((six &amp; <span class="number">0x20</span>) &gt;&gt; <span class="number">4</span>) | (six &amp; <span class="number">0x01</span>);</span><br><span class="line">        <span class="type">int</span> col = (six &gt;&gt; <span class="number">1</span>) &amp; <span class="number">0x0F</span>;</span><br><span class="line">        u8 s = (u8)SBOX[i][row][col];</span><br><span class="line">        out32 = (out32 &lt;&lt; <span class="number">4</span>) | s;</span><br><span class="line">    &#125;</span><br><span class="line">    u64 Pout = <span class="built_in">permute_n</span>((u64)out32, P_tab, <span class="number">32</span>, <span class="number">32</span>); <span class="comment">// P ç½®æ¢</span></span><br><span class="line">    <span class="keyword">return</span> (u32)Pout;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---- å•å—åŠ å¯†ï¼ˆECB åŸºå…ƒï¼‰----</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">void</span> <span class="title">des_encrypt_block</span><span class="params">(<span class="type">const</span> u8 in[<span class="number">8</span>], u8 out[<span class="number">8</span>], <span class="type">const</span> u64 subkey[<span class="number">16</span>])</span> </span>&#123;</span><br><span class="line">    u64 B   = <span class="built_in">load64_be</span>(in);</span><br><span class="line">    u64 IPB = <span class="built_in">permute</span>&lt;<span class="number">64</span>&gt;(B, IP);           <span class="comment">// åˆå§‹ç½®æ¢</span></span><br><span class="line">    u32 L   = (u32)(IPB &gt;&gt; <span class="number">32</span>), R = (u32)IPB; <span class="comment">// æ‹†æˆ L/R</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> r = <span class="number">0</span>; r &lt; <span class="number">16</span>; ++r) &#123; <span class="comment">// 16 è½® Feistel</span></span><br><span class="line">        u32 f    = <span class="built_in">des_f</span>(R, subkey[r]);</span><br><span class="line">        u32 newL = R;</span><br><span class="line">        u32 newR = L ^ f;</span><br><span class="line">        L = newL;</span><br><span class="line">        R = newR;</span><br><span class="line">    &#125;</span><br><span class="line">    u64 preout = (((u64)R) &lt;&lt; <span class="number">32</span>) | L; <span class="comment">// äº¤æ¢ L/R</span></span><br><span class="line">    u64 C      = <span class="built_in">permute</span>&lt;<span class="number">64</span>&gt;(preout, FP);   <span class="comment">// é€†åˆå§‹ç½®æ¢</span></span><br><span class="line">    <span class="built_in">store64_be</span>(C, out);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---- å•å—è§£å¯†ï¼ˆå­å¯†é’¥é€†åºï¼‰----</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">void</span> <span class="title">des_decrypt_block</span><span class="params">(<span class="type">const</span> u8 in[<span class="number">8</span>], u8 out[<span class="number">8</span>], <span class="type">const</span> u64 subkey[<span class="number">16</span>])</span> </span>&#123;</span><br><span class="line">    u64 rev[<span class="number">16</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; ++i)</span><br><span class="line">        rev[i] = subkey[<span class="number">15</span> - i]; <span class="comment">// åå‘å­å¯†é’¥</span></span><br><span class="line">    <span class="built_in">des_encrypt_block</span>(in, out, rev);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---- PKCS#7 å¡«å……/å»å¡«å…… ----</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> vector&lt;u8&gt; <span class="title">pkcs7_pad_vec</span><span class="params">(<span class="type">const</span> vector&lt;u8&gt; &amp;data, <span class="type">size_t</span> block = <span class="number">8</span>)</span> </span>&#123;</span><br><span class="line">    <span class="type">size_t</span> n   = data.<span class="built_in">size</span>();</span><br><span class="line">    <span class="type">size_t</span> pad = block - (n % block);</span><br><span class="line">    <span class="keyword">if</span> (pad == <span class="number">0</span>) pad = block;</span><br><span class="line">    vector&lt;u8&gt; out;</span><br><span class="line">    out.<span class="built_in">reserve</span>(n + pad);</span><br><span class="line">    out.<span class="built_in">insert</span>(out.<span class="built_in">end</span>(), data.<span class="built_in">begin</span>(), data.<span class="built_in">end</span>());</span><br><span class="line">    out.<span class="built_in">insert</span>(out.<span class="built_in">end</span>(), pad, (u8)pad);</span><br><span class="line">    <span class="keyword">return</span> out;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">bool</span> <span class="title">pkcs7_unpad_inplace</span><span class="params">(vector&lt;u8&gt; &amp;buf, <span class="type">size_t</span> block = <span class="number">8</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (buf.<span class="built_in">empty</span>() || (buf.<span class="built_in">size</span>() % block) != <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    u8 p = buf.<span class="built_in">back</span>();</span><br><span class="line">    <span class="keyword">if</span> (p == <span class="number">0</span> || p &gt; block || p &gt; buf.<span class="built_in">size</span>())</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; p; ++i)</span><br><span class="line">        <span class="keyword">if</span> (buf[buf.<span class="built_in">size</span>() - <span class="number">1</span> - i] != p)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    buf.<span class="built_in">resize</span>(buf.<span class="built_in">size</span>() - p);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---- ECB æ¨¡å¼ï¼ˆæ¼”ç¤ºç”¨ï¼Œä¸å®‰å…¨ï¼‰----</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> vector&lt;u8&gt; <span class="title">des_ecb_encrypt_vec</span><span class="params">(<span class="type">const</span> vector&lt;u8&gt; &amp;plain, <span class="type">const</span> u8 key8[<span class="number">8</span>])</span> </span>&#123;</span><br><span class="line">    u64 subkey[<span class="number">16</span>];</span><br><span class="line">    <span class="built_in">des_key_schedule</span>(key8, subkey);</span><br><span class="line">    vector&lt;u8&gt; in  = <span class="built_in">pkcs7_pad_vec</span>(plain, <span class="number">8</span>);</span><br><span class="line">    <span class="function">vector&lt;u8&gt; <span class="title">out</span><span class="params">(in.size())</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; in.<span class="built_in">size</span>(); i += <span class="number">8</span>)</span><br><span class="line">        <span class="built_in">des_encrypt_block</span>(&amp;in[i], &amp;out[i], subkey);</span><br><span class="line">    <span class="keyword">return</span> out;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">bool</span> <span class="title">des_ecb_decrypt_vec</span><span class="params">(<span class="type">const</span> vector&lt;u8&gt; &amp;cipher, <span class="type">const</span> u8 key8[<span class="number">8</span>], vector&lt;u8&gt; &amp;plain_out)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (cipher.<span class="built_in">size</span>() % <span class="number">8</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    u64 subkey[<span class="number">16</span>];</span><br><span class="line">    <span class="built_in">des_key_schedule</span>(key8, subkey);</span><br><span class="line">    plain_out.<span class="built_in">assign</span>(cipher.<span class="built_in">size</span>(), <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; cipher.<span class="built_in">size</span>(); i += <span class="number">8</span>)</span><br><span class="line">        <span class="built_in">des_decrypt_block</span>(&amp;cipher[i], &amp;plain_out[i], subkey);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pkcs7_unpad_inplace</span>(plain_out, <span class="number">8</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---- hex ç¼–è§£ç ï¼ˆè°ƒè¯•å¯ç”¨ï¼‰----</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> string <span class="title">to_hex</span><span class="params">(<span class="type">const</span> vector&lt;u8&gt; &amp;v)</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> <span class="type">char</span> *H = <span class="string">&quot;0123456789abcdef&quot;</span>;</span><br><span class="line">    string s;</span><br><span class="line">    s.<span class="built_in">resize</span>(v.<span class="built_in">size</span>() * <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; v.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">        u8 b = v[i];</span><br><span class="line">        s[<span class="number">2</span> * i]     = H[b &gt;&gt; <span class="number">4</span>];</span><br><span class="line">        s[<span class="number">2</span> * i + <span class="number">1</span>] = H[b &amp; <span class="number">0xF</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> vector&lt;u8&gt; <span class="title">from_hex</span><span class="params">(<span class="type">const</span> string &amp;h)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> hexv = [](<span class="type">char</span> c) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> c - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&#x27;a&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;f&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> c - <span class="string">&#x27;a&#x27;</span> + <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&#x27;A&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;F&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> c - <span class="string">&#x27;A&#x27;</span> + <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    vector&lt;u8&gt; v;</span><br><span class="line">    <span class="keyword">if</span> (h.<span class="built_in">size</span>() % <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span> v;</span><br><span class="line">    v.<span class="built_in">resize</span>(h.<span class="built_in">size</span>() / <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; v.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">        <span class="type">int</span> hi = <span class="built_in">hexv</span>(h[<span class="number">2</span> * i]), lo = <span class="built_in">hexv</span>(h[<span class="number">2</span> * i + <span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span> (hi &lt; <span class="number">0</span> || lo &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            v.<span class="built_in">clear</span>();</span><br><span class="line">            <span class="keyword">return</span> v;</span><br><span class="line">        &#125;</span><br><span class="line">        v[i] = (u8)((hi &lt;&lt; <span class="number">4</span>) | lo);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> v;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---- è¾“å…¥è¯»å–ï¼šæ”¯æŒ @path æ–‡ä»¶æˆ–ç›´æ¥ stdin ----</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">bool</span> <span class="title">is_space_le</span><span class="params">(<span class="type">char</span> c)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">static_cast</span>&lt;<span class="type">unsigned</span> <span class="type">char</span>&gt;(c) &lt;= <span class="string">&#x27; &#x27;</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;u8&gt; <span class="title">get_plain</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">all</span><span class="params">((istreambuf_iterator&lt;<span class="type">char</span>&gt;(cin)), istreambuf_iterator&lt;<span class="type">char</span>&gt;())</span></span>;</span><br><span class="line">    <span class="type">size_t</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; all.<span class="built_in">size</span>() &amp;&amp; <span class="built_in">is_space_le</span>(all[i]))</span><br><span class="line">        ++i;</span><br><span class="line">    <span class="keyword">if</span> (i &lt; all.<span class="built_in">size</span>() &amp;&amp; all[i] == <span class="string">&#x27;@&#x27;</span>) &#123; <span class="comment">// @ è·¯å¾„è¯»å–æ–‡ä»¶</span></span><br><span class="line">        <span class="type">size_t</span> j = i + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (j &lt; all.<span class="built_in">size</span>() &amp;&amp; <span class="built_in">is_space_le</span>(all[j]))</span><br><span class="line">            ++j;</span><br><span class="line">        <span class="type">size_t</span> k = all.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">while</span> (k &gt; j &amp;&amp; <span class="built_in">is_space_le</span>(all[k - <span class="number">1</span>]))</span><br><span class="line">            --k;</span><br><span class="line">        string path = all.<span class="built_in">substr</span>(j, k - j);</span><br><span class="line">        FILE *fp = <span class="built_in">fopen</span>(path.<span class="built_in">c_str</span>(), <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!fp)</span><br><span class="line">            <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">        <span class="built_in">fseek</span>(fp, <span class="number">0</span>, SEEK_END);</span><br><span class="line">        <span class="type">long</span> n = <span class="built_in">ftell</span>(fp);</span><br><span class="line">        <span class="keyword">if</span> (n &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">fclose</span>(fp);</span><br><span class="line">            <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">fseek</span>(fp, <span class="number">0</span>, SEEK_SET);</span><br><span class="line">        <span class="function">vector&lt;u8&gt; <span class="title">buf</span><span class="params">(<span class="keyword">static_cast</span>&lt;<span class="type">size_t</span>&gt;(n))</span></span>;</span><br><span class="line">        <span class="keyword">if</span> (n &gt; <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">fread</span>(buf.<span class="built_in">data</span>(), <span class="number">1</span>, <span class="built_in">static_cast</span>&lt;<span class="type">size_t</span>&gt;(n), fp);</span><br><span class="line">        <span class="built_in">fclose</span>(fp);</span><br><span class="line">        <span class="keyword">return</span> buf;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">vector</span>&lt;u8&gt;(all.<span class="built_in">begin</span>(), all.<span class="built_in">end</span>()); <span class="comment">// ç›´æ¥è¿”å›å…¨éƒ¨å­—èŠ‚</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¬¬ä¸€è¡Œï¼šæ¨¡å¼</span></span><br><span class="line">    string mode;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">getline</span>(cin, mode))</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¬¬äºŒè¡Œï¼šå¯†é’¥(8 chars)</span></span><br><span class="line">    string key_in;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">getline</span>(cin, key_in))</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (key_in.<span class="built_in">size</span>() &lt; <span class="number">8</span>)</span><br><span class="line">        key_in.<span class="built_in">append</span>(<span class="number">8</span> - key_in.<span class="built_in">size</span>(), <span class="string">&#x27;\0&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (key_in.<span class="built_in">size</span>() &gt; <span class="number">8</span>)</span><br><span class="line">        key_in.<span class="built_in">resize</span>(<span class="number">8</span>);</span><br><span class="line">    u8 key8[<span class="number">8</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; ++i)</span><br><span class="line">        key8[i] = (u8)key_in[i];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (mode == <span class="string">&quot;enc&quot;</span> || mode == <span class="string">&quot;ENC&quot;</span> || mode == <span class="string">&quot;Enc&quot;</span>) &#123;</span><br><span class="line">        <span class="comment">// åŠ å¯†æ¨¡å¼ï¼šè¯»å–åç»­æ‰€æœ‰æ•°æ®ä¸ºæ˜æ–‡</span></span><br><span class="line">        vector&lt;u8&gt; plain  = <span class="built_in">get_plain</span>();</span><br><span class="line">        vector&lt;u8&gt; cipher = <span class="built_in">des_ecb_encrypt_vec</span>(plain, key8);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¾“å‡ºï¼šåå…­è¿›åˆ¶å¯†æ–‡ + è¿˜åŸæ˜æ–‡ï¼ˆå’Œä½ åŸæ¥ç±»ä¼¼çš„æ¼”ç¤ºï¼‰</span></span><br><span class="line">        vector&lt;u8&gt; plain2;</span><br><span class="line">        <span class="type">bool</span> ok = <span class="built_in">des_ecb_decrypt_vec</span>(cipher, key8, plain2);</span><br><span class="line">        <span class="keyword">if</span> (!ok) &#123;</span><br><span class="line">            cerr &lt;&lt; <span class="string">&quot;unpad failed\n&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">to_hex</span>(cipher) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        cout.<span class="built_in">write</span>((<span class="type">const</span> <span class="type">char</span> *)plain2.<span class="built_in">data</span>(), (streamsize)plain2.<span class="built_in">size</span>());</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mode == <span class="string">&quot;dec&quot;</span> || mode == <span class="string">&quot;DEC&quot;</span> || mode == <span class="string">&quot;Dec&quot;</span>) &#123;</span><br><span class="line">        <span class="comment">// è§£å¯†æ¨¡å¼ï¼šç¬¬ä¸‰è¡Œè¯»å–åå…­è¿›åˆ¶å¯†æ–‡</span></span><br><span class="line">        string cipher_hex;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">getline</span>(cin, cipher_hex)) &#123;</span><br><span class="line">            cerr &lt;&lt; <span class="string">&quot;no ciphertext\n&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;u8&gt; cipher = <span class="built_in">from_hex</span>(cipher_hex);</span><br><span class="line">        <span class="keyword">if</span> (cipher_hex.<span class="built_in">size</span>() &gt; <span class="number">0</span> &amp;&amp; cipher.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            cerr &lt;&lt; <span class="string">&quot;invalid hex ciphertext\n&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;u8&gt; plain;</span><br><span class="line">        <span class="type">bool</span> ok = <span class="built_in">des_ecb_decrypt_vec</span>(cipher, key8, plain);</span><br><span class="line">        <span class="keyword">if</span> (!ok) &#123;</span><br><span class="line">            cerr &lt;&lt; <span class="string">&quot;decrypt or unpad failed\n&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// åªè¾“å‡ºæ˜æ–‡</span></span><br><span class="line">        cout.<span class="built_in">write</span>((<span class="type">const</span> <span class="type">char</span> *)plain.<span class="built_in">data</span>(), (streamsize)plain.<span class="built_in">size</span>());</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        cerr &lt;&lt; <span class="string">&quot;unknown mode, use enc/dec\n&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="DEA"><a href="#DEA" class="headerlink" title="DEA"></a>DEA</h2><p>ä¸‹é¢æ˜¯ IDEAï¼ˆInternational Data Encryption Algorithmï¼‰ç®—æ³•æµç¨‹çš„</p>
<p>åŸºæœ¬å‚æ•°</p>
<ul>
<li>åˆ†ç»„é•¿åº¦ï¼š64 ä½ã€‚ (<a href="https://www.geeksforgeeks.org/simplified-international-data-encryption-algorithm-idea/?utm_source=chatgpt.com">geeksforgeeks.org</a>)</li>
<li>å¯†é’¥é•¿åº¦ï¼š128 ä½ã€‚ (<a href="https://www.geeksforgeeks.org/simplified-international-data-encryption-algorithm-idea/?utm_source=chatgpt.com">geeksforgeeks.org</a>)</li>
<li>è½®æ•°ç»“æ„ï¼š8 ä¸ªå…¨è½® + åŠè½®ï¼ˆè¾“å‡ºå˜æ¢ï¼‰ã€‚ (<a href="https://de.wikipedia.org/wiki/International_Data_Encryption_Algorithm?utm_source=chatgpt.com">ç»´åŸºç™¾ç§‘</a>)</li>
</ul>
<p>å…³é”®æ“ä½œï¼ˆåœ¨æ¯è½®ä¸­ä½¿ç”¨çš„è¿ç®—ï¼‰</p>
<p>åœ¨ IDEA ä¸­ï¼Œæ¯è½®å¯¹æ•°æ®å—ä½¿ç”¨ä»¥ä¸‹ä¸‰ç§ä¸åŒä»£æ•°ç¾¤çš„è¿ç®—ï¼Œä»¥å¢å¼ºå®‰å…¨æ€§ï¼š</p>
<ol>
<li><strong>å¼‚æˆ– (XOR)</strong> è¿ç®—ã€‚ (<a href="https://pt.wikipedia.org/wiki/International_Data_Encryption_Algorithm?utm_source=chatgpt.com">ç»´åŸºç™¾ç§‘</a>)</li>
<li><strong>æ¨¡ 2Â¹â¶ åŠ æ³•</strong>ï¼ˆå³ä»¥ 2Â¹â¶ ä¸ºæ¨¡çš„åŠ æ³•è¿ç®—ï¼‰ã€‚ (<a href="https://de.wikipedia.org/wiki/International_Data_Encryption_Algorithm?utm_source=chatgpt.com">ç»´åŸºç™¾ç§‘</a>)</li>
<li><strong>æ¨¡ (2Â¹â¶ + 1) ä¹˜æ³•</strong>ï¼ˆå¹¶ä¸”å°†å€¼ 0x0000 è§†ä½œ 2Â¹â¶ ï¼‰ã€‚ (<a href="https://pt.wikipedia.org/wiki/International_Data_Encryption_Algorithm?utm_source=chatgpt.com">ç»´åŸºç™¾ç§‘</a>)</li>
</ol>
<p>å­å¯†é’¥ç”Ÿæˆ (Key Schedule)</p>
<ul>
<li>ä» 128 ä½ä¸»å¯†é’¥ä¸­ï¼Œæå–å‡ºè‹¥å¹² 16 ä½å­å¯†é’¥ã€‚ (<a href="https://de.wikipedia.org/wiki/International_Data_Encryption_Algorithm?utm_source=chatgpt.com">ç»´åŸºç™¾ç§‘</a>)</li>
<li>æ¯è½®ä½¿ç”¨ 6 ä¸ª 16 ä½å­å¯†é’¥ï¼›è¾“å‡ºåŠè½®ä½¿ç”¨ 4 ä¸ª 16 ä½å­å¯†é’¥ã€‚ æ€»è®¡ 52 ä¸ªå­å¯†é’¥ã€‚ (<a href="https://www.rroij.com/open-access/international-data-encryption-algorithm-idea-a-typical-illustration.php?aid=37580&amp;utm_source=chatgpt.com">å›½é™…æœŸåˆŠç ”ç©¶ä¸è¯„è®º</a>)</li>
<li>æ¯æ¬¡æå–å­å¯†é’¥åï¼Œå¯¹ä¸»å¯†é’¥æ‰§è¡Œå·¦æ—‹ 25 ä½ï¼Œç„¶åç»§ç»­æå–ã€‚ (<a href="https://it.wikipedia.org/wiki/International_Data_Encryption_Algorithm?utm_source=chatgpt.com">ç»´åŸºç™¾ç§‘</a>)</li>
</ul>
<p>åŠ å¯†æµç¨‹ï¼ˆæ¯ä¸ªåˆ†ç»„å¤„ç†æµç¨‹ï¼‰</p>
<ol>
<li>å°† 64 ä½æ˜æ–‡åˆ†ä¸ºå››ä¸ª 16 ä½å­å—ï¼šXâ‚, Xâ‚‚, Xâ‚ƒ, Xâ‚„ã€‚</li>
<li>å¯¹äº i = 1 åˆ° 8 è½®ï¼ˆæ¯è½®è¿‡ç¨‹å¦‚ä¸‹ï¼‰ï¼š<ul>
<li>ä½¿ç”¨æœ¬è½®çš„ 6 ä¸ªå­å¯†é’¥åˆ†åˆ«å¯¹ Xâ‚â€“Xâ‚„ è¿›è¡Œæ¨¡ 2Â¹â¶ åŠ ï¼æ¨¡ (2Â¹â¶+1) ä¹˜ï¼XOR ç­‰æ“ä½œï¼ˆå…·ä½“ç»„åˆè§åŸæ–‡ï¼‰ã€‚</li>
<li>ç„¶åå¯¹ä¸­é—´ç»“æœåšæ··åˆï¼ˆä¾‹å¦‚ä¸¤ä¸ªå­å—ä¹‹é—´åš XORï¼‰ï¼Œå†ç»§ç»­å¯¹å…¶ä¸­ä¸¤ä¸ªå­å—åšæ¨¡ 2Â¹â¶ åŠ ï¼æ¨¡ (2Â¹â¶+1) ä¹˜ã€‚</li>
<li>è½®ç»“æŸåï¼Œå°†å››ä¸ªå­å—ä½ç½®è¿›è¡ŒæŸç§ç½®æ¢ï¼ˆäº¤æ¢ Xâ‚‚ä¸ Xâ‚ƒï¼‰æˆ–é‡ç»„ï¼Œä¸ºä¸‹ä¸€è½®è¾“å…¥ã€‚</li>
</ul>
</li>
<li>ç»è¿‡ 8 æ¬¡ä¸Šè¿°å…¨è½®åï¼Œå†æ‰§è¡Œä¸€ä¸ªâ€œåŠè½®â€è¾“å‡ºå˜æ¢ï¼ˆä½¿ç”¨ 4 ä¸ªå­å¯†é’¥ï¼Œå¯¹å››ä¸ª16 ä½å­å—ä½œæœ€åçš„æ¨¡è¿ç®—å’Œå¼‚æˆ–ï¼‰ã€‚</li>
<li>æœ€ç»ˆå°†å››ä¸ª 16 ä½å­å—åˆå¹¶ä¸º 64 ä½å¯†æ–‡ã€‚</li>
</ol>
<p>è§£å¯†æµç¨‹</p>
<ul>
<li>è§£å¯†æµç¨‹ä¸åŠ å¯†æµç¨‹ç»“æ„ç›¸åŒï¼Œä½†å­å¯†é’¥ä½¿ç”¨é¡ºåºä¸ºåå‘ï¼ˆè€Œä¸”åœ¨ä¹˜æ³•ï¼åŠ æ³•è¿ç®—ä¸­ä½¿ç”¨ç›¸åº”çš„é€†å…ƒç´ æˆ–é€†è¿ç®—ï¼‰ã€‚ (<a href="https://www.rroij.com/open-access/international-data-encryption-algorithm-idea-a-typical-illustration.php?aid=37580&amp;utm_source=chatgpt.com">å›½é™…æœŸåˆŠç ”ç©¶ä¸è¯„è®º</a>)</li>
</ul>
<p>ç‰¹ç‚¹ &amp; å®‰å…¨æ€§</p>
<ul>
<li>IDEA é€šè¿‡â€œæ··åˆâ€ä¸‰ç±»ä¸åŒä»£æ•°è¿ç®—ï¼ˆåŠ ã€ä¹˜ã€XORï¼‰å¢å¼ºäº†æŠ—å·®åˆ†ï¼çº¿æ€§åˆ†æçš„èƒ½åŠ›ã€‚ (<a href="https://pt.wikipedia.org/wiki/International_Data_Encryption_Algorithm?utm_source=chatgpt.com">ç»´åŸºç™¾ç§‘</a>)</li>
<li>è™½ç„¶ å¯†é’¥ç©ºé—´è¾¾åˆ° 2Â¹Â²â¸ ï¼Œä½†éšç€æ—¶é—´æ¨è¿›ï¼Œå®ƒåœ¨æ•ˆç‡å’Œæ ‡å‡†åŒ–æ–¹é¢é€æ¸è¢«æ–°ç®—æ³•ï¼ˆå¦‚ AESï¼‰å–ä»£ã€‚ (<a href="https://nordvpn.com/blog/idea-encryption/?utm_source=chatgpt.com">NordVPN</a>)</li>
</ul>
<h3 id="std-1"><a href="#std-1" class="headerlink" title="std"></a>std</h3><p>ç¤ºä¾‹è¾“å…¥ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">jielycatjielycat</span></span><br><span class="line"><span class="comment">Hello! IDEA!</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p>ç¨‹åºï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> u64 = <span class="type">uint64_t</span>;</span><br><span class="line"><span class="keyword">using</span> u32 = <span class="type">uint32_t</span>;</span><br><span class="line"><span class="keyword">using</span> u8 = <span class="type">uint8_t</span>;</span><br><span class="line"><span class="keyword">using</span> u16 = <span class="type">uint16_t</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">constexpr</span> ll ADD_MOD = <span class="number">65536LL</span>;</span><br><span class="line"><span class="keyword">constexpr</span> ll MUL_MOD = <span class="number">65537LL</span>;</span><br><span class="line"></span><br><span class="line">u16 key[<span class="number">60</span>];</span><br><span class="line">u16 key2[<span class="number">60</span>];</span><br><span class="line">string my_key_bin_str;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> u16 <span class="title">add</span><span class="params">(u16 a, u16 b)</span> </span>&#123; <span class="keyword">return</span> a + b; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function">u16 <span class="title">mul</span><span class="params">(u16 a, u16 b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    u64 a1 = (a == <span class="number">0</span>) ? ADD_MOD : a;</span><br><span class="line">    u64 b1 = (b == <span class="number">0</span>) ? ADD_MOD : b;</span><br><span class="line">    u64 res = (a1 * b1) % MUL_MOD;</span><br><span class="line">    <span class="keyword">return</span> (res == ADD_MOD) ? <span class="number">0</span> : <span class="built_in">static_cast</span>&lt;u16&gt;(res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> u16 <span class="title">yihuo</span><span class="params">(u16 a, u16 b)</span> </span>&#123; <span class="keyword">return</span> a ^ b; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function">u16 <span class="title">bin_str_to_u16</span><span class="params">(string_view s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    u16 res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; ++i)</span><br><span class="line">        res = (res &lt;&lt; <span class="number">1</span>) | (s[i] - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 128æ¯”ç‰¹å¾ªç¯å·¦ç§»25ä½</span></span><br><span class="line"><span class="function">string <span class="title">roll_left</span><span class="params">(string t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">s</span><span class="params">(<span class="number">128</span>, <span class="string">&#x27;0&#x27;</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">128</span>; i++)</span><br><span class="line">        s[i] = t[(i + <span class="number">25</span>) % <span class="number">128</span>];</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿæˆ52ä¸ªå­å¯†é’¥</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">extend</span><span class="params">(string t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> k_idx = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        key[k_idx++] = <span class="built_in">bin_str_to_u16</span>(<span class="built_in">string_view</span>(t.<span class="built_in">c_str</span>() + <span class="number">0</span>, <span class="number">16</span>));</span><br><span class="line">        key[k_idx++] = <span class="built_in">bin_str_to_u16</span>(<span class="built_in">string_view</span>(t.<span class="built_in">c_str</span>() + <span class="number">16</span>, <span class="number">16</span>));</span><br><span class="line">        key[k_idx++] = <span class="built_in">bin_str_to_u16</span>(<span class="built_in">string_view</span>(t.<span class="built_in">c_str</span>() + <span class="number">32</span>, <span class="number">16</span>));</span><br><span class="line">        key[k_idx++] = <span class="built_in">bin_str_to_u16</span>(<span class="built_in">string_view</span>(t.<span class="built_in">c_str</span>() + <span class="number">48</span>, <span class="number">16</span>));</span><br><span class="line">        key[k_idx++] = <span class="built_in">bin_str_to_u16</span>(<span class="built_in">string_view</span>(t.<span class="built_in">c_str</span>() + <span class="number">64</span>, <span class="number">16</span>));</span><br><span class="line">        key[k_idx++] = <span class="built_in">bin_str_to_u16</span>(<span class="built_in">string_view</span>(t.<span class="built_in">c_str</span>() + <span class="number">80</span>, <span class="number">16</span>));</span><br><span class="line">        key[k_idx++] = <span class="built_in">bin_str_to_u16</span>(<span class="built_in">string_view</span>(t.<span class="built_in">c_str</span>() + <span class="number">96</span>, <span class="number">16</span>));</span><br><span class="line">        key[k_idx++] = <span class="built_in">bin_str_to_u16</span>(<span class="built_in">string_view</span>(t.<span class="built_in">c_str</span>() + <span class="number">112</span>, <span class="number">16</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    key[k_idx++] = <span class="built_in">bin_str_to_u16</span>(<span class="built_in">string_view</span>(t.<span class="built_in">c_str</span>() + <span class="number">0</span>, <span class="number">16</span>));</span><br><span class="line">    key[k_idx++] = <span class="built_in">bin_str_to_u16</span>(<span class="built_in">string_view</span>(t.<span class="built_in">c_str</span>() + <span class="number">16</span>, <span class="number">16</span>));</span><br><span class="line">    key[k_idx++] = <span class="built_in">bin_str_to_u16</span>(<span class="built_in">string_view</span>(t.<span class="built_in">c_str</span>() + <span class="number">32</span>, <span class="number">16</span>));</span><br><span class="line">    key[k_idx++] = <span class="built_in">bin_str_to_u16</span>(<span class="built_in">string_view</span>(t.<span class="built_in">c_str</span>() + <span class="number">48</span>, <span class="number">16</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">exgcd</span><span class="params">(ll a, ll b, ll &amp;d, ll &amp;x, ll &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b)</span><br><span class="line">    &#123;</span><br><span class="line">        d = a;</span><br><span class="line">        x = <span class="number">1</span>;</span><br><span class="line">        y = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">exgcd</span>(b, a % b, d, y, x);</span><br><span class="line">        y -= x * (a / b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">u16 <span class="title">inv</span><span class="params">(u16 a_u16, ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll a = (a_u16 == <span class="number">0</span>) ? ADD_MOD : a_u16;</span><br><span class="line">    ll d, x, y;</span><br><span class="line">    <span class="built_in">exgcd</span>(a, p, d, x, y);</span><br><span class="line">    ll res = (d == <span class="number">1</span>) ? (x % p + p) % p : <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">return</span> (res == ADD_MOD) ? <span class="number">0</span> : <span class="built_in">static_cast</span>&lt;u16&gt;(res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">u16 <span class="title">add_ni</span><span class="params">(u16 a, ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll b = -<span class="built_in">static_cast</span>&lt;ll&gt;(a);</span><br><span class="line">    b = (b % p + p) % p;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">static_cast</span>&lt;u16&gt;(b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿæˆè§£å¯†å­å¯†é’¥</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dkey</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">9</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">4</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> t = <span class="number">6</span> * (<span class="number">10</span> - i - <span class="number">1</span>) + j;</span><br><span class="line">            <span class="keyword">if</span> (j == <span class="number">1</span> || j == <span class="number">4</span>)</span><br><span class="line">                key2[(i - <span class="number">1</span>) * <span class="number">6</span> + j] = <span class="built_in">inv</span>(key[t], MUL_MOD);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (i == <span class="number">1</span> || i == <span class="number">9</span>)</span><br><span class="line">                    key2[(i - <span class="number">1</span>) * <span class="number">6</span> + j] = <span class="built_in">add_ni</span>(key[t], ADD_MOD);</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (j == <span class="number">2</span>)</span><br><span class="line">                        key2[(i - <span class="number">1</span>) * <span class="number">6</span> + j] = <span class="built_in">add_ni</span>(key[t + <span class="number">1</span>], ADD_MOD);</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        key2[(i - <span class="number">1</span>) * <span class="number">6</span> + j] = <span class="built_in">add_ni</span>(key[t - <span class="number">1</span>], ADD_MOD);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        key2[(i - <span class="number">1</span>) * <span class="number">6</span> + <span class="number">5</span>] = key[(<span class="number">9</span> - i - <span class="number">1</span>) * <span class="number">6</span> + <span class="number">5</span>];</span><br><span class="line">        key2[(i - <span class="number">1</span>) * <span class="number">6</span> + <span class="number">6</span>] = key[(<span class="number">9</span> - i - <span class="number">1</span>) * <span class="number">6</span> + <span class="number">6</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ å¯†å—</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">IDEA_encrypt_block</span><span class="params">(u16 x[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> k_idx = (i - <span class="number">1</span>) * <span class="number">6</span> + <span class="number">1</span>;</span><br><span class="line">        u16 z1 = key[k_idx++], z2 = key[k_idx++], z3 = key[k_idx++],</span><br><span class="line">            z4 = key[k_idx++], z5 = key[k_idx++], z6 = key[k_idx++];</span><br><span class="line"></span><br><span class="line">        u16 t1 = <span class="built_in">mul</span>(x[<span class="number">0</span>], z1);</span><br><span class="line">        u16 t2 = <span class="built_in">add</span>(x[<span class="number">1</span>], z2);</span><br><span class="line">        u16 t3 = <span class="built_in">add</span>(x[<span class="number">2</span>], z3);</span><br><span class="line">        u16 t4 = <span class="built_in">mul</span>(x[<span class="number">3</span>], z4);</span><br><span class="line">        u16 t5 = <span class="built_in">yihuo</span>(t1, t3);</span><br><span class="line">        u16 t6 = <span class="built_in">yihuo</span>(t2, t4);</span><br><span class="line">        u16 t7 = <span class="built_in">mul</span>(t5, z5);</span><br><span class="line">        u16 t8 = <span class="built_in">add</span>(t6, t7);</span><br><span class="line">        u16 t9 = <span class="built_in">mul</span>(t8, z6);</span><br><span class="line">        u16 t10 = <span class="built_in">add</span>(t7, t9);</span><br><span class="line"></span><br><span class="line">        u16 w1 = <span class="built_in">yihuo</span>(t1, t9);</span><br><span class="line">        u16 w2 = <span class="built_in">yihuo</span>(t3, t9);</span><br><span class="line">        u16 w3 = <span class="built_in">yihuo</span>(t2, t10);</span><br><span class="line">        u16 w4 = <span class="built_in">yihuo</span>(t4, t10);</span><br><span class="line"></span><br><span class="line">        x[<span class="number">0</span>] = w1;</span><br><span class="line">        x[<span class="number">1</span>] = w2;</span><br><span class="line">        x[<span class="number">2</span>] = w3;</span><br><span class="line">        x[<span class="number">3</span>] = w4;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    u16 y1 = <span class="built_in">mul</span>(x[<span class="number">0</span>], key[<span class="number">49</span>]);</span><br><span class="line">    u16 y2 = <span class="built_in">add</span>(x[<span class="number">2</span>], key[<span class="number">50</span>]);</span><br><span class="line">    u16 y3 = <span class="built_in">add</span>(x[<span class="number">1</span>], key[<span class="number">51</span>]);</span><br><span class="line">    u16 y4 = <span class="built_in">mul</span>(x[<span class="number">3</span>], key[<span class="number">52</span>]);</span><br><span class="line">    x[<span class="number">0</span>] = y1;</span><br><span class="line">    x[<span class="number">1</span>] = y2;</span><br><span class="line">    x[<span class="number">2</span>] = y3;</span><br><span class="line">    x[<span class="number">3</span>] = y4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§£å¯†å—</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">IDEA_decrypt_block</span><span class="params">(u16 x[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">8</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> k_idx = (i - <span class="number">1</span>) * <span class="number">6</span> + <span class="number">1</span>;</span><br><span class="line">        u16 z1 = key2[k_idx++], z2 = key2[k_idx++], z3 = key2[k_idx++],</span><br><span class="line">            z4 = key2[k_idx++], z5 = key2[k_idx++], z6 = key2[k_idx++];</span><br><span class="line"></span><br><span class="line">        u16 t1 = <span class="built_in">mul</span>(x[<span class="number">0</span>], z1);</span><br><span class="line">        u16 t2 = <span class="built_in">add</span>(x[<span class="number">1</span>], z2);</span><br><span class="line">        u16 t3 = <span class="built_in">add</span>(x[<span class="number">2</span>], z3);</span><br><span class="line">        u16 t4 = <span class="built_in">mul</span>(x[<span class="number">3</span>], z4);</span><br><span class="line">        u16 t5 = <span class="built_in">yihuo</span>(t1, t3);</span><br><span class="line">        u16 t6 = <span class="built_in">yihuo</span>(t2, t4);</span><br><span class="line">        u16 t7 = <span class="built_in">mul</span>(t5, z5);</span><br><span class="line">        u16 t8 = <span class="built_in">add</span>(t6, t7);</span><br><span class="line">        u16 t9 = <span class="built_in">mul</span>(t8, z6);</span><br><span class="line">        u16 t10 = <span class="built_in">add</span>(t7, t9);</span><br><span class="line"></span><br><span class="line">        u16 w1 = <span class="built_in">yihuo</span>(t1, t9);</span><br><span class="line">        u16 w2 = <span class="built_in">yihuo</span>(t3, t9);</span><br><span class="line">        u16 w3 = <span class="built_in">yihuo</span>(t2, t10);</span><br><span class="line">        u16 w4 = <span class="built_in">yihuo</span>(t4, t10);</span><br><span class="line"></span><br><span class="line">        x[<span class="number">0</span>] = w1;</span><br><span class="line">        x[<span class="number">1</span>] = w2;</span><br><span class="line">        x[<span class="number">2</span>] = w3;</span><br><span class="line">        x[<span class="number">3</span>] = w4;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    u16 y1 = <span class="built_in">mul</span>(x[<span class="number">0</span>], key2[<span class="number">49</span>]);</span><br><span class="line">    u16 y2 = <span class="built_in">add</span>(x[<span class="number">2</span>], key2[<span class="number">50</span>]);</span><br><span class="line">    u16 y3 = <span class="built_in">add</span>(x[<span class="number">1</span>], key2[<span class="number">51</span>]);</span><br><span class="line">    u16 y4 = <span class="built_in">mul</span>(x[<span class="number">3</span>], key2[<span class="number">52</span>]);</span><br><span class="line">    x[<span class="number">0</span>] = y1;</span><br><span class="line">    x[<span class="number">1</span>] = y2;</span><br><span class="line">    x[<span class="number">2</span>] = y3;</span><br><span class="line">    x[<span class="number">3</span>] = y4;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å­—èŠ‚è½¬äºŒè¿›åˆ¶å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="function">string <span class="title">B2b</span><span class="params">(vector&lt;<span class="type">char</span>&gt; &amp;block)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string out;</span><br><span class="line">    out.<span class="built_in">reserve</span>(<span class="number">128</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        u8 u = <span class="built_in">static_cast</span>&lt;u8&gt;(block[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> b = <span class="number">7</span>; b &gt;= <span class="number">0</span>; --b)</span><br><span class="line">            out.<span class="built_in">push_back</span>(((u &gt;&gt; b) &amp; <span class="number">1</span>) ? <span class="string">&#x27;1&#x27;</span> : <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯»å–16å­—èŠ‚å¯†é’¥</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">char</span>&gt; <span class="title">get_key</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string key;</span><br><span class="line">    <span class="built_in">getline</span>(cin, key);</span><br><span class="line">    <span class="keyword">while</span> (key.<span class="built_in">size</span>() &lt; <span class="number">16</span>)</span><br><span class="line">        key += <span class="string">&quot;0&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span> (key.<span class="built_in">size</span>() &gt; <span class="number">16</span>)</span><br><span class="line">        key.<span class="built_in">resize</span>(<span class="number">16</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">vector</span>&lt;<span class="type">char</span>&gt;(key.<span class="built_in">begin</span>(), key.<span class="built_in">end</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">bool</span> <span class="title">is_space_le</span><span class="params">(<span class="type">char</span> c)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">static_cast</span>&lt;<span class="type">unsigned</span> <span class="type">char</span>&gt;(c) &lt;= <span class="string">&#x27; &#x27;</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–æ˜æ–‡</span></span><br><span class="line"><span class="function">vector&lt;u8&gt; <span class="title">get_plain</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">all</span><span class="params">((istreambuf_iterator&lt;<span class="type">char</span>&gt;(cin)), (istreambuf_iterator&lt;<span class="type">char</span>&gt;()))</span></span>;</span><br><span class="line">    <span class="type">size_t</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; all.<span class="built_in">size</span>() &amp;&amp; <span class="built_in">is_space_le</span>(all[i]))</span><br><span class="line">        ++i;</span><br><span class="line">    <span class="keyword">if</span> (i &lt; all.<span class="built_in">size</span>() &amp;&amp; all[i] == <span class="string">&#x27;@&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">size_t</span> j = i + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (j &lt; all.<span class="built_in">size</span>() &amp;&amp; <span class="built_in">is_space_le</span>(all[j]))</span><br><span class="line">            ++j;</span><br><span class="line">        <span class="type">size_t</span> k = all.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">while</span> (k &gt; j &amp;&amp; <span class="built_in">is_space_le</span>(all[k - <span class="number">1</span>]))</span><br><span class="line">            --k;</span><br><span class="line">        string path = all.<span class="built_in">substr</span>(j, k - j);</span><br><span class="line">        FILE *fp = <span class="built_in">fopen</span>(path.<span class="built_in">c_str</span>(), <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!fp)</span><br><span class="line">            <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">        <span class="built_in">fseek</span>(fp, <span class="number">0</span>, SEEK_END);</span><br><span class="line">        <span class="type">long</span> n = <span class="built_in">ftell</span>(fp);</span><br><span class="line">        <span class="keyword">if</span> (n &lt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">fclose</span>(fp);</span><br><span class="line">            <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">fseek</span>(fp, <span class="number">0</span>, SEEK_SET);</span><br><span class="line">        <span class="function">vector&lt;u8&gt; <span class="title">buf</span><span class="params">(<span class="keyword">static_cast</span>&lt;<span class="type">size_t</span>&gt;(n))</span></span>;</span><br><span class="line">        <span class="keyword">if</span> (n &gt; <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">fread</span>(buf.<span class="built_in">data</span>(), <span class="number">1</span>, <span class="built_in">static_cast</span>&lt;<span class="type">size_t</span>&gt;(n), fp);</span><br><span class="line">        <span class="built_in">fclose</span>(fp);</span><br><span class="line">        <span class="keyword">return</span> buf;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">vector</span>&lt;u8&gt;(all.<span class="built_in">begin</span>(), all.<span class="built_in">end</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    vector&lt;<span class="type">char</span>&gt; key0 = <span class="built_in">get_key</span>();</span><br><span class="line">    my_key_bin_str = <span class="built_in">B2b</span>(key0);</span><br><span class="line">    <span class="built_in">extend</span>(my_key_bin_str);</span><br><span class="line">    <span class="built_in">dkey</span>();</span><br><span class="line"></span><br><span class="line">    vector&lt;u8&gt; plain = <span class="built_in">get_plain</span>();</span><br><span class="line">    <span class="type">size_t</span> original_len = plain.<span class="built_in">size</span>();</span><br><span class="line">    <span class="type">size_t</span> padding = (<span class="number">8</span> - (original_len % <span class="number">8</span>)) % <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; padding; ++i)</span><br><span class="line">        plain.<span class="built_in">push_back</span>(padding);</span><br><span class="line"></span><br><span class="line">    <span class="type">size_t</span> num_blocks = plain.<span class="built_in">size</span>() / <span class="number">8</span>;</span><br><span class="line">    <span class="function">vector&lt;u8&gt; <span class="title">encrypted_bytes</span><span class="params">(plain.size())</span></span>;</span><br><span class="line">    <span class="function">vector&lt;u8&gt; <span class="title">decrypted_bytes</span><span class="params">(plain.size())</span></span>;</span><br><span class="line">    u16 x[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åŠ å¯†</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; num_blocks; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        u8 *p_in = plain.<span class="built_in">data</span>() + i * <span class="number">8</span>;</span><br><span class="line">        x[<span class="number">0</span>] = (p_in[<span class="number">0</span>] &lt;&lt; <span class="number">8</span>) | p_in[<span class="number">1</span>];</span><br><span class="line">        x[<span class="number">1</span>] = (p_in[<span class="number">2</span>] &lt;&lt; <span class="number">8</span>) | p_in[<span class="number">3</span>];</span><br><span class="line">        x[<span class="number">2</span>] = (p_in[<span class="number">4</span>] &lt;&lt; <span class="number">8</span>) | p_in[<span class="number">5</span>];</span><br><span class="line">        x[<span class="number">3</span>] = (p_in[<span class="number">6</span>] &lt;&lt; <span class="number">8</span>) | p_in[<span class="number">7</span>];</span><br><span class="line">        <span class="built_in">IDEA_encrypt_block</span>(x);</span><br><span class="line">        u8 *p_out = encrypted_bytes.<span class="built_in">data</span>() + i * <span class="number">8</span>;</span><br><span class="line">        p_out[<span class="number">0</span>] = (x[<span class="number">0</span>] &gt;&gt; <span class="number">8</span>);</span><br><span class="line">        p_out[<span class="number">1</span>] = (x[<span class="number">0</span>] &amp; <span class="number">0xFF</span>);</span><br><span class="line">        p_out[<span class="number">2</span>] = (x[<span class="number">1</span>] &gt;&gt; <span class="number">8</span>);</span><br><span class="line">        p_out[<span class="number">3</span>] = (x[<span class="number">1</span>] &amp; <span class="number">0xFF</span>);</span><br><span class="line">        p_out[<span class="number">4</span>] = (x[<span class="number">2</span>] &gt;&gt; <span class="number">8</span>);</span><br><span class="line">        p_out[<span class="number">5</span>] = (x[<span class="number">2</span>] &amp; <span class="number">0xFF</span>);</span><br><span class="line">        p_out[<span class="number">6</span>] = (x[<span class="number">3</span>] &gt;&gt; <span class="number">8</span>);</span><br><span class="line">        p_out[<span class="number">7</span>] = (x[<span class="number">3</span>] &amp; <span class="number">0xFF</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è§£å¯†</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; num_blocks; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        u8 *p_in = encrypted_bytes.<span class="built_in">data</span>() + i * <span class="number">8</span>;</span><br><span class="line">        x[<span class="number">0</span>] = (p_in[<span class="number">0</span>] &lt;&lt; <span class="number">8</span>) | p_in[<span class="number">1</span>];</span><br><span class="line">        x[<span class="number">1</span>] = (p_in[<span class="number">2</span>] &lt;&lt; <span class="number">8</span>) | p_in[<span class="number">3</span>];</span><br><span class="line">        x[<span class="number">2</span>] = (p_in[<span class="number">4</span>] &lt;&lt; <span class="number">8</span>) | p_in[<span class="number">5</span>];</span><br><span class="line">        x[<span class="number">3</span>] = (p_in[<span class="number">6</span>] &lt;&lt; <span class="number">8</span>) | p_in[<span class="number">7</span>];</span><br><span class="line">        <span class="built_in">IDEA_decrypt_block</span>(x);</span><br><span class="line">        u8 *p_out = decrypted_bytes.<span class="built_in">data</span>() + i * <span class="number">8</span>;</span><br><span class="line">        p_out[<span class="number">0</span>] = (x[<span class="number">0</span>] &gt;&gt; <span class="number">8</span>);</span><br><span class="line">        p_out[<span class="number">1</span>] = (x[<span class="number">0</span>] &amp; <span class="number">0xFF</span>);</span><br><span class="line">        p_out[<span class="number">2</span>] = (x[<span class="number">1</span>] &gt;&gt; <span class="number">8</span>);</span><br><span class="line">        p_out[<span class="number">3</span>] = (x[<span class="number">1</span>] &amp; <span class="number">0xFF</span>);</span><br><span class="line">        p_out[<span class="number">4</span>] = (x[<span class="number">2</span>] &gt;&gt; <span class="number">8</span>);</span><br><span class="line">        p_out[<span class="number">5</span>] = (x[<span class="number">2</span>] &amp; <span class="number">0xFF</span>);</span><br><span class="line">        p_out[<span class="number">6</span>] = (x[<span class="number">3</span>] &gt;&gt; <span class="number">8</span>);</span><br><span class="line">        p_out[<span class="number">7</span>] = (x[<span class="number">3</span>] &amp; <span class="number">0xFF</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// cout &lt;&lt; &quot;æ˜æ–‡ï¼š&quot; &lt;&lt; string(plain.begin(), plain.begin() + original_len) &lt;&lt; endl;</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; &quot;å¯†æ–‡ (hex)ï¼š&quot;;</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; hex &lt;&lt; setfill(&#x27;0&#x27;);</span></span><br><span class="line">    <span class="comment">// for (size_t i = 0; i &lt; encrypted_bytes.size(); ++i)</span></span><br><span class="line">        <span class="comment">// cout &lt;&lt; setw(2) &lt;&lt; static_cast&lt;int&gt;(encrypted_bytes[i]);</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; dec &lt;&lt; endl;</span></span><br><span class="line">    <span class="comment">// string mingwen1(decrypted_bytes.begin(), decrypted_bytes.begin() + original_len);</span></span><br><span class="line">    <span class="comment">// cout &lt;&lt; &quot;è§£å¯†åçš„æ˜æ–‡ï¼š&quot; &lt;&lt; mingwen1 &lt;&lt; endl;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://blog.csdn.net/qq_40279192/article/details/107292156?ops_request_misc=%257B%2522request%255Fid%2522%253A%252249495e8167f16de5ceab5baf35f292c3%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=49495e8167f16de5ceab5baf35f292c3&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-2-107292156-null-null.nonecase&amp;utm_term=DES&amp;spm=1018.2226.3001.4450">DES_CSDN</a>.</p>
<p><a href="https://blog.csdn.net/qq_40279192/article/details/107420773?ops_request_misc=%257B%2522request%255Fid%2522%253A%25226497a398d2e1887824cd06b0f7fd5bf2%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&amp;request_id=6497a398d2e1887824cd06b0f7fd5bf2&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-1-107420773-null-null.nonecase&amp;utm_term=IDEA&amp;spm=1018.2226.3001.4450">IDEA_CSDN</a>.</p>
<p><a href="https://github.com/xiaojinwayawa/IDEA#">IDEA_GitHub</a>.</p>
]]></content>
      <categories>
        <category>Learn</category>
      </categories>
      <tags>
        <tag>åŠ å¯†ç®—æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>zsh/oh_my_zsh</title>
    <url>/zsh-oh-my-zsh.html</url>
    <content><![CDATA[<!--more-->
<h1 id="zsh-oh-my-zshé…ç½®-debian-ubuntu"><a href="#zsh-oh-my-zshé…ç½®-debian-ubuntu" class="headerlink" title="zsh/oh_my_zshé…ç½®(debian/ubuntu)"></a>zsh/oh_my_zshé…ç½®(debian/ubuntu)</h1><p>å¦‚æœbashçš„è„šæœ¬å¼€å¤´æ˜¯ä»¥!#/bin/bashçš„è¯ï¼Œåœ¨zshä¸‹å®Œå…¨å…¼å®¹bash,å…¶ä½™çš„æˆ‘å°±ä¸çŸ¥é“é¸Ÿ  </p>
<blockquote>
<p> æ³¨æ„ä»¥ä¸‹æ‰€æœ‰æŒ‡ä»¤å‡åœ¨debianç³»ä¸‹è¿è¡Œ  </p>
</blockquote>
<h1 id="zsh"><a href="#zsh" class="headerlink" title="zsh"></a>zsh</h1><p>æŸ¥çœ‹shell</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">echo $SHELL</span><br></pre></td></tr></table></figure>
<p>å®‰è£…zsh</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install zsh</span><br></pre></td></tr></table></figure>
<p>è®¾ç½®é»˜è®¤shell</p>
<ul>
<li>ä¸ºsudoç”¨æˆ·è®¾ç½®</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo chsh -s /bin/zsh</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ä»¥ä¸ŠæŒ‡ä»¤ä¸èƒ½æ­£å¸¸è¿è¡Œæ—¶å¯ä»¥è¯•è¯•ä»¥ä¸‹æŒ‡ä»¤</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo chsh -s $(which zsh)</span><br></pre></td></tr></table></figure>
</blockquote>
<ul>
<li>ä¸ºç‰¹å®šç”¨æˆ·</li>
</ul>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo chsh -s /bin/zsh &lt;username&gt;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">&lt;username&gt; æ›¿æ¢ä¸ºå®é™…ç”¨æˆ·å</span></span><br></pre></td></tr></table></figure>
<h1 id="oh-my-zsh"><a href="#oh-my-zsh" class="headerlink" title="oh_my_zsh"></a>oh_my_zsh</h1><p>å®‰è£…git</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install git</span><br></pre></td></tr></table></figure>
<p>è‡ªåŠ¨å®‰è£…</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sh -c &quot;$(wget https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -)&quot;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ç½‘ç»œä¸å¥½æ—¶å¯å°è¯•</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sh -c &quot;$(curl -fsSL https://gitee.com/leok77s/ohmyzsh-gitee/raw/main/install.gitee.sh)&quot;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>ä¹Ÿå¯ä»¥æ‰‹åŠ¨è‡ªè¡Œå»githubä¸Šå…‹éš†å®‰è£…ï¼Œç„¶åå°†é…ç½®cpåˆ°è‡ªå·±çš„.zshrcä¸Š</p>
<ul>
<li><h3 id="è¿›é˜¶"><a href="#è¿›é˜¶" class="headerlink" title="è¿›é˜¶"></a>è¿›é˜¶</h3></li>
</ul>
<p>åŠŸèƒ½ä»‹ç»ï¼šä¼˜é›…ä¸»é¢˜ã€è‡ªåŠ¨è¡¥å…¨ã€è¯­æ³•é«˜äº®ã€escä¸¤æ¬¡ç­‰äºæ·»åŠ sudo</p>
<p><strong>ä¸»é¢˜</strong></p>
<p>ç¥–ä¼ powerlevel10kï¼Œ</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git clone --depth=1 https://gitee.com/romkatv/powerlevel10k.git $&#123;ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom&#125;/themes/powerlevel10k</span><br></pre></td></tr></table></figure>
<p>åœ¨<code>~/.zshrc</code>ä¸­é…ç½®<code>ZSH_THEME=&quot;powerlevel10k/powerlevel10k&quot;</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Set name of the theme to load --- <span class="keyword">if</span> <span class="built_in">set</span> to <span class="string">&quot;random&quot;</span>, it will</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">load a random theme each time Oh My Zsh is loaded, <span class="keyword">in</span> <span class="built_in">which</span> <span class="keyword">case</span>,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">to know <span class="built_in">which</span> specific one was loaded, run: <span class="built_in">echo</span> <span class="variable">$RANDOM_THEME</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">See https://github.com/ohmyzsh/ohmyzsh/wiki/Themes</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ZSH_THEME=<span class="string">&quot;robbyrussell&quot;</span></span></span><br><span class="line">ZSH_THEME=&quot;powerlevel10k/powerlevel10k&quot;</span><br></pre></td></tr></table></figure>
<p><code>source ~/.zshrc</code>ä¸€ä¸‹</p>
<p><strong>plus</strong></p>
<p>æ‰¾åˆ°pluginå†æ·»åŠ å¦‚ä¸‹é…ç½®ï¼ˆè¿˜å¯ä»¥è‡ªå·±è¡¥å……ï¼Œä¸è¿‡ä»¥ä¸‹ä¸‰æ¡è¶³ä»¥ï¼‰</p>
<p><strong>zsh-autosuggestion:</strong>:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git clone --depth=1 https://github.com/zsh-users/zsh-autosuggestions.git $&#123;ZSH_CUSTOM:-$&#123;ZSH:-~/.oh-my-zsh&#125;/custom&#125;/plugins/zsh-autosuggestions</span><br></pre></td></tr></table></figure>
<p><strong>zsh-syntax-highlighting</strong>:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git clone --depth=1 https://github.com/zsh-users/zsh-syntax-highlighting.git $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-syntax-highlighting</span><br></pre></td></tr></table></figure>
<p>ç¼–è¾‘<code>~/.zshrc</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Which plugins would you like to load?</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Standard plugins can be found <span class="keyword">in</span> <span class="variable">$ZSH</span>/plugins/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Custom plugins may be added to <span class="variable">$ZSH_CUSTOM</span>/plugins/</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Example format: plugins=(rails git textmate ruby lighthouse)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Add wisely, as too many plugins slow down shell startup.</span></span><br><span class="line">plugins=(</span><br><span class="line">        git</span><br><span class="line">        sudo</span><br><span class="line">        zsh-syntax-highlighting</span><br><span class="line">        zsh-autosuggestions</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>æœ€åè®°å¾—<code>source .zshrc</code>ï¼Œç„¶åä¼šè¿›å…¥ä¸»é¢˜çš„é…ç½®ç•Œé¢ï¼Œéå¸¸ç®€å•çš„äº¤äº’<br><img src="/zsh-oh-my-zsh/p1.png" alt><br>æœ€ç»ˆæ•ˆæœï¼Œç®€çº¦ï¼Œè¡¥å…¨ï¼ˆæ ¹æ®æœ€è¿‘å†å²è®°å½•)ï¼Œæ—¶é—´æ˜¾ç¤ºï¼ŒæŒ‰ä¸¤æ¬¡escå¯ä»¥ç›´æ¥sudo</p>
<blockquote>
<p>ç†Ÿç»ƒååœ¨æ–°è®¾å¤‡ä¸Šäº”åˆ†é’Ÿä¸åˆ°å°±OKï¼Œå¦‚æœä½ å‘ç°æ€ä¹ˆéƒ½æ²¡åŠæ³•æŠŠzshè°ƒæˆé»˜è®¤shellï¼Œä¸å¦¨è¯•ä¸€ä¸‹é‡å¯ï¼Œè¡€å‹é£™å‡ï¼</p>
</blockquote>
<h1 id="å‚è€ƒæ•™ç¨‹"><a href="#å‚è€ƒæ•™ç¨‹" class="headerlink" title="å‚è€ƒæ•™ç¨‹"></a>å‚è€ƒæ•™ç¨‹</h1><p><a href="https://ohmyz.sh/">oh_my_zshå®˜ç½‘</a></p>
<p><a href="https://sysin.org/blog/linux-zsh/">sysin</a></p>
<p><a href="https://www.zhihu.com/question/33277508">çŸ¥ä¹_theme</a></p>
]]></content>
      <categories>
        <category>Learn</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>zsh/oh_my_zsh</tag>
      </tags>
  </entry>
  <entry>
    <title>Linuxåˆ†å¸ƒå¼é›†ç¾¤</title>
    <url>/Linux%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4.html</url>
    <content><![CDATA[<!--more-->
<h1 id="Linuxåˆ†å¸ƒå¼é›†ç¾¤æ­å»º"><a href="#Linuxåˆ†å¸ƒå¼é›†ç¾¤æ­å»º" class="headerlink" title="Linuxåˆ†å¸ƒå¼é›†ç¾¤æ­å»º"></a>Linuxåˆ†å¸ƒå¼é›†ç¾¤æ­å»º</h1><p>ç›®å‰å·²ç»å®Œæˆlinxuå±‚é¢çš„é›†ç¾¤åŸºç¡€ï¼ˆç½‘ç»œ/ä¸»æœºå/SSH/æ—¶é’Ÿ/ç»Ÿä¸€ç”¨æˆ·/JDKï¼‰ï¼Œä¸ºåç»­çš„Hadoopéƒ¨ç½²å¥ å®šåŸºç¡€ã€‚</p>
<p>ç›®å‰èŠ‚ç‚¹ï¼š</p>
<ul>
<li><code>debian-master</code>ï¼š192.168.122.166 (debian13)</li>
<li><code>debian-slave1</code>ï¼š192.168.122.112 (debian13)</li>
</ul>
<p>è™šæ‹ŸåŒ–ä¸ç½‘ç»œï¼šKVM/QEMUï¼Œ<code>default:NAT(virbr0)</code>,ç½‘æ®µ<code>192.168.122.0/24</code></p>
<p><img src="/Linux%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4/KVM.png" alt></p>
<h2 id="å›ºå®šä¸»æœºåä¸ä¸»æœºåè§£æ"><a href="#å›ºå®šä¸»æœºåä¸ä¸»æœºåè§£æ" class="headerlink" title="å›ºå®šä¸»æœºåä¸ä¸»æœºåè§£æ"></a>å›ºå®šä¸»æœºåä¸ä¸»æœºåè§£æ</h2><p><code>hostnamectl set-hostname debian-master / debian-slave1</code></p>
<p>ä¸¤æœº<code>/etc/hosts</code>ç›¸äº’åŠ å…¥ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">192.168.122.166  debian-master</span><br><span class="line">192.168.122.112  debian-slave1</span><br></pre></td></tr></table></figure>
<p><img src="/Linux%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4/slave1.png" alt></p>
<p><img src="/Linux%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4/master.png" alt></p>
<p>éªŒè¯<code>ping debian-master / debian-slave1</code>å‡æˆåŠŸ</p>
<h2 id="SSHäº’ä¿¡"><a href="#SSHäº’ä¿¡" class="headerlink" title="SSHäº’ä¿¡"></a>SSHäº’ä¿¡</h2><p>åœ¨ master ä¸Šä¸ºç™»å½• slave1 çš„è´¦æˆ· <strong>jiangshun</strong> åˆ†å‘å¯†é’¥ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa -b 4096</span><br><span class="line">ssh-copy-id jiangshun@debian-slave1</span><br></pre></td></tr></table></figure>
<p><strong>éªŒè¯</strong>ï¼š<code>ssh jiangshun@debian-slave1</code> æˆåŠŸç™»å½•</p>
<blockquote>
<p>å½“copyå¤±è´¥æˆ–sshç™»é™†å¤±è´¥æ—¶ï¼Œå¯ä»¥è¯•ä¸€ä¸‹è°ƒæ•´æ“ä½œæƒé™<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># master:</span><br><span class="line">chmod 700 ~/.ssh</span><br><span class="line">chmod 644 ~/.ssh/known_hosts</span><br><span class="line"></span><br><span class="line"># slave:</span><br><span class="line">mkdir -p ~/.ssh</span><br><span class="line">chmod 700 ~/.ssh</span><br><span class="line">touch ~/.ssh/authorized_keys</span><br><span class="line">chmod 600 ~/.ssh/authorized_keys</span><br><span class="line">chown -R &lt;username&gt;:&lt;username&gt; ~/.ssh</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>åœ¨AIå»ºè®®ä¸‹ï¼Œæˆ‘ç»Ÿä¸€äº†é›†ç¾¤ç”¨æˆ·ä¸ç›®å½•ï¼Œå³ä¸¤æœºåˆ›å»ºç›¸åŒè¿è¡Œè´¦æˆ·ï¼ˆhadoopï¼‰</p>
<p><img src="/Linux%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4/hadoop.png" alt></p>
<h3 id="ç»Ÿä¸€é›†ç¾¤åçš„SSHäº’ä¿¡"><a href="#ç»Ÿä¸€é›†ç¾¤åçš„SSHäº’ä¿¡" class="headerlink" title="ç»Ÿä¸€é›†ç¾¤åçš„SSHäº’ä¿¡"></a>ç»Ÿä¸€é›†ç¾¤åçš„SSHäº’ä¿¡</h3><p><img src="/Linux%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4/hadoop_ssh.png" alt></p>
<h2 id="æ—¶é—´åŒæ­¥ï¼ˆchronyï¼‰"><a href="#æ—¶é—´åŒæ­¥ï¼ˆchronyï¼‰" class="headerlink" title="æ—¶é—´åŒæ­¥ï¼ˆchronyï¼‰"></a>æ—¶é—´åŒæ­¥ï¼ˆchronyï¼‰</h2><p>Master <code>/etc/chrony/chrony.conf</code>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">allow 192.168.122.0/24</span><br><span class="line">local stratum 10</span><br></pre></td></tr></table></figure>
<p>Slave1 <code>/etc/chrony/chrony.conf</code>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">server debian-master iburst</span><br></pre></td></tr></table></figure>
<p><strong>éªŒè¯</strong>ï¼š<code>chronyc sources</code> å¯è§ <code>debian-master</code> ä¸ºæ—¶é—´æºï¼Œè¾“å‡ºæ˜¾ç¤ºåŒæ­¥æˆåŠŸ</p>
<p><img src="/Linux%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4/time.png" alt></p>
<h2 id="JDKå®‰è£…ä¸ç¯å¢ƒå˜é‡"><a href="#JDKå®‰è£…ä¸ç¯å¢ƒå˜é‡" class="headerlink" title="JDKå®‰è£…ä¸ç¯å¢ƒå˜é‡"></a>JDKå®‰è£…ä¸ç¯å¢ƒå˜é‡</h2><p>å®‰è£…ï¼š<code>sudo apt install openjdk-21-jdk</code></p>
<p>ä¸¤æœº <code>hadoop</code> ç”¨æˆ· <code>~/.bashrc</code> æ·»åŠ ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">export JAVA_HOME=/usr/lib/jvm/java-21-openjdk-amd64</span><br><span class="line">export HADOOP_HOME=/opt/hadoop</span><br><span class="line">export HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoop</span><br><span class="line">export PATH=$JAVA_HOME/bin:$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$PATH</span><br></pre></td></tr></table></figure>
<p><strong>éªŒè¯</strong>ï¼š<code>java -version</code>ã€<code>echo $JAVA_HOME</code> æ­£å¸¸</p>
<h2 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h2><h3 id="å¦‚ä½•å°†ç”¨æˆ·åŠ å…¥sudoersï¼š"><a href="#å¦‚ä½•å°†ç”¨æˆ·åŠ å…¥sudoersï¼š" class="headerlink" title="å¦‚ä½•å°†ç”¨æˆ·åŠ å…¥sudoersï¼š"></a>å¦‚ä½•å°†ç”¨æˆ·åŠ å…¥sudoersï¼š</h3><blockquote>
<p>å…ˆ<code>su -</code>è¿›rootï¼Œå†<code>visudo</code>è¿›å»ï¼Œæ·»åŠ <code>Username  ALL=(ALL:ALL) ALL</code></p>
</blockquote>
<h3 id="å¦‚ä½•å›ºå®šIP"><a href="#å¦‚ä½•å›ºå®šIP" class="headerlink" title="å¦‚ä½•å›ºå®šIP"></a>å¦‚ä½•å›ºå®šIP</h3><p>å›ºå®šIPå‚è€ƒ<a href="https://www.cnblogs.com/Ai-Hen-Jiao-zhi/p/11339867.html">åšå®¢å›­</a></p>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://www.cnblogs.com/Ai-Hen-Jiao-zhi/p/11339867.html">debianå›ºå®šIP</a></p>
<p><a href="https://www.runoob.com/linux/linux-vim.html">vimè¿›é˜¶æŒ‡ä»¤</a></p>
<p><a href="https://www.debian.org/CD/netinst/">ISOæº</a></p>
]]></content>
      <categories>
        <category>Learn</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Bodyguard</title>
    <url>/Bodyguard.html</url>
    <content><![CDATA[<!--more-->
<p>æœ¬æ–‡çš„ä¸»è§’å¤§å«-é‚¦å¾·ï¼Œä¸€åå†›äººã€ä¸€åè­¦å¯Ÿã€ä¸€ä½ä¸ˆå¤«ã€ä¸€ä½çˆ¶äº²ï¼Œåœ¨å‰§ä¸­ä¸€å¼€å§‹å°±å±•ç¤ºäº†å¼‚äºå¸¸äººçš„æ´å¯ŸåŠ›ä¸å…±æƒ…åŠ›ï¼Œä»¥åŠåº”å¯¹çªå‘æƒ…å†µçš„ä¸“ä¸šç´ å…»ï¼Œæˆ‘æ·±æ·±åœ°è¢«è¿™ä¸€ä½æŸ”æƒ…ç¡¬æ±‰æ‰“åŠ¨ã€‚ç„¶è€Œï¼Œè¿™æ ·ä¸€ä½å¯ä»¥è¯´æ˜¯é€šæƒ…è¾¾ç†çš„äººï¼Œå±…ç„¶å’Œå¦»å­å¤„äºåˆ†å±…çŠ¶æ€ï¼Œè¿™ä¹Ÿè®©æˆ‘å¯¹é‚¦å¾·çš„èº«ä¸–ç»å†å……æ»¡äº†å¥½å¥‡ï¼Œä»–çœ‹èµ·æ¥å­¤ç‹¬ï¼Œå¿§éƒï¼Œç”šè‡³è¿˜æœ‰æŠ‘éƒç—‡ï¼Œå…¶å®è¿™å¹¶ä¸ä¸å…¶å¤–åœ¨çš„æ²‰ç€å½¢è±¡å†²çªï¼Œä»–çš„å¤–åœ¨å…¶å®ä¹Ÿæ˜¯çœŸå®çš„ä»–è‡ªå·±ï¼Œå› ä¸ºæœ‰æ—¶å€™æˆ‘ä»¬å®æ„¿çœŸå®åœ°é¢å¯¹ä»–äººï¼Œä¹Ÿä¸æ„¿å¦ç™½å¯¹å¾…è‡ªå·±ã€‚å¤§å«é‚¦å¾·çš„æ•…äº‹ä¹Ÿæ˜¯ä¸€åè´´èº«ä¿é•–çš„æ•…äº‹ï¼Œå› ä¸ºä»–çš„è‹±å‹‡ä¸¾åŠ¨éœ‡æƒŠå…¨è‹±ï¼Œå„ç•Œéƒ½é«˜åº¦å…³æ³¨è¿™æ ·ä¸€ä½èƒ½å¤Ÿè¯´æœè‡ªæ€ç‚¸å¼¹æºå¸¦è€…ä»¥ä¿æŠ¤å…¨åˆ—è½¦äººçš„è­¦å¯Ÿï¼Œå°¤å…¶æ˜¯æ”¿åºœé«˜å±‚ï¼Œå› æ­¤ï¼Œä»–è¢«æˆäºˆäº†ä¸€é¡¹ç‰¹æ®Šçš„ä»»åŠ¡ï¼Œæˆä¸ºå†…åŠ¡å¤§è‡£çš„è´´èº«ä¿é•–ï¼Œè€ŒçœŸæ­£çš„å¤§å«é‚¦å¾·ï¼Œå¼€å§‹é€æ¸æµ®ç°ã€‚</p>
<p>æœ€è®¨åŒå†…åŠ¡å¤§è‡£çš„äººåè€Œæˆä¸ºäº†å†…åŠ¡å¤§è‡£èº«è¾¹æœ€äº²è¿‘çš„äººã€‚å¤§å«é‚¦å¾·ä¸å†…åŠ¡å¤§è‡£æœ‰ç“œè‘›å—ï¼Œå½“ç„¶ï¼Œè°éƒ½ä¸ä¼šæ— ç¼˜æ— æ•…è®¨åŒä¸€ä¸ªç´ ä¸ç›¸è¯†çš„äººï¼Œå‰é¢æåˆ°å¤§å«é‚¦å¾·æ˜¯ä¸€åå†›äººï¼Œæ²¡é”™ï¼Œä»–æ›¾æ˜¯ä¸€åå†›äººï¼Œè¢«æ´¾å¾€é˜¿å¯Œæ±—å‚åŠ éæ­£ä¹‰çš„æˆ˜äº‰ï¼Œä¹Ÿå› æ­¤å¤§å«é‚¦å¾·å¤±å»äº†å¾ˆå¤šä½äº²å¯†çš„å…„å¼Ÿï¼Œè‡ªå·±ä¹Ÿå·®ç‚¹æ®’å‘½ï¼Œæœ€é‡è¦çš„æ˜¯å¤§å«é‚¦å¾·æ‚£ä¸Šäº†<a href="https://zh.wikipedia.org/wiki/%E5%89%B5%E5%82%B7%E5%BE%8C%E5%A3%93%E5%8A%9B%E7%97%87">åˆ›ä¼¤ååº”æ¿€éšœç¢</a>ï¼Œè€Œè¿™äº›å†›äººæœ‰ä¸€ä¸ªå…±åŒçš„æ•Œäººï¼Œé‚£å°±æ˜¯é‚£äº›è§†ä»–ä»¬ç”Ÿå‘½å¦‚è‡ªå·±æƒåŠ›ç‰ºç‰²å“çš„ã€ä¸æ„¿æ„äº²è‡ªç•™ä¸€æ»´è¡€çš„å†·è¡€çš„åŠ¿åŠ›çš„æ”¿å®¢ã€‚è€Œä¸å†…åŠ¡å¤§è‡£ç›¸é‡çš„å‰æœŸï¼Œå¥¹ä¸å‡ºæ„å¤–çš„ä½“ç°äº†å‡ºäº†æ‰€æœ‰ä»¤å¤§å«é‚¦å¾·å’Œä»–æˆ˜å‹æ‰€è®¨åŒçš„ç‰¹å¾ï¼Œå¹¶ä¸”å½“å¤§å«é‚¦å¾·äº²è‡ªé—®å¥¹æ‰€ä½œè¨€è®ºæ˜¯å¦å±å®æ—¶ï¼Œå†…åŠ¡å¤§è‡£å´è¯´ä¸ºäº†å¤§å±€å¥¹å¿…é¡»æœ‰æ‰€æŠ‰æ‹©ï¼Œè¿™å½»åº•æ¿€æ€’äº†å¤§å«é‚¦å¾·ã€‚å¤§å«é‚¦å¾·æœ‰æ— æ•°æ¬¡æƒ³äº²è‡ªäº†è§£è¿™ä½ä¸çŸ¥æ‚”æ”¹çš„æ”¿å®¢ï¼Œä½†æ˜¯å´åˆå‡ºäºèŒä¸šé“å¾·æ— æ•°æ¬¡æ‹¯æ•‘å†…åŠ¡å¤§è‡£ï¼Œç”šè‡³åœ¨ä¸€åœºæš—æ€ä¸­ï¼Œå¤§å«ä¹Ÿâ€œæ€æ­»â€äº†èº«ä¸ºæˆ˜å‹çš„æ€æ‰‹ï¼Œè€Œé‚£åè‡ªæ€çš„æˆ˜å‹ï¼Œåœ¨æŸç§æ„ä¹‰ä¸Šï¼Œå°†æœªå®Œæˆçš„ä½¿å‘½åˆåŠ é‡åœ¨å¤§å«é‚¦å¾·èº«ä¸Šã€‚</p>
<p>ä¹Ÿè®¸æ˜¯ä¸€æ¬¡æ¬¡çš„ç”Ÿæ­»ä¸å…±ï¼Œåˆæˆ–è€…æ˜¯å­¤ç‹¬çµé­‚çš„ç›¸é‡ï¼Œå†…åŠ¡å¤§è‡£å’Œå¤§å«é‚¦å¾·åœ¨åŠ«åä½™ç”Ÿæ—¶ï¼Œç”¨èº«ä½“æŠšæ…°æƒŠé­‚ã€‚èµ·åˆæˆ‘åªæ˜¯è®¤ä¸ºå†…åŠ¡å¤§è‡£ä¸ºäº†è®©å¤§å«é‚¦å¾·å…¨å¿ƒå…¨æ„çš„ä¿æŠ¤è‡ªå·±äºæ˜¯ä¸Šæ¼”äº†ç¾äººè®¡ï¼ŒåŒæ—¶ä¹Ÿè®¤ä¸ºå¤§å«é‚¦å¾·ä¸ºäº†æ›´é è¿‘å†…åŠ¡å¤§è‡£é…åˆäº†è¿™åœºæ¼”å‡ºï¼Œä½†å†…åŠ¡å¤§è‡£å¯¹å¤§å«é‚¦å¾·çš„å­©å­ä»¬çš„å¸®åŠ©ï¼Œä»¥åŠå¤§å«é‚¦å¾·è™½å¸®åŠ©è‡ªå·±çš„ç›´å±ä¸Šå¸åˆ‡ç¡®å†…åŠ¡å¤§è‡£çš„æƒ…æŠ¥å´è£…ä½œä¸€æ— æ‰€è·ï¼Œè¿˜æœ‰å†…åŠ¡å¤§è‡£åœ¨æ¼”è®²æ—¶è¢«ç‚¸å¼¹è¢­å‡»æ®’å‘½åå¤§å«é‚¦å¾·çš„æ„¤æ€’ï¼Œéƒ½å‘æˆ‘ä¼ è¾¾å‡ºä¸€ä¸ªè®¯å·ï¼Œé‚£å°±æ˜¯ï¼Œä»–ä»¬åœ¨æŸç§æ„ä¹‰ä¸Šè¢«è¿æ¥åœ¨äº†ä¸€èµ·ï¼Œæ˜¯é‚£ç§äº¦æ•Œäº¦å‹çš„è€äººå¯»å‘³ï¼Œå› ä¸ºå¤§å«é‚¦å¾·è¿˜çˆ±ç€è‡ªå·±çš„åˆ†å±…å¦»å­ï¼Œä¸”æˆ‘ä¹Ÿå¾ˆéš¾æ¥å—è¿™ç§æç«¯æƒ…å½¢ä¸‹çš„çˆ±æƒ…ï¼Œå› æ­¤æˆ‘è®¤ä¸ºè¿™ä¸ç®—å¾—ä¸Šæ˜¯çˆ±æƒ…ï¼Œè€Œæ˜¯æ›´å€¾å‘äºå‰æ–‡æ‰€è¯´çš„ç›¸äº’æŠšæ…°ï¼Œå› ä¸ºä»–ä»¬ä¸€ä¸ªå¤„äºPTSDçš„ç¬¼ç½©ï¼Œä¸€ä¸ªç«™åœ¨æ”¿ç•Œçš„é£å£æµªå°–ï¼Œä¸¤äººå› ä¸ºä¸åŒçš„åŸå› ï¼Œéšæ—¶éƒ½æœ‰å¯èƒ½å¤±å»ç”Ÿå‘½ã€‚</p>
<p>åœ¨å†…åŠ¡å¤§è‡£æ­»åï¼Œæ•´ä¸ªå‰§é›†åªå‰©ä¸‹å¿«èŠ‚å¥çš„è¿½å‡¶ï¼Œæ‰“æ–—ä¸æ¨ç†åè½¬ï¼Œè¿™ä¹Ÿæ˜¯çœ‹çš„æœ€çˆ½çš„ä¸€éƒ¨åˆ†ï¼Œç„¶æˆ‘è¿‘ä¹å¿˜è®°äº†å¤–ç•Œæ—¶é—´çš„æµé€ï¼Œä½†èƒ½å›å¿†èµ·æ¥çš„æ‰€å‰©æ— å‡ ã€‚</p>
<p>åœ¨å¿˜æ‰ä¹‹å‰ï¼Œæˆ‘å¿…é¡»é¦–å…ˆæåŠæˆ‘å½±å“æœ€æ·±åˆ»çš„å‡ ä¸ªè§’è‰²ï¼Œåˆæˆ–è€…è¯´ï¼Œå‰§é›†ä¸­å¯¹æ¯ä¸ªäººç‰©å‡ ä¹éƒ½æœ‰ä¸¤é¢å¡‘é€ ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬æœ€èƒ½å¼•èµ·å…±é¸£çš„åœ°æ–¹ï¼Œæ¯ä¸ªäººæ˜¯å–„ä¹Ÿæ˜¯æ¶ï¼Œæœ‰å†²åŠ¨ä¹Ÿæœ‰å†·é™ï¼Œæˆ‘çœ‹åˆ°äº†æ¯ä¸ªè§’è‰²çš„ç‹¬æœ‰é­…åŠ›ï¼Œè­¦å¯Ÿã€ä¼´ä¾£ã€åŒäº‹ã€æœ‹å‹ã€ä¸Šçº§ã€ä¸Šçº§ä¹‹ä¸Šçº§ã€‚è€Œå¤§å«é‚¦å¾·ä¹‹æ‰€æ‚£äº†PTSDè¿˜èƒ½ç»§ç»­å½“è­¦å¯Ÿç”šè‡³æ˜¯è´´èº«ä¿é•–ï¼Œæ˜¯å› ä¸ºä»–å¯¹åˆ«äººéšç’äº†ç—…æƒ…ï¼Œåªæœ‰æœ€äº²è¿‘çš„äººï¼Œä¹Ÿå°±æ˜¯æˆ˜å‹å’Œå¦»å­çŸ¥é“ï¼Œè€Œå½“æœ€åå¤§å«é‚¦å¾·æ”¾ä¸‹äº†ä¹”è£…çš„åšå¼ºï¼Œå‘å¿ƒç†åŒ»ç”Ÿè¢’éœ²è‡ªå·±çš„è„†å¼±åï¼Œæˆ‘ä»¬ä¾æ—§èƒ½å¤Ÿè¢«é‡å½’äºå¥½çš„å¤§å«é‚¦å¾·å’Œå…¶å¦»å­è–‡çªçš„å¹¸ç¦ä¸€å®¶æ‰€æ¸©æš–ã€‚æ˜¯å•Šï¼ŒåŸæ¥æ¥å—æ²»ç–—ï¼Œæ‰“å¼€å¿ƒæ‰‰å°±èƒ½å›å½’æ­£å¸¸ç”Ÿæ´»ï¼Œå°±å‰©æ„Ÿå—æœ€å¹³å‡¡çš„å¿«ä¹ï¼Œä½†æ˜¯ï¼Œæœ‰äº›æ—¶å€™ï¼Œéš¾çš„ä¸æ˜¯æ²»ç–—ï¼Œè€Œæ˜¯æ¥å—æ²»ç–—ï¼Œéš¾çš„ä¸æ˜¯ç°çŠ¶ï¼Œè€Œæ˜¯æ¥å—ç°çŠ¶ï¼Œæˆ‘æƒ³ï¼Œä¸å‘æœ‹å‹æ©ç›–ï¼Œä¸å¯¹å®¶äººä¼ªè£…ï¼ŒçœŸå®çš„è¡¨è¾¾è‡ªå·±ï¼Œè¡¨è¾¾è¯‰æ±‚ï¼Œä¸è¦å®³æ€•çª˜è¿«ï¼Œæ‡‚ä½ çš„äººä¸ä¼šè®©ä½ éš¾å ªï¼Œæ‰€è°“æ‡‚ä½ çš„äººæ— éœ€å¤šè¨€ï¼Œä¸æ‡‚çš„äººä½•å¿…å¤šè¨€ï¼Œæ¥å—ä½ çœŸå®å‘ä¸–ç•Œè¡¨è¾¾åçš„æ‰€æœ‰ç»“æœã€‚</p>
]]></content>
      <categories>
        <category>Daily</category>
      </categories>
      <tags>
        <tag>something</tag>
      </tags>
  </entry>
  <entry>
    <title>Git_for_Android-Studio</title>
    <url>/Git-for-Android-Studio.html</url>
    <content><![CDATA[<!--more-->
<h1 id="ç†Ÿæ‚‰Git"><a href="#ç†Ÿæ‚‰Git" class="headerlink" title="ç†Ÿæ‚‰Git"></a>ç†Ÿæ‚‰Git</h1><p><code>Git</code>æ˜¯å½“ä»Šæœ€å¹¿æ³›åº”ç”¨ä¸”åŠŸèƒ½å¼ºå¤§ã€çµæ´»çš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚å®ƒçš„æœ€å¤§ä¼˜åŠ¿åœ¨äºæ¯ä½å¼€å‘è€…æœ¬åœ°å‡æ‹¥æœ‰å®Œæ•´çš„ç‰ˆæœ¬å†å²ï¼Œå³ä½¿åœ¨è„±æœºçŠ¶æ€ä¸‹ä¹Ÿèƒ½å®Œæˆå¤§éƒ¨åˆ†æ“ä½œï¼Œè¿™ä½¿å¾—å¤šäººåä½œå’Œä»£ç åˆå¹¶å˜å¾—æ›´åŠ é«˜æ•ˆå’Œä¾¿æ·ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œé›†ä¸­å¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¾èµ–ä¸­å¤®æœåŠ¡å™¨ï¼Œå®¹æ˜“å—åˆ°å•ç‚¹æ•…éšœçš„å½±å“ã€‚è™½ç„¶åœ¨ç®¡ç†å¤§å‹äºŒè¿›åˆ¶æ–‡ä»¶æˆ–æŸäº›ç‰¹æ®Šåœºæ™¯ä¸‹å¯èƒ½éœ€è¦è¾…ä»¥å…¶ä»–å·¥å…·ï¼Œä½† Git çš„è¿™äº›æ˜¾è‘—ä¼˜åŠ¿æ­£æ˜¯æˆ‘ä»¬å­¦ä¹ å’Œä½¿ç”¨å®ƒçš„é‡è¦åŸå› ã€‚</p>
<!--more-->
<h1 id="é…ç½®Git"><a href="#é…ç½®Git" class="headerlink" title="é…ç½®Git"></a>é…ç½®Git</h1><p>å…ˆä¸‹è½½Gitï¼Œä¹‹åçš„å‘½ä»¤å¯ä»¥åœ¨ä»»ä½•bashä¸­è¿è¡Œ</p>
<p><code>Github</code>åŸºäºwebçš„ç‰ˆæœ¬æ§åˆ¶ç•Œé¢ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥åœ¨ä¸Šé¢éƒ¨ç½²é¡¹ç›®ï¼Œæ˜¯ä½¿ç”¨<code>git</code>çš„ä¸€å¤§åˆ©å™¨ï¼Œæˆ‘ä»¬è¦æŠŠ<code>Android Studio</code>ä¸Šçš„é¡¹ç›®è¿›è¡Œ<code>git</code>ç®¡ç†ï¼Œé¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ª<code>Github</code>è´¦å·ï¼ˆèƒ½è¿›è¡Œç‰ˆæœ¬æ§åˆ¶çš„ä¸æ­¢æœ‰<code>Github</code>, è¿˜æœ‰<code>Gitee</code>ç­‰ç­‰ï¼‰ã€‚</p>
<p>è¿›è¡Œgitè´¦å·çš„é…ç½®ï¼Œä»¥å‘Šè¯‰<code>git</code>æ˜¯è°åœ¨å¯¹<code>git</code>è¿›è¡Œæ“ä½œä»¥åŠä»¥å<code>git</code>çš„æ“ä½œå¯¹è±¡ã€‚</p>
<p>ä»¥ä¸‹ä¸¤æ¡æŒ‡ä»¤çš„å‚æ•°å¡«ä¹‹å‰åœ¨<code>Github</code>æ³¨å†Œçš„è´¦å·ä¿¡æ¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// --global å‚æ•°è¡¨ç¤ºè¯¥é…ç½®ä¸ºå…¨å±€é…ç½®ï¼Œé€‚ç”¨äºè¯¥ç”¨æˆ·çš„æ‰€æœ‰ Git ä»“åº“</span><br><span class="line">git config --global user.name &quot;Your Name&quot;</span><br><span class="line">git config --global user.email &quot;email@example.com&quot;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸‹ä¸¤æ¡æŒ‡ä»¤ç”¨äºæŸ¥è¯¢å½“å‰<code>git</code>ç»‘å®šçš„è´¦å·ä¿¡æ¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config user.name</span><br><span class="line">git config user.email</span><br></pre></td></tr></table></figure>
<p>ç¡®è®¤æ— è¯¯ä¹‹åå°±è¿›è¡Œç»‘å®šçš„æœ€åä¸€æ­¥ï¼Œåˆ›å»º<code>SSH</code>è¿æ¥ï¼Œæ–¹ä¾¿æœ¬åœ°<code>git</code>èƒ½ç›´æ¥å¯¹æ¥åˆ°<code>Github</code>ä»¥è¿›è¡Œæ“ä½œ</p>
<p>åœ¨æœ¬åœ°ç”Ÿæˆå¯†é’¥å’Œå…¬é’¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;xxx@xxx.com&quot;</span><br></pre></td></tr></table></figure>
<p>è·å–ç”Ÿæˆçš„å…¬é’¥ï¼ˆ<code>id_rsa.pub</code>ï¼‰ååœ¨<code>Github</code>ä¸Šåˆ›å»º<code>SSHKey</code>ï¼ˆä¸å¤ªç†Ÿæ‚‰çš„å¯ä»¥åœ¨ç½‘ä¸Šæœ<code>Github SSHé…ç½®</code>, ä¹Ÿå¯ä»¥ç›´æ¥çœ‹æˆ‘æ‰¾å¥½çš„æ•™ç¨‹ <a href="https://blog.csdn.net/weixin_42310154/article/details/118340458">é…ç½®SSHæ•™ç¨‹</a>ï¼Œ ä¼šäº†ä¸€æ¬¡ä¹‹åå°±ç†Ÿæ‚‰äº†ï¼‰</p>
<p>éªŒè¯æ˜¯å¦æˆåŠŸ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure>
<p>å‡†å¤‡å·¥ä½œå…¨éƒ¨å®Œæ•´ï¼Œæ¥ä¸‹æ¥å‡ æ¡ç®€å•å°±ä»¤å°±èƒ½è½»æ¾å®Œæˆé¡¹ç›®å’Œä»“åº“çš„ç»‘å®š</p>
<p>ä»ç°åœ¨å¼€å§‹çš„æŒ‡ä»¤åœ¨Android Studioä¸­çš„ç»ˆç«¯è¿è¡Œ<img src="/Git-for-Android-Studio/git1.png" alt="git1"><br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git init</span><br></pre></td></tr></table></figure></p>
<p>åœ¨<code>Github</code>ä¸­åˆ›å»ºä¸€ä¸ªä»“åº“ï¼ˆ<code>repository</code>ï¼‰ï¼Œå‘½åéšæ„ï¼Œå¤åˆ¶å…¶SSHï¼ˆæ³¨æ„ä¸ä¹‹å‰çš„SSHåšåŒºåˆ†ï¼‰</p>
<p>æ·»åŠ è¿œç¨‹åº“ï¼ˆä¹Ÿå°±æ˜¯å°†è¿™ä¸ªæ–°åˆ›å»ºçš„ä»“åº“ä½œä¸º<code>git</code>ç‰ˆæœ¬ç®¡ç†çš„å­˜å‚¨åº“ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git remote add origin &lt;åˆšæ‰è®©å¤åˆ¶çš„SSH&gt;</span><br></pre></td></tr></table></figure>
<p>æ¨é€å‰å…ˆå°†æ›´æ”¹ï¼ˆéƒ¨ç½²<code>git</code>å‰çš„æ‰€æœ‰ä»£ç ï¼‰æ·»åŠ åˆ°æš‚å­˜åŒºå¹¶ä¸”æäº¤æ›´æ”¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m &#x27;init git for Android Studio&#x27;</span><br></pre></td></tr></table></figure>
<p>ç„¶åè¿›è¡Œç¬¬ä¸€æ¬¡æ¨é€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git push -u origin main</span><br></pre></td></tr></table></figure>
<p>ä¹‹åæ¯æ¬¡è¿›è¡Œä¿®æ”¹åè¿è¡Œ<code>git push</code>å³å¯å®Œæˆæ¨é€</p>
<p>ç°åœ¨å¯å»åˆšåˆšåˆ›å»ºçš„ä»“åº“é‡Œçœ‹çœ‹æ˜¯å¦æœ‰ä¸€å †æ–‡ä»¶ä¸Šä¼ äº†ï¼Œè¿™äº›æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªç‰ˆæœ¬ï¼Œä¹‹åçš„æ¯æ¬¡pushéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œç‰ˆæœ¬å¯ä»¥è¿›è¡Œå„ç§æ“ä½œï¼Œå¦‚åˆ†æ”¯ç®¡ç†ã€ç‰ˆæœ¬å›é€€ã€åˆå¹¶ç­‰ã€‚</p>
<h1 id="ç®¡ç†Git"><a href="#ç®¡ç†Git" class="headerlink" title="ç®¡ç†Git"></a>ç®¡ç†Git</h1><p>ä¹‹åæ­£å¸¸çš„ç‰ˆæœ¬ç®¡ç†å°±éå¸¸è½»æ¾äº†ï¼Œ<code>git</code>æ˜¯ç”¨æ¥æ–¹ä¾¿ç®¡ç†çš„ï¼Œæ²¡æœ‰é‚£ä¹ˆå¤æ‚ï¼Œæ˜¯ä¸€ä¸ªéå¸¸å¥½ç”¨çš„å·¥å…·ï¼Œå› æ­¤éœ€è¦æŒæ¡ä¸€äº›å¸¸è§çš„æŒ‡ä»¤å’ŒåŸç†ã€‚</p>
<p>å¯å‚è§å¤§ä½¬çš„åšå®¢<a href="https://liaoxuefeng.com/books/git/introduction/index.html">å»–é›ªå³°</a>å’Œæˆ‘åšçš„ä¸€äº›é€Ÿè®°<a href="https://baoziwan.icu/learngit.html">å°ç«™</a></p>
<p>æœ€åï¼Œç»™è¯¥é¡¹ç›®åˆ›å»ºä¸€ä¸ª<code>README</code>æ–‡ä»¶ï¼Œç”¨äºä»‹ç»è¿™ä¸ªé¡¹ç›®æˆ–è€…è¯´ä»“åº“</p>
<p>å¯ç›´æ¥åœ¨<code>Github</code>çš„ä»“åº“ä¸‹ç‚¹å‡»<code>Add a README</code>å¿«é€Ÿåˆ›å»ºï¼Œä¹Ÿå¯åœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ª<code>README.md</code>æ–‡ä»¶åè¿›è¡Œç¼–è¾‘å†<code>git push</code>ä¸Š<code>Github</code></p>
<p><img src="/Git-for-Android-Studio/gi2.png" alt="gi2"></p>
<p>ç»“æœç¤ºä¾‹</p>
<p><img src="/Git-for-Android-Studio/git3.png" alt="git3"></p>
<h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><p><a href="https://liaoxuefeng.com/books/git/introduction/index.html">å»–é›ªå³°</a><br><a href="https://blog.csdn.net/weixin_42310154/article/details/118340458">é…ç½®SSHæ•™ç¨‹</a><br><a href="https://baoziwan.icu/learngit.html">è‡ªå®¶å°ç«™</a></p>
]]></content>
      <categories>
        <category>Learn</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>cycle</title>
    <url>/cycle.html</url>
    <content><![CDATA[<!--more-->
<h1 id="é“è…šè¡Œ"><a href="#é“è…šè¡Œ" class="headerlink" title="é“è…šè¡Œ"></a>é“è…šè¡Œ</h1><h2 id="å·²å¤‡éª‘è¡Œè£…å¤‡"><a href="#å·²å¤‡éª‘è¡Œè£…å¤‡" class="headerlink" title="å·²å¤‡éª‘è¡Œè£…å¤‡"></a>å·²å¤‡éª‘è¡Œè£…å¤‡</h2><ul>
<li>è½¦</li>
</ul>
<p>å–œå¾·ç››RC200ï¼ˆ2025-2-11ï¼‰ <span class="price" data-price="1499"> 1499 ï¿¥</span></p>
<p><img src="/cycle/init1.png" alt="init1"></p>
<p>å–œå¾·èƒœAD300ï¼ˆ2025-12-25ï¼‰ <span class="price" data-price="2999"> 2999 ï¿¥</span></p>
<p>äºŒæ‰‹æ”¶è´­å¤§å­¦ç”Ÿä¹ä¹æ–°ğŸ˜</p>
<p><img src="/cycle/ad300.png" alt></p>
<ul>
<li>æŠ¤ç›®é•œï¼š</li>
</ul>
<p>åŒ¹å…‹æ—¥å¸¸ <span class="price" data-price="39"> 39 ï¿¥</span></p>
<ul>
<li>æ‰‹æœºæ”¯æ¶</li>
</ul>
<p>ROCKBROS <span class="price" data-price="29"> 29 ï¿¥</span></p>
<ul>
<li>å¤´ç›”</li>
</ul>
<p>GUB M5 Mipséª‘è¡Œå¤´ç›” <span class="price" data-price="239"> 239 ï¿¥</span></p>
<ul>
<li>æ‰‹å¥—</li>
</ul>
<p>VEIDOORN åŠæŒ‡ <span class="price" data-price="39"> 39 ï¿¥</span></p>
<ul>
<li>æ°´å£¶ + æ°´å£¶æ¶</li>
</ul>
<p>ROCKBROS <span class="price" data-price="35">`35ï¿¥</span></p>
<p>é“‚æœ—å°¼æ°´å£¶ <span class="price" data-price="23"> 23 ï¿¥</span></p>
<p>ç¢³çº¹ABSä¸€ä½“æˆå‹æ°´æ¯æ¶ <span class="price" data-price="16"> 16 ï¿¥</span></p>
<ul>
<li>å°¾ç¯</li>
</ul>
<p>ç¾åˆ©è¾¾æ™ºèƒ½æ„Ÿåº”åˆ¹è½¦ç¯ <span class="price" data-price="30"> 30 ï¿¥</span></p>
<hr>
<blockquote>
<p><strong>æ€»ä»·</strong>:  <span id="total-price">è®¡ç®—ä¸­â€¦</span></p>
</blockquote>
<h2 id="æ€»è¡Œç¨‹"><a href="#æ€»è¡Œç¨‹" class="headerlink" title="æ€»è¡Œç¨‹"></a>æ€»è¡Œç¨‹</h2><p>2025-03-01ä¹‹å‰ <span class="distance" data-distance="147"> 147 km</span></p>
<p>2025-03-01 <span class="distance" data-distance="150"> 150 km<br><img src="/cycle/lvdao1.png" alt="lvdao1"></span></p>
<p>2025-03-11 <span class="distance" data-distance="40"> 40 km<br><img src="/cycle/shouan1.jpg" alt="shouan1"></span></p>
<p>2025-03-15 <span class="distance" data-distance="13"> 13 km</span></p>
<p>2025-03-18 <span class="distance" data-distance="40"> 40 km</span></p>
<!-- ![shouan2](cycle/shouan2.jpg) -->
<p>2025-03-25 <span class="distance" data-distance="40"> 40 km</span></p>
<!-- ![shouan3](cycle/shouan3.jpg) -->
<p>2025-04-02 <span class="distance" data-distance="40"> 40 km</span></p>
<!-- ![shouan4](cycle/shouan4.jpg) -->
<p>2025-04-08 <span class="distance" data-distance="40"> 40 km</span></p>
<!-- ![shouan5](cycle/shouan5.jpg) -->
<p>2025-04-15 <span class="distance" data-distance="40"> 40 km</span></p>
<!-- ![shouan6](cycle/shouan6.jpg) -->
<p>2025-04-22 <span class="distance" data-distance="40"> 40 km</span></p>
<!-- ![shouan7](cycle/shouan7.jpg) -->
<p>2025-05-24 <span class="distance" data-distance="40"> 40 km<br>ç¬¬ä¸€æ¬¡å¤œéª‘ï¼Œæ²¡æœ‰å‰ç¯åªæœ‰å°¾ç¯ï¼Œéª‘çš„è¿˜æ˜¯ä¹¡é•‡è·¯ï¼Œä¼¸æ‰‹ä¸è§äº”æŒ‡çš„æˆ‘å®Œæˆäº†pb<br><img src="/cycle/shouan8.jpg" alt="shouan8"></span></p>
<p>2025-05-27 <span class="distance" data-distance="40"> 40 km</span></p>
<!-- ![shouan9](cycle/shouan9.jpg)
å’•å™œå’•å™œç‰›è‚‰é¢
<div style="text-align: center;">
  <video style="max-width: 90%;" controls>
    <source src="cycle/beef2.mp4" type="video/mp4">
    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ video æ ‡ç­¾ã€‚
  </video>
</div> -->
<!-- ![beefnoodle1](cycle/beefnoodle1.png) -->
<p>2025-05-29 <span class="distance" data-distance="40"> 40 km</span></p>
<!-- ![shouan10](cycle/shouan10.jpg) -->
<p>2025-05-30 <span class="distance" data-distance="40"> 40 km</span></p>
<!-- ![shouan11](cycle/shouan11.jpg) -->
<p>2025-06-05 <span class="distance" data-distance="50"> 50 km<br>è§£é”æ–°è·¯çº¿ï¼šåŒ—æ—</span></p>
<!-- ![shouan12_2](cycle/shouan12_2.png) -->
<p><img src="/cycle/shouan12_3.png" alt="shouan12_3"><br><img src="/cycle/shouan12_1.png" alt="shouan12_1"></p>
<p>2025-06-25 <span class="distance" data-distance="40"> 40 km</span></p>
<p>è§£æ”¾çš„æœŸæœ«ï¼Œä¹…è¿çš„éª‘è¡Œ</p>
<!-- ![shouan13](cycle/shouan13.png) -->
<p>2025-06-28 <span class="distance" data-distance="40"> 40 km</span></p>
<p>æœ€ç´¯çš„ä¸€é›†ï¼Œæ„Ÿè§‰æœŸæœ«çŠ¶æ€æ²¡æ¢å¤è¿‡æ¥</p>
<!-- ![shouan14](cycle/shouan14.png) -->
<p>2025-07-07 <span class="distance" data-distance="25"> 25 km</span></p>
<p>å›å®¶äº†ï¼Œç»•åŸ</p>
<p><img src="/cycle/dianjiang1.png" alt="dianjiang1"></p>
<p>2025-07-15 <span class="distance" data-distance="20"> 20 km</span></p>
<p>2025-07-17 <span class="distance" data-distance="20"> 20 km</span></p>
<p>2025-07-18 <span class="distance" data-distance="15"> 15 km</span></p>
<p>2025-07-24 <span class="distance" data-distance="20"> 20 km</span></p>
<p>2025-07-27 <span class="distance" data-distance="10"> 10 km</span></p>
<p>2025-07-28 <span class="distance" data-distance="20"> 20 km</span></p>
<p>2025-07-30 <span class="distance" data-distance="110"> 100 km<br>æœ€è‰°éš¾çš„ä¸€é›†ï¼Œæ¥è¿‘å››ååº¦çš„å¤©æ°”æš´æ™’å…«å°æ—¶ï¼ˆä¸ä¼šå†é¡¶ç€é«˜æ¸©å¾æˆ˜ç»¿é“äº†ï¼Œå·®ç‚¹æ²¡æ´»ç€å›æ¥ï¼‰</span></p>
<p>2025-08-02 <span class="distance" data-distance="40"> 40 km</span></p>
<p>2025-08-03 <span class="distance" data-distance="40"> 40 km<br>åŒæ’<br><img src="/cycle/shouan15.png" alt="shouan15"></span></p>
<p>2025-08-06 <span class="distance" data-distance="40"> 40 km</span></p>
<p>2025-08-09 <span class="distance" data-distance="40"> 40 km</span></p>
<p>2025-08-11 <span class="distance" data-distance="50"> 50 km</span></p>
<p>2025-08-13 <span class="distance" data-distance="50"> 50 km</span></p>
<p>2025-08-25 <span class="distance" data-distance="50"> 40 km</span></p>
<p>2025-08-29 <span class="distance" data-distance="40"> 40 km<br>é›¨éª‘çš„é­…åŠ›åœ¨äºï¼Œè¶Šéª‘è¶Šå†·â€¦</span></p>
<p>2025-08-31 <span class="distance" data-distance="40"> 40 km</span></p>
<p>2025-09-09 <span class="distance" data-distance="40"> 40 km</span></p>
<p>2025-09-13 <span class="distance" data-distance="40"> 40 km</span></p>
<blockquote>
<p><strong>æ€»è¡Œç¨‹</strong>: <span id="total-distance"> è®¡ç®—ä¸­â€¦</span></p>
</blockquote>
<hr>
<h2 id="è½¦"><a href="#è½¦" class="headerlink" title="è½¦"></a>è½¦</h2><p>2025-04-21 ç¬¬ä¸€æ¬¡æ‰èƒï¼Œæ‰åˆ°è½å¶é‡Œç”Ÿå‘½çš„ä½™éŸµäº†ğŸ”¥<br><img src="/cycle/cy1.jpg" alt="2"></p>
<p>2025-06-29 ç¬¬ä¸€æ¬¡æ‹†è½¦å¹¶è£…è½¦ï¼Œä¸€å®šè¦ç»å¸¸æ¾åŠ¨ä¸€äº›å…³é”®éƒ¨ä½çš„èºä¸ï¼Œä¸ç„¶ç”Ÿé”ˆäº†ä¼šå¡æ­»ï¼Œæ‹†ä¸‹æ¥çš„å‰è½®è¦æ”¾åœ¨é£ç›˜çš„å¦ä¸€ä¾§ï¼Œè½®è½´å·®ä¸å¤šå¯¹å‡†æ”¾ç«–æ¯æ¶çš„åœ°æ–¹ã€‚<br><img src="/cycle/offcar1.png" alt="offcar"></p>
<blockquote>
<p>ä¸€ä¸ªæœˆåé¡ºåˆ©è£…è½¦è¿”æ ¡â€¦</p>
</blockquote>
<p>2025-08-13 æ´—è½¦ï¼Œä¸Šæ²¹</p>
<script>
document.addEventListener("DOMContentLoaded", function () {
    let totalPrice = 0;
    document.querySelectorAll(".price").forEach(item => {
        totalPrice += parseFloat(item.getAttribute("data-price"));
    });
    document.getElementById("total-price").innerText = totalPrice.toFixed(2) + " ï¿¥";

    let totalDistance = 0;
    document.querySelectorAll(".distance").forEach(item => {
        totalDistance += parseFloat(item.getAttribute("data-distance"));
    });
    document.getElementById("total-distance").innerText = totalDistance + " km";
});
</script>
]]></content>
      <categories>
        <category>Daily</category>
      </categories>
      <tags>
        <tag>Bike</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo better</title>
    <url>/learnhexo.html</url>
    <content><![CDATA[<!--more-->
<h1 id="æ¥æ—¶è·¯"><a href="#æ¥æ—¶è·¯" class="headerlink" title="æ¥æ—¶è·¯"></a>æ¥æ—¶è·¯</h1><h2 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h2><h3 id="1ï¼šæ— æ³•åˆå§‹åŒ–"><a href="#1ï¼šæ— æ³•åˆå§‹åŒ–" class="headerlink" title="1ï¼šæ— æ³•åˆå§‹åŒ–"></a>1ï¼šæ— æ³•åˆå§‹åŒ–</h3><p>hexo init ï¼ˆblogï¼‰æ—¶å› ä¸ºä»£ç†æ— æ³•æ­£å¸¸åˆå§‹åŒ–å®Œæˆï¼Œä¿®æ”¹ä»£ç†åœ°å€ï¼Œä¾‹ï¼š<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config --global http.proxy http://127.0.0.1:7890</span><br><span class="line">git config --global https.proxy http://127.0.0.1:7890</span><br></pre></td></tr></table></figure><br>è¿™å°†å…è®¸ Git é€šè¿‡æœ¬åœ°ä»£ç†è¿›è¡Œè¿æ¥ã€‚å¦‚æœä¸å†éœ€è¦ä»£ç†ï¼Œæˆ–è€…æƒ³è¦æ¸…é™¤ä»£ç†è®¾ç½®ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config --global --unset http.proxy</span><br><span class="line">git config --global --unset https.proxy</span><br></pre></td></tr></table></figure>
<h3 id="2ï¼šnpmé€Ÿåº¦æ…¢"><a href="#2ï¼šnpmé€Ÿåº¦æ…¢" class="headerlink" title="2ï¼šnpmé€Ÿåº¦æ…¢"></a>2ï¼šnpmé€Ÿåº¦æ…¢</h3><p><a href="https://npmmirror.com/">æ·˜å®é•œåƒ</a></p>
<p><img src="/learnhexo/taobao1.png" alt="p1"></p>
<p>ä¹‹ååœ¨npmå‰åŠ ä¸ªc!</p>
<h2 id="å¸¸ç”¨æŒ‡ä»¤"><a href="#å¸¸ç”¨æŒ‡ä»¤" class="headerlink" title="å¸¸ç”¨æŒ‡ä»¤"></a>å¸¸ç”¨æŒ‡ä»¤</h2><h3 id="å»ºç«™å‰"><a href="#å»ºç«™å‰" class="headerlink" title="å»ºç«™å‰"></a>å»ºç«™å‰</h3><p>åœ¨gitbaseä¸­cdåˆ°åšå®¢æ–‡ä»¶å¤¹</p>
<p>ä¸‹è½½hexoæ¡†æ¶</p>
<h2 id><a href="#" class="headerlink" title></a><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure></h2><p>åˆå§‹åŒ–åšå®¢é¡¹ç›®ï¼ˆè‹¥å·²ç»åœ¨ä¸‹ä¸€çº§æ–‡ä»¶å¤¹ä¸­å¯ä¸åŠ folderï¼‰</p>
<h2 id="-1"><a href="#-1" class="headerlink" title></a><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo init [folder] </span><br></pre></td></tr></table></figure></h2><p>è¿›å…¥folder</p>
<p>å®‰è£…ä¾èµ–é¡¹</p>
<h2 id="-2"><a href="#-2" class="headerlink" title></a><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure></h2><p>ä¸‹è½½éƒ¨ç½²å™¨</p>
<h2 id="-3"><a href="#-3" class="headerlink" title></a><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure></h2><p>ä¹‹åå¯éšæ—¶éƒ¨ç½²åˆ°Githubä¸Š<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure></p>
<h3 id="å»ºç«™å"><a href="#å»ºç«™å" class="headerlink" title="å»ºç«™å"></a>å»ºç«™å</h3><p>new æ–°å»ºä¸€ç¯‡æ–‡ç« </p>
<p>-p è‡ªå®šä¹‰æ–‡ç« è·¯å¾„</p>
<p>-r å¦‚æœå­˜åœ¨åˆ™æ›¿æ¢</p>
<p>-s æ–‡ç« åˆ«å</p>
<h2 id="-4"><a href="#-4" class="headerlink" title></a><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo new [layout] &lt;title&gt;</span><br></pre></td></tr></table></figure></h2><p>clean æ¸…é™¤ç¼“å­˜æ–‡ä»¶ (db.json) å’Œå·²ç”Ÿæˆçš„é™æ€æ–‡ä»¶ (public)</p>
<h2 id="-5"><a href="#-5" class="headerlink" title></a><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo cl</span><br></pre></td></tr></table></figure></h2><p>generate ç”Ÿæˆé™æ€æ–‡ä»¶</p>
<h2 id="-6"><a href="#-6" class="headerlink" title></a><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure></h2><p>publish å‘å¸ƒè‰ç¨¿</p>
<h2 id="-7"><a href="#-7" class="headerlink" title></a><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo publish [layout] &lt;filename&gt;</span><br></pre></td></tr></table></figure></h2><p>server å¯åŠ¨æœåŠ¡å™¨</p>
<p>-p é‡è®¾ç«¯å£</p>
<p>-s åªä½¿ç”¨é™æ€æ–‡ä»¶</p>
<p>-l å¯ç”¨æ—¥å¿—</p>
<h2 id="-8"><a href="#-8" class="headerlink" title></a><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure></h2><p>deploy éƒ¨ç½²ç½‘ç«™</p>
<h2 id="-9"><a href="#-9" class="headerlink" title></a><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure></h2><p>render æ¸²æŸ“æ–‡ä»¶<br>-o output destination</p>
<h2 id="-10"><a href="#-10" class="headerlink" title></a><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo render &lt;file1&gt; [file2] ...</span><br></pre></td></tr></table></figure></h2><p>migrate ä»å…¶ä»–åšå®¢ç³»ç»Ÿè¿ç§»å†…å®¹</p>
<h2 id="-11"><a href="#-11" class="headerlink" title></a><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo migrate&lt;type&gt;</span><br></pre></td></tr></table></figure></h2><p>list åˆ—å‡ºæ‰€æœ‰è·¯ç”±</p>
<h2 id="-12"><a href="#-12" class="headerlink" title></a><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo list &lt;type&gt;</span><br></pre></td></tr></table></figure></h2><p>version æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯</p>
<h2 id="-13"><a href="#-13" class="headerlink" title></a><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo version</span><br></pre></td></tr></table></figure></h2><p>config åˆ—å‡ºç½‘ç«™çš„é…ç½®ï¼ˆ_config.ymlï¼‰ã€‚ å¦‚æœæŒ‡å®šäº† keyï¼Œåˆ™åªå±•ç¤ºé…ç½®ä¸­å¯¹åº” key çš„å€¼ï¼›å¦‚æœåŒæ—¶æŒ‡å®šäº† key å’Œ valueï¼Œåˆ™å°†é…ç½®ä¸­å¯¹åº”çš„ key çš„å€¼ä¿®æ”¹ä¸º valueã€‚<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo config [key] [value]</span><br></pre></td></tr></table></figure></p>
<p>æŸ¥çœ‹å·²ç»å®‰è£…çš„æ’ä»¶<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm ls --depth=0</span><br></pre></td></tr></table></figure></p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://dayuzy.com/">èµ„æ·±æŠ€æœ¯åšå®¢</a></p>
<p><a href="https://blog.csdn.net/cat_bayi/article/details/128725230">CSDNè‰¯å¿ƒæ•™å­¦</a></p>
<p><a href="https://mp.weixin.qq.com/s/GmTmhpkB0QmoHIL5bmXQGw">å°å²›ç å†œ</a></p>
<p><a href="https://hexo.io/zh-cn/">å®˜æ–¹æ–‡æ¡£</a></p>
]]></content>
      <categories>
        <category>Learn</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>Git better</title>
    <url>/learngit.html</url>
    <content><![CDATA[<!--more-->
<h1 id="Gitå¸¸ç”¨æŒ‡ä»¤"><a href="#Gitå¸¸ç”¨æŒ‡ä»¤" class="headerlink" title="Gitå¸¸ç”¨æŒ‡ä»¤"></a>Gitå¸¸ç”¨æŒ‡ä»¤</h1><ul>
<li>è‡ªæŠ¥å®¶é—¨</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config --global user.name &quot;Your Name&quot;</span><br><span class="line">git config --global user.email &quot;email@example.com&quot;</span><br></pre></td></tr></table></figure>
<ul>
<li>æŸ¥è¯¢å®¶é—¨</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config user.name</span><br><span class="line">git config user.email</span><br></pre></td></tr></table></figure>
<h2 id><a href="#" class="headerlink" title></a><!--more--></h2><p>åˆ›å»ºSSHè¿æ¥<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># åœ¨æœ¬åœ°ç”Ÿæˆå¯†é’¥å’Œå…¬é’¥</span><br><span class="line">ssh-keygen -t rsa -C &quot;xxx@xxx.com&quot;</span><br><span class="line"></span><br><span class="line">è·å–å…¬é’¥ï¼ˆid_rsa.pubï¼‰ååœ¨Githubä¸Šåˆ›å»ºSSHKey</span><br><span class="line"></span><br><span class="line">éªŒè¯æ˜¯å¦æˆåŠŸ</span><br><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure></p>
<hr>
<ul>
<li>pwd ç”¨äºæ˜¾ç¤ºå½“å‰ç›®å½•  </li>
</ul>
<p><code>$ pwd</code></p>
<hr>
<ul>
<li>init æŠŠå½“å‰ç›®å½•å˜æˆGitå¯ä»¥ç®¡ç†çš„ä»“åº“</li>
</ul>
<p><code>$ git init</code></p>
<hr>
<ul>
<li>la -ah ç”¨äºæŸ¥çœ‹éšè—çš„.gitç›®å½•</li>
</ul>
<p><code>$ ls -ah</code></p>
<hr>
<ul>
<li>add æŠŠæ–‡ä»¶æ·»åŠ åˆ°ä»“åº“</li>
</ul>
<p><code>$ git add &lt;file&gt;</code></p>
<hr>
<ul>
<li>commit æŠŠæ–‡ä»¶æäº¤åˆ°ä»“åº“</li>
</ul>
<p><code>$ git commit -m &lt;message&gt;</code></p>
<hr>
<ul>
<li>status æŸ¥çœ‹åº“çŠ¶æ€</li>
</ul>
<p><code>$ git status</code></p>
<hr>
<ul>
<li>dif æŸ¥çœ‹ä¿®æ”¹å†…å®¹</li>
</ul>
<p><code>$ git diff &lt;file&gt;</code></p>
<hr>
<ul>
<li>log æŸ¥çœ‹å†å²è®°å½•</li>
</ul>
<p><code>$ git log</code><br><code>$ git log --pretty=oneline</code></p>
<ul>
<li>reflog æŸ¥çœ‹æ¯ä¸€æ¬¡å‘½ä»¤</li>
</ul>
<p><code>$ git reflog</code></p>
<hr>
<ul>
<li>reset ç‰ˆæœ¬å›é€€</li>
</ul>
<p>â€”hardä¼šå›é€€åˆ°ä¸Šä¸ªç‰ˆæœ¬çš„å·²æäº¤çŠ¶æ€ï¼Œè€Œâ€”softä¼šå›é€€åˆ°ä¸Šä¸ªç‰ˆæœ¬çš„æœªæäº¤çŠ¶æ€ï¼Œâ€”mixedä¼šå›é€€åˆ°ä¸Šä¸ªç‰ˆæœ¬å·²æ·»åŠ ä½†æœªæäº¤çš„çŠ¶æ€.</p>
<p><code>$ git reset --hard HEAD~&lt;num&gt;</code><br><code>$ git reset --hard &lt;version&gt;</code></p>
<hr>
<ul>
<li>cat æŸ¥çœ‹å†…å®¹</li>
</ul>
<p><code>$ cat &lt;file&gt;</code></p>
<hr>
<ul>
<li>æ’¤é”€å·¥ä½œåŒºä¿®æ”¹</li>
</ul>
<p><code>$ git checkout -- &lt;file&gt;</code></p>
<ul>
<li>æ’¤é”€æš‚å­˜åŒºä¿®æ”¹</li>
</ul>
<p><code>$ git reset HEAD &lt;file&gt;</code></p>
<hr>
<ul>
<li>åˆ é™¤æ–‡ä»¶</li>
</ul>
<p><code>$ git rm &lt;file&gt;</code></p>
<hr>
<ul>
<li>æ·»åŠ è¿œç¨‹åº“</li>
</ul>
<p><code>$ git remote add origin git@github.com:&lt;yourname&gt;/learngit.git</code></p>
<ul>
<li>æ¨é€</li>
</ul>
<p><code>$ git push -u origin master</code></p>
<ul>
<li>æœ¬åœ°åšäº†æäº¤å</li>
</ul>
<p><code>$ git push origin master</code></p>
<ul>
<li>æŸ¥çœ‹è¿œç¨‹åº“ä¿¡æ¯</li>
</ul>
<p><code>$ git remote -v</code></p>
<ul>
<li>åˆ é™¤è¿œç¨‹åº“</li>
</ul>
<p><code>$ git remote rm &lt;name&gt;</code></p>
<hr>
<ul>
<li>å…‹éš†</li>
</ul>
<p><code>$ git clone git@github.com:&lt;name&gt;/gitskills.git</code></p>
<hr>
<ul>
<li>åˆ›å»ºå¹¶åˆ‡æ¢è‡³æ–°åˆ†æ”¯</li>
</ul>
<p><code>$ git checkout -b &lt;name&gt;</code><br><code>$ git switch -c &lt;name&gt;</code> </p>
<p>ç­‰åŒäº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ git branch dev</span><br><span class="line">$ git checkout dev</span><br></pre></td></tr></table></figure>
<p>æˆ–</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ git branch dev</span><br><span class="line">$ git switch master</span><br></pre></td></tr></table></figure>
<ul>
<li>æŸ¥çœ‹åˆ†æ”¯</li>
</ul>
<p><code>$ git branch</code></p>
<ul>
<li>åˆå¹¶åˆ†æ”¯</li>
</ul>
<p><code>$ git merge &lt;name&gt;</code></p>
<ul>
<li>åˆ é™¤åˆ†æ”¯</li>
</ul>
<p><code>$ git branch -d &lt;name&gt;</code></p>
<ul>
<li>å¼ºåˆ¶åˆ é™¤</li>
</ul>
<p><code>$ git branch -D &lt;name&gt;</code></p>
<ul>
<li><code>--no-ff</code>æ–¹å¼çš„<code>git merge</code></li>
</ul>
<p><code>$ git merge --no-ff -m &quot;merge with no-ff&quot; &lt;name&gt;</code></p>
<ul>
<li>stashå‚¨è—å·¥ä½œç°åœº</li>
</ul>
<p><code>$ git stash</code></p>
<ul>
<li>æŸ¥çœ‹</li>
</ul>
<p><code>$ git stash list</code></p>
<ul>
<li>æ¢å¤ç°åœº</li>
</ul>
<p>æ¢å¤å¹¶åˆ é™¤<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ git stash apply</span><br><span class="line">$ git stash drop</span><br></pre></td></tr></table></figure><br>æˆ–<br><code>$ git stash pop</code></p>
<ul>
<li>å¤åˆ¶ä¿®æ”¹</li>
</ul>
<p><code>$ git cherry-pick &lt;version&gt;</code></p>
<ul>
<li>æ¨é€å†²çªåæŠ“å–æ–‡ä»¶åˆ°æœ¬åœ°åˆå¹¶</li>
</ul>
<p><code>$ git pull</code></p>
<ul>
<li>å˜åŸº</li>
</ul>
<p><code>$ git rebase</code></p>
<hr>
<ul>
<li>æ‰“æ ‡ç­¾</li>
</ul>
<p><code>$ git tag &lt;tag&gt;</code><br><code>$ git tag &lt;tag&gt; &lt;version&gt;</code></p>
<p>è¿˜å¯ä»¥åˆ›å»ºå¸¦æœ‰è¯´æ˜çš„æ ‡ç­¾ï¼Œç”¨-aæŒ‡å®šæ ‡ç­¾åï¼Œ-mæŒ‡å®šè¯´æ˜æ–‡å­—ï¼š</p>
<p><code>$ git tag -a &lt;tag&gt; -m &quot;info&quot; &lt;version&gt;</code></p>
<ul>
<li>æŸ¥çœ‹æ ‡ç­¾</li>
</ul>
<p><code>$ git tag</code></p>
<ul>
<li>æŸ¥çœ‹æ ‡ç­¾å†…å®¹</li>
</ul>
<p><code>$ git show &lt;tag&gt;</code></p>
<ul>
<li>åˆ é™¤æ ‡ç­¾</li>
</ul>
<p><code>$ git tag -d &lt;tag&gt;</code></p>
<ul>
<li>æ¨é€æ ‡ç­¾</li>
</ul>
<p><code>$ git push origin &lt;tag&gt;</code><br><code>$ git push origin --tags</code></p>
<ul>
<li>åˆ é™¤è¿œç¨‹æ ‡ç­¾</li>
</ul>
<p>å…ˆåˆ é™¤æœ¬åœ°å†ï¼š<br><code>$ git push origin :refs/tags/&lt;tag&gt;</code></p>
<p>è¡¥å……</p>
<p><img src="/learngit/git1.png" alt="git1"></p>
<h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><p><a href="https://liaoxuefeng.com/">å»–é›ªå³°</a></p>
]]></content>
      <categories>
        <category>Learn</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
</search>
