<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"liujunhong2.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":true,"version":"8.22.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":"ture","style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="算法板子">
<meta property="og:type" content="article">
<meta property="og:title" content="algorithm">
<meta property="og:url" content="https://liujunhong2.github.io/algorithm.html">
<meta property="og:site_name" content="豹子湾2.0">
<meta property="og:description" content="算法板子">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-03-24T10:29:49.000Z">
<meta property="article:modified_time" content="2025-07-19T06:52:04.084Z">
<meta property="article:author" content="jiangshun">
<meta property="article:tag" content="algorithm">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://liujunhong2.github.io/algorithm.html">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://liujunhong2.github.io/algorithm.html","path":"algorithm.html","title":"algorithm"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>algorithm | 豹子湾2.0</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script>
<script>
window.MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']],
    displayMath: [['$$', '$$'], ['\\[', '\\]']],
    processEscapes: true,
    processEnvironments: true
  },
  options: {
    skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">豹子湾2.0</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">6</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">2</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">5</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AE%97%E6%B3%95%E6%B1%87%E6%80%BB"><span class="nav-number">1.</span> <span class="nav-text">算法汇总</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%97%E6%B3%95"><span class="nav-number">1.1.</span> <span class="nav-text">算法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BB%BA%E5%9B%BE"><span class="nav-number">1.1.1.</span> <span class="nav-text">建图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%BE%E6%9C%80%E7%9F%AD%E8%B7%AF"><span class="nav-number">1.1.2.</span> <span class="nav-text">图最短路</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Dijkstra%E7%AE%97%E6%B3%95"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">Dijkstra算法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%99%AE%E9%80%9A%E5%A0%86"><span class="nav-number">1.1.2.1.1.</span> <span class="nav-text">普通堆</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%8D%E5%90%91%E7%B4%A2%E5%BC%95%E5%A0%86"><span class="nav-number">1.1.2.1.2.</span> <span class="nav-text">反向索引堆</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B1%82%E6%9C%80%E7%9F%AD%E5%A5%87%E5%81%B6%E8%B7%AF%E5%BE%84"><span class="nav-number">1.1.2.1.3.</span> <span class="nav-text">求最短奇偶路径</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Floyd%E7%AE%97%E6%B3%95"><span class="nav-number">1.1.2.2.</span> <span class="nav-text">Floyd算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SPFA%EF%BC%88Shortest-Path-Faster-Algorithm%EF%BC%89%E7%AE%97%E6%B3%95"><span class="nav-number">1.1.2.3.</span> <span class="nav-text">SPFA（Shortest Path Faster Algorithm）算法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91"><span class="nav-number">1.1.3.</span> <span class="nav-text">最小生成树</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Kruskal%E7%AE%97%E6%B3%95"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">Kruskal算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Prim%E7%AE%97%E6%B3%95"><span class="nav-number">1.1.3.2.</span> <span class="nav-text">Prim算法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E5%8F%89%E6%A0%91"><span class="nav-number">1.1.4.</span> <span class="nav-text">二叉树</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%8F%8A%E5%85%88%E4%B8%AD%E5%BA%8F%E6%9E%84%E9%80%A0"><span class="nav-number">1.1.4.1.</span> <span class="nav-text">二叉树的序列化与反序列化及先中序构造</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A9%E7%94%A8%E5%85%88%E5%BA%8F%E5%92%8C%E4%B8%AD%E5%BA%8F%E6%9E%84%E9%80%A0%E4%BA%8C%E5%8F%89%E6%A0%91"><span class="nav-number">1.1.4.2.</span> <span class="nav-text">利用先序和中序构造二叉树</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E5%8F%89%E6%A0%91%E4%B8%ADLCA%E7%AE%97%E6%B3%95"><span class="nav-number">1.1.4.3.</span> <span class="nav-text">二叉树中LCA算法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84"><span class="nav-number">1.1.5.</span> <span class="nav-text">树状数组</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E7%BB%B4"><span class="nav-number">1.1.5.1.</span> <span class="nav-text">一维</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8D%95%E7%82%B9%E4%BF%AE%E6%94%B9%E5%8C%BA%E9%97%B4%E6%9F%A5%E8%AF%A2"><span class="nav-number">1.1.5.1.1.</span> <span class="nav-text">单点修改区间查询</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8C%BA%E9%97%B4%E4%BF%AE%E6%94%B9%E5%8D%95%E7%82%B9%E6%9F%A5%E8%AF%A2"><span class="nav-number">1.1.5.1.2.</span> <span class="nav-text">区间修改单点查询</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8C%83%E5%9B%B4%E4%BF%AE%E6%94%B9%E8%8C%83%E5%9B%B4%E6%9F%A5%E8%AF%A2"><span class="nav-number">1.1.5.1.3.</span> <span class="nav-text">范围修改范围查询</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E7%BB%B4"><span class="nav-number">1.1.5.2.</span> <span class="nav-text">二维</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8D%95%E7%82%B9%E4%BF%AE%E6%94%B9%E8%8C%83%E5%9B%B4%E6%9F%A5%E8%AF%A2"><span class="nav-number">1.1.5.2.1.</span> <span class="nav-text">单点修改范围查询</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8C%83%E5%9B%B4%E6%9F%A5%E8%AF%A2%E8%8C%83%E5%9B%B4%E4%BF%AE%E6%94%B9"><span class="nav-number">1.1.5.2.2.</span> <span class="nav-text">范围查询范围修改</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E6%AE%B5%E6%A0%91"><span class="nav-number">1.1.6.</span> <span class="nav-text">线段树</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8C%83%E5%9B%B4%E5%A2%9E%E5%8A%A0%E8%8C%83%E5%9B%B4%E6%9F%A5%E8%AF%A2%E7%B4%AF%E5%8A%A0%E5%92%8C"><span class="nav-number">1.1.6.1.</span> <span class="nav-text">范围增加范围查询累加和</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%89%E4%BC%98%E5%85%88%E7%BA%A7%E8%B0%83%E6%95%B4%E7%9A%84%E5%A4%9A%E8%8C%83%E5%9B%B4%E4%BF%AE%E6%94%B9%E4%BB%BB%E5%8A%A1"><span class="nav-number">1.1.6.2.</span> <span class="nav-text">有优先级调整的多范围修改任务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A6%BB%E6%95%A3%E5%8C%96"><span class="nav-number">1.1.6.3.</span> <span class="nav-text">离散化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8C%BA%E9%97%B4%E6%9C%80%E5%80%BC%E5%92%8C%E5%8E%86%E5%8F%B2%E6%9C%80%E5%80%BC"><span class="nav-number">1.1.6.4.</span> <span class="nav-text">区间最值和历史最值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%93%E5%90%88%E6%91%A9%E5%B0%94%E6%8A%95%E7%A5%A8"><span class="nav-number">1.1.6.5.</span> <span class="nav-text">结合摩尔投票</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BB%8F%E5%85%B8%E6%91%A9%E5%B0%94%E6%8A%95%E7%A5%A8%EF%BC%8C%E6%B1%82%E6%95%B0%E7%BB%84%E4%B8%AD%E5%87%BA%E7%8E%B0%E6%AC%A1%E6%95%B0%E5%A4%A7%E4%BA%8E-frac-n-2-d-%E6%95%B0"><span class="nav-number">1.1.6.5.1.</span> <span class="nav-text">经典摩尔投票，求数组中出现次数大于$\frac{n}{2}$d 数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BB%93%E5%90%88%E7%BA%BF%E6%AE%B5%E6%A0%91%E6%B1%82%E5%8C%BA%E9%97%B4%E6%B5%B7%E7%8E%8B%E6%95%B0"><span class="nav-number">1.1.6.5.2.</span> <span class="nav-text">结合线段树求区间海王数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B1%82%E4%B8%80%E4%B8%AA%E6%95%B0%E7%BB%84%E4%B8%AD%E6%9F%90%E4%B8%80%E4%B8%AA%E5%8C%BA%E9%97%B4%E5%87%BA%E7%8E%B0%E4%BA%86%E6%9F%90%E4%B8%AA%E6%95%B0%E7%9A%84%E6%AC%A1%E6%95%B0"><span class="nav-number">1.1.6.5.3.</span> <span class="nav-text">求一个数组中某一个区间出现了某个数的次数</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A8%80%E7%96%8F%E8%A1%A8ST"><span class="nav-number">1.1.7.</span> <span class="nav-text">稀疏表ST</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LCA"><span class="nav-number">1.1.8.</span> <span class="nav-text">LCA</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%87%87%E7%94%A8deep%E6%95%B0%E7%BB%84%E5%92%8Cst%E8%A1%A8"><span class="nav-number">1.1.8.1.</span> <span class="nav-text">采用deep数组和st表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Tarjan"><span class="nav-number">1.1.8.2.</span> <span class="nav-text">Tarjan</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%91%E7%9A%84%E9%87%8D%E5%BF%83"><span class="nav-number">1.1.9.</span> <span class="nav-text">树的重心</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%91%E7%9A%84%E7%9B%B4%E5%BE%84"><span class="nav-number">1.1.10.</span> <span class="nav-text">树的直径</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%A4%E6%AC%A1DFS"><span class="nav-number">1.1.10.1.</span> <span class="nav-text">两次DFS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%91%E5%BD%A2DP"><span class="nav-number">1.1.10.2.</span> <span class="nav-text">树形DP</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%B6%E6%9F%A5%E9%9B%86"><span class="nav-number">1.1.11.</span> <span class="nav-text">并查集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E4%BA%8C%E5%88%86"><span class="nav-number">1.1.12.</span> <span class="nav-text">常见二分</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E5%88%86"><span class="nav-number">1.1.13.</span> <span class="nav-text">三分</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%9A%E5%BC%88%E8%AE%BA%EF%BC%88SG%E5%AE%9A%E7%90%86%EF%BC%89"><span class="nav-number">1.1.14.</span> <span class="nav-text">博弈论（SG定理）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%98%E7%A7%AF%E6%9C%80%E5%A4%A7%E5%AD%90%E6%95%B0%E7%BB%84"><span class="nav-number">1.1.15.</span> <span class="nav-text">乘积最大子数组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%88"><span class="nav-number">1.1.16.</span> <span class="nav-text">栈</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%95%E8%B0%83%E6%A0%88"><span class="nav-number">1.1.16.1.</span> <span class="nav-text">单调栈</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%80%E5%A4%A7%E9%A2%91%E7%8E%87%E6%A0%88"><span class="nav-number">1.1.16.2.</span> <span class="nav-text">最大频率栈</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A0%86"><span class="nav-number">1.1.17.</span> <span class="nav-text">堆</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E5%A0%86%E5%AF%BB%E6%89%BE%E4%B8%AD%E4%BD%8D%E6%95%B0"><span class="nav-number">1.1.17.1.</span> <span class="nav-text">动态堆寻找中位数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%A7%E5%B0%8F%E6%A0%B9%E5%A0%86"><span class="nav-number">1.1.17.2.</span> <span class="nav-text">大小根堆</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%AB%E6%8F%8F%E7%BA%BF"><span class="nav-number">1.1.18.</span> <span class="nav-text">扫描线</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%92%E5%BA%8F"><span class="nav-number">1.1.19.</span> <span class="nav-text">排序</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BD%92%E5%B9%B6%E5%88%86%E6%B2%BB"><span class="nav-number">1.1.19.1.</span> <span class="nav-text">归并分治</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9A%8F%E6%9C%BA%E5%BF%AB%E6%8E%92-%E9%80%89%E6%8B%A9%E7%AC%AC-k-%E5%B0%8F-%E5%A4%A7-%E7%9A%84%E6%95%B0"><span class="nav-number">1.1.19.2.</span> <span class="nav-text">随机快排 &amp; 选择第 k 小&#x2F;大 的数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%98%B6%E4%B9%98%E4%B8%8E%E9%80%86%E5%85%83"><span class="nav-number">1.1.20.</span> <span class="nav-text">阶乘与逆元</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E6%80%A7%E9%80%92%E6%8E%A8%E9%80%86%E5%85%83"><span class="nav-number">1.1.21.</span> <span class="nav-text">线性递推逆元</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E5%BF%AB%E9%80%9F%E5%B9%82"><span class="nav-number">1.1.22.</span> <span class="nav-text">矩阵快速幂</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95"><span class="nav-number">1.1.23.</span> <span class="nav-text">扩展欧几里得算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Stein-GCD%E7%AE%97%E6%B3%95"><span class="nav-number">1.1.24.</span> <span class="nav-text">Stein GCD算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Least-Recently-Used-LRU-%E7%AE%97%E6%B3%95"><span class="nav-number">1.1.25.</span> <span class="nav-text">Least Recently Used (LRU)算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BD%8D"><span class="nav-number">1.1.26.</span> <span class="nav-text">二进制位</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%8D%E5%9B%BE"><span class="nav-number">1.1.26.1.</span> <span class="nav-text">位图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%8D%E8%BF%90%E7%AE%97%E5%AE%9E%E7%8E%B0%E5%9B%9B%E5%88%99%E8%BF%90%E7%AE%97"><span class="nav-number">1.1.26.2.</span> <span class="nav-text">位运算实现四则运算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%8D%E8%BF%90%E7%AE%97%E9%AA%9A%E6%93%8D%E4%BD%9C"><span class="nav-number">1.1.26.3.</span> <span class="nav-text">位运算骚操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Brain-Kernighan%E7%AE%97%E6%B3%95"><span class="nav-number">1.1.27.</span> <span class="nav-text">Brain Kernighan算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%93%BE%E8%A1%A8%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="nav-number">1.1.28.</span> <span class="nav-text">链表基本操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E4%B8%A4%E4%B8%AA%E6%97%A0%E7%8E%AF%E9%93%BE%E8%A1%A8%E7%9B%B8%E4%BA%A4%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E8%8A%82%E7%82%B9"><span class="nav-number">1.1.28.1.</span> <span class="nav-text">返回两个无环链表相交的第一个节点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AF%8Fk%E4%B8%AA%E8%8A%82%E7%82%B9%E4%B8%80%E7%BB%84%E7%BF%BB%E8%BD%AC%E9%93%BE%E8%A1%A8"><span class="nav-number">1.1.28.2.</span> <span class="nav-text">每k个节点一组翻转链表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%8D%E5%88%B6%E5%B8%A6%E9%9A%8F%E6%9C%BA%E6%8C%87%E9%92%88%E7%9A%84%E9%93%BE%E8%A1%A8"><span class="nav-number">1.1.28.3.</span> <span class="nav-text">复制带随机指针的链表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E6%98%AF%E5%9B%9E%E6%96%87%E7%BB%93%E6%9E%84%EF%BC%88%E5%BF%AB%E6%85%A2%E6%8C%87%E9%92%88%EF%BC%89"><span class="nav-number">1.1.28.4.</span> <span class="nav-text">判断是否是回文结构（快慢指针）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%85%A5%E7%8E%AF%E8%8A%82%E7%82%B9"><span class="nav-number">1.1.28.5.</span> <span class="nav-text">返回第一个入环节点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A8%B3%E5%AE%9A%E6%8E%92%E5%BA%8F"><span class="nav-number">1.1.28.6.</span> <span class="nav-text">稳定排序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%88%E5%B9%B6n%E4%B8%AA%E6%9C%89%E5%BA%8F%E9%93%BE%E8%A1%A8"><span class="nav-number">1.1.28.7.</span> <span class="nav-text">合并n个有序链表</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%AB%E9%98%9F%E7%AE%97%E6%B3%95"><span class="nav-number">1.1.29.</span> <span class="nav-text">莫队算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#KMP%E7%AE%97%E6%B3%95"><span class="nav-number">1.1.30.</span> <span class="nav-text">KMP算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#manacher%E7%AE%97%E6%B3%95"><span class="nav-number">1.1.31.</span> <span class="nav-text">manacher算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Z%E5%87%BD%E6%95%B0"><span class="nav-number">1.1.32.</span> <span class="nav-text">Z函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E7%BC%80%E6%A0%91"><span class="nav-number">1.1.33.</span> <span class="nav-text">前缀树</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AC%E8%87%AA%E5%8A%A8%E6%9C%BA"><span class="nav-number">1.1.34.</span> <span class="nav-text">AC自动机</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%93%88%E5%B8%8C"><span class="nav-number">1.1.35.</span> <span class="nav-text">字符串哈希</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%82%E6%88%96%E5%93%88%E5%B8%8C"><span class="nav-number">1.1.36.</span> <span class="nav-text">异或哈希</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B4%A8%E6%95%B0-%E7%B4%A0%E6%95%B0"><span class="nav-number">1.1.37.</span> <span class="nav-text">质数&#x2F;素数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B4%A8%E6%95%B0%E5%88%A4%E5%88%AB"><span class="nav-number">1.1.37.1.</span> <span class="nav-text">质数判别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BA%BF%E6%80%A7%E8%B4%A8%E6%95%B0%E7%AD%9B"><span class="nav-number">1.1.37.2.</span> <span class="nav-text">线性质数筛</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Pick%E5%AE%9A%E7%90%86"><span class="nav-number">1.1.38.</span> <span class="nav-text">Pick定理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%AE%E5%88%86"><span class="nav-number">1.1.39.</span> <span class="nav-text">差分</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E7%BB%B4-1"><span class="nav-number">1.1.39.1.</span> <span class="nav-text">一维</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E7%BB%B4-1"><span class="nav-number">1.1.39.2.</span> <span class="nav-text">二维</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%8F%E5%88%97-%E6%95%B0%E7%BB%84%E9%97%AE%E9%A2%98"><span class="nav-number">1.1.40.</span> <span class="nav-text">序列&#x2F;数组问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%AD%90%E5%BA%8F%E5%88%97"><span class="nav-number">1.1.40.1.</span> <span class="nav-text">最长公共子序列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%80%E9%95%BF%E9%80%92%E5%A2%9E%E5%AD%90%E5%BA%8F%E5%88%97"><span class="nav-number">1.1.40.2.</span> <span class="nav-text">最长递增子序列</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%99%AE%E9%80%9A%E7%89%88"><span class="nav-number">1.1.40.2.1.</span> <span class="nav-text">普通版</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AD%97%E5%85%B8%E5%BA%8F%E6%9C%80%E5%B0%8F%E7%89%88"><span class="nav-number">1.1.40.2.2.</span> <span class="nav-text">字典序最小版</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B4%AF%E5%8A%A0%E5%92%8C%E4%B8%8D%E5%A4%A7%E4%BA%8Ek%E7%9A%84%E6%9C%80%E9%95%BF%E5%AD%90%E6%95%B0%E7%BB%84"><span class="nav-number">1.1.40.3.</span> <span class="nav-text">累加和不大于k的最长子数组</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DP"><span class="nav-number">1.1.41.</span> <span class="nav-text">DP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E4%BD%8DDP"><span class="nav-number">1.1.41.1.</span> <span class="nav-text">数位DP</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%91%E5%BD%A2DP-1"><span class="nav-number">1.1.41.2.</span> <span class="nav-text">树形DP</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Fliegel%E2%80%93Van-Flandern-%E7%AE%97%E6%B3%95"><span class="nav-number">1.1.42.</span> <span class="nav-text">Fliegel–Van Flandern 算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%86%E6%B3%A2%E5%85%B0%E5%BC%8F"><span class="nav-number">1.1.43.</span> <span class="nav-text">逆波兰式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%A6%E7%91%9F%E5%A4%AB%E7%8E%AF"><span class="nav-number">1.1.44.</span> <span class="nav-text">约瑟夫环</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A6%BB%E6%95%A3%E5%8C%96-1"><span class="nav-number">1.1.45.</span> <span class="nav-text">离散化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#N%E7%9A%87%E5%90%8E%E9%97%AE%E9%A2%98"><span class="nav-number">1.1.46.</span> <span class="nav-text">N皇后问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%8D%E8%BF%90%E7%AE%97%E7%89%88%E6%9C%AC"><span class="nav-number">1.1.46.1.</span> <span class="nav-text">位运算版本</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8"><span class="nav-number">1.2.</span> <span class="nav-text">容器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#set"><span class="nav-number">1.2.1.</span> <span class="nav-text">set</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ordered-set"><span class="nav-number">1.2.2.</span> <span class="nav-text">ordered_set</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#string"><span class="nav-number">1.2.3.</span> <span class="nav-text">string</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E5%80%BC%E4%B8%8E%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BD%AC%E5%8C%96"><span class="nav-number">1.2.3.1.</span> <span class="nav-text">数值与字符串转化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BE%93%E5%85%A5%E4%B8%8E%E5%88%86%E5%89%B2"><span class="nav-number">1.2.3.2.</span> <span class="nav-text">字符串输入与分割</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%94%B9%E5%8F%98%E5%A4%A7%E5%B0%8F%E5%86%99"><span class="nav-number">1.2.3.3.</span> <span class="nav-text">改变大小写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%90%E4%B8%B2substr"><span class="nav-number">1.2.3.4.</span> <span class="nav-text">子串substr</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE"><span class="nav-number">1.2.3.5.</span> <span class="nav-text">查找</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#find"><span class="nav-number">1.2.3.5.1.</span> <span class="nav-text">find</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#rfind"><span class="nav-number">1.2.3.5.2.</span> <span class="nav-text">rfind</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#find-of"><span class="nav-number">1.2.3.5.3.</span> <span class="nav-text">find_...of</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%92%E5%85%A5insert"><span class="nav-number">1.2.3.6.</span> <span class="nav-text">插入insert</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#map-unordered-map"><span class="nav-number">1.2.4.</span> <span class="nav-text">map  &amp; unordered_map</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#tips"><span class="nav-number">1.3.</span> <span class="nav-text">tips</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E8%BD%BD%E8%BF%90%E7%AE%97%E7%AC%A6%E5%8F%B7%EF%BC%88%E6%AF%94%E8%BE%83%EF%BC%89"><span class="nav-number">1.3.1.</span> <span class="nav-text">重载运算符号（比较）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B1%82%E6%9C%80%E5%A4%A7%E7%9A%84%E6%9C%80%E5%B0%8F%E6%88%96%E8%80%85%E6%9C%80%E5%B0%8F%E7%9A%84%E6%9C%80%E5%A4%A7%E9%97%AE%E9%A2%98"><span class="nav-number">1.3.2.</span> <span class="nav-text">求最大的最小或者最小的最大问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%86%E5%91%A8%E7%8E%87-960"><span class="nav-number">1.3.3.</span> <span class="nav-text">圆周率π</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B1%82%E5%AE%B9%E5%99%A8%E6%9C%80%E5%A4%A7%E5%80%BC"><span class="nav-number">1.3.4.</span> <span class="nav-text">求容器最大值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A8%E6%8E%92%E5%88%97"><span class="nav-number">1.3.5.</span> <span class="nav-text">全排列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B1%82%E4%BA%8C%E7%BB%B4%E5%B9%B3%E9%9D%A2%E4%B8%8A%E7%9A%84%E4%B8%89%E8%A7%92%E5%BD%A2%E9%9D%A2%E7%A7%AF"><span class="nav-number">1.3.6.</span> <span class="nav-text">求二维平面上的三角形面积</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%99%E5%AE%9A%E4%B8%89%E4%B8%AA%E9%A1%B6%E7%82%B9"><span class="nav-number">1.3.6.1.</span> <span class="nav-text">给定三个顶点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%99%E5%AE%9A%E4%B8%89%E6%9D%A1%E8%BE%B9"><span class="nav-number">1.3.6.2.</span> <span class="nav-text">给定三条边</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B1%82%E4%B8%89%E7%BB%B4%E7%A9%BA%E9%97%B4%E4%B8%AD%E4%B8%A4%E6%9D%A1%E7%9B%B4%E7%BA%BF%E6%9C%80%E7%9F%AD%E8%B7%9D%E7%A6%BB"><span class="nav-number">1.3.7.</span> <span class="nav-text">求三维空间中两条直线最短距离</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GCD%E6%95%B0%E9%87%8F%E7%BA%A7"><span class="nav-number">1.3.8.</span> <span class="nav-text">GCD数量级</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%82%B9%E5%88%B0%E7%9B%B4%E7%BA%BF%E7%9A%84%E8%B7%9D%E7%A6%BB%E5%85%AC%E5%BC%8F"><span class="nav-number">1.3.9.</span> <span class="nav-text">点到直线的距离公式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9A%8F%E6%9C%BA%E6%95%B0"><span class="nav-number">1.3.10.</span> <span class="nav-text">随机数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%8C%E5%85%A8%E5%B9%B3%E6%96%B9%E6%95%B0"><span class="nav-number">1.3.11.</span> <span class="nav-text">完全平方数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9A%8F%E6%9C%BA%E5%93%88%E5%B8%8C%E7%BC%96%E7%A0%81"><span class="nav-number">1.3.12.</span> <span class="nav-text">随机哈希编码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%B9%E9%87%8F%E6%93%8D%E4%BD%9C"><span class="nav-number">1.3.13.</span> <span class="nav-text">批量操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#lower-bound-upper-bound"><span class="nav-number">1.3.14.</span> <span class="nav-text">lower_bound &amp; upper_bound</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%98%E5%B0%BA%E5%AE%9A%E7%90%86"><span class="nav-number">1.3.15.</span> <span class="nav-text">折尺定理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%A4%E4%B8%A4%E7%BB%9D%E5%AF%B9%E5%80%BC%E6%B1%82%E5%92%8C"><span class="nav-number">1.3.16.</span> <span class="nav-text">两两绝对值求和</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="nav-number">2.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="jiangshun"
      src="/images/p1.jpeg">
  <p class="site-author-name" itemprop="name">jiangshun</p>
  <div class="site-description" itemprop="description">个人博客</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">5</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/liujunhong2" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;liujunhong2" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa-solid fa-user fa-fw"></i>
          友链
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://www.whalefall.fun/" title="https:&#x2F;&#x2F;www.whalefall.fun&#x2F;" rel="noopener" target="_blank">美式男孩</a>
            </li>
            <li class="links-of-blogroll-item">
              <a href="https://kirawii.cyou/" title="https:&#x2F;&#x2F;kirawii.cyou&#x2F;" rel="noopener" target="_blank">日本柜子</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://liujunhong2.github.io/algorithm.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/p1.jpeg">
      <meta itemprop="name" content="jiangshun">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="豹子湾2.0">
      <meta itemprop="description" content="个人博客">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="algorithm | 豹子湾2.0">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          algorithm
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-03-24 18:29:49" itemprop="dateCreated datePublished" datetime="2025-03-24T18:29:49+08:00">2025-03-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-07-19 14:52:04" itemprop="dateModified" datetime="2025-07-19T14:52:04+08:00">2025-07-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Learn/" itemprop="url" rel="index"><span itemprop="name">Learn</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>24k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1:28</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>算法板子</p>
<span id="more"></span>
<h1 id="算法汇总"><a href="#算法汇总" class="headerlink" title="算法汇总"></a>算法汇总</h1><h2 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h2><h3 id="建图"><a href="#建图" class="headerlink" title="建图"></a>建图</h3><p>三种建图方式</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">11</span>; <span class="comment">// 最大点数</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXM = <span class="number">21</span>; <span class="comment">// 最大边数（无向图需 2 倍）</span></span><br><span class="line"><span class="comment">// 邻接矩阵</span></span><br><span class="line"><span class="type">int</span> graph1[MAXN][MAXN];</span><br><span class="line"><span class="comment">// 邻接表</span></span><br><span class="line">vector&lt;vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt;&gt; graph2;</span><br><span class="line"><span class="comment">// 链式前向星</span></span><br><span class="line"><span class="type">int</span> head[MAXN], nxt[MAXM], to[MAXM], weight[MAXM], cnt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 清空邻接矩阵</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">            graph1[i][j] = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 清空邻接表</span></span><br><span class="line">    graph2.<span class="built_in">clear</span>();</span><br><span class="line">    graph2.<span class="built_in">resize</span>(n + <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// 清空链式前向星</span></span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(head, <span class="number">0</span>, <span class="built_in">sizeof</span>(head));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span> </span>&#123;</span><br><span class="line">    nxt[ ++cnt] = head[u];</span><br><span class="line">    to[cnt] = v;</span><br><span class="line">    weight[cnt] = w;</span><br><span class="line">    head[u] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//有向</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">directGraph</span><span class="params">(<span class="type">const</span> vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&amp; edges)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span>&amp; edge : edges) &#123;</span><br><span class="line">        graph1[edge[<span class="number">0</span>]][edge[<span class="number">1</span>]] = edge[<span class="number">2</span>];</span><br><span class="line">        graph2[edge[<span class="number">0</span>]].<span class="built_in">emplace_back</span>(edge[<span class="number">1</span>], edge[<span class="number">2</span>]);</span><br><span class="line">        <span class="built_in">addEdge</span>(edge[<span class="number">0</span>], edge[<span class="number">1</span>], edge[<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 无向</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">undirectGraph</span><span class="params">(<span class="type">const</span> vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;&amp; edges)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">const</span> <span class="keyword">auto</span>&amp; edge : edges) &#123;</span><br><span class="line">        graph1[edge[<span class="number">0</span>]][edge[<span class="number">1</span>]] = edge[<span class="number">2</span>];</span><br><span class="line">        graph1[edge[<span class="number">1</span>]][edge[<span class="number">0</span>]] = edge[<span class="number">2</span>];</span><br><span class="line">        </span><br><span class="line">        graph2[edge[<span class="number">0</span>]].<span class="built_in">emplace_back</span>(edge[<span class="number">1</span>], edge[<span class="number">2</span>]);</span><br><span class="line">        graph2[edge[<span class="number">1</span>]].<span class="built_in">emplace_back</span>(edge[<span class="number">0</span>], edge[<span class="number">2</span>]);</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">addEdge</span>(edge[<span class="number">0</span>], edge[<span class="number">1</span>], edge[<span class="number">2</span>]);</span><br><span class="line">        <span class="built_in">addEdge</span>(edge[<span class="number">1</span>], edge[<span class="number">0</span>], edge[<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">traversal</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;邻接矩阵遍历:&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) &#123;</span><br><span class="line">            cout &lt;&lt; graph1[i][j] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;邻接表遍历:&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        cout &lt;&lt; i &lt;&lt; <span class="string">&quot; (邻居,边权): &quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; edge : graph2[i]) &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;(&quot;</span> &lt;&lt; edge.first &lt;&lt; <span class="string">&quot;,&quot;</span> &lt;&lt; edge.second &lt;&lt; <span class="string">&quot;) &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;链式前向星遍历:&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        cout &lt;&lt; i &lt;&lt; <span class="string">&quot; (邻居,边权): &quot;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> ei = head[i]; ei &gt; <span class="number">0</span>; ei = nxt[ei]) &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;(&quot;</span> &lt;&lt; to[ei] &lt;&lt; <span class="string">&quot;,&quot;</span> &lt;&lt; weight[ei] &lt;&lt; <span class="string">&quot;) &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n1 = <span class="number">4</span>;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; edges1 = &#123;&#123;<span class="number">1</span>, <span class="number">3</span>, <span class="number">6</span>&#125;, &#123;<span class="number">4</span>, <span class="number">3</span>, <span class="number">4</span>&#125;, &#123;<span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>&#125;, &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">7</span>&#125;, &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>&#125;, &#123;<span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>&#125;&#125;;</span><br><span class="line">    <span class="built_in">build</span>(n1);</span><br><span class="line">    <span class="built_in">directGraph</span>(edges1);</span><br><span class="line">    <span class="built_in">traversal</span>(n1);</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;==============================&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="type">int</span> n2 = <span class="number">5</span>;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; edges2 = &#123;&#123;<span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>&#125;, &#123;<span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>&#125;, &#123;<span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>&#125;, &#123;<span class="number">5</span>, <span class="number">2</span>, <span class="number">4</span>&#125;, &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">7</span>&#125;, &#123;<span class="number">1</span>, <span class="number">5</span>, <span class="number">5</span>&#125;, &#123;<span class="number">4</span>, <span class="number">2</span>, <span class="number">6</span>&#125;&#125;;</span><br><span class="line">    <span class="built_in">build</span>(n2);</span><br><span class="line">    <span class="built_in">undirectGraph</span>(edges2);</span><br><span class="line">    <span class="built_in">traversal</span>(n2);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="图最短路"><a href="#图最短路" class="headerlink" title="图最短路"></a>图最短路</h3><p>从某一基点到其他点的最短路径</p>
<h4 id="Dijkstra算法"><a href="#Dijkstra算法" class="headerlink" title="Dijkstra算法"></a>Dijkstra算法</h4><h5 id="普通堆"><a href="#普通堆" class="headerlink" title="普通堆"></a>普通堆</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m, st;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; st;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">distance</span><span class="params">(n + <span class="number">1</span>, INT_MAX)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">visited</span><span class="params">(n + <span class="number">1</span>, <span class="literal">false</span>)</span></span>;</span><br><span class="line">    vector&lt;vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;&gt; <span class="built_in">g</span>(n + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, u, v, w; i &lt; m; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">        g[u].<span class="built_in">push_back</span>(&#123;v, w&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"> 	priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;,vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;,greater&lt;&gt;&gt; q1;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> it : g[st])&#123;</span><br><span class="line">        q1.<span class="built_in">push</span>(&#123;it.second,it.first&#125;);  </span><br><span class="line">    &#125;</span><br><span class="line">    distance[st] = <span class="number">0</span>;</span><br><span class="line">    pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; temp;</span><br><span class="line">    <span class="type">int</span> u, w, v;</span><br><span class="line">    <span class="keyword">while</span>(!q1.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        temp = q1.<span class="built_in">top</span>();</span><br><span class="line">        q1.<span class="built_in">pop</span>();</span><br><span class="line">        u = temp.second;</span><br><span class="line">        w = temp.first;</span><br><span class="line">        <span class="keyword">if</span>(visited[u]) <span class="keyword">continue</span>;</span><br><span class="line">        visited[u] = <span class="literal">true</span>;</span><br><span class="line">        distance[u] = w;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> it : g[u])&#123;</span><br><span class="line">            v = it.first;</span><br><span class="line">            <span class="keyword">if</span>(!visited[v] &amp;&amp; it.second + distance[u] &lt; distance[v])&#123;</span><br><span class="line">                q1.<span class="built_in">push</span>(&#123;it.second + distance[u], v&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">        cout &lt;&lt; distance[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="反向索引堆"><a href="#反向索引堆" class="headerlink" title="反向索引堆"></a>反向索引堆</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">//heap</span></span><br><span class="line"><span class="type">int</span> MAXN = <span class="number">100001</span>;</span><br><span class="line"><span class="type">int</span> MAXM = <span class="number">200001</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head</span><span class="params">(MAXN)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">next1</span><span class="params">(MAXM)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">to</span><span class="params">(MAXM)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">weight</span><span class="params">(MAXM)</span></span>;</span><br><span class="line"><span class="type">int</span> cnt = <span class="number">1</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">heap</span><span class="params">(MAXN)</span></span>;</span><br><span class="line"><span class="type">int</span> sizeh = <span class="number">0</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">where</span><span class="params">(MAXN,<span class="number">-1</span>)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">distance1</span><span class="params">(MAXN,INT_MAX)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">swap1</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">swap</span>(heap[i], heap[j]);</span><br><span class="line">    where[heap[i]] = i;</span><br><span class="line">    where[heap[j]] = j;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heapInsert</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (i &gt; <span class="number">0</span> &amp;&amp; distance1[heap[i]] &lt; distance1[heap[(i - <span class="number">1</span>) / <span class="number">2</span>]])&#123;</span><br><span class="line">        <span class="built_in">swap1</span>(i, (i - <span class="number">1</span>) / <span class="number">2</span>);</span><br><span class="line">        i = (i - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heapify</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = i * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> max_mark;</span><br><span class="line">    <span class="type">int</span> mark;</span><br><span class="line">    <span class="keyword">while</span> (l &lt; sizeh) &#123;</span><br><span class="line">        max_mark = l + <span class="number">1</span> &lt; sizeh &amp;&amp; distance1[heap[l + <span class="number">1</span>]] &lt; distance1[heap[l]] ? l + <span class="number">1</span> : l;</span><br><span class="line">        mark =distance1[ heap[i]] &lt;distance1[ heap[max_mark]] ? i : max_mark;</span><br><span class="line">        <span class="keyword">if</span> (mark == i) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">swap1</span>(i, mark);</span><br><span class="line">            i = mark;</span><br><span class="line">            l = i * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m, s;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; s;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, x, y, w; i &lt; m; i++) &#123;</span><br><span class="line">        cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;</span><br><span class="line">        next1[cnt] = head[x];</span><br><span class="line">        to[cnt] = y;</span><br><span class="line">        weight[cnt] = w;</span><br><span class="line">        head[x] = cnt++;</span><br><span class="line">    &#125;</span><br><span class="line">    heap[sizeh++] = s;</span><br><span class="line">    distance1[s] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (sizeh) &#123;</span><br><span class="line">        <span class="type">int</span> u = heap[<span class="number">0</span>];</span><br><span class="line">        <span class="built_in">swap1</span>(<span class="number">0</span>, --sizeh);</span><br><span class="line">        <span class="built_in">heapify</span>(<span class="number">0</span>);</span><br><span class="line">        where[u] = <span class="number">-2</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> ei = head[u]; ei &gt; <span class="number">0</span>; ei = next1[ei]) &#123;</span><br><span class="line">            <span class="type">int</span> v = to[ei];</span><br><span class="line">            <span class="type">int</span> w = weight[ei];</span><br><span class="line">            <span class="keyword">if</span> (where[v] == <span class="number">-1</span>) &#123;</span><br><span class="line">                distance1[v] = w + distance1[u];</span><br><span class="line">                where[v] = sizeh;</span><br><span class="line">                heap[sizeh++] = v;</span><br><span class="line">                <span class="built_in">heapInsert</span>(where[v]);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (where[v] &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">                distance1[v] = <span class="built_in">min</span>(distance1[v], distance1[u] + w);</span><br><span class="line">                <span class="built_in">heapInsert</span>(where[v]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        cout &lt;&lt; distance1[i];</span><br><span class="line">        <span class="keyword">if</span> (i != n) cout &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="求最短奇偶路径"><a href="#求最短奇偶路径" class="headerlink" title="求最短奇偶路径"></a>求最短奇偶路径</h5><p>该思想可拓展为某一个节点有n种状态，故每条边增加一个变量为路的数量，一般设置为t &#x3D; 1,而跑DJ算法时，可以在优先队列后面再加一个属性表示状态type，type &#x3D; (type + t) % n。</p>
<p>当再增加一个属性表示节点的类别，相同节点间可以以某个代价相互传送时，则可以抽象为新增了一个祖先节点，该祖先与所有该类别的节点相互联通，节点到祖先的t&#x3D;1，祖先到节点的t&#x3D;0。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 假设边权为1,若不为1则w+1变成w+weight[ei]</span></span><br><span class="line"><span class="comment">// 初始化奇数和偶数路径长度的距离数组</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dis_o</span><span class="params">(n + <span class="number">1</span>, <span class="number">1e18</span>)</span>, <span class="title">dis_e</span><span class="params">(n + <span class="number">1</span>, <span class="number">1e18</span>)</span></span>; <span class="comment">// dis_o: 最短奇数路径，dis_e: 最短偶数路径</span></span><br><span class="line">dis_e[<span class="number">1</span>] = <span class="number">0</span>; <span class="comment">// 起点（节点1）的偶数路径长度为0</span></span><br><span class="line"><span class="comment">// 使用最小堆优先队列存储 &#123;距离, 节点&#125; 对</span></span><br><span class="line">priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;, vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;, greater&lt;&gt;&gt; q1;</span><br><span class="line">q1.<span class="built_in">push</span>(&#123;<span class="number">0</span>, <span class="number">1</span>&#125;); <span class="comment">// 从节点1开始，距离为0</span></span><br><span class="line"><span class="comment">// Dijkstra算法</span></span><br><span class="line"><span class="keyword">while</span> (!q1.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">    <span class="keyword">auto</span> [w, u] = q1.<span class="built_in">top</span>(); <span class="comment">// w: 当前距离，u: 当前节点</span></span><br><span class="line">    q1.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="comment">// 遍历节点u的所有邻居</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> ei = head[u]; ei; ei = next[ei]) &#123;</span><br><span class="line">        <span class="type">int</span> v = to[ei]; <span class="comment">// 邻居节点</span></span><br><span class="line">        <span class="keyword">if</span> (w &amp; <span class="number">1</span>) &#123; <span class="comment">// 如果到u的路径长度为奇数</span></span><br><span class="line">            <span class="keyword">if</span> (dis_e[v] &gt; w + <span class="number">1</span>) &#123; <span class="comment">// 尝试更新v的偶数路径</span></span><br><span class="line">                dis_e[v] = w + <span class="number">1</span>;</span><br><span class="line">                q1.<span class="built_in">push</span>(&#123;w + <span class="number">1</span>, v&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// 如果到u的路径长度为偶数</span></span><br><span class="line">            <span class="keyword">if</span> (dis_o[v] &gt; w + <span class="number">1</span>) &#123; <span class="comment">// 尝试更新v的奇数路径</span></span><br><span class="line">                dis_o[v] = w + <span class="number">1</span>;</span><br><span class="line">                q1.<span class="built_in">push</span>(&#123;w + <span class="number">1</span>, v&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*迷宫有n个房间，通过m条单向道路连接，迷宫的起点是1号房间，终点是n号房间。每条道路都有一个守路人，需要支付对应数量的金币才能通过，这个迷宫还存在着两个神秘的规则：</span></span><br><span class="line"><span class="comment">1.只有当走到终点时经过的路的数量是3的倍数时她才能顺利逃离迷宫。</span></span><br><span class="line"><span class="comment">2.每个房间都有一个类别属性，她可以花费x个金币在相同类别的属性之间瞬移（注意每次瞬移也算作走过了一条路），特殊地她可以在同个房间内进行瞬移</span></span><br><span class="line"><span class="comment">如果怎样都不能走出迷宫的话输出“-1”*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> inf = <span class="number">1e18</span>;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>)-&gt;ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    <span class="keyword">while</span>(t --)&#123;</span><br><span class="line">		<span class="type">int</span> n, m, k;</span><br><span class="line">		cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">		<span class="function">vector <span class="title">adj</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, vector&lt;array&lt;<span class="type">int</span>, <span class="number">3</span>&gt;&gt;())</span></span>;</span><br><span class="line">		<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sta</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">			cin &gt;&gt; sta[i];</span><br><span class="line">			adj[i].<span class="built_in">push_back</span>(&#123;sta[i] + n, k, <span class="number">1</span>&#125;);</span><br><span class="line">			adj[sta[i] + n].<span class="built_in">push_back</span>(&#123;i, <span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, u, v, w; i &lt;= m; i ++)&#123;</span><br><span class="line">			cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">			adj[u].<span class="built_in">push_back</span>(&#123;v, w, <span class="number">1</span>&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">		vector&lt;array&lt;<span class="type">int</span>, 3&gt;&gt; <span class="built_in">dis</span>(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, &#123;inf, inf, inf&#125;);</span><br><span class="line">		priority_queue&lt;array&lt;<span class="type">int</span>, 3&gt;, vector&lt;array&lt;<span class="type">int</span>, 3&gt;&gt;, greater&lt;&gt;&gt; q1;</span><br><span class="line">		array&lt;<span class="type">int</span>, 3&gt; t1;</span><br><span class="line">		<span class="type">int</span> u, val, in, in1;</span><br><span class="line">		dis[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">		q1.<span class="built_in">push</span>(&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;);</span><br><span class="line">		<span class="keyword">while</span>(!q1.<span class="built_in">empty</span>())&#123;</span><br><span class="line">			t1 = q1.<span class="built_in">top</span>();</span><br><span class="line">			q1.<span class="built_in">pop</span>();</span><br><span class="line">			val = t1[<span class="number">0</span>], u = t1[<span class="number">1</span>], in = t1[<span class="number">2</span>];</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">auto</span> [v, w, gap] : adj[u])&#123;</span><br><span class="line">				in1 = (in + gap) % <span class="number">3</span>;</span><br><span class="line">				<span class="keyword">if</span>(dis[v][in1] &gt; val + w)&#123;</span><br><span class="line">					dis[v][in1] = val + w;</span><br><span class="line">					q1.<span class="built_in">push</span>(&#123;dis[v][in1], v, in1&#125;);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(dis[n][<span class="number">0</span>] == inf)&#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;-1\n&quot;</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			cout &lt;&lt; dis[n][<span class="number">0</span>] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">    &#125;   </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Floyd算法"><a href="#Floyd算法" class="headerlink" title="Floyd算法"></a>Floyd算法</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = numeric_limits&lt;<span class="type">int</span>&gt;::<span class="built_in">max</span>();</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">floydWarshallTemplate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="comment">// 初始化邻接矩阵，默认不可达时权值为 INF</span></span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">dist</span>(n, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(n, INF));</span><br><span class="line">    <span class="comment">// 自己到自己距离为 0</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        dist[i][i] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 读入边，假设输入为无向图，若为有向图则只更新一边</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="type">int</span> u, v, w;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">        u--; v--; <span class="comment">// 若输入顶点编号从 1 开始则转换为从 0 开始</span></span><br><span class="line">        <span class="comment">// 对于多重边取权值最小的一条</span></span><br><span class="line">        dist[u][v] = <span class="built_in">min</span>(dist[u][v], w);</span><br><span class="line">        dist[v][u] = <span class="built_in">min</span>(dist[v][u], w);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Floyd–Warshall 算法：枚举中转点 k、起点 i 和终点 j</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; n; k++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="comment">// 如果 i-&gt;k 不可达则无需更新</span></span><br><span class="line">            <span class="keyword">if</span> (dist[i][k] == INF) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">                <span class="comment">// 若路径 i-&gt;k 和 k-&gt;j 均可达，更新 i-&gt;j 的最短路径</span></span><br><span class="line">                <span class="keyword">if</span> (dist[k][j] &lt; INF)</span><br><span class="line">                    dist[i][j] = <span class="built_in">min</span>(dist[i][j], dist[i][k] + dist[k][j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 输出结果：若两点不可达则输出 0，否则输出最短路径长度</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            cout &lt;&lt; (dist[i][j] == INF ? <span class="number">0</span> : dist[i][j]) &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="SPFA（Shortest-Path-Faster-Algorithm）算法"><a href="#SPFA（Shortest-Path-Faster-Algorithm）算法" class="headerlink" title="SPFA（Shortest Path Faster Algorithm）算法"></a><code>SPFA</code>（Shortest Path Faster Algorithm）算法</h4><p><code>SPFA</code> 算法是对 Bellman-Ford 算法的一种改进，主要用于在含有负权边的图中求最短路径。它利用队列来维护“待更新”的节点，从而提高更新效率。</p>
<p>根据最短路径理论，在没有负权回路的图中，从起点到任一节点的最短路径最多只需要经过 <code>n-1</code> 条边。所以若某节点的路径更新次数超过 <code>n-1</code>，就能确定有负权回路存在。</p>
<p><code>visited</code>：标记当前节点是否在队列中，防止重复入队</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">6001</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head</span><span class="params">(M/<span class="number">2</span>)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">next1</span><span class="params">(M)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">to</span><span class="params">(M)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">weight</span><span class="params">(M)</span></span>;</span><br><span class="line"><span class="type">int</span> cnt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">addedge</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> w)</span></span>&#123;</span><br><span class="line">    next1[cnt] = head[x];</span><br><span class="line">    to[cnt] = y;</span><br><span class="line">    weight[cnt] = w;</span><br><span class="line">    head[x] = cnt++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    cnt=<span class="number">1</span>;</span><br><span class="line">    <span class="built_in">fill</span>(head.<span class="built_in">begin</span>(),head.<span class="built_in">end</span>(),<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>, x, y, w; i &lt; m; i++) &#123;</span><br><span class="line">        cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;</span><br><span class="line">        <span class="built_in">addedge</span>(x,y,w);</span><br><span class="line">        <span class="keyword">if</span> (w &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">addedge</span>(y,x,w);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; heap;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">distance</span><span class="params">(n + <span class="number">1</span>, INT_MAX)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">upcnt</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">visited</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    heap.<span class="built_in">push</span>(<span class="number">1</span>);</span><br><span class="line">    distance[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    upcnt[<span class="number">1</span>]++;</span><br><span class="line">    visited[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (!heap.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="type">int</span> u = heap.<span class="built_in">front</span>();</span><br><span class="line">        heap.<span class="built_in">pop</span>();</span><br><span class="line">        visited[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> ei = head[u];ei &gt; <span class="number">0</span>;ei = next1[ei]) &#123;</span><br><span class="line">            <span class="type">int</span> v = to[ei];</span><br><span class="line">            <span class="type">int</span> w = weight[ei];</span><br><span class="line">            <span class="keyword">if</span> (w + distance[u] &lt; distance[v]) &#123;</span><br><span class="line">                distance[v] = w + distance[u];</span><br><span class="line">                <span class="keyword">if</span> (visited[v]==<span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((++upcnt[v])  &gt; n<span class="number">-1</span>) &#123;</span><br><span class="line">                        <span class="comment">//存在负权回路</span></span><br><span class="line">                        cout &lt;&lt; <span class="string">&quot;YES&quot;</span> &lt;&lt; endl;</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    visited[v] = <span class="number">1</span>;</span><br><span class="line">                    heap.<span class="built_in">push</span>(v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;NO&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="最小生成树"><a href="#最小生成树" class="headerlink" title="最小生成树"></a>最小生成树</h3><p>树上的一条无回路的连通所有节点的一条权值最小的路径</p>
<h4 id="Kruskal算法"><a href="#Kruskal算法" class="headerlink" title="Kruskal算法"></a>Kruskal算法</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Kruskal 算法：利用并查集求最小生成树</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">kruskal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    vector&lt;tuple&lt;<span class="type">int</span>,<span class="type">int</span>,<span class="type">int</span>&gt;&gt; edges; <span class="comment">// (权值, 点u, 点v)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="type">int</span> u, v, w;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">        edges.<span class="built_in">push_back</span>(&#123;w, u, v&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(edges.<span class="built_in">begin</span>(), edges.<span class="built_in">end</span>());</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">parent</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) parent[i] = i;</span><br><span class="line">	<span class="keyword">auto</span> find = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> x) -&gt; <span class="type">int</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(parent[x] != x)&#123;</span><br><span class="line">			parent[x] = <span class="built_in">f</span>(f,parent[x]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> parent[x];</span><br><span class="line">	&#125;;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> [w, u, v] : edges) &#123;</span><br><span class="line">        <span class="type">int</span> pu = <span class="built_in">find</span>(find, u), pv = <span class="built_in">find</span>(find, v);</span><br><span class="line">        <span class="keyword">if</span> (pu != pv) &#123;</span><br><span class="line">            parent[pu] = pv;</span><br><span class="line">            sum += w;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="Prim算法"><a href="#Prim算法" class="headerlink" title="Prim算法"></a>Prim算法</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Prim 算法</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">prim</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    vector&lt;vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;&gt; <span class="built_in">graph</span>(n + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="type">int</span> u, v, w;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">        graph[u].<span class="built_in">push_back</span>(&#123;v, w&#125;);</span><br><span class="line">        graph[v].<span class="built_in">push_back</span>(&#123;u, w&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">visited</span><span class="params">(n + <span class="number">1</span>, <span class="literal">false</span>)</span></span>;</span><br><span class="line">    <span class="comment">// 优先队列：pair(权值, 节点)</span></span><br><span class="line">    priority_queue&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;, vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;, greater&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt;&gt; pq;</span><br><span class="line">    visited[<span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> edge : graph[<span class="number">1</span>]) pq.<span class="built_in">push</span>(&#123;edge.second, edge.first&#125;);</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!pq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="keyword">auto</span> [w, u] = pq.<span class="built_in">top</span>();</span><br><span class="line">        pq.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">if</span> (visited[u]) <span class="keyword">continue</span>;</span><br><span class="line">        visited[u] = <span class="literal">true</span>;</span><br><span class="line">        sum += w;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> edge : graph[u])</span><br><span class="line">            <span class="keyword">if</span> (!visited[edge.first])</span><br><span class="line">                pq.<span class="built_in">push</span>(&#123;edge.second, edge.first&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="二叉树"><a href="#二叉树" class="headerlink" title="二叉树"></a>二叉树</h3><h4 id="二叉树的序列化与反序列化及先中序构造"><a href="#二叉树的序列化与反序列化及先中序构造" class="headerlink" title="二叉树的序列化与反序列化及先中序构造"></a>二叉树的序列化与反序列化及先中序构造</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TreeNode</span>&#123;</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    TreeNode * left, * right;</span><br><span class="line">    <span class="built_in">TreeNode</span> (<span class="type">int</span> x)&#123;</span><br><span class="line">        val = x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//先序的序列化与反序列化</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Codec</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">serialize</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        string r;</span><br><span class="line">        <span class="built_in">serialize_h</span>(root,r);</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">TreeNode* <span class="title">deserialize</span><span class="params">(string data)</span> </span>&#123;</span><br><span class="line">        vector&lt;string&gt; vals = <span class="built_in">split</span>(data,<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">        <span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">deserialize_h</span>(vals,cnt);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">serialize_h</span><span class="params">(TreeNode* root,string&amp; r)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            r+=<span class="string">&quot;#,&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            r+=<span class="built_in">to_string</span>(root-&gt;val)+<span class="string">&quot;,&quot;</span>;</span><br><span class="line">            <span class="built_in">serialize_h</span>(root-&gt;left,r);</span><br><span class="line">            <span class="built_in">serialize_h</span>(root-&gt;right,r);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">TreeNode* <span class="title">deserialize_h</span><span class="params">(<span class="type">const</span> vector&lt;string&gt;&amp; vals,<span class="type">int</span>&amp; cnt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(cnt &gt;= vals.<span class="built_in">size</span>() || vals[cnt]==<span class="string">&quot;#&quot;</span> )&#123;</span><br><span class="line">            cnt++;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        TreeNode* node = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="built_in">stoi</span>(vals[cnt++]));</span><br><span class="line">        node-&gt;left=<span class="built_in">deserialize_h</span>(vals,cnt);</span><br><span class="line">        node-&gt;right=<span class="built_in">deserialize_h</span>(vals,cnt);</span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;string&gt; <span class="title">split</span><span class="params">(<span class="type">const</span> string&amp;s,<span class="type">char</span> delimiter)</span></span>&#123;</span><br><span class="line">        vector&lt;string&gt; tokens;</span><br><span class="line">        string token;</span><br><span class="line">        <span class="function">istringstream <span class="title">tokenStream</span><span class="params">(s)</span></span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">getline</span>(tokenStream,token,delimiter))&#123;</span><br><span class="line">            tokens.<span class="built_in">push_back</span>(token);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> tokens;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//按层的序列化与反序列化</span></span><br><span class="line">    <span class="function">string <span class="title">serialize1</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>) <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        string result;</span><br><span class="line">        queue&lt;TreeNode*&gt; q;</span><br><span class="line">        q.<span class="built_in">push</span>(root);</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            TreeNode* node = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(node!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">                result += <span class="built_in">to_string</span>(node-&gt;val)+<span class="string">&quot;,&quot;</span>;</span><br><span class="line">                q.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                q.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">            &#125;<span class="keyword">else</span> result+=<span class="string">&quot;#,&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">TreeNode* <span class="title">deserialize1</span><span class="params">(string data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(data.<span class="built_in">empty</span>()) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="function">stringstream <span class="title">ss</span><span class="params">(data)</span></span>;</span><br><span class="line">        string item;</span><br><span class="line">        <span class="built_in">getline</span>(ss,item,<span class="string">&#x27;,&#x27;</span>);</span><br><span class="line">        TreeNode* root = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="built_in">stoi</span>(item));</span><br><span class="line">        queue&lt;TreeNode*&gt; q;</span><br><span class="line">        q.<span class="built_in">push</span>(root);</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            TreeNode* node = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">getline</span>(ss,item,<span class="string">&#x27;,&#x27;</span>))&#123;</span><br><span class="line">                <span class="keyword">if</span>(item==<span class="string">&quot;#&quot;</span>)&#123;</span><br><span class="line">                    node-&gt;left=<span class="literal">nullptr</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    node-&gt;left = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="built_in">stoi</span>(item));</span><br><span class="line">                    q.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">getline</span>(ss,item,<span class="string">&#x27;,&#x27;</span>))&#123;</span><br><span class="line">                <span class="keyword">if</span>(item==<span class="string">&quot;#&quot;</span>)&#123;</span><br><span class="line">                    node-&gt;right=<span class="literal">nullptr</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    node-&gt;right=<span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="built_in">stoi</span>(item));</span><br><span class="line">                    q.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="利用先序和中序构造二叉树"><a href="#利用先序和中序构造二叉树" class="headerlink" title="利用先序和中序构造二叉树"></a>利用先序和中序构造二叉树</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//先序和中序构造二叉树</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">buildTree</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; preorder, vector&lt;<span class="type">int</span>&gt;&amp; inorder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preorder.<span class="built_in">empty</span>() || inorder.<span class="built_in">empty</span>() || preorder.<span class="built_in">size</span>() != inorder.<span class="built_in">size</span>()) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt; map;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;inorder.<span class="built_in">size</span>();i++) map[inorder[i]]=i;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">build</span>(preorder,<span class="number">0</span>,inorder.<span class="built_in">size</span>()<span class="number">-1</span>,inorder,<span class="number">0</span>,inorder.<span class="built_in">size</span>()<span class="number">-1</span>,map);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">build</span><span class="params">(<span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; preorder,<span class="type">int</span> l1,<span class="type">int</span> r1,<span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; inorder,<span class="type">int</span> l2,<span class="type">int</span> r2,</span></span></span><br><span class="line"><span class="params"><span class="function">    unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&amp; map)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l1&gt;r1) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        TreeNode* root = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(preorder[l1]);</span><br><span class="line">        <span class="keyword">if</span>(l1==r1) <span class="keyword">return</span> root;</span><br><span class="line">        <span class="type">int</span> k=map[preorder[l1]];</span><br><span class="line">        root-&gt;left = <span class="built_in">build</span>(preorder,l1+<span class="number">1</span>,l1+k-l2,inorder,l2,k<span class="number">-1</span>,map);</span><br><span class="line">        root-&gt;right = <span class="built_in">build</span>(preorder,l1+k-l2+<span class="number">1</span>,r1,inorder,k+<span class="number">1</span>,r2,map);</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="二叉树中LCA算法"><a href="#二叉树中LCA算法" class="headerlink" title="二叉树中LCA算法"></a>二叉树中LCA算法</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//LCA问题</span></span><br><span class="line"><span class="comment">//求二叉树两个节点的最近公共祖先</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">lowestCommonAncestor</span><span class="params">(TreeNode* root, TreeNode* p, TreeNode* q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span> || root==p || root==q)&#123;</span><br><span class="line">        	<span class="keyword">return</span> root;</span><br><span class="line">		&#125;</span><br><span class="line">        TreeNode* l = <span class="built_in">lowestCommonAncestor</span>(root-&gt;left,p,q);</span><br><span class="line">        TreeNode* r = <span class="built_in">lowestCommonAncestor</span>(root-&gt;right,p,q);</span><br><span class="line">        <span class="keyword">if</span>(l!=<span class="literal">nullptr</span> &amp;&amp; r!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        	<span class="comment">//左右两边都已经找到</span></span><br><span class="line">        	<span class="keyword">return</span> root;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(l==<span class="literal">nullptr</span> &amp;&amp; r==<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        	<span class="comment">//左右两边都没有找到</span></span><br><span class="line">        	<span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//只有一边找到了，返回找到的一边</span></span><br><span class="line">        <span class="keyword">return</span> l==<span class="literal">nullptr</span>?r:l;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//求线索二叉树两个节点的最近公共祖先</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">lowestCommonAncestor</span><span class="params">(TreeNode* root, TreeNode* p, TreeNode* q)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// root从上到下</span></span><br><span class="line">		<span class="comment">// 如果先遇到了p，说明p是答案</span></span><br><span class="line">		<span class="comment">// 如果先遇到了q，说明q是答案</span></span><br><span class="line">		<span class="comment">// 如果root在p~q的值之间，不用管p和q谁大谁小，只要root在中间，那么此时的root就是答案</span></span><br><span class="line">		<span class="comment">// 如果root在p~q的值的左侧，那么root往右移动</span></span><br><span class="line">		<span class="comment">// 如果root在p~q的值的右侧，那么root往左移动</span></span><br><span class="line">        <span class="keyword">while</span>(root-&gt;val!=p-&gt;val &amp;&amp; root-&gt;val!=q-&gt;val)&#123;</span><br><span class="line">            <span class="keyword">if</span>(root-&gt;val &lt; <span class="built_in">max</span>(p-&gt;val,q-&gt;val) &amp;&amp; root-&gt;val &gt; <span class="built_in">min</span>(p-&gt;val,q-&gt;val))&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            root = root-&gt;val &lt; <span class="built_in">min</span>(q-&gt;val,p-&gt;val)?root-&gt;right:root-&gt;left;</span><br><span class="line">        &#125;<span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="树状数组"><a href="#树状数组" class="headerlink" title="树状数组"></a>树状数组</h3><h4 id="一维"><a href="#一维" class="headerlink" title="一维"></a>一维</h4><h5 id="单点修改区间查询"><a href="#单点修改区间查询" class="headerlink" title="单点修改区间查询"></a>单点修改区间查询</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">5e5</span> + <span class="number">1</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">low</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &amp; -x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= n)&#123;</span><br><span class="line">        v1[i] += x;</span><br><span class="line">        i += <span class="built_in">low</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i)&#123;</span><br><span class="line">        ans += v1[i];</span><br><span class="line">        i -= <span class="built_in">low</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">range</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">get</span>(j) - <span class="built_in">get</span>(i - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, x; i &lt;= n; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">        <span class="built_in">add</span>(i, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, op, x, y; i &lt; m; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; op &gt;&gt; x &gt;&gt; y;</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="built_in">add</span>(x, y);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            cout &lt;&lt; <span class="built_in">range</span>(x, y) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="区间修改单点查询"><a href="#区间修改单点查询" class="headerlink" title="区间修改单点查询"></a>区间修改单点查询</h5><p>在单点基础上，利用一维差分，最后求从0到i的累加和即为i点的值</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">5e5</span> + <span class="number">1</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; <span class="title">v1</span><span class="params">(N, <span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">low</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &amp; -x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= n)&#123;</span><br><span class="line">        v1[i] += x;</span><br><span class="line">        i += <span class="built_in">low</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">get</span><span class="params">(<span class="type">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i)&#123;</span><br><span class="line">        ans += v1[i];</span><br><span class="line">        i -= <span class="built_in">low</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">range</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">get</span>(j) - <span class="built_in">get</span>(i - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, x; i &lt;= n; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">        <span class="built_in">add</span>(i, x);</span><br><span class="line">        <span class="built_in">add</span>(i + <span class="number">1</span>, -x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, op, x, y, z; i &lt; m; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; op;</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">            cin &gt;&gt; x &gt;&gt; y &gt;&gt; z;</span><br><span class="line">            <span class="built_in">add</span>(x, z);</span><br><span class="line">            <span class="built_in">add</span>(y + <span class="number">1</span>, -z);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            cin &gt;&gt; x;</span><br><span class="line">            cout &lt;&lt; <span class="built_in">range</span>(<span class="number">1</span>, x) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="范围修改范围查询"><a href="#范围修改范围查询" class="headerlink" title="范围修改范围查询"></a>范围修改范围查询</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">1</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; <span class="title">v1</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; <span class="title">v2</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">low</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &amp; -x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> x, vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; &amp; v)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= n)&#123;</span><br><span class="line">        v[i] += x;</span><br><span class="line">        i += <span class="built_in">low</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">get</span><span class="params">(<span class="type">int</span> i, vector&lt;<span class="type">long</span> <span class="type">long</span>&gt; &amp; v)</span></span>&#123;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i)&#123;</span><br><span class="line">        ans += v[i];</span><br><span class="line">        i -= <span class="built_in">low</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">range</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> j * <span class="built_in">get</span>(j, v1) - <span class="built_in">get</span>(j, v2) - ((i - <span class="number">1</span>) * <span class="built_in">get</span>(i - <span class="number">1</span>, v1) - <span class="built_in">get</span>(i <span class="number">-1</span>, v2));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">long</span> <span class="type">long</span> w)</span></span>&#123;</span><br><span class="line">    <span class="built_in">add</span>(x, w, v1);</span><br><span class="line">    <span class="built_in">add</span>(y + <span class="number">1</span>, -w, v1);</span><br><span class="line">    <span class="built_in">add</span>(x, (x - <span class="number">1</span>) * w, v2);</span><br><span class="line">    <span class="built_in">add</span>(y + <span class="number">1</span>, - y * w, v2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, x; i &lt;= n; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">        <span class="built_in">add</span>(i, i, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, op, x, y, z; i &lt; m; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; op;</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">            cin &gt;&gt; x &gt;&gt; y &gt;&gt; z;</span><br><span class="line">            <span class="built_in">add</span>(x, y, z);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            cin &gt;&gt; x &gt;&gt; y;</span><br><span class="line">            cout &lt;&lt; <span class="built_in">range</span>(x,  y) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="二维"><a href="#二维" class="headerlink" title="二维"></a>二维</h4><h5 id="单点修改范围查询"><a href="#单点修改范围查询" class="headerlink" title="单点修改范围查询"></a>单点修改范围查询</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">low</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> i &amp; -i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; &amp; bit, <span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> w, <span class="type">int</span> n, <span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = x; i &lt;= n; i += <span class="built_in">low</span>(i)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = y; j &lt;= m; j += <span class="built_in">low</span>(j)) &#123;</span><br><span class="line">            bit[i][j] += w;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; &amp;bit, <span class="type">int</span> x, <span class="type">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = x; i &gt; <span class="number">0</span>; i -= <span class="built_in">low</span>(i)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = y; j &gt; <span class="number">0</span>; j -= <span class="built_in">low</span>(j)) &#123;</span><br><span class="line">            ans += bit[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; &amp;bit, <span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x1 &gt; x2 || y1 &gt; y2) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">query</span>(bit, x2, y2) - <span class="built_in">query</span>(bit, x1 - <span class="number">1</span>, y2) - <span class="built_in">query</span>(bit, x2, y1 - <span class="number">1</span>) + <span class="built_in">query</span>(bit, x1 - <span class="number">1</span>, y1 - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">v1</span>(n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(m + <span class="number">1</span>, <span class="number">0</span>)); <span class="comment">// 原始数组</span></span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">bit</span>(n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(m + <span class="number">1</span>, <span class="number">0</span>)); <span class="comment">// 树状数组</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">            cin &gt;&gt; v1[i][j];</span><br><span class="line">            <span class="built_in">add</span>(bit, i, j, v1[i][j], n, m);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> q;</span><br><span class="line">    cin &gt;&gt; q;</span><br><span class="line">    <span class="type">int</span> type;</span><br><span class="line">    <span class="type">int</span> x, y, w;</span><br><span class="line">    <span class="type">int</span> diff;</span><br><span class="line">    <span class="type">int</span> x1, y1, x2, y2;</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        cin &gt;&gt; type;</span><br><span class="line">        <span class="keyword">if</span> (type == <span class="number">1</span>) &#123; </span><br><span class="line">            cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;</span><br><span class="line">            diff = w - v1[x][y];</span><br><span class="line">            v1[x][y] = w;</span><br><span class="line">            <span class="built_in">add</span>(bit, x, y, diff, n, m);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type == <span class="number">2</span>) &#123;</span><br><span class="line">            cin &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2;</span><br><span class="line">            cout &lt;&lt; <span class="built_in">get</span>(bit, x1, y1, x2, y2) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="范围查询范围修改"><a href="#范围查询范围修改" class="headerlink" title="范围查询范围修改"></a>范围查询范围修改</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2050</span>;</span><br><span class="line"><span class="type">int</span> bit1[N][N];</span><br><span class="line"><span class="type">int</span> bit2[N][N];</span><br><span class="line"><span class="type">int</span> bit3[N][N];</span><br><span class="line"><span class="type">int</span> bit4[N][N];</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> a, b, c, d, w;</span><br><span class="line"><span class="type">int</span> v1, v2, v3, v4;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">low</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &amp; -x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">    v1 = v;</span><br><span class="line">    v2 = x * v;</span><br><span class="line">    v3 = y * v;</span><br><span class="line">    v4 = x * y * v;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = x; i &lt;= n; i += <span class="built_in">low</span>(i))&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = y; j &lt;= m; j += <span class="built_in">low</span>(j))&#123;</span><br><span class="line">            bit1[i][j] += v1;</span><br><span class="line">            bit2[i][j] += v2;</span><br><span class="line">            bit3[i][j] += v3;</span><br><span class="line">            bit4[i][j] += v4;</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = x; i; i -= <span class="built_in">low</span>(i))&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = y; j; j -= <span class="built_in">low</span>(j))&#123;</span><br><span class="line">            ans += (x + <span class="number">1</span>) * (y + <span class="number">1</span>) * bit1[i][j] - (y + <span class="number">1</span>) * bit2[i][j] - (x + <span class="number">1</span>) * bit3[i][j] + bit4[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2, <span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">    <span class="built_in">add</span>(x1, y1, v);</span><br><span class="line">    <span class="built_in">add</span>(x2 + <span class="number">1</span>, y2 + <span class="number">1</span>, v);</span><br><span class="line">    <span class="built_in">add</span>(x1, y2 + <span class="number">1</span>, - v);</span><br><span class="line">    <span class="built_in">add</span>(x2 + <span class="number">1</span>, y1, - v);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">get</span>(x2, y2) + <span class="built_in">get</span>(x1 - <span class="number">1</span>, y1 - <span class="number">1</span>) - <span class="built_in">get</span>(x1 - <span class="number">1</span>, y2) - <span class="built_in">get</span>(x2, y1 - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">char</span> C)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(C == <span class="string">&#x27;L&#x27;</span>)&#123;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c &gt;&gt; d &gt;&gt; w;</span><br><span class="line">        <span class="built_in">add</span>(a, b, c, d, w);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(C != <span class="string">&#x27;X&#x27;</span>)&#123;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c &gt;&gt; d;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">get</span>(a, b, c, d) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">char</span> C;</span><br><span class="line">    <span class="keyword">while</span> (cin &gt;&gt; C) &#123;</span><br><span class="line">        <span class="built_in">solve</span>(C);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="线段树"><a href="#线段树" class="headerlink" title="线段树"></a>线段树</h3><h4 id="范围增加范围查询累加和"><a href="#范围增加范围查询累加和" class="headerlink" title="范围增加范围查询累加和"></a>范围增加范围查询累加和</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P3372</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>) -&gt; ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--)&#123;</span><br><span class="line">		<span class="type">int</span> n, q;</span><br><span class="line">		cin &gt;&gt; n &gt;&gt; q;</span><br><span class="line">		<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">sum</span><span class="params">((n &lt;&lt; <span class="number">2</span>) + <span class="number">1</span>)</span>, <span class="title">add</span><span class="params">((n &lt;&lt; <span class="number">2</span>) + <span class="number">1</span>)</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">			cin &gt;&gt; v1[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">auto</span> build = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">				sum[i] = v1[l];</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">				<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">				sum[i] = sum[i &lt;&lt; <span class="number">1</span>] + sum[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			add[i] = <span class="number">0</span>;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> up = [&amp;](<span class="type">int</span> i)&#123;</span><br><span class="line">			sum[i] = sum[i &lt;&lt; <span class="number">1</span>] + sum[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> lazy = [&amp;](<span class="type">int</span> i, <span class="type">int</span> val, <span class="type">int</span> len)&#123;</span><br><span class="line">			sum[i] += val * len;</span><br><span class="line">			add[i] += val;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> down = [&amp;](<span class="type">int</span> i, <span class="type">int</span> lenl, <span class="type">int</span> lenr)&#123;</span><br><span class="line">			<span class="keyword">if</span>(add[i] == <span class="number">0</span>)&#123;</span><br><span class="line">				<span class="keyword">return</span> ;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">lazy</span>(i &lt;&lt; <span class="number">1</span>, add[i], lenl);</span><br><span class="line">			<span class="built_in">lazy</span>(i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, add[i], lenr);</span><br><span class="line">			add[i] = <span class="number">0</span>;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> add1 = [&amp;](<span class="keyword">auto</span> &amp;&amp; f,<span class="type">int</span> i, <span class="type">int</span> val, <span class="type">int</span> basel, <span class="type">int</span> baser, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(basel &lt;= l &amp;&amp; baser &gt;= r)&#123;</span><br><span class="line">				<span class="built_in">lazy</span>(i, val, r - l + <span class="number">1</span>);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">down</span>(i, mid - l + <span class="number">1</span>, r - mid);</span><br><span class="line">				<span class="keyword">if</span>(basel &lt;= mid)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, val, basel, baser, l, mid);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(baser &gt;= mid + <span class="number">1</span>)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, val, basel ,baser, mid + <span class="number">1</span>, r);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="built_in">up</span>(i);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="built_in">build</span>(build, <span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">		<span class="keyword">auto</span> query = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> basel, <span class="type">int</span> baser, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(basel &lt;= l &amp;&amp; baser &gt;= r)&#123;</span><br><span class="line">				<span class="keyword">return</span> sum[i];</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">down</span>(i, mid - l + <span class="number">1</span>, r - mid);</span><br><span class="line">				<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">if</span>(basel &lt;= mid)&#123;</span><br><span class="line">					ans += <span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, basel, baser, l, mid);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(baser &gt;= mid + <span class="number">1</span>)&#123;</span><br><span class="line">					ans += <span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, basel, baser, mid + <span class="number">1</span>, r);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">return</span> ans;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; q; i ++)&#123;</span><br><span class="line">			<span class="type">int</span> op;</span><br><span class="line">			cin &gt;&gt; op;</span><br><span class="line">			<span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">				<span class="type">int</span> l, r, val;</span><br><span class="line">				cin &gt;&gt; l &gt;&gt; r &gt;&gt; val;</span><br><span class="line">				<span class="built_in">add1</span>(add1, <span class="number">1</span>, val, l , r, <span class="number">1</span>, n);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="type">int</span> l, r;</span><br><span class="line">				cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">				cout &lt;&lt; <span class="built_in">query</span>(query, <span class="number">1</span>, l, r, <span class="number">1</span>, n) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="有优先级调整的多范围修改任务"><a href="#有优先级调整的多范围修改任务" class="headerlink" title="有优先级调整的多范围修改任务"></a>有优先级调整的多范围修改任务</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P1253</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>) -&gt; ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--)&#123;</span><br><span class="line">		 <span class="type">int</span> n, q;</span><br><span class="line">		 cin &gt;&gt; n &gt;&gt; q;</span><br><span class="line">		 <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">change</span><span class="params">((n &lt;&lt; <span class="number">2</span>))</span>, <span class="title">max1</span><span class="params">((n &lt;&lt; <span class="number">2</span>))</span>, <span class="title">add</span><span class="params">((n &lt;&lt; <span class="number">2</span>))</span></span>;</span><br><span class="line">		 <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">has</span><span class="params">((n &lt;&lt; <span class="number">2</span>))</span></span>;</span><br><span class="line">		 <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">		 	cin &gt;&gt; v1[i];</span><br><span class="line">		 &#125;</span><br><span class="line">		 <span class="keyword">auto</span> biuld = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">		 	<span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">			 	 max1[i] = v1[l];</span><br><span class="line">		 	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		 		<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">		 		<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">		 		<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">		 		max1[i] = <span class="built_in">max</span>(max1[i &lt;&lt; <span class="number">1</span>], max1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);</span><br><span class="line">		 	&#125;</span><br><span class="line">		 	has[i] = <span class="literal">false</span>;</span><br><span class="line">		 	add[i] = <span class="number">0</span>;</span><br><span class="line">		 &#125;;</span><br><span class="line">		 <span class="built_in">biuld</span>(biuld, <span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">		 <span class="keyword">auto</span> up = [&amp;](<span class="type">int</span> i) &#123;</span><br><span class="line">		 	max1[i] = <span class="built_in">max</span>(max1[i &lt;&lt; <span class="number">1</span>], max1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);</span><br><span class="line">		 &#125;;</span><br><span class="line">		 <span class="keyword">auto</span> lazyadd = [&amp;](<span class="type">int</span> i, <span class="type">int</span> val) &#123;</span><br><span class="line">		 	max1[i] += val;</span><br><span class="line">		 	add[i] += val;</span><br><span class="line">		 &#125;;</span><br><span class="line">		 <span class="keyword">auto</span> lazyset = [&amp;](<span class="type">int</span> i, <span class="type">int</span> val) &#123;</span><br><span class="line">		 	max1[i] = val;</span><br><span class="line">		 	change[i] = val;</span><br><span class="line">		 	add[i] = <span class="number">0</span>;</span><br><span class="line">		 	has[i] = <span class="literal">true</span>;</span><br><span class="line">		 &#125;;</span><br><span class="line">		 <span class="keyword">auto</span> down = [&amp;](<span class="type">int</span> i) &#123;</span><br><span class="line">			<span class="keyword">if</span>(has[i])&#123;</span><br><span class="line">				<span class="built_in">lazyset</span>(i &lt;&lt; <span class="number">1</span>, change[i]);</span><br><span class="line">				<span class="built_in">lazyset</span>(i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, change[i]);</span><br><span class="line">				has[i] = <span class="literal">false</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(add[i])&#123;</span><br><span class="line">				<span class="built_in">lazyadd</span>(i &lt;&lt; <span class="number">1</span>, add[i]);</span><br><span class="line">				<span class="built_in">lazyadd</span>(i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, add[i]);</span><br><span class="line">				add[i] = <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		 &#125;;</span><br><span class="line">		 <span class="keyword">auto</span> add1 = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> val, <span class="type">int</span> basel, <span class="type">int</span> baser, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">		 	<span class="keyword">if</span>(basel &lt;= l &amp;&amp; baser &gt;= r)&#123;</span><br><span class="line">		 		<span class="built_in">lazyadd</span>(i, val);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">down</span>(i);</span><br><span class="line">				<span class="keyword">if</span>(basel &lt;= mid)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, val, basel, baser, l, mid);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(baser &gt; mid)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, val, basel, baser, mid + <span class="number">1</span>, r);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="built_in">up</span>(i);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> set = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> val, <span class="type">int</span> basel, <span class="type">int</span> baser, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(basel &lt;= l &amp;&amp; baser &gt;= r)&#123;</span><br><span class="line">				<span class="built_in">lazyset</span>(i, val);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">down</span>(i);</span><br><span class="line">				<span class="keyword">if</span>(basel &lt;= mid)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, val, basel, baser, l, mid);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(baser &gt; mid)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, val, basel, baser, mid + <span class="number">1</span>, r);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="built_in">up</span>(i);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> query = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> basel, <span class="type">int</span> baser, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">int</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(basel &lt;= l &amp;&amp; baser &gt;= r)&#123;</span><br><span class="line">				<span class="keyword">return</span> max1[i];</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">down</span>(i);</span><br><span class="line">				<span class="type">int</span> ans = <span class="number">-1e18</span>;</span><br><span class="line">				<span class="keyword">if</span>(basel &lt;= mid)&#123;</span><br><span class="line">					ans = <span class="built_in">max</span>(ans, <span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, basel, baser, l, mid));</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(baser &gt; mid)&#123;</span><br><span class="line">					ans = <span class="built_in">max</span>(ans, <span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, basel, baser, mid + <span class="number">1</span>, r));</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">return</span> ans;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; q; i ++)&#123;</span><br><span class="line">			<span class="type">int</span> op;</span><br><span class="line">			cin &gt;&gt; op;</span><br><span class="line">			<span class="type">int</span> l, r;</span><br><span class="line">			cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">			<span class="keyword">if</span>(op == <span class="number">2</span>)&#123;</span><br><span class="line">				<span class="type">int</span> x;</span><br><span class="line">				cin &gt;&gt; x;</span><br><span class="line">				<span class="built_in">add1</span>(add1, <span class="number">1</span>, x, l, r, <span class="number">1</span>, n);</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">				<span class="type">int</span> x;</span><br><span class="line">				cin &gt;&gt; x;</span><br><span class="line">				<span class="built_in">set</span>(set, <span class="number">1</span>, x, l, r, <span class="number">1</span>, n);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				cout &lt;&lt; <span class="built_in">query</span>(query, <span class="number">1</span>, l, r, <span class="number">1</span>, n) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="离散化"><a href="#离散化" class="headerlink" title="离散化"></a>离散化</h4><p>离散化之后要注意间隙，如覆盖问题，要在离散化之后的两个差值不为一i的数据中间添加一个数</p>
<h4 id="区间最值和历史最值"><a href="#区间最值和历史最值" class="headerlink" title="区间最值和历史最值"></a>区间最值和历史最值</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P6242</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="type">int</span> n, m;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">max1</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span>,    <span class="comment">// 区间当前最大值</span></span></span><br><span class="line"><span class="function">                    <span class="title">sec</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span>,     <span class="comment">// 区间严格次大值</span></span></span><br><span class="line"><span class="function">                    <span class="title">cnt</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span>,     <span class="comment">// 区间等于最大值的元素个数</span></span></span><br><span class="line"><span class="function">                    <span class="title">sum</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span>,     <span class="comment">// 区间元素和</span></span></span><br><span class="line"><span class="function">                    <span class="title">his</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span>,     <span class="comment">// 区间历史最大值（曾经出现过的最大值）</span></span></span><br><span class="line"><span class="function">                    <span class="title">add1</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span>,    <span class="comment">// 懒标记 A：对“当前最大值元素”做加法</span></span></span><br><span class="line"><span class="function">                    <span class="title">add2</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span>,    <span class="comment">// 懒标记 B：对“非最大值元素”做加法</span></span></span><br><span class="line"><span class="function">                    <span class="title">adds1</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span>,   <span class="comment">// 历史最大值懒标记 A</span></span></span><br><span class="line"><span class="function">                    <span class="title">adds2</span><span class="params">(n&lt;&lt;<span class="number">2</span>)</span></span>;   <span class="comment">// 历史最大值懒标记 B</span></span><br><span class="line">        <span class="keyword">auto</span> up = [&amp;](<span class="type">int</span> i)&#123;</span><br><span class="line">            sum[i] = sum[i&lt;&lt;<span class="number">1</span>] + sum[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">            his[i] = <span class="built_in">max</span>(his[i&lt;&lt;<span class="number">1</span>], his[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">            max1[i] = <span class="built_in">max</span>(max1[i&lt;&lt;<span class="number">1</span>], max1[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">            <span class="comment">// 合并 cnt 与 sec</span></span><br><span class="line">            <span class="keyword">if</span>(max1[i&lt;&lt;<span class="number">1</span>] == max1[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>])&#123;</span><br><span class="line">                cnt[i] = cnt[i&lt;&lt;<span class="number">1</span>] + cnt[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">                sec[i] = <span class="built_in">max</span>(sec[i&lt;&lt;<span class="number">1</span>], sec[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(max1[i&lt;&lt;<span class="number">1</span>] &gt; max1[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>])&#123;</span><br><span class="line">                cnt[i] = cnt[i&lt;&lt;<span class="number">1</span>];</span><br><span class="line">                sec[i] = <span class="built_in">max</span>(sec[i&lt;&lt;<span class="number">1</span>], max1[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                cnt[i] = cnt[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">                sec[i] = <span class="built_in">max</span>(sec[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>], max1[i&lt;&lt;<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">auto</span> build = [&amp;](<span class="keyword">auto</span>&amp;&amp; self, <span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">                <span class="type">int</span> x;</span><br><span class="line">                cin &gt;&gt; x;</span><br><span class="line">                max1[i] = sum[i] = his[i] = x;  <span class="comment">// 当前值、区间和值、历史最大均为 x</span></span><br><span class="line">                cnt[i] = <span class="number">1</span>;                     <span class="comment">// 只有一个元素</span></span><br><span class="line">                sec[i] = LLONG_MIN / <span class="number">2</span>;         <span class="comment">// 次大值设为 -INF（用很小的数）</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>, l, mid);</span><br><span class="line">                <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r);</span><br><span class="line">                <span class="built_in">up</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 懒标记初始为 0</span></span><br><span class="line">            add1[i] = add2[i] = adds1[i] = adds2[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="built_in">build</span>(build, <span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">        <span class="comment">// 核心懒标记下发函数</span></span><br><span class="line">        <span class="comment">// val1: 加到“当前最大值元素”上的增量</span></span><br><span class="line">        <span class="comment">// val2: 加到“非最大值元素”上的增量</span></span><br><span class="line">        <span class="comment">// val3/val4: 用于更新历史最大值的增量</span></span><br><span class="line">        <span class="comment">// len: 本区间长度</span></span><br><span class="line">        <span class="keyword">auto</span> lazy = [&amp;](<span class="type">int</span> i, <span class="type">int</span> val1, <span class="type">int</span> val2, <span class="type">int</span> val3, <span class="type">int</span> val4, <span class="type">int</span> len)&#123;</span><br><span class="line">            <span class="comment">// 更新历史最大值</span></span><br><span class="line">            his[i] = <span class="built_in">max</span>(his[i], max1[i] + val3);</span><br><span class="line">            <span class="comment">// 更新子树的历史懒标记</span></span><br><span class="line">            adds1[i] = <span class="built_in">max</span>(adds1[i], add1[i] + val3);</span><br><span class="line">            adds2[i] = <span class="built_in">max</span>(adds2[i], add2[i] + val4);</span><br><span class="line">            <span class="comment">// 区间和更新</span></span><br><span class="line">            sum[i] += val1 * cnt[i] + val2 * (len - cnt[i]);</span><br><span class="line">            <span class="comment">// 更新“当前最大值”与“非最大值”懒标记</span></span><br><span class="line">            add1[i] += val1;</span><br><span class="line">            add2[i] += val2;</span><br><span class="line">            <span class="comment">// 更新当前最大值</span></span><br><span class="line">            max1[i] += val1;</span><br><span class="line">            <span class="comment">// 次大值也需加 val2（若不存在则保持 -INF）</span></span><br><span class="line">            <span class="keyword">if</span>(sec[i] &gt; LLONG_MIN/<span class="number">2</span>) sec[i] += val2;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// 下推函数：将 i 节点的懒标记传递给左右子节点</span></span><br><span class="line">        <span class="keyword">auto</span> down = [&amp;](<span class="type">int</span> i, <span class="type">int</span> lenL, <span class="type">int</span> lenR)&#123;</span><br><span class="line">            <span class="comment">// 左右子节点新的“当前最大”值</span></span><br><span class="line">            <span class="type">int</span> tL = max1[i&lt;&lt;<span class="number">1</span>], tR = max1[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">            <span class="comment">// 父节点最高值</span></span><br><span class="line">            <span class="type">int</span> mx = <span class="built_in">max</span>(max1[i&lt;&lt;<span class="number">1</span>], max1[i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">            <span class="comment">// 左子树</span></span><br><span class="line">            <span class="keyword">if</span>(tL == mx)&#123;</span><br><span class="line">                <span class="comment">// 左子树中有父区间最大值元素</span></span><br><span class="line">                <span class="built_in">lazy</span>(i&lt;&lt;<span class="number">1</span>, add1[i], add2[i], adds1[i], adds2[i], lenL);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 左子树中只有“非最大值”元素</span></span><br><span class="line">                <span class="built_in">lazy</span>(i&lt;&lt;<span class="number">1</span>, add2[i], add2[i], adds2[i], adds2[i], lenL);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 右子树（同理）</span></span><br><span class="line">            <span class="keyword">if</span>(tR == mx)&#123;</span><br><span class="line">                <span class="built_in">lazy</span>(i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, add1[i], add2[i], adds1[i], adds2[i], lenR);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">lazy</span>(i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, add2[i], add2[i], adds2[i], adds2[i], lenR);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 清空父节点懒标记</span></span><br><span class="line">            add1[i] = add2[i] = adds1[i] = adds2[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// 区间加法 [bl,br] 全加 val</span></span><br><span class="line">        <span class="keyword">auto</span> addRange = [&amp;](<span class="keyword">auto</span>&amp;&amp; self, <span class="type">int</span> i, <span class="type">int</span> bl, <span class="type">int</span> br, <span class="type">int</span> val, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(bl &lt;= l &amp;&amp; r &lt;= br)&#123;</span><br><span class="line">                <span class="comment">// 统一打懒标记，val1=val2=val3=val4=val</span></span><br><span class="line">                <span class="built_in">lazy</span>(i, val, val, val, val, r-l+<span class="number">1</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">down</span>(i, mid-l+<span class="number">1</span>, r-mid);</span><br><span class="line">                <span class="keyword">if</span>(bl &lt;= mid)      <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>, bl, br, val, l, mid);</span><br><span class="line">                <span class="keyword">if</span>(br &gt; mid)       <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, bl, br, val, mid+<span class="number">1</span>, r);</span><br><span class="line">                <span class="built_in">up</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// 区间 chmin：把区间内所有大于 val 的值降到 val</span></span><br><span class="line">        <span class="keyword">auto</span> chminRange = [&amp;](<span class="keyword">auto</span>&amp;&amp; self, <span class="type">int</span> i, <span class="type">int</span> bl, <span class="type">int</span> br, <span class="type">int</span> val, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(max1[i] &lt;= val) <span class="keyword">return</span>;  <span class="comment">// 本区间最大值已 ≤ val，无需操作</span></span><br><span class="line">            <span class="keyword">if</span>(bl &lt;= l &amp;&amp; r &lt;= br &amp;&amp; sec[i] &lt; val)&#123;</span><br><span class="line">                <span class="comment">// 全区间最大值都大于 val，且次大值 &lt; val</span></span><br><span class="line">                <span class="comment">// 只需把“最大值元素”降到 val</span></span><br><span class="line">                <span class="built_in">lazy</span>(i, val-max1[i], <span class="number">0</span>, val-max1[i], <span class="number">0</span>, r-l+<span class="number">1</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">down</span>(i, mid-l+<span class="number">1</span>, r-mid);</span><br><span class="line">                <span class="keyword">if</span>(bl &lt;= mid)      <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>, bl, br, val, l, mid);</span><br><span class="line">                <span class="keyword">if</span>(br &gt; mid)       <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, bl, br, val, mid+<span class="number">1</span>, r);</span><br><span class="line">                <span class="built_in">up</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// 区间求和</span></span><br><span class="line">        <span class="keyword">auto</span> querySum = [&amp;](<span class="keyword">auto</span>&amp;&amp; self, <span class="type">int</span> i, <span class="type">int</span> bl, <span class="type">int</span> br, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(bl &lt;= l &amp;&amp; r &lt;= br)&#123;</span><br><span class="line">                <span class="keyword">return</span> sum[i];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">down</span>(i, mid-l+<span class="number">1</span>, r-mid);</span><br><span class="line">                <span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span>(bl &lt;= mid)    res += <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>, bl, br, l, mid);</span><br><span class="line">                <span class="keyword">if</span>(br &gt; mid)     res += <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, bl, br, mid+<span class="number">1</span>, r);</span><br><span class="line">                <span class="keyword">return</span> res;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// 区间最大值</span></span><br><span class="line">        <span class="keyword">auto</span> queryMax = [&amp;](<span class="keyword">auto</span>&amp;&amp; self, <span class="type">int</span> i, <span class="type">int</span> bl, <span class="type">int</span> br, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(bl &lt;= l &amp;&amp; r &lt;= br)&#123;</span><br><span class="line">                <span class="keyword">return</span> max1[i];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">down</span>(i, mid-l+<span class="number">1</span>, r-mid);</span><br><span class="line">                <span class="type">int</span> res = LLONG_MIN/<span class="number">2</span>;</span><br><span class="line">                <span class="keyword">if</span>(bl &lt;= mid)    res = <span class="built_in">max</span>(res, <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>, bl, br, l, mid));</span><br><span class="line">                <span class="keyword">if</span>(br &gt; mid)     res = <span class="built_in">max</span>(res, <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, bl, br, mid+<span class="number">1</span>, r));</span><br><span class="line">                <span class="keyword">return</span> res;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// 区间历史最大值</span></span><br><span class="line">        <span class="keyword">auto</span> queryHis = [&amp;](<span class="keyword">auto</span>&amp;&amp; self, <span class="type">int</span> i, <span class="type">int</span> bl, <span class="type">int</span> br, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(bl &lt;= l &amp;&amp; r &lt;= br)&#123;</span><br><span class="line">                <span class="keyword">return</span> his[i];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="built_in">down</span>(i, mid-l+<span class="number">1</span>, r-mid);</span><br><span class="line">                <span class="type">int</span> res = LLONG_MIN/<span class="number">2</span>;</span><br><span class="line">                <span class="keyword">if</span>(bl &lt;= mid)    res = <span class="built_in">max</span>(res, <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>, bl, br, l, mid));</span><br><span class="line">                <span class="keyword">if</span>(br &gt; mid)     res = <span class="built_in">max</span>(res, <span class="built_in">self</span>(self, i&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, bl, br, mid+<span class="number">1</span>, r));</span><br><span class="line">                <span class="keyword">return</span> res;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// 处理 m 次操作</span></span><br><span class="line">        <span class="keyword">while</span>(m--)&#123;</span><br><span class="line">            <span class="type">int</span> op, l, r;</span><br><span class="line">            cin &gt;&gt; op &gt;&gt; l &gt;&gt; r;</span><br><span class="line">            <span class="keyword">if</span>(op == <span class="number">1</span>)&#123;</span><br><span class="line">                <span class="type">int</span> x; cin &gt;&gt; x;</span><br><span class="line">                <span class="built_in">addRange</span>(addRange, <span class="number">1</span>, l, r, x, <span class="number">1</span>, n);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">2</span>)&#123;</span><br><span class="line">                <span class="type">int</span> x; cin &gt;&gt; x;</span><br><span class="line">                <span class="built_in">chminRange</span>(chminRange, <span class="number">1</span>, l, r, x, <span class="number">1</span>, n);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">3</span>)&#123;</span><br><span class="line">                cout &lt;&lt; <span class="built_in">querySum</span>(querySum, <span class="number">1</span>, l, r, <span class="number">1</span>, n) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">4</span>)&#123;</span><br><span class="line">                cout &lt;&lt; <span class="built_in">queryMax</span>(queryMax, <span class="number">1</span>, l, r, <span class="number">1</span>, n) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(op == <span class="number">5</span>)&#123;</span><br><span class="line">                cout &lt;&lt; <span class="built_in">queryHis</span>(queryHis, <span class="number">1</span>, l, r, <span class="number">1</span>, n) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="结合摩尔投票"><a href="#结合摩尔投票" class="headerlink" title="结合摩尔投票"></a>结合摩尔投票</h4><h5 id="经典摩尔投票，求数组中出现次数大于-frac-n-2-d-数"><a href="#经典摩尔投票，求数组中出现次数大于-frac-n-2-d-数" class="headerlink" title="经典摩尔投票，求数组中出现次数大于$\frac{n}{2}$d 数"></a>经典摩尔投票，求数组中出现次数大于$\frac{n}{2}$d 数</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">majorityElement</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">  		<span class="type">int</span> now = <span class="number">-1</span>, cnt = <span class="number">0</span>;</span><br><span class="line">  		<span class="keyword">for</span>(<span class="keyword">auto</span> x : nums)&#123;</span><br><span class="line">  			<span class="keyword">if</span>(!cnt)&#123;</span><br><span class="line">  				now = x;</span><br><span class="line">  				cnt = <span class="number">1</span>;</span><br><span class="line">  			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  				<span class="keyword">if</span>(now == x)&#123;</span><br><span class="line">  					cnt ++;</span><br><span class="line">  				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  					cnt --;</span><br><span class="line">  				&#125;</span><br><span class="line">  			&#125;</span><br><span class="line">  		&#125;</span><br><span class="line">  		<span class="keyword">return</span> now;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="结合线段树求区间海王数"><a href="#结合线段树求区间海王数" class="headerlink" title="结合线段树求区间海王数"></a>结合线段树求区间海王数</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://leetcode.cn/problems/online-majority-element-in-subarray/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MajorityChecker</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; val, cnt, v1;</span><br><span class="line">	vector&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&gt; v2;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(!cnt[i &lt;&lt; <span class="number">1</span>] &amp;&amp; !cnt[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>])&#123;</span><br><span class="line">			cnt[i] = <span class="number">0</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(!cnt[i &lt;&lt; <span class="number">1</span>])&#123;</span><br><span class="line">			cnt[i] = cnt[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">			val[i] = val[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(!cnt[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>])&#123;</span><br><span class="line">			cnt[i] = cnt[i &lt;&lt; <span class="number">1</span>];</span><br><span class="line">			val[i] = val[i &lt;&lt; <span class="number">1</span>];</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(val[i &lt;&lt; <span class="number">1</span>] == val[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>])&#123;</span><br><span class="line">				val[i] = val[i &lt;&lt; <span class="number">1</span>];</span><br><span class="line">				cnt[i] = cnt[i &lt;&lt; <span class="number">1</span>] + cnt[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">if</span>(cnt[i &lt;&lt; <span class="number">1</span>] &gt;= cnt[i &lt;&lt; <span class="number">1</span>| <span class="number">1</span>])&#123;</span><br><span class="line">					val[i] = val[i &lt;&lt; <span class="number">1</span>];</span><br><span class="line">					cnt[i] = cnt[i &lt;&lt; <span class="number">1</span>] - cnt[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					val[i] = val[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">					cnt[i] = cnt[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] - cnt[i &lt;&lt; <span class="number">1</span>];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(l == r)&#123;</span><br><span class="line">			cnt[i] = <span class="number">1</span>;</span><br><span class="line">			val[i] = v1[l];</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			<span class="built_in">build</span>(i &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">			<span class="built_in">build</span>(i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">			<span class="built_in">up</span>(i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; <span class="title">get</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> bl, <span class="type">int</span> br, <span class="type">int</span> l, <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(bl &lt;= l &amp;&amp; br &gt;= r)&#123;</span><br><span class="line">			<span class="keyword">return</span> &#123;val[i], cnt[i]&#125;;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; left = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;, right = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;, ans;</span><br><span class="line">			<span class="keyword">if</span>(bl &lt;= mid)&#123;</span><br><span class="line">				left = <span class="built_in">get</span>(i &lt;&lt; <span class="number">1</span>, bl, br, l, mid);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(br &gt; mid)&#123;</span><br><span class="line">				right = <span class="built_in">get</span>(i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, bl, br, mid + <span class="number">1</span>, r);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(!left.sc &amp;&amp; !right.sc)&#123;</span><br><span class="line">				ans.sc = <span class="number">0</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(!left.sc)&#123;</span><br><span class="line">				ans.fr = right.fr;</span><br><span class="line">				ans.sc = right.sc;</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(!right.sc)&#123;</span><br><span class="line">				ans.fr = left.fr;</span><br><span class="line">				ans.sc = left.sc;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">if</span>(left.fr == right.fr)&#123;</span><br><span class="line">					ans.fr = left.fr;</span><br><span class="line">					ans.sc = left.sc + right.sc;</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					<span class="keyword">if</span>(left.sc &gt;= right.sc)&#123;</span><br><span class="line">						ans.fr = left.fr;</span><br><span class="line">						ans.sc = left.sc - right.sc;</span><br><span class="line">					&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">						ans.fr = right.fr;</span><br><span class="line">						ans.sc = right.sc - left.sc;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> ans;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> in)</span> </span>&#123;</span><br><span class="line">		<span class="type">int</span> l = <span class="number">0</span>, r = n - <span class="number">1</span>;</span><br><span class="line">		<span class="type">int</span> mid, ans = <span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">			mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(v2[mid].fr &gt; x)&#123;</span><br><span class="line">				r = mid - <span class="number">1</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(v2[mid].fr &lt; x)&#123;</span><br><span class="line">				l = mid + <span class="number">1</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(v2[mid].sc &gt;= in)&#123;</span><br><span class="line">                    				ans = mid;</span><br><span class="line">					r = mid - <span class="number">1</span>;</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					l = mid + <span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line">	&#125;;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">find2</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> in)</span> </span>&#123;</span><br><span class="line">		<span class="type">int</span> l = <span class="number">0</span>, r = n - <span class="number">1</span>;</span><br><span class="line">		<span class="type">int</span> mid, ans = <span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">			mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(v2[mid].fr &gt; x)&#123;</span><br><span class="line">				r = mid - <span class="number">1</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(v2[mid].fr &lt; x)&#123;</span><br><span class="line">				l = mid + <span class="number">1</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(v2[mid].sc &lt;= in)&#123;</span><br><span class="line">                    				ans = mid;</span><br><span class="line">					l = mid + <span class="number">1</span>;</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					r = mid - <span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line">	&#125;;</span><br><span class="line">    <span class="built_in">MajorityChecker</span>(vector&lt;<span class="type">int</span>&gt;&amp; arr) &#123;</span><br><span class="line">    	v1.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">auto</span> x : arr)&#123;</span><br><span class="line">    		v1.<span class="built_in">push_back</span>(x);</span><br><span class="line">    	&#125;</span><br><span class="line">     	n = arr.<span class="built_in">size</span>();</span><br><span class="line">     	val.<span class="built_in">resize</span>(n &lt;&lt; <span class="number">2</span>);</span><br><span class="line">     	cnt.<span class="built_in">resize</span>(n &lt;&lt; <span class="number">2</span>); </span><br><span class="line">     	<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">     	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">     		v2.<span class="built_in">push_back</span>(&#123;v1[i], i&#125;);</span><br><span class="line">     	&#125;</span><br><span class="line">     	<span class="built_in">sort</span>(v2.<span class="built_in">begin</span>(), v2.<span class="built_in">end</span>(), [](pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; a, pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; b)&#123;</span><br><span class="line">     		<span class="keyword">if</span>(a.fr == b.fr)&#123;</span><br><span class="line">     			<span class="keyword">return</span> a.sc &lt; b.sc;</span><br><span class="line">     		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">     			<span class="keyword">return</span> a.fr &lt; b.fr;</span><br><span class="line">     		&#125;</span><br><span class="line">     	&#125;);</span><br><span class="line">        <span class="comment">// for(int i = 0; i &lt; n; i ++)&#123;</span></span><br><span class="line">        <span class="comment">//     cout &lt;&lt; v2[i].fr &lt;&lt; &quot; &quot; &lt;&lt; v2[i].sc &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> left, <span class="type">int</span> right, <span class="type">int</span> threshold)</span> </span>&#123;</span><br><span class="line">    	left ++, right ++;</span><br><span class="line">    	pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt; temp = <span class="built_in">get</span>(<span class="number">1</span>, left, right, <span class="number">1</span>, n);</span><br><span class="line">    	<span class="keyword">if</span>(temp.sc == <span class="number">0</span>)&#123;</span><br><span class="line">    		<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    	&#125;</span><br><span class="line">        <span class="comment">// cout &lt;&lt; temp.fr &lt;&lt; &quot; &quot; &lt;&lt;  temp.sc &lt;&lt; &quot; &quot;;</span></span><br><span class="line">    	<span class="type">int</span> l = <span class="built_in">find</span>(temp.fr, left), r = <span class="built_in">find2</span>(temp.fr, right);</span><br><span class="line">        <span class="comment">// cout &lt;&lt; &quot;L; &quot; &lt;&lt;  left &lt;&lt; &quot; R: &quot; &lt;&lt; right &lt;&lt; &quot; l1: &quot; &lt;&lt; l &lt;&lt; &quot; r1: &quot; &lt;&lt; r &lt;&lt; &quot;\n&quot;; </span></span><br><span class="line">    	<span class="keyword">return</span> (r - l + <span class="number">1</span>) &gt;= threshold ? temp.fr : <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="求一个数组中某一个区间出现了某个数的次数"><a href="#求一个数组中某一个区间出现了某个数的次数" class="headerlink" title="求一个数组中某一个区间出现了某个数的次数"></a>求一个数组中某一个区间出现了某个数的次数</h5><p>参考上面摩尔投票结合线段树的例子，将一个数组按照数的大小和出现顺序升序排序，然后用不同逻辑的二分查找得到相对位置</p>
<h3 id="稀疏表ST"><a href="#稀疏表ST" class="headerlink" title="稀疏表ST"></a>稀疏表ST</h3><p>**Sparse Table（稀疏表）**是一种高效的数据结构，主要用于 <strong>静态数组的区间最值查询（RMQ）</strong>。</p>
<ul>
<li>适用于：<strong>查询频繁，修改不需要或很少</strong></li>
<li>查询时间复杂度：<strong>O(1)</strong></li>
<li>预处理时间复杂度：<strong>O(n log n)</strong></li>
</ul>
<p>支持的运算</p>
<p>Sparse Table 支持 <strong>幂等操作（idempotent operations）</strong>：</p>
<ul>
<li><code>min()</code> ✅</li>
<li><code>max()</code> ✅</li>
<li><code>gcd()</code> ✅</li>
<li><code>lcm()</code> ❌（不满足幂等性）</li>
<li><code>sum()</code> ❌（不满足幂等性）</li>
</ul>
<p>核心构建流程（以最大值为例）</p>
<ol>
<li>定义</li>
</ol>
<ul>
<li><code>st[i][j]</code> 表示从 <strong>下标 i 开始，长度为 2^j 的区间最大值</strong></li>
</ul>
<ol start="2">
<li>初始化</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    st[i][<span class="number">0</span>] = arr[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>状态转移</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; (<span class="number">1</span> &lt;&lt; j) &lt;= n; j++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= n; i++) &#123;</span><br><span class="line">        st[i][j] = <span class="built_in">max</span>(st[i][j - <span class="number">1</span>], st[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>预处理 log2 表</p>
<p>为什么要提前预处理 <code>log2[]</code>？</p>
<p>查询时需计算区间长度对应的 <code>log2(r - l + 1)</code>，预处理可避免浮点误差和时间浪费</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">log2[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    log2[i] = log2[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>区间查询（以最大值为例）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> k = log2[r - l + <span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> res = <span class="built_in">max</span>(st[l][k], st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br></pre></td></tr></table></figure>

<p>这个查询方式的核心是使用<strong>两个长度为 <code>2^k</code> 的区间覆盖整个 <code>[l, r]</code> 区间</strong>。</p>
<p>Luogu P4155：环形区间覆盖跳跃优化</p>
<p>**目标：**给定一系列区间，在环上查找覆盖长度为 <code>m</code> 所需的最少跳跃次数（倍增思想）</p>
<p><strong>关键用法：</strong></p>
<ul>
<li><code>st[i][j]</code> 表示从第 <code>i</code> 个区间开始，跳 <code>2^j</code> 步可覆盖到的位置</li>
</ul>
<p><strong>构建：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">st[i][<span class="number">0</span>] = rightmost reachable from i</span><br><span class="line">st[i][j] = st[st[i][j - <span class="number">1</span>]][j - <span class="number">1</span>];</span><br></pre></td></tr></table></figure>

<p><strong>查询：</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j = logn; j &gt;= <span class="number">0</span>; j--) &#123;</span><br><span class="line">    <span class="keyword">if</span> (v1[st[cur][j]][<span class="number">2</span>] &lt; goal) &#123;</span><br><span class="line">        cur = st[cur][j];</span><br><span class="line">        ans += <span class="number">1</span> &lt;&lt; j;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>利用 Sparse Table 进行跳跃优化（倍增思想）</p>
<p>每次跳跃代表一段区间，用于计算覆盖长度最少的路径</p>
<p>模板封装（最值查询）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, LOG = <span class="number">20</span>;</span><br><span class="line"><span class="type">int</span> st[N][LOG], log2[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build_st</span><span class="params">(<span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; a)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n = a.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">    log2[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        st[i][<span class="number">0</span>] = a[i];</span><br><span class="line">        log2[i] = log2[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; (<span class="number">1</span> &lt;&lt; j) &lt;= n; j++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= n; i++) &#123;</span><br><span class="line">            st[i][j] = <span class="built_in">max</span>(st[i][j - <span class="number">1</span>], st[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query_max</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> k = log2[r - l + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>(st[l][k], st[r - (<span class="number">1</span> &lt;&lt; k) + <span class="number">1</span>][k]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="LCA"><a href="#LCA" class="headerlink" title="LCA"></a>LCA</h3><p>最近祖先问题，用于快速查询树中两个节点的最近公共祖先。</p>
<h4 id="采用deep数组和st表"><a href="#采用deep数组和st表" class="headerlink" title="采用deep数组和st表"></a>采用deep数组和st表</h4><p>deep数组用于记录深度，st表用于快速查询父亲及以上节点</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P3379</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>), cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">	<span class="keyword">while</span>(t --)&#123;</span><br><span class="line">		<span class="type">int</span> n, m, root;</span><br><span class="line">		cin &gt;&gt; n &gt;&gt; m &gt;&gt; root;</span><br><span class="line">		<span class="function">vector <span class="title">adj</span><span class="params">(n + <span class="number">1</span>, vector&lt;<span class="type">int</span>&gt;())</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;  i &lt; n; i ++)&#123;</span><br><span class="line">			<span class="type">int</span> u, v;</span><br><span class="line">			cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">			adj[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">			adj[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">		&#125;</span><br><span class="line">        <span class="comment">// 构建LCA结构</span></span><br><span class="line">		<span class="type">int</span> n1 = <span class="built_in">log2</span>(n);</span><br><span class="line">		<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">deep</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">		<span class="function">vector <span class="title">st</span><span class="params">(n + <span class="number">1</span>, vector&lt;<span class="type">int</span>&gt;(n1 + <span class="number">1</span>))</span></span>;</span><br><span class="line">		<span class="keyword">auto</span> dfs = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> u, <span class="type">int</span> last, <span class="type">int</span> d) -&gt; <span class="type">void</span>&#123;</span><br><span class="line">			deep[u] = d;</span><br><span class="line">			st[u][<span class="number">0</span>] = last;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n1; i ++)&#123;</span><br><span class="line">				st[u][i] = st[st[u][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">auto</span> v : adj[u])&#123;</span><br><span class="line">				<span class="keyword">if</span>(v != last)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, v, u, d + <span class="number">1</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="built_in">dfs</span>(dfs, root, root, <span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i ++)&#123;</span><br><span class="line">			<span class="type">int</span> u, v;</span><br><span class="line">			cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">			<span class="comment">// 查询公共祖先部分部分</span></span><br><span class="line">            <span class="comment">// 先统一高度</span></span><br><span class="line">			<span class="keyword">if</span>(deep[u] &lt; deep[v])&#123;</span><br><span class="line">				<span class="built_in">swap</span>(u, v);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span>(<span class="type">int</span> j = n1; j &gt;= <span class="number">0</span>; j --)&#123;</span><br><span class="line">				<span class="keyword">if</span>(deep[st[u][j]] &gt;= deep[v])&#123;</span><br><span class="line">					u = st[u][j];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">            <span class="comment">// 特判</span></span><br><span class="line">			<span class="keyword">if</span>(u == v)&#123;</span><br><span class="line">				cout &lt;&lt; v &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="type">int</span> j = n1; j &gt;= <span class="number">0</span>; j --)&#123;</span><br><span class="line">					<span class="keyword">if</span>(st[u][j] != st[v][j])&#123;</span><br><span class="line">						u = st[u][j];</span><br><span class="line">						v = st[v][j];</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				cout &lt;&lt; st[u][<span class="number">0</span>] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Tarjan"><a href="#Tarjan" class="headerlink" title="Tarjan"></a>Tarjan</h4><p>利用并查集来一次dfs就构建好lca信息</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P3379</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>), cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">	<span class="keyword">while</span>(t --)&#123;</span><br><span class="line">		<span class="type">int</span> n, m, root;</span><br><span class="line">		cin &gt;&gt; n &gt;&gt; m &gt;&gt; root;</span><br><span class="line">		<span class="function">vector <span class="title">adj</span><span class="params">(n + <span class="number">1</span>, vector&lt;<span class="type">int</span>&gt;())</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, u, v; i &lt; n; i ++)&#123;</span><br><span class="line">			cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">			adj[u].<span class="built_in">push_back</span>(v);</span><br><span class="line">			adj[v].<span class="built_in">push_back</span>(u);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function">vector <span class="title">adj2</span><span class="params">(m + <span class="number">1</span>, vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt;())</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, u, v; i &lt;= m; i ++)&#123;</span><br><span class="line">			cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">			adj2[u].<span class="built_in">push_back</span>(&#123;v, i&#125;);</span><br><span class="line">			adj2[v].<span class="built_in">push_back</span>(&#123;u, i&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">fa</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">ans</span><span class="params">(m + <span class="number">1</span>)</span></span>;</span><br><span class="line">		<span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">vi</span><span class="params">(n + <span class="number">1</span>, <span class="literal">false</span>)</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">			fa[i] = i;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">auto</span> find = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(x != fa[x])&#123;</span><br><span class="line">				fa[x] = <span class="built_in">f</span>(f, fa[x]);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> fa[x];</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> tarjin = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> u, <span class="type">int</span> last) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">			vi[u] = <span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">auto</span> v : adj[u])&#123;</span><br><span class="line">				<span class="keyword">if</span>(v != last)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, v, u);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">auto</span> [v, n1] : adj2[u])&#123;</span><br><span class="line">				<span class="keyword">if</span>(vi[v])&#123;</span><br><span class="line">					ans[n1] = <span class="built_in">find</span>(find, v);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			fa[u] = last;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="built_in">tarjin</span>(tarjin, root, <span class="number">-1</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i ++)&#123;</span><br><span class="line">			cout &lt;&lt; ans[i] &lt;&lt; <span class="string">&quot; \n&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3379">练习题</a></p>
<h3 id="树的重心"><a href="#树的重心" class="headerlink" title="树的重心"></a>树的重心</h3><p>如果在树中选择某个节点并删除，这棵树将分为若干棵子树，使所有子树最大值最小的节点被称为整个树的重心。</p>
<p>性质：</p>
<ul>
<li>树的重心如果不唯一，则至多有两个，且这两个重心相邻。</li>
<li>以树的重心为根时，所有子树的大小都不超过整棵树大小的一半。</li>
<li>树中所有点到某个点的距离和中，到重心的距离和是最小的；如果有两个重心，那么到它们的距离和一样。</li>
<li>把两棵树通过一条边相连得到一棵新的树，那么新的树的重心在连接原来两棵树的重心的路径上。</li>
<li>在一棵树上添加或删除一个叶子，那么它的重心最多只移动一条边的距离。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">5e4</span> + <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> head[N] ,next1[N &lt;&lt; <span class="number">1</span>], to[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="type">int</span> size1[N], max1[N];</span><br><span class="line"><span class="type">int</span> cnt1 = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span> <span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">	next1[cnt1] = head[u];</span><br><span class="line">	to[cnt1] = v;</span><br><span class="line">	head[u] = cnt1 ++;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> last)</span></span>&#123;</span><br><span class="line">	size1[u] = <span class="number">1</span>;</span><br><span class="line">	max1[u] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> ei = head[u], v; ei; ei = next1[ei])&#123;</span><br><span class="line">		v = to[ei];</span><br><span class="line">		<span class="keyword">if</span>(v != last)&#123;</span><br><span class="line">			<span class="built_in">dfs</span>(v, u);</span><br><span class="line">			max1[u] = <span class="built_in">max</span>(max1[u], size1[v]);</span><br><span class="line">			size1[u] += size1[v];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	max1[u] = <span class="built_in">max</span>(max1[u], n - size1[u]);;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">	<span class="keyword">while</span>(t --)&#123;</span><br><span class="line">		cin &gt;&gt; n;</span><br><span class="line">		<span class="built_in">fill</span>(head, head + <span class="number">1</span> + n, <span class="number">0</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i ++)&#123;</span><br><span class="line">			<span class="type">int</span> u, v;</span><br><span class="line">			cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">			<span class="built_in">add</span>(u, v);</span><br><span class="line">			<span class="built_in">add</span>(v, u);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">		<span class="type">int</span> ans[<span class="number">2</span>];</span><br><span class="line">		<span class="type">int</span> m = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">            <span class="comment">// 依照树的重心的定义</span></span><br><span class="line">			<span class="keyword">if</span>(max1[i] &lt;= n &gt;&gt; <span class="number">1</span>)&#123;</span><br><span class="line">				ans[m ++] = i;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i ++)&#123;</span><br><span class="line">			cout &lt;&lt; ans[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当节点有值时，重心的依据是节点权而不是边权。</p>
<h3 id="树的直径"><a href="#树的直径" class="headerlink" title="树的直径"></a>树的直径</h3><p>树上任意两点之间最常的简单路径为树的直径，一棵树可以有多条直径，长度相等</p>
<h4 id="两次DFS"><a href="#两次DFS" class="headerlink" title="两次DFS"></a>两次DFS</h4><p>适用与无负边树</p>
<p>首先从任意节点 y 开始进行第一次 DFS，到达距离其最远的节点，记为 z，然后再从z 开始做第二次 DFS，到达距离z最远的节点，记为z’，则 $\delta(z,z’)$ 即为树的直径。</p>
<p>显然，如果第一次 DFS 到达的节点z是直径的一端，那么第二次 DFS 到达的节点z’一定是直径的一端。我们只需证明在任意情况下，z必为直径的一端。</p>
<p>定理：在一棵树上，从任意节点y开始进行一次 DFS，到达的距离其最远的节点z必为直径的一端。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n;</span><br><span class="line">cin &gt;&gt; n;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span>, <span class="title">next</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">to</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">weight</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="type">int</span> cnt1 = <span class="number">1</span>;</span><br><span class="line"><span class="comment">// 两次DFS</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dis</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span>, <span class="title">fa</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">len</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="type">int</span> st, en;</span><br><span class="line"><span class="keyword">auto</span> dfs = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> u, <span class="type">int</span> last, <span class="type">int</span> val) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">    dis[u] = val;</span><br><span class="line">    fa[u] = last;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> ei = head[u], v, w; ei; ei = next[ei])&#123;</span><br><span class="line">        v = to[ei];</span><br><span class="line">        w = weight[ei];</span><br><span class="line">        <span class="keyword">if</span>(v != last)&#123;</span><br><span class="line">            len[v] = w;</span><br><span class="line">            <span class="built_in">f</span>(f, v, u, val + w);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">dfs</span>(dfs, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, max1 = <span class="number">0</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(max1 &lt; dis[i])&#123;</span><br><span class="line">        max1 = dis[i];</span><br><span class="line">        dis[i] = len[i] = <span class="number">0</span>;</span><br><span class="line">        st = i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">dfs</span>(dfs, st, <span class="number">-1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, max1 = <span class="number">0</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    <span class="keyword">if</span>(max1 &lt; dis[i])&#123;</span><br><span class="line">        max1 = dis[i];</span><br><span class="line">        en = i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> sum1 = dis[en]; <span class="comment">// 直径</span></span><br></pre></td></tr></table></figure>

<h4 id="树形DP"><a href="#树形DP" class="headerlink" title="树形DP"></a>树形DP</h4><p>可用于有负边树</p>
<p>我们记录当1为树的根时，每个节点作为子树的根向下，所能延伸的最长路径长度$d_{1}$与次长路径（与最长路径无公共边）$d_{2}$，那么直径就是对于每一个点，该点的$d_{1}+d_{2}$能取到的最大值</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head1</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span>, <span class="title">next1</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">to1</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span>, <span class="title">weight</span><span class="params">(n &lt;&lt; <span class="number">1</span> | <span class="number">1</span>)</span></span>;</span><br><span class="line">cnt1 = <span class="number">1</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">ans</span><span class="params">(n + <span class="number">1</span>)</span>，<span class="title">v1</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="keyword">auto</span> dfs3 = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> u, <span class="type">int</span> last) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">    ans[u] = <span class="number">0</span>, v1[u] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> ei = head1[u], v, w; ei; ei = next1[ei])&#123;</span><br><span class="line">        v = to1[ei], w = weight[ei];</span><br><span class="line">        <span class="keyword">if</span>(v != last)&#123;</span><br><span class="line">            <span class="built_in">f</span>(f, v, u);</span><br><span class="line">            ans[u] = <span class="built_in">max</span>(ans[u], v1[u] + v1[v] + w);</span><br><span class="line">            v1[u] = <span class="built_in">max</span>(v1[u], v1[v] + w);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">dfs3</span>(dfs3, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="type">int</span> max2 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    max2 = <span class="built_in">max</span>(max2, ans[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="并查集"><a href="#并查集" class="headerlink" title="并查集"></a>并查集</h3><p>对数据进行分类</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 递归找祖先</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x != fa[x]) fa[x] = <span class="built_in">find</span>(fa[x]);</span><br><span class="line">    <span class="keyword">return</span> fa[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">U</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">    fa[<span class="built_in">find</span>(x)] = <span class="built_in">find</span>(y);</span><br><span class="line">    <span class="built_in">find</span>(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后使用前记得统一根，即便利一遍时操作find</p>
<h3 id="常见二分"><a href="#常见二分" class="headerlink" title="常见二分"></a>常见二分</h3><p>加速查询</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; v1 = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ,<span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line"><span class="comment">// 最小大于等于</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F1</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> r = v1.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> ans, mid;</span><br><span class="line">    <span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(x &gt;= v1[mid])&#123;</span><br><span class="line">            ans = mid;</span><br><span class="line">            l = mid - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 最小大于</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F2</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> r = v1.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> ans, mid;</span><br><span class="line">    <span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(x &gt; v1[mid])&#123;</span><br><span class="line">            ans = mid;</span><br><span class="line">            l = mid - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 最长递增子序列</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F1</span><span class="params">(<span class="type">int</span> x, vector&lt;<span class="type">int</span>&gt; &amp; v)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> r = v1.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> mid;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(x &gt; v[mid]) l = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            r = mid - <span class="number">1</span>;</span><br><span class="line">            ans = mid;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 最长递减子序列</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F2</span><span class="params">(<span class="type">int</span> x, vector&lt;<span class="type">int</span>&gt; &amp; v)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> r = v1.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> mid;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(x &lt; v[mid]) l = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            r = mid - <span class="number">1</span>;</span><br><span class="line">            ans = mid;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="三分"><a href="#三分" class="headerlink" title="三分"></a>三分</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// F视具体情况</span></span><br><span class="line"><span class="function">ll <span class="title">ternary_search</span><span class="params">(ll l, ll r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (r - l &gt; <span class="number">3</span>) &#123;</span><br><span class="line">        ll m1 = l + (r - l) / <span class="number">3</span>;</span><br><span class="line">        ll m2 = r - (r - l) / <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">F</span>(m1) &lt;= <span class="built_in">F</span>(m2)) &#123;</span><br><span class="line">            r = m2;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            l = m1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll best = <span class="number">1e9</span>;</span><br><span class="line">    <span class="comment">// 最后暴力求解</span></span><br><span class="line">    <span class="keyword">for</span> (ll i = l; i &lt;= r; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">F</span>(i) &lt; <span class="built_in">F</span>(best)) &#123;</span><br><span class="line">            best = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> best;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="博弈论（SG定理）"><a href="#博弈论（SG定理）" class="headerlink" title="博弈论（SG定理）"></a>博弈论（<code>SG</code>定理）</h3><p>所有相同子游戏最终<code>sg</code>异或结果为0则先手必败，不为零则先手必胜，<code>sg</code>为从某一节点开始，到最大限度往前便利后的第一个没有出现的自然数。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// 计算集合中缺失的最小非负整数（mex函数）</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">mex</span><span class="params">(<span class="type">const</span> set&lt;<span class="type">int</span>&gt;&amp; s)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> m = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (s.<span class="built_in">count</span>(m)) m++;</span><br><span class="line">    <span class="keyword">return</span> m;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;请输入石子堆的石子数量：&quot;</span>;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="comment">// 允许的操作：每次可以取 1、2 或 3 个石子</span></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; moves = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;;</span><br><span class="line">    <span class="comment">// 动态规划数组，sg[i] 表示当前石子数量为 i 时的 SG 值</span></span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sg</span><span class="params">(n+<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    sg[<span class="number">0</span>] = <span class="number">0</span>; <span class="comment">// 没有石子时，SG值为0</span></span><br><span class="line">    <span class="comment">// 计算每个状态的 SG 值</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">        set&lt;<span class="type">int</span>&gt; nextSG;</span><br><span class="line">        <span class="comment">// 对每一种允许的走法，计算下一状态的 SG 值</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> move : moves) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i - move &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                nextSG.<span class="built_in">insert</span>(sg[i - move]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        sg[i] = <span class="built_in">mex</span>(nextSG);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;状态 &quot;</span> &lt;&lt; n &lt;&lt; <span class="string">&quot; 的 SG 值为：&quot;</span> &lt;&lt; sg[n] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(sg[n] != <span class="number">0</span>)</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;先手必胜\n&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;后手必胜\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="乘积最大子数组"><a href="#乘积最大子数组" class="headerlink" title="乘积最大子数组"></a>乘积最大子数组</h3><p>保留乘积最小的结果以准备触底反弹</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line"><span class="type">int</span> min1 = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> max1 = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> ans1 = INT_MIN;</span><br><span class="line"><span class="type">int</span> pre1 = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> pre2 = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; v1.<span class="built_in">size</span>(); i ++)&#123;</span><br><span class="line">    max1 = <span class="built_in">max</span>(&#123;v1[i], pre1 * v1[i], pre2 * v1[i]&#125;);</span><br><span class="line">    min1 = <span class="built_in">min</span>(&#123;v1[i], pre1 * v1[i], pre2 * v1[i]&#125;);</span><br><span class="line">    pre1 = max1;</span><br><span class="line">    pre2 = min1;</span><br><span class="line">    ans1 = <span class="built_in">max</span>(ans1, max1);</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; ans1 &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="栈"><a href="#栈" class="headerlink" title="栈"></a>栈</h3><h4 id="单调栈"><a href="#单调栈" class="headerlink" title="单调栈"></a>单调栈</h4><p>求某一侧第一个 大于或者小于其的数</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="comment">// 求右边第一个比其大的数</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp; v1, <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">ans</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="type">int</span> size=v1.<span class="built_in">size</span>();</span><br><span class="line">    stack&lt;<span class="type">int</span>&gt; s1;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;size;i++)&#123;</span><br><span class="line">        <span class="keyword">while</span>(!s1.<span class="built_in">empty</span>() &amp;&amp; v1[i] &gt; v1[s1.<span class="built_in">top</span>()])&#123;</span><br><span class="line">            ans[s1.<span class="built_in">top</span>()] = i+<span class="number">1</span>;</span><br><span class="line">            s1.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        s1.<span class="built_in">push</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;size;i++)&#123;</span><br><span class="line">        cout&lt;&lt;ans[i]&lt;&lt;<span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    &#125;cout&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        cin&gt;&gt;v1[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">solve</span>(v1, n);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="最大频率栈"><a href="#最大频率栈" class="headerlink" title="最大频率栈"></a>最大频率栈</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FreqStack</span> &#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    unordered_map&lt;<span class="type">int</span>,vector&lt;<span class="type">int</span>&gt;&gt; s1;</span><br><span class="line">    unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt; t1;</span><br><span class="line">    <span class="type">int</span> max1;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">FreqStack</span>() &#123;</span><br><span class="line">        max1=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> val)</span> </span>&#123;</span><br><span class="line">        t1[val]++;</span><br><span class="line">        s1[t1[val]].<span class="built_in">push_back</span>(val);</span><br><span class="line">        max1=t1[val]&gt;max1?t1[val]:max1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    int pop() 删除并返回堆栈中出现频率最高的元素。</span></span><br><span class="line"><span class="comment">	如果出现频率最高的元素不只一个，则移除并返回最接近栈顶的元素。</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> ans=s1[max1].<span class="built_in">back</span>();</span><br><span class="line">        s1[t1[ans]--].<span class="built_in">pop_back</span>();</span><br><span class="line">        <span class="keyword">if</span>(t1[ans]==<span class="number">0</span>)&#123;</span><br><span class="line">            t1.<span class="built_in">erase</span>(ans);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(s1[max1].<span class="built_in">empty</span>())&#123;</span><br><span class="line">            max1--;</span><br><span class="line">            s1.<span class="built_in">erase</span>(max1+<span class="number">1</span>);</span><br><span class="line">        &#125;<span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="堆"><a href="#堆" class="headerlink" title="堆"></a>堆</h3><h4 id="动态堆寻找中位数"><a href="#动态堆寻找中位数" class="headerlink" title="动态堆寻找中位数"></a>动态堆寻找中位数</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1e5</span>;</span><br><span class="line"><span class="type">int</span> n;               <span class="comment">// 操作次数</span></span><br><span class="line">string op;            <span class="comment">// 输入的操作命令</span></span><br><span class="line"><span class="type">int</span> size1 = <span class="number">0</span>;        <span class="comment">// 当前栈的大小</span></span><br><span class="line"><span class="type">int</span> minsize = <span class="number">0</span>;      <span class="comment">// 小根堆中元素的数量</span></span><br><span class="line"><span class="type">int</span> maxsize = <span class="number">0</span>;      <span class="comment">// 大根堆中元素的数量</span></span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">stack1</span><span class="params">(N)</span></span>;    <span class="comment">// 用于模拟栈，存储所有插入的数字</span></span><br><span class="line">priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;<span class="type">int</span>&gt;&gt; minheap;  <span class="comment">// 小根堆，用于存储大于等于中位数的数</span></span><br><span class="line">priority_queue&lt;<span class="type">int</span>&gt; maxheap;  <span class="comment">// 大根堆，用于存储小于等于中位数的数</span></span><br><span class="line"><span class="comment">// 用于延迟删除的映射：记录需要从堆中删除但还未实际删除的数字及其次数</span></span><br><span class="line">unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; delayed;  </span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">prune</span><span class="params">(T &amp;heap)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 当堆不为空时，检查堆顶元素是否在延迟删除映射中</span></span><br><span class="line">    <span class="keyword">while</span> (!heap.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="type">int</span> num = heap.<span class="built_in">top</span>();</span><br><span class="line">        <span class="keyword">if</span> (delayed.<span class="built_in">count</span>(num)) &#123;  <span class="comment">// 如果堆顶元素需要被删除</span></span><br><span class="line">            delayed[num]--;        <span class="comment">// 延迟删除计数减一</span></span><br><span class="line">            <span class="keyword">if</span> (delayed[num] == <span class="number">0</span>)</span><br><span class="line">                delayed.<span class="built_in">erase</span>(num);  <span class="comment">// 如果次数为0则从映射中删除</span></span><br><span class="line">            heap.<span class="built_in">pop</span>();              <span class="comment">// 弹出堆顶元素</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">break</span>; <span class="comment">// 堆顶元素未被延迟删除，退出循环</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">balance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 如果大根堆的元素比小根堆多超过1个，则将大根堆的堆顶移动到小根堆中</span></span><br><span class="line">    <span class="keyword">if</span> (maxsize &gt; minsize + <span class="number">1</span>) &#123;</span><br><span class="line">        minheap.<span class="built_in">push</span>(maxheap.<span class="built_in">top</span>());</span><br><span class="line">        maxheap.<span class="built_in">pop</span>();</span><br><span class="line">        minsize++;</span><br><span class="line">        maxsize--;</span><br><span class="line">        <span class="built_in">prune</span>(maxheap);  <span class="comment">// 清理大根堆堆顶可能存在的延迟删除元素</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 如果大根堆的元素数目小于小根堆，则将小根堆的堆顶移动到大根堆中</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (maxsize &lt; minsize) &#123;</span><br><span class="line">        maxheap.<span class="built_in">push</span>(minheap.<span class="built_in">top</span>());</span><br><span class="line">        minheap.<span class="built_in">pop</span>();</span><br><span class="line">        maxsize++;</span><br><span class="line">        minsize--;</span><br><span class="line">        <span class="built_in">prune</span>(minheap);  <span class="comment">// 清理小根堆堆顶可能存在的延迟删除元素</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">erase</span><span class="params">(<span class="type">int</span> num)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 标记该数字需要延迟删除</span></span><br><span class="line">    delayed[num]++;</span><br><span class="line">    <span class="keyword">if</span> (num &lt;= maxheap.<span class="built_in">top</span>()) &#123;</span><br><span class="line">        maxsize--;</span><br><span class="line">        <span class="comment">// 如果待删除数字恰好是大根堆堆顶，则立即清理</span></span><br><span class="line">        <span class="keyword">if</span> (num == maxheap.<span class="built_in">top</span>()) &#123;</span><br><span class="line">            <span class="built_in">prune</span>(maxheap);</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        minsize--;</span><br><span class="line">        <span class="comment">// 如果待删除数字恰好是小根堆堆顶，则立即清理</span></span><br><span class="line">        <span class="keyword">if</span> (num == minheap.<span class="built_in">top</span>())</span><br><span class="line">            <span class="built_in">prune</span>(minheap);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">balance</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">void</span>)</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        cin &gt;&gt; op;</span><br><span class="line">        <span class="comment">// peek</span></span><br><span class="line">        <span class="keyword">if</span> (op[<span class="number">1</span>] == <span class="string">&#x27;e&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (size1 == <span class="number">0</span>)</span><br><span class="line">                cout &lt;&lt; <span class="string">&quot;Invalid&quot;</span> &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="comment">// 中位数为大根堆的堆顶</span></span><br><span class="line">                cout &lt;&lt; maxheap.<span class="built_in">top</span>() &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="comment">// pop</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (op[<span class="number">1</span>] == <span class="string">&#x27;o&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (size1 == <span class="number">0</span>)</span><br><span class="line">                cout &lt;&lt; <span class="string">&quot;Invalid&quot;</span> &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 输出栈顶元素</span></span><br><span class="line">                cout &lt;&lt; stack1[size1 - <span class="number">1</span>] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">                <span class="comment">// 删除栈顶元素，并在堆中延迟删除对应数字</span></span><br><span class="line">                <span class="built_in">erase</span>(stack1[--size1]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="comment">// push</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            cin &gt;&gt; stack1[size1++];</span><br><span class="line">            <span class="comment">// 如果大根堆为空，则直接插入到大根堆中</span></span><br><span class="line">            <span class="keyword">if</span> (maxsize == <span class="number">0</span>) &#123;</span><br><span class="line">                maxheap.<span class="built_in">push</span>(stack1[size1 - <span class="number">1</span>]);</span><br><span class="line">                maxsize++;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 根据新插入数字与当前中位数比较，决定放入哪个堆</span></span><br><span class="line">            <span class="keyword">if</span> (stack1[size1 - <span class="number">1</span>] &gt; maxheap.<span class="built_in">top</span>()) &#123;</span><br><span class="line">                minheap.<span class="built_in">push</span>(stack1[size1 - <span class="number">1</span>]);</span><br><span class="line">                minsize++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                maxheap.<span class="built_in">push</span>(stack1[size1 - <span class="number">1</span>]);</span><br><span class="line">                maxsize++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 保持两个堆的平衡</span></span><br><span class="line">            <span class="built_in">balance</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>) -&gt; ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> t; </span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="大小根堆"><a href="#大小根堆" class="headerlink" title="大小根堆"></a>大小根堆</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// 向堆中插入新元素，使其满足大顶堆性质</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heapInsert</span><span class="params">(<span class="type">int</span> arr[], <span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(arr[i] &gt; arr[(i<span class="number">-1</span>)/<span class="number">2</span>]) &#123;</span><br><span class="line">        <span class="built_in">swap</span>(arr[i], arr[(i<span class="number">-1</span>)/<span class="number">2</span>]);</span><br><span class="line">        i = (i<span class="number">-1</span>)/<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 堆化：从下标 i 开始向下调整，使子树满足大顶堆性质，size 为堆的大小</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">heapify</span><span class="params">(<span class="type">int</span> arr[], <span class="type">int</span> i, <span class="type">int</span> size)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = i * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> maxIdx;  <span class="comment">// 保存左右孩子中较大值的下标</span></span><br><span class="line">    <span class="type">int</span> idx;     <span class="comment">// 保存父节点与较大孩子中较大者的下标</span></span><br><span class="line">    <span class="keyword">while</span>(l &lt; size) &#123;</span><br><span class="line">        <span class="comment">// 在左右孩子中选择较大者</span></span><br><span class="line">        maxIdx = (l + <span class="number">1</span> &lt; size &amp;&amp; arr[l+<span class="number">1</span>] &gt; arr[l]) ? l + <span class="number">1</span> : l;</span><br><span class="line">        <span class="comment">// 选择父节点与较大孩子中较大者</span></span><br><span class="line">        idx = (arr[i] &gt; arr[maxIdx]) ? i : maxIdx;</span><br><span class="line">        <span class="keyword">if</span>(idx == i) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">swap</span>(arr[i], arr[idx]);</span><br><span class="line">            i = idx;</span><br><span class="line">            l = i * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">heapPop</span><span class="params">(<span class="type">int</span> arr[], <span class="type">int</span> &amp;size)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(size &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> top = arr[<span class="number">0</span>];             <span class="comment">// 保存堆顶元素</span></span><br><span class="line">    <span class="built_in">swap</span>(arr[<span class="number">0</span>], arr[size - <span class="number">1</span>]);    <span class="comment">// 将堆顶与最后一个元素交换</span></span><br><span class="line">    size--;                       <span class="comment">// 删除最后一个元素</span></span><br><span class="line">    <span class="built_in">heapify</span>(arr, <span class="number">0</span>, size);        <span class="comment">// 从顶端重新调整堆</span></span><br><span class="line">    <span class="keyword">return</span> top;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="扫描线"><a href="#扫描线" class="headerlink" title="扫描线"></a>扫描线</h3><p>利用扫描思想平移某一个轴时，加工另一个轴的信息来一边扫过去就能解决问题</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P5490</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>) -&gt; ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">	<span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">	<span class="keyword">while</span>(t --)&#123;</span><br><span class="line">		<span class="type">int</span> n;</span><br><span class="line">		cin &gt;&gt; n;</span><br><span class="line">		vector&lt;<span class="type">int</span>&gt; v2 = &#123;<span class="number">-2</span>&#125;;</span><br><span class="line">		vector&lt;array&lt;<span class="type">int</span>, 4&gt;&gt; v1;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++)&#123;</span><br><span class="line">			<span class="type">int</span> x1, y1, x2, y2;</span><br><span class="line">			cin &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2;</span><br><span class="line">			v2.<span class="built_in">push_back</span>(y1);</span><br><span class="line">			v2.<span class="built_in">push_back</span>(y2);</span><br><span class="line">			v1.<span class="built_in">push_back</span>(&#123;x1, y1, y2, <span class="number">1</span>&#125;);</span><br><span class="line">			v1.<span class="built_in">push_back</span>(&#123;x2, y1, y2, <span class="number">-1</span>&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">sort</span>(v2.<span class="built_in">begin</span>() + <span class="number">1</span>, v2.<span class="built_in">end</span>());</span><br><span class="line">		<span class="type">int</span> m = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt; v2.<span class="built_in">size</span>(); i ++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(v2[i] != v2[m])&#123;</span><br><span class="line">				v2[++ m] = v2[i];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		v2.<span class="built_in">push_back</span>(v2[m]);</span><br><span class="line">		<span class="keyword">auto</span> find = [&amp;](<span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">			<span class="type">int</span> l = <span class="number">1</span>, r = m;</span><br><span class="line">			<span class="type">int</span> mid, ans = <span class="number">-1</span>;</span><br><span class="line">			<span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">				mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">if</span>(v2[mid] &gt;= x)&#123;</span><br><span class="line">					ans = mid;</span><br><span class="line">					r = mid - <span class="number">1</span>;</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					l = mid + <span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> ans;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">sum1</span><span class="params">(m &lt;&lt; <span class="number">4</span>)</span>, <span class="title">cnt1</span><span class="params">(m &lt;&lt; <span class="number">4</span>)</span>, <span class="title">cover</span><span class="params">(m &lt;&lt; <span class="number">4</span>)</span></span>;</span><br><span class="line">		<span class="keyword">auto</span> build = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(l &lt; r)&#123;</span><br><span class="line">				<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">				<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">			&#125;</span><br><span class="line">			cover[i] = v2[r + <span class="number">1</span>] - v2[l];</span><br><span class="line">			sum1[i] = cnt1[i] = <span class="number">0</span>;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="built_in">build</span>(build, <span class="number">1</span>, <span class="number">1</span>, m);</span><br><span class="line">		<span class="keyword">auto</span> up = [&amp;](<span class="type">int</span> i) &#123;</span><br><span class="line">			<span class="keyword">if</span>(cnt1[i] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">				sum1[i] = cover[i]; </span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				sum1[i] = sum1[i &lt;&lt; <span class="number">1</span>] + sum1[i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> set = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> i, <span class="type">int</span> bl, <span class="type">int</span> br, <span class="type">int</span> val, <span class="type">int</span> l, <span class="type">int</span> r) -&gt; <span class="type">void</span> &#123;</span><br><span class="line">			<span class="keyword">if</span>(bl &lt;= l &amp;&amp; br &gt;= r)&#123;</span><br><span class="line">				cnt1[i] += val;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">if</span>(bl &lt;= mid)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span>, bl, br, val, l, mid);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(br &gt; mid)&#123;</span><br><span class="line">					<span class="built_in">f</span>(f, i &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, bl, br, val, mid + <span class="number">1</span>, r);</span><br><span class="line">				&#125;     </span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">up</span>(i);</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="built_in">sort</span>(v1.<span class="built_in">begin</span>(), v1.<span class="built_in">end</span>());</span><br><span class="line">		<span class="type">int</span> last = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n &lt;&lt; <span class="number">1</span>; i ++)&#123;</span><br><span class="line">			<span class="type">int</span> now = v1[i][<span class="number">0</span>];</span><br><span class="line">			ans += sum1[<span class="number">1</span>] * (now - last);</span><br><span class="line">			<span class="comment">// cout &lt;&lt; sum1[1] &lt;&lt; &quot; &quot; &lt;&lt; now &lt;&lt; &quot; &quot; &lt;&lt; last &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">			last = now;</span><br><span class="line">			<span class="built_in">set</span>(set, <span class="number">1</span>, <span class="built_in">find</span>(v1[i][<span class="number">1</span>]), <span class="built_in">find</span>(v1[i][<span class="number">2</span>]) - <span class="number">1</span>, v1[i][<span class="number">3</span>], <span class="number">1</span>, m);</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><h4 id="归并分治"><a href="#归并分治" class="headerlink" title="归并分治"></a>归并分治</h4><p>分而治之</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 500</span></span><br><span class="line"><span class="type">int</span> a1[M];</span><br><span class="line"><span class="type">int</span> temp[M];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> m,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> i=l;</span><br><span class="line">    <span class="type">int</span> j=m+<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> mark=l;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;=m &amp;&amp; j&lt;=r) a1[mark++]=temp[i]&lt;temp[j]?temp[i++]:temp[j++];</span><br><span class="line">    <span class="keyword">while</span>(i&lt;=m) a1[mark++]=temp[i++];</span><br><span class="line">    <span class="keyword">while</span>(j&lt;=r) a1[mark++]=temp[j++];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k=l;k&lt;=r;k++) temp[k]=a1[k];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">guibing</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(l&gt;=r) <span class="keyword">return</span> ;</span><br><span class="line">	<span class="type">int</span> m=(l+r)/<span class="number">2</span>;</span><br><span class="line">	<span class="built_in">guibing</span>(l,m);</span><br><span class="line">	<span class="built_in">guibing</span>(m+<span class="number">1</span>,r);</span><br><span class="line">	<span class="built_in">merge</span>(l,m,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        cin&gt;&gt;a1[i];</span><br><span class="line">        temp[i]=a1[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">guibing</span>(<span class="number">0</span>,n<span class="number">-1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++) cout&lt;&lt;a1[i]&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="随机快排-选择第-k-小-大-的数"><a href="#随机快排-选择第-k-小-大-的数" class="headerlink" title="随机快排 &amp; 选择第 k 小&#x2F;大 的数"></a>随机快排 &amp; 选择第 k 小&#x2F;大 的数</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 500</span></span><br><span class="line"><span class="comment">// 经典</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">partition1</span><span class="params">(<span class="type">int</span> a1[],<span class="type">int</span> l,<span class="type">int</span> mid,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> i=l;</span><br><span class="line">    <span class="type">int</span> j=r;</span><br><span class="line">    <span class="type">int</span> temp=a1[mid];</span><br><span class="line">    <span class="built_in">swap</span>(a1[mid],a1[l]);</span><br><span class="line">    <span class="keyword">while</span>(i&lt;j)&#123;</span><br><span class="line">        <span class="keyword">while</span>(j&gt;i &amp;&amp; a1[j]&gt;temp)&#123;</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">        a1[i]=a1[j];</span><br><span class="line">        <span class="keyword">while</span>(i&lt;j &amp;&amp; a1[i]&lt;=temp)&#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        a1[j]=a1[i];</span><br><span class="line">    &#125;</span><br><span class="line">    a1[i]=temp;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">qs1</span><span class="params">(<span class="type">int</span> a1[],<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="type">int</span> x=l+(<span class="built_in">rand</span>()%(r-l+<span class="number">1</span>));</span><br><span class="line">    <span class="type">int</span> mid=<span class="built_in">partition1</span>(a1,l,x,r);</span><br><span class="line">    <span class="built_in">qs1</span>(a1,l,mid<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">qs1</span>(a1,mid+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 优化</span></span><br><span class="line"><span class="type">int</span> first;</span><br><span class="line"><span class="type">int</span> second;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">partition2</span><span class="params">(<span class="type">int</span> a1[],<span class="type">int</span> l,<span class="type">int</span> mid,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    first=l;</span><br><span class="line">    second=r;</span><br><span class="line">    <span class="type">int</span> temp=a1[mid];</span><br><span class="line">    <span class="type">int</span> i=l;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;=second)&#123;</span><br><span class="line">        <span class="keyword">if</span>(a1[i]==temp)&#123;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(a1[i]&lt;temp)&#123;</span><br><span class="line">            <span class="built_in">swap</span>(a1[first++],a1[i++]);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">swap</span>(a1[i],a1[second--]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">qs2</span><span class="params">(<span class="type">int</span> a1[],<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l&gt;=r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="type">int</span> x=l+(<span class="built_in">rand</span>()%(r-l+<span class="number">1</span>));</span><br><span class="line">    <span class="built_in">partition2</span>(a1,l,x,r);</span><br><span class="line">    <span class="type">int</span> left=first;</span><br><span class="line">    <span class="type">int</span> right=second;</span><br><span class="line">    <span class="built_in">qs2</span>(a1,l,left<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">qs2</span>(a1,right+<span class="number">1</span>,r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 随机选择第 tar 小的元素（0-based）</span></span><br><span class="line"><span class="comment">// 要求第k大的元素等同于求n - k小的元素</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">randomizedSelect</span><span class="params">(<span class="type">int</span> a1[], <span class="type">int</span> k, <span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>, r = n - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">        <span class="type">int</span> x = l + <span class="built_in">rand</span>() % (r - l + <span class="number">1</span>); <span class="comment">// 随机选取枢纽值</span></span><br><span class="line">        <span class="built_in">partition2</span>(a1, l, x, r); <span class="comment">// 三路划分，结果通过 first 和 second 表示</span></span><br><span class="line">        <span class="keyword">if</span> (k &lt; first) &#123;</span><br><span class="line">            r = first - <span class="number">1</span>; <span class="comment">// 目标在左侧</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (k &gt; second) &#123;</span><br><span class="line">            l = second + <span class="number">1</span>; <span class="comment">// 目标在右侧</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> a1[k]; <span class="comment">// 命中：tar 位于等于区域内</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 若未找到（理论上不会出现），返回 -1 表示错误</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="阶乘与逆元"><a href="#阶乘与逆元" class="headerlink" title="阶乘与逆元"></a>阶乘与逆元</h3><p>乘以逆元等于除以某一个数再取模</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">auto</span> power = [&amp;](<span class="type">int</span> x, <span class="type">int</span> n) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n &amp; <span class="number">1</span>)&#123;</span><br><span class="line">            ans = ans * x % mod;</span><br><span class="line">        &#125;</span><br><span class="line">        x = x * x % mod;</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">fac</span><span class="params">(n + <span class="number">1</span>)</span></span>; <span class="comment">// 阶乘</span></span><br><span class="line">fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    fac[i] = fac[i - <span class="number">1</span>] * i % mod; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">inv</span><span class="params">(n + <span class="number">1</span>)</span></span>; <span class="comment">// 逆元</span></span><br><span class="line">inv[n] = <span class="built_in">power</span>(fac[n], mod - <span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i --)&#123;</span><br><span class="line">    inv[i] = inv[i + <span class="number">1</span>] * (i + <span class="number">1</span>) % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">auto</span> C = [&amp;](<span class="type">int</span> n, <span class="type">int</span> m) -&gt; <span class="type">int</span> &#123; <span class="comment">// 组合数</span></span><br><span class="line">    <span class="keyword">if</span>(m &gt; n)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fac[n] * inv[m] % mod * inv[n - m] % mod;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="线性递推逆元"><a href="#线性递推逆元" class="headerlink" title="线性递推逆元"></a>线性递推逆元</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// p 必须为质数</span></span><br><span class="line">inv2[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">	inv2[i] = (p - p / i) * inv2[p % i] % p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="矩阵快速幂"><a href="#矩阵快速幂" class="headerlink" title="矩阵快速幂"></a>矩阵快速幂</h3><p>加速矩阵计算</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;&gt; <span class="built_in">multiply</span>(<span class="type">const</span> vector&lt;vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;&gt; &amp;a,<span class="type">const</span> vector&lt;vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;&gt; &amp;b) &#123;</span><br><span class="line">		<span class="type">int</span> n = a.<span class="built_in">size</span>(), p = a[<span class="number">0</span>].<span class="built_in">size</span>(), m = b[<span class="number">0</span>].<span class="built_in">size</span>();</span><br><span class="line">		<span class="function">vector <span class="title">ans</span><span class="params">(n, vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;(m, <span class="number">0</span>))</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j++) &#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; p; k++) &#123;</span><br><span class="line">					ans[i][j] += a[i][k] * b[k][j];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line">	&#125;</span><br><span class="line">	vector&lt;vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;&gt; <span class="built_in">power</span>(vector&lt;vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;&gt; v, <span class="type">int</span> cnt) &#123;</span><br><span class="line">		<span class="type">int</span> n = v.<span class="built_in">size</span>();</span><br><span class="line">		vector&lt;vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;&gt; <span class="built_in">ans</span>(n, <span class="built_in">vector</span>&lt;<span class="type">long</span> <span class="type">long</span>&gt;(n, <span class="number">0</span>));</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">			ans[i][i] = <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span> (cnt) &#123;</span><br><span class="line">			<span class="keyword">if</span> (cnt &amp; <span class="number">1</span>) &#123;</span><br><span class="line">				ans = <span class="built_in">multiply</span>(ans, v);</span><br><span class="line">			&#125;</span><br><span class="line">			v = <span class="built_in">multiply</span>(v, v);</span><br><span class="line">			cnt &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">tribonacci</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(n == <span class="number">1</span> || n == <span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        vector&lt;vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;&gt; start = &#123;&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line">        vector&lt;vector&lt;<span class="type">long</span> <span class="type">long</span>&gt;&gt; base = &#123;&#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">multiply</span>(start, <span class="built_in">power</span>(base, n - <span class="number">2</span>))[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="扩展欧几里得算法"><a href="#扩展欧几里得算法" class="headerlink" title="扩展欧几里得算法"></a>扩展欧几里得算法</h3><p>得到某一个ax + by &#x3D; d的各种参数，d为最大公约数，x和y为贝祖系数（裴蜀定理的算法实现）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> x, y, px, py;</span><br><span class="line"><span class="type">int</span> d;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">gcd1</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)&#123;</span><br><span class="line">        x = <span class="number">1</span>;</span><br><span class="line">        y = <span class="number">0</span>;</span><br><span class="line">        d = a;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">gcd1</span>(b, a % b);</span><br><span class="line">        px = x;</span><br><span class="line">        py = y;</span><br><span class="line">        x = py;</span><br><span class="line">        y = px - py * (a / b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>); cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> a, b;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="built_in">gcd1</span>(a, b);</span><br><span class="line">    cout &lt;&lt; (x % b + b) % b &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Stein-GCD算法"><a href="#Stein-GCD算法" class="headerlink" title="Stein GCD算法"></a>Stein GCD算法</h3><p>Stein算法是一种计算两个非负整数的最大公约数的算法。它比传统的欧几里得算法在某些情况下更高效，<br>因为它避免了使用除法操作。该算法利用了以下几条规则：<br>GCD(0, b) &#x3D; b：如果一个数是0，另一个数就是最大公约数。<br>GCD(a, 0) &#x3D; a：同上，如果一个数是0，另一个数就是最大公约数。<br>如果a和b都是偶数，那么GCD(a, b) &#x3D; 2 * GCD(a&#x2F;2, b&#x2F;2)。<br>如果a是偶数且b是奇数，那么GCD(a, b) &#x3D; GCD(a&#x2F;2, b)。<br>如果a是奇数且b是偶数，那么GCD(a, b) &#x3D; GCD(a, b&#x2F;2)。<br>如果a和b都是奇数，并且a &gt;&#x3D; b，那么GCD(a, b) &#x3D; GCD((a - b)&#x2F;2, b)。<br>如果a和b都是奇数，并且a &lt; b，那么GCD(a, b) &#x3D; GCD((b - a)&#x2F;2, a)。<br>通过不断应用这些规则，最终可以将两个数变为0，从而找到它们的最大公约数。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">int</span> <span class="title">steinGCD</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a, <span class="type">unsigned</span> <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a == <span class="number">0</span>) <span class="keyword">return</span> b;</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>) <span class="keyword">return</span> a;</span><br><span class="line">    <span class="comment">// 找到a和b的共同因子2的数量</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> shift = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (((a | b) &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        a &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        shift++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 使a成为奇数</span></span><br><span class="line">    <span class="keyword">while</span> ((a &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        a &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="comment">// 使b成为奇数</span></span><br><span class="line">        <span class="keyword">while</span> ((b &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 保证a &lt;= b</span></span><br><span class="line">        <span class="keyword">if</span> (a &gt; b) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(a, b);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// b - a是偶数，所以我们可以继续右移</span></span><br><span class="line">        b = (b - a);</span><br><span class="line">    &#125; <span class="keyword">while</span> (b != <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// 恢复共同因子2的数量</span></span><br><span class="line">    <span class="keyword">return</span> a &lt;&lt; shift;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Least-Recently-Used-LRU-算法"><a href="#Least-Recently-Used-LRU-算法" class="headerlink" title="Least Recently Used (LRU)算法"></a>Least Recently Used (LRU)算法</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 1010</span></span><br><span class="line"><span class="comment">// Least Recently Used (LRU) 缓存实现</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LRU</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// 定义双向链表节点</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">DoubleNode</span> &#123;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="type">int</span> key;    <span class="comment">// 节点对应的 key</span></span><br><span class="line">        <span class="type">int</span> val;    <span class="comment">// 节点对应的 value</span></span><br><span class="line">        DoubleNode* next; <span class="comment">// 后继节点指针</span></span><br><span class="line">        DoubleNode* last; <span class="comment">// 前驱节点指针</span></span><br><span class="line">        <span class="built_in">DoubleNode</span>(<span class="type">int</span> k, <span class="type">int</span> v): <span class="built_in">key</span>(k), <span class="built_in">val</span>(v), <span class="built_in">last</span>(<span class="literal">nullptr</span>), <span class="built_in">next</span>(<span class="literal">nullptr</span>) &#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 定义双向链表，用于维护访问顺序</span></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">DoubleList</span> &#123;</span><br><span class="line">    <span class="keyword">private</span>:</span><br><span class="line">        DoubleNode* head; <span class="comment">// 链表头部（最久未使用）</span></span><br><span class="line">        DoubleNode* tail; <span class="comment">// 链表尾部（最近使用）</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="built_in">DoubleList</span>(): <span class="built_in">head</span>(<span class="literal">nullptr</span>), <span class="built_in">tail</span>(<span class="literal">nullptr</span>) &#123;&#125;</span><br><span class="line">        <span class="comment">// 在链表尾部添加新节点（最新使用的节点）</span></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">addNode</span><span class="params">(DoubleNode* newNode)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!newNode) <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">if</span> (!head) &#123;</span><br><span class="line">                head = tail = newNode;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                tail-&gt;next = newNode;</span><br><span class="line">                newNode-&gt;last = tail;</span><br><span class="line">                tail = newNode;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 将已有节点移动到链表尾部（表示最近使用）</span></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">moveNodeToTail</span><span class="params">(DoubleNode* node)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (tail == node) <span class="keyword">return</span>;  <span class="comment">// 节点已在尾部，无需移动</span></span><br><span class="line">            <span class="keyword">if</span> (head == node) &#123;        <span class="comment">// 节点位于头部</span></span><br><span class="line">                head = node-&gt;next;</span><br><span class="line">                <span class="keyword">if</span> (head) head-&gt;last = <span class="literal">nullptr</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;                   <span class="comment">// 节点在中间</span></span><br><span class="line">                node-&gt;last-&gt;next = node-&gt;next;</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;next)</span><br><span class="line">                    node-&gt;next-&gt;last = node-&gt;last;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 将节点移动到尾部</span></span><br><span class="line">            node-&gt;last = tail;</span><br><span class="line">            node-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">            <span class="keyword">if</span> (tail) tail-&gt;next = node;</span><br><span class="line">            tail = node;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 移除链表头部节点（最久未使用的节点）并返回该节点</span></span><br><span class="line">        <span class="function">DoubleNode* <span class="title">removeHead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!head) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">            DoubleNode* ans = head;</span><br><span class="line">            <span class="keyword">if</span> (head == tail) &#123;</span><br><span class="line">                head = tail = <span class="literal">nullptr</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                head = head-&gt;next;</span><br><span class="line">                <span class="keyword">if</span> (head) head-&gt;last = <span class="literal">nullptr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="comment">// 辅助函数：清空链表，释放所有节点</span></span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            DoubleNode* cur = head;</span><br><span class="line">            <span class="keyword">while</span>(cur) &#123;</span><br><span class="line">                DoubleNode* next = cur-&gt;next;</span><br><span class="line">                <span class="keyword">delete</span> cur;</span><br><span class="line">                cur = next;</span><br><span class="line">            &#125;</span><br><span class="line">            head = tail = <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;    </span><br><span class="line">        <span class="comment">// 提供链表头部访问，用于析构时遍历</span></span><br><span class="line">        <span class="function">DoubleNode* <span class="title">getHead</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    unordered_map&lt;<span class="type">int</span>, DoubleNode*&gt; keyNodeMap; <span class="comment">// 快速定位 key 对应的节点</span></span><br><span class="line">    DoubleList nodeList;                        <span class="comment">// 维护节点顺序的双向链表</span></span><br><span class="line">    <span class="type">int</span> cap;                                    <span class="comment">// 缓存容量</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// 构造函数</span></span><br><span class="line">    <span class="built_in">LRU</span>(<span class="type">int</span> c): <span class="built_in">cap</span>(c) &#123;&#125;</span><br><span class="line">    <span class="comment">// 析构函数，释放所有申请的内存</span></span><br><span class="line">    ~<span class="built_in">LRU</span>() &#123;</span><br><span class="line">        <span class="comment">// 遍历双向链表释放节点</span></span><br><span class="line">        DoubleNode* cur = nodeList.<span class="built_in">getHead</span>();</span><br><span class="line">        <span class="keyword">while</span>(cur) &#123;</span><br><span class="line">            DoubleNode* next = cur-&gt;next;</span><br><span class="line">            <span class="keyword">delete</span> cur;</span><br><span class="line">            cur = next;</span><br><span class="line">        &#125;</span><br><span class="line">        keyNodeMap.<span class="built_in">clear</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @brief 获取 key 对应的值，并将该节点移到尾部表示最近使用</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * @param key 缓存中的键</span></span><br><span class="line"><span class="comment">     * @return int 若 key 存在则返回对应值，否则返回 -1</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">get</span><span class="params">(<span class="type">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (keyNodeMap.<span class="built_in">count</span>(key)) &#123;</span><br><span class="line">            DoubleNode* ans = keyNodeMap[key];</span><br><span class="line">            nodeList.<span class="built_in">moveNodeToTail</span>(ans);  <span class="comment">// 更新最近使用</span></span><br><span class="line">            <span class="keyword">return</span> ans-&gt;val;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * @brief 向缓存中插入或更新一个 key-value 对</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * 若 key 存在，则更新其值并将节点移到尾部；</span></span><br><span class="line"><span class="comment">     * 若 key 不存在，则插入新节点，若缓存已满，则移除最久未使用的节点。</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * @param key 缓存中的键</span></span><br><span class="line"><span class="comment">     * @param val1 缓存中的值</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">put</span><span class="params">(<span class="type">int</span> key, <span class="type">int</span> val1)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (keyNodeMap.<span class="built_in">count</span>(key)) &#123;</span><br><span class="line">            <span class="comment">// key 存在，更新值并移到尾部</span></span><br><span class="line">            DoubleNode* node = keyNodeMap[key];</span><br><span class="line">            node-&gt;val = val1;</span><br><span class="line">            nodeList.<span class="built_in">moveNodeToTail</span>(node);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 如果缓存已满，删除最久未使用的节点</span></span><br><span class="line">            <span class="keyword">if</span> (keyNodeMap.<span class="built_in">size</span>() == cap) &#123;</span><br><span class="line">                DoubleNode* removed = nodeList.<span class="built_in">removeHead</span>();</span><br><span class="line">                <span class="keyword">if</span>(removed) &#123;</span><br><span class="line">                    keyNodeMap.<span class="built_in">erase</span>(removed-&gt;key);</span><br><span class="line">                    <span class="keyword">delete</span> removed;  <span class="comment">// 释放内存</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 插入新节点</span></span><br><span class="line">            DoubleNode* newNode = <span class="keyword">new</span> <span class="built_in">DoubleNode</span>(key, val1);</span><br><span class="line">            keyNodeMap[key] = newNode;</span><br><span class="line">            nodeList.<span class="built_in">addNode</span>(newNode);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">// 测试用例：创建容量为3的LRU缓存</span></span><br><span class="line">    <span class="function">LRU <span class="title">cache</span><span class="params">(<span class="number">3</span>)</span></span>;</span><br><span class="line">    <span class="comment">// 插入数据</span></span><br><span class="line">    cache.<span class="built_in">put</span>(<span class="number">1</span>, <span class="number">100</span>);</span><br><span class="line">    cache.<span class="built_in">put</span>(<span class="number">2</span>, <span class="number">200</span>);</span><br><span class="line">    cache.<span class="built_in">put</span>(<span class="number">3</span>, <span class="number">300</span>);</span><br><span class="line">    <span class="comment">// 访问 key 1，将其更新为最近使用</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;get(1): &quot;</span> &lt;&lt; cache.<span class="built_in">get</span>(<span class="number">1</span>) &lt;&lt; <span class="string">&quot;\n&quot;</span>; <span class="comment">// 输出 100</span></span><br><span class="line">    <span class="comment">// 插入新数据，当缓存满时会淘汰最久未使用的 key（此时 key 2 被淘汰）</span></span><br><span class="line">    cache.<span class="built_in">put</span>(<span class="number">4</span>, <span class="number">400</span>);</span><br><span class="line">    <span class="comment">// 尝试获取被淘汰的 key 2</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;get(2): &quot;</span> &lt;&lt; cache.<span class="built_in">get</span>(<span class="number">2</span>) &lt;&lt; <span class="string">&quot;\n&quot;</span>; <span class="comment">// 输出 -1，表示不存在</span></span><br><span class="line">    <span class="comment">// 继续获取其他 key 的值</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;get(3): &quot;</span> &lt;&lt; cache.<span class="built_in">get</span>(<span class="number">3</span>) &lt;&lt; <span class="string">&quot;\n&quot;</span>; <span class="comment">// 输出 300</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;get(4): &quot;</span> &lt;&lt; cache.<span class="built_in">get</span>(<span class="number">4</span>) &lt;&lt; <span class="string">&quot;\n&quot;</span>; <span class="comment">// 输出 400</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="二进制位"><a href="#二进制位" class="headerlink" title="二进制位"></a>二进制位</h3><h4 id="位图"><a href="#位图" class="headerlink" title="位图"></a>位图</h4><p>判断某一个数是否存在</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> arr[],<span class="type">int</span> num)</span></span>&#123;</span><br><span class="line">	arr[num/<span class="number">32</span>] |= <span class="number">1</span>&lt;&lt;(num%<span class="number">32</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">remove</span><span class="params">(<span class="type">int</span> arr[],<span class="type">int</span> num)</span></span>&#123;</span><br><span class="line">	arr[num/<span class="number">32</span>] &amp;= ~(<span class="number">1</span>&lt;&lt;(num%<span class="number">32</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverse</span><span class="params">(<span class="type">int</span> arr[],<span class="type">int</span> num)</span></span>&#123;</span><br><span class="line">	arr[num/<span class="number">32</span>] ^= <span class="number">1</span>&lt;&lt;(num%<span class="number">32</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">contains</span><span class="params">(<span class="type">int</span> arr[],<span class="type">int</span> num)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> arr[num/<span class="number">32</span>] &amp; (<span class="number">1</span>&lt;&lt;(num%<span class="number">32</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin&gt;&gt;n;</span><br><span class="line">	<span class="type">int</span> set[(n + <span class="number">32</span> - <span class="number">1</span>) / <span class="number">32</span>]; <span class="comment">// 表示存储n个数需要的大小</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="位运算实现四则运算"><a href="#位运算实现四则运算" class="headerlink" title="位运算实现四则运算"></a>位运算实现四则运算</h4><p>加速运算</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = n;</span><br><span class="line">    <span class="keyword">while</span>(m != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// 无进位相加</span></span><br><span class="line">        ans = n ^ m;</span><br><span class="line">        <span class="comment">// 计算进位，注意进位要左移一位</span></span><br><span class="line">        m = (n &amp; m) &lt;&lt; <span class="number">1</span>;</span><br><span class="line">        n = ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">neg</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 对 n 取反后加 1 得到 -n</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">add</span>(~n, <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">minus1</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">add</span>(n, <span class="built_in">neg</span>(m));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">mul</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(m != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>((m &amp; <span class="number">1</span>) == <span class="number">1</span>) &#123;</span><br><span class="line">            ans = <span class="built_in">add</span>(ans, n);</span><br><span class="line">        &#125;</span><br><span class="line">        n &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        m &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">div1</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 转为正数处理，保存符号信息</span></span><br><span class="line">    <span class="type">int</span> a = n &lt; <span class="number">0</span> ? <span class="built_in">neg</span>(n) : n;</span><br><span class="line">    <span class="type">int</span> b = m &lt; <span class="number">0</span> ? <span class="built_in">neg</span>(m) : m;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 从最高位开始遍历</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">30</span>; i &gt;= <span class="number">0</span>; i = <span class="built_in">minus1</span>(i, <span class="number">1</span>)) &#123;</span><br><span class="line">        <span class="comment">// 判断 a 右移 i 位后是否大于等于 b</span></span><br><span class="line">        <span class="keyword">if</span>((a &gt;&gt; i) &gt;= b) &#123;</span><br><span class="line">            <span class="comment">// 减去 b 左移 i 位</span></span><br><span class="line">            a = <span class="built_in">minus1</span>(a, (b &lt;&lt; i));</span><br><span class="line">            <span class="comment">// 将结果对应位设为1</span></span><br><span class="line">            ans |= (<span class="number">1</span> &lt;&lt; i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 如果 n 与 m 符号不同，则结果取负</span></span><br><span class="line">    <span class="keyword">return</span> (n &lt; <span class="number">0</span>) ^ (m &lt; <span class="number">0</span>) ? <span class="built_in">neg</span>(ans) : ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 完整版</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">div2</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a == INT_MIN &amp;&amp; b == INT_MIN) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(a != INT_MIN &amp;&amp; b != INT_MIN) <span class="keyword">return</span> <span class="built_in">div1</span>(a, b);</span><br><span class="line">    <span class="keyword">if</span>(b == INT_MIN) <span class="keyword">return</span> <span class="number">0</span>;  <span class="comment">// 除数为 INT_MIN，其它数除以它的商为0</span></span><br><span class="line">    <span class="keyword">if</span>(b == <span class="built_in">neg</span>(<span class="number">1</span>)) <span class="keyword">return</span> INT_MAX;  <span class="comment">// 防止 INT_MIN / -1 溢出</span></span><br><span class="line">    <span class="comment">// 近似处理：调整 a 的值</span></span><br><span class="line">    a = <span class="built_in">add</span>(a, b &gt; <span class="number">0</span> ? b : <span class="built_in">neg</span>(b));</span><br><span class="line">    <span class="type">int</span> ans = <span class="built_in">div1</span>(a, b);</span><br><span class="line">    <span class="comment">// 根据除数的正负决定偏移</span></span><br><span class="line">    <span class="type">int</span> offset = b &gt; <span class="number">0</span> ? <span class="built_in">neg</span>(<span class="number">1</span>) : <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">add</span>(ans, offset);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="位运算骚操作"><a href="#位运算骚操作" class="headerlink" title="位运算骚操作"></a>位运算骚操作</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">//判断一个数是不是2的幂</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">jurge1</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> n&gt;<span class="number">0</span> &amp;&amp; n == (n&amp;(-n));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//判断一个数是不是3的幂</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 1162261467</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">jurge2</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> n&gt;<span class="number">0</span> &amp;&amp; M%n==<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//求大于等于n的最小2次幂</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F1</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n&lt;=<span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	n--;</span><br><span class="line">	n |= n&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	n |= n&gt;&gt;<span class="number">2</span>;</span><br><span class="line">	n |= n&gt;&gt;<span class="number">4</span>;</span><br><span class="line">	n |= n&gt;&gt;<span class="number">8</span>;</span><br><span class="line">	n |= n&gt;&gt;<span class="number">16</span>;;</span><br><span class="line">	<span class="keyword">return</span> n+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//逆序二进制状态</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F2</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	n= ((n&amp;<span class="number">0xaaaaaaaa</span>)&gt;&gt;<span class="number">1</span>) | ((n&amp;<span class="number">0x55555555</span>)&lt;&lt;<span class="number">1</span>);</span><br><span class="line">	n= ((n&amp;<span class="number">0xcccccccc</span>)&gt;&gt;<span class="number">2</span>) | ((n&amp;<span class="number">0x33333333</span>)&lt;&lt;<span class="number">2</span>);</span><br><span class="line">	n= ((n&amp;<span class="number">0xf0f0f0f0</span>)&gt;&gt;<span class="number">4</span>) | ((n&amp;<span class="number">0x0f0f0f0f</span>)&lt;&lt;<span class="number">4</span>);</span><br><span class="line">	n= ((n&amp;<span class="number">0xff00ff00</span>)&gt;&gt;<span class="number">8</span>) | ((n&amp;<span class="number">0x00ff00ff</span>)&lt;&lt;<span class="number">8</span>);</span><br><span class="line">	n = (n&gt;&gt;<span class="number">16</span>) | (n&lt;&lt;<span class="number">16</span>);</span><br><span class="line">	<span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//返回n的二进制中有几个1</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F3</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	n = (n&amp;<span class="number">0x55555555</span>)+((n&gt;&gt;<span class="number">1</span>)&amp;<span class="number">0x55555555</span>);</span><br><span class="line">	n = (n&amp;<span class="number">0x33333333</span>)+((n&gt;&gt;<span class="number">2</span>)&amp;<span class="number">0x33333333</span>);</span><br><span class="line">	n = (n&amp;<span class="number">0x0f0f0f0f</span>)+((n&gt;&gt;<span class="number">4</span>)&amp;<span class="number">0x0f0f0f0f</span>);</span><br><span class="line">	n = (n&amp;<span class="number">0x00ff00ff</span>)+((n&gt;&gt;<span class="number">8</span>)&amp;<span class="number">0x00ff00ff</span>);</span><br><span class="line">	n = (n&amp;<span class="number">0x0000ffff</span>)+((n&gt;&gt;<span class="number">18</span>)&amp;<span class="number">0x0000ffff</span>);</span><br><span class="line">	<span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//求x到y的所有数&amp;的结果</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F4</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(y&gt;x)&#123;</span><br><span class="line">		y -= y &amp;(-y);</span><br><span class="line">	&#125;<span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Brain-Kernighan算法"><a href="#Brain-Kernighan算法" class="headerlink" title="Brain Kernighan算法"></a>Brain Kernighan算法</h3><p>异或技巧</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 500</span></span><br><span class="line"><span class="type">int</span> a1[M];</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="comment">// 以下两个全局变量用于功能1：两个出现次数为奇数次的数字</span></span><br><span class="line"><span class="type">int</span> ero1 = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> ero2 = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> a[], <span class="type">int</span> size)</span> </span>&#123;</span><br><span class="line">    ero1 = <span class="number">0</span>;</span><br><span class="line">    ero2 = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 计算所有数字的异或结果</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">        ero1 ^= a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 找到最右侧的1</span></span><br><span class="line">    <span class="type">int</span> rightone = ero1 &amp; (-ero1);</span><br><span class="line">    <span class="comment">// 根据该位是否为1将数字分组，并对其中一组异或</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((a[i] &amp; rightone) == <span class="number">0</span>) &#123;</span><br><span class="line">            ero2 ^= a[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 另一个奇数次数字</span></span><br><span class="line">    ero1 = ero1 ^ ero2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 以下全局变量用于功能2：求数组中出现次数少于 cnt 次的数字</span></span><br><span class="line"><span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> bits[<span class="number">32</span>];  <span class="comment">// 用于统计各二进制位1的个数</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve2</span><span class="params">(<span class="type">int</span> size, <span class="type">int</span> cnt, <span class="type">int</span> a[])</span> </span>&#123;</span><br><span class="line">    ans = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(bits, <span class="number">0</span>, <span class="built_in">sizeof</span>(bits));</span><br><span class="line">    <span class="comment">// 统计每一位的1的个数</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++) &#123;</span><br><span class="line">            <span class="comment">// 等价于：if(a[i] &amp; (1 &lt;&lt; j)) bits[j]++;</span></span><br><span class="line">            bits[j] += (a[i] &gt;&gt; j) &amp; <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 对每一位判断是否为目标数字的1</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (bits[j] % cnt) &#123;</span><br><span class="line">            ans |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="链表基本操作"><a href="#链表基本操作" class="headerlink" title="链表基本操作"></a>链表基本操作</h3><h4 id="返回两个无环链表相交的第一个节点"><a href="#返回两个无环链表相交的第一个节点" class="headerlink" title="返回两个无环链表相交的第一个节点"></a>返回两个无环链表相交的第一个节点</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LinkNode</span>&#123;</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    LinkNode *next;</span><br><span class="line">    <span class="built_in">LinkNode</span>(<span class="type">int</span> _val) : <span class="built_in">val</span>(_val), <span class="built_in">next</span>(<span class="literal">nullptr</span>) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//返回两个无环链表相交的第一个节点</span></span><br><span class="line"><span class="function">LinkNode *<span class="title">converge</span><span class="params">(LinkNode *&amp;L1,LinkNode *&amp;L2)</span></span>&#123;</span><br><span class="line">    LinkNode *p1=L1-&gt;next;</span><br><span class="line">    LinkNode *p2=L2-&gt;next;</span><br><span class="line">    <span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(L1==<span class="literal">nullptr</span> || L2==<span class="literal">nullptr</span>) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">while</span>(p1!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        cnt++;</span><br><span class="line">        p1=p1-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(p2!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        cnt--;</span><br><span class="line">        p2=p2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    p1=L1;</span><br><span class="line">    p2=L2;</span><br><span class="line">    <span class="keyword">if</span>(cnt&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">while</span>(cnt--) p1=p1-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        cnt=<span class="built_in">abs</span>(cnt);</span><br><span class="line">        <span class="keyword">while</span>(cnt--) p2=p2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(p1!=p2 &amp;&amp; p1!=<span class="literal">nullptr</span> &amp;&amp; p2!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        p1=p1-&gt;next;</span><br><span class="line">        p2=p2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="每k个节点一组翻转链表"><a href="#每k个节点一组翻转链表" class="headerlink" title="每k个节点一组翻转链表"></a>每k个节点一组翻转链表</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//每k个节点一组翻转链表</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reverse</span><span class="params">(<span class="type">int</span> k, LinkNode *&amp;L)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(k&lt;=<span class="number">1</span> || L==<span class="literal">nullptr</span> || L-&gt;next==<span class="literal">nullptr</span>) <span class="keyword">return</span>;</span><br><span class="line">    LinkNode *p1=L-&gt;next;</span><br><span class="line">    <span class="type">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(p1!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        cnt++;</span><br><span class="line">        p1=p1-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(cnt&lt;k) <span class="keyword">return</span>;</span><br><span class="line">    p1=L;</span><br><span class="line">    LinkNode *pre;</span><br><span class="line">    LinkNode *p;</span><br><span class="line">    LinkNode *pp;</span><br><span class="line">    LinkNode *p0=L;</span><br><span class="line">    LinkNode *last=p0-&gt;next;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;k;i++) p1=p1-&gt;next;</span><br><span class="line">    p=p0-&gt;next;</span><br><span class="line">    pp=p-&gt;next;</span><br><span class="line">    p-&gt;next=p1-&gt;next;</span><br><span class="line">    pre=p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;k;i++)&#123;</span><br><span class="line">        p=pp;</span><br><span class="line">        pp=p-&gt;next;</span><br><span class="line">        p-&gt;next=pre;</span><br><span class="line">        pre=p;</span><br><span class="line">    &#125;</span><br><span class="line">    p0-&gt;next=p1;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=cnt-k;j&gt;=k;j-=k)&#123;</span><br><span class="line">        p0=last;</span><br><span class="line">        p1=last;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;k;i++) p1=p1-&gt;next;</span><br><span class="line">        p=p0-&gt;next;</span><br><span class="line">        last=p;</span><br><span class="line">        pp=p-&gt;next;</span><br><span class="line">        p-&gt;next=p1-&gt;next;</span><br><span class="line">        pre=p;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;k;i++)&#123;</span><br><span class="line">            p=pp;</span><br><span class="line">            pp=p-&gt;next;</span><br><span class="line">            p-&gt;next=pre;</span><br><span class="line">            pre=p;</span><br><span class="line">        &#125;</span><br><span class="line">        p0-&gt;next=p1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="复制带随机指针的链表"><a href="#复制带随机指针的链表" class="headerlink" title="复制带随机指针的链表"></a>复制带随机指针的链表</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//复制带随机指针的链表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NodeR</span>&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    NodeR *next;</span><br><span class="line">    NodeR *random;</span><br><span class="line">    <span class="built_in">NodeR</span>(<span class="type">int</span> x)&#123;</span><br><span class="line">        val=x;</span><br><span class="line">        next=<span class="literal">nullptr</span>;</span><br><span class="line">        random=<span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">NodeR * <span class="title">copy</span><span class="params">(NodeR *&amp;L1)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L1==<span class="literal">nullptr</span>) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    NodeR* cur=L1-&gt;next;</span><br><span class="line">    <span class="comment">//复制节点并插入原节点之后</span></span><br><span class="line">    <span class="keyword">while</span>(cur!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        NodeR* next=<span class="keyword">new</span> <span class="built_in">NodeR</span>(cur-&gt;val);</span><br><span class="line">        next-&gt;next=cur-&gt;next;</span><br><span class="line">        cur-&gt;next=next;</span><br><span class="line">        cur=next-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//更新节点的随机指针</span></span><br><span class="line">    cur=L1-&gt;next;</span><br><span class="line">    <span class="keyword">while</span>(cur!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(cur-&gt;random!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            cur-&gt;next-&gt;random=cur-&gt;random;</span><br><span class="line">        &#125;</span><br><span class="line">        cur=cur-&gt;next-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//分离链表</span></span><br><span class="line">    cur=L1-&gt;next;</span><br><span class="line">    NodeR* L2=<span class="keyword">new</span> <span class="built_in">NodeR</span>(<span class="number">0</span>);</span><br><span class="line">    NodeR* temp=L2;</span><br><span class="line">    <span class="keyword">while</span>(cur!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        temp-&gt;next=cur-&gt;next;</span><br><span class="line">        cur-&gt;next=cur-&gt;next-&gt;next;</span><br><span class="line">        cur=cur-&gt;next;</span><br><span class="line">        temp=temp-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> L2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="判断是否是回文结构（快慢指针）"><a href="#判断是否是回文结构（快慢指针）" class="headerlink" title="判断是否是回文结构（快慢指针）"></a>判断是否是回文结构（快慢指针）</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//判断链表是否是回文结构（快慢指针）</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">judge_HuiWen</span><span class="params">(LinkNode *L)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L==<span class="literal">nullptr</span> || L-&gt;next==<span class="literal">nullptr</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">//快慢指针找中点</span></span><br><span class="line">    LinkNode* f=L;</span><br><span class="line">    LinkNode* s=L;</span><br><span class="line">    <span class="keyword">while</span>(f!=<span class="literal">nullptr</span> &amp;&amp; f-&gt;next!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        f=f-&gt;next-&gt;next;</span><br><span class="line">        s=s-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//翻转</span></span><br><span class="line">    LinkNode* pre=s;</span><br><span class="line">    LinkNode* cur=s-&gt;next;</span><br><span class="line">    LinkNode* next=<span class="literal">nullptr</span>;</span><br><span class="line">    pre-&gt;next=<span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">while</span>(cur!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        next=cur-&gt;next;</span><br><span class="line">        cur-&gt;next=pre;</span><br><span class="line">        pre=cur;</span><br><span class="line">        cur=next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//判断回文</span></span><br><span class="line">    <span class="type">bool</span> ans=<span class="literal">true</span>;</span><br><span class="line">    LinkNode* sta1=L-&gt;next;</span><br><span class="line">    LinkNode* sta2=pre;</span><br><span class="line">    <span class="keyword">while</span>(sta1!=<span class="literal">nullptr</span> &amp;&amp; sta2!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(sta1-&gt;val!=sta2-&gt;val)&#123;</span><br><span class="line">            ans=<span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        sta1=sta1-&gt;next;</span><br><span class="line">        sta2=sta2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//还原</span></span><br><span class="line">    cur=pre-&gt;next;</span><br><span class="line">    pre-&gt;next=<span class="literal">nullptr</span>;</span><br><span class="line">    next=<span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">while</span>(cur!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        next=cur-&gt;next;</span><br><span class="line">        cur-&gt;next=pre;</span><br><span class="line">        pre=cur;</span><br><span class="line">        cur=next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="返回第一个入环节点"><a href="#返回第一个入环节点" class="headerlink" title="返回第一个入环节点"></a>返回第一个入环节点</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//返回链表的第一个入环节点</span></span><br><span class="line"><span class="function">LinkNode* <span class="title">cycle</span><span class="params">(LinkNode *L)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (L == <span class="literal">nullptr</span> || L-&gt;next == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    LinkNode* f=L;</span><br><span class="line">    LinkNode* s=L;</span><br><span class="line">    <span class="keyword">while</span>(f!=<span class="literal">nullptr</span> &amp;&amp; f-&gt;next!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        s=s-&gt;next;</span><br><span class="line">        f=f-&gt;next-&gt;next;</span><br><span class="line">        <span class="keyword">if</span>(s==f)&#123;</span><br><span class="line">            f=L;</span><br><span class="line">            <span class="keyword">while</span>(f!=s)&#123;</span><br><span class="line">                f=f-&gt;next;</span><br><span class="line">                s=s-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> f;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="稳定排序"><a href="#稳定排序" class="headerlink" title="稳定排序"></a>稳定排序</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在链表上排序，时间复杂度O（n*logn），额外空间复杂度（1），排序有稳定性</span></span><br><span class="line"><span class="function">LinkNode* <span class="title">createNode</span><span class="params">(<span class="type">int</span> data)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">LinkNode</span>(data);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 在链表尾部添加节点</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">appendNode</span><span class="params">(LinkNode*&amp; head, <span class="type">int</span> data)</span> </span>&#123;</span><br><span class="line">    LinkNode* newNode = <span class="built_in">createNode</span>(data);</span><br><span class="line">    LinkNode* temp = head;</span><br><span class="line">    <span class="keyword">while</span> (temp-&gt;next) &#123;</span><br><span class="line">        temp = temp-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    temp-&gt;next = newNode;</span><br><span class="line">&#125;</span><br><span class="line">LinkNode* start;</span><br><span class="line">LinkNode* end1;</span><br><span class="line"><span class="function">LinkNode* <span class="title">FindEnd</span><span class="params">(LinkNode* l,<span class="type">int</span> len)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(l-&gt;next!=<span class="literal">nullptr</span> &amp;&amp; --len!=<span class="number">0</span>)&#123;</span><br><span class="line">        l=l-&gt;next;</span><br><span class="line">    &#125;<span class="keyword">return</span> l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(LinkNode* l1, LinkNode* r1, LinkNode* l2, LinkNode* r2)</span> </span>&#123;</span><br><span class="line">    LinkNode* pre;</span><br><span class="line">    <span class="keyword">if</span> (l1-&gt;val &lt;= l2-&gt;val) &#123;</span><br><span class="line">        start = l1;</span><br><span class="line">        pre = l1;</span><br><span class="line">        l1 = l1-&gt;next;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        start = l2;</span><br><span class="line">        pre = l2;</span><br><span class="line">        l2 = l2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (l1 != <span class="literal">nullptr</span> &amp;&amp; l2 != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (l1-&gt;val &lt;= l2-&gt;val) &#123;</span><br><span class="line">            pre-&gt;next = l1;</span><br><span class="line">            pre = l1;</span><br><span class="line">            l1 = l1-&gt;next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            pre-&gt;next = l2;</span><br><span class="line">            pre = l2;</span><br><span class="line">            l2 = l2-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (l1 != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        pre-&gt;next = l1;</span><br><span class="line">        end1 = r1;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        pre-&gt;next = l2;</span><br><span class="line">        end1 = r2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sort</span><span class="params">(LinkNode*&amp; L)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (L == <span class="literal">nullptr</span> || L-&gt;next == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> len=<span class="number">0</span>;</span><br><span class="line">    LinkNode* temp=L;</span><br><span class="line">    <span class="keyword">while</span>(temp!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        len++;</span><br><span class="line">        temp=temp-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    LinkNode* l1;</span><br><span class="line">    LinkNode* r1;</span><br><span class="line">    LinkNode* l2;</span><br><span class="line">    LinkNode* r2;</span><br><span class="line">    LinkNode* lastTeamend;</span><br><span class="line">    LinkNode* next;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;len;i&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">        l1=L;</span><br><span class="line">        r1=<span class="built_in">FindEnd</span>(l1,i);</span><br><span class="line">        l2=r1-&gt;next;</span><br><span class="line">        r2=<span class="built_in">FindEnd</span>(l2,i);</span><br><span class="line">        next = r2-&gt;next;</span><br><span class="line">        r1-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">        r2-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="built_in">merge</span>(l1,r1,l2,r2);</span><br><span class="line">        L=start;</span><br><span class="line">        lastTeamend=end1;</span><br><span class="line">        <span class="keyword">while</span>(next!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            l1=next;</span><br><span class="line">            r1=<span class="built_in">FindEnd</span>(l1,i);</span><br><span class="line">        	l2 = r1-&gt;next;</span><br><span class="line">        	<span class="keyword">if</span>(l2==<span class="literal">nullptr</span>)&#123;</span><br><span class="line">        		lastTeamend-&gt;next = l1;</span><br><span class="line">        		<span class="keyword">break</span>;</span><br><span class="line">        	&#125;</span><br><span class="line">            r2 = <span class="built_in">FindEnd</span>(l2, i);</span><br><span class="line">            next = r2-&gt;next;</span><br><span class="line">            r1-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">            r2-&gt;next = <span class="literal">nullptr</span>;</span><br><span class="line">            <span class="built_in">merge</span>(l1,r1,l2,r2);</span><br><span class="line">            lastTeamend-&gt;next=start;</span><br><span class="line">            lastTeamend=end1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="合并n个有序链表"><a href="#合并n个有序链表" class="headerlink" title="合并n个有序链表"></a>合并n个有序链表</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 500</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ListNode</span>&#123;</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    ListNode * next;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Create</span><span class="params">(ListNode *&amp;q)</span></span>&#123;</span><br><span class="line">    q=(ListNode *)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(ListNode));</span><br><span class="line">    q-&gt;next=<span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cmp</span>&#123;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(ListNode* a,ListNode* b)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a-&gt;val &gt; b-&gt;val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">ListNode *<span class="title">merge</span><span class="params">(vector&lt;ListNode*&gt;&amp; v1)</span></span>&#123;</span><br><span class="line">    priority_queue&lt;ListNode*,vector&lt;ListNode*&gt;,cmp&gt; pq1;</span><br><span class="line">    <span class="keyword">for</span>(ListNode* it : v1) <span class="keyword">if</span>(it) pq1.<span class="built_in">push</span>(it);</span><br><span class="line">    ListNode* ans;</span><br><span class="line">    <span class="built_in">Create</span>(ans);</span><br><span class="line">    ListNode* temp;</span><br><span class="line">    ListNode* pre=ans;</span><br><span class="line">    <span class="keyword">while</span>(!pq1.<span class="built_in">empty</span>())&#123;</span><br><span class="line">        temp=pq1.<span class="built_in">top</span>();</span><br><span class="line">        pq1.<span class="built_in">pop</span>();</span><br><span class="line">        pre-&gt;next=temp;</span><br><span class="line">        pre=temp;</span><br><span class="line">        <span class="keyword">if</span>(temp-&gt;next) pq1.<span class="built_in">push</span>(temp-&gt;next);</span><br><span class="line">    &#125;pre-&gt;next=<span class="literal">nullptr</span>;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="type">int</span> cnt;</span><br><span class="line">    ListNode* pre;</span><br><span class="line">    <span class="type">int</span> temp1;</span><br><span class="line">    vector&lt;ListNode*&gt; v1;</span><br><span class="line">    <span class="keyword">while</span>(n--)&#123;</span><br><span class="line">        cin&gt;&gt;cnt;</span><br><span class="line">        ListNode * l=(ListNode*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(ListNode));</span><br><span class="line">        l-&gt;next=<span class="literal">nullptr</span>;</span><br><span class="line">        pre=l;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;cnt;i++)&#123;</span><br><span class="line">            cin&gt;&gt;temp1;</span><br><span class="line">            ListNode *temp=(ListNode*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(ListNode));</span><br><span class="line">            temp-&gt;val=temp1;</span><br><span class="line">            temp-&gt;next=pre-&gt;next;</span><br><span class="line">            pre-&gt;next=temp;</span><br><span class="line">            pre=temp;</span><br><span class="line">        &#125;v1.<span class="built_in">push_back</span>(l-&gt;next);</span><br><span class="line">    &#125;</span><br><span class="line">    ListNode * <span class="keyword">final</span>;</span><br><span class="line">    <span class="built_in">Create</span>(<span class="keyword">final</span>);</span><br><span class="line">    <span class="keyword">final</span>=<span class="built_in">merge</span>(v1);</span><br><span class="line">    pre=<span class="keyword">final</span>-&gt;next;</span><br><span class="line">    <span class="keyword">while</span>(pre)&#123;</span><br><span class="line">        cout&lt;&lt;pre-&gt;val&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">        pre=pre-&gt;next;</span><br><span class="line">    &#125;cout&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="莫队算法"><a href="#莫队算法" class="headerlink" title="莫队算法"></a>莫队算法</h3><p>离线加速处理查询</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Query</span> &#123;</span><br><span class="line">    <span class="type">int</span> l, r, id, blk;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> n, q;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; q;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">original</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">ans</span><span class="params">(q)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">    	cin &gt;&gt; original[i];</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// 离散化</span></span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; temp = original;</span><br><span class="line">    <span class="built_in">sort</span>(temp.<span class="built_in">begin</span>()+<span class="number">1</span>, temp.<span class="built_in">end</span>());</span><br><span class="line">    <span class="type">int</span> m = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    	<span class="keyword">if</span>(temp[m] != temp[i])&#123;</span><br><span class="line">    		temp[++ m] = temp[i];</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">auto</span> find = [&amp;](<span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">    	<span class="type">int</span> l = <span class="number">1</span>, r = m;</span><br><span class="line">    	<span class="type">int</span> mid, ans;</span><br><span class="line">    	<span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">    		mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    		<span class="keyword">if</span>(temp[mid] &lt;= x)&#123;</span><br><span class="line">    			ans = mid;</span><br><span class="line">    			l = mid + <span class="number">1</span>;</span><br><span class="line">    		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    			r = mid - <span class="number">1</span>;</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">return</span> ans;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 莫队函数</span></span><br><span class="line">    <span class="type">int</span> now_ans = <span class="number">0</span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">fre</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">auto</span> add = [&amp;](<span class="type">int</span> x) &#123;</span><br><span class="line">    	<span class="type">int</span> &amp; f = fre[<span class="built_in">find</span>(x)];</span><br><span class="line">    	<span class="keyword">if</span> (f == <span class="number">1</span>) &#123;</span><br><span class="line">	        now_ans++;</span><br><span class="line">	    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (f == <span class="number">2</span>) &#123;</span><br><span class="line">	        now_ans--;</span><br><span class="line">	    &#125;</span><br><span class="line">        f++;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">auto</span> remove = [&amp;](<span class="type">int</span> x) &#123;</span><br><span class="line">    	<span class="type">int</span> &amp;f = fre[<span class="built_in">find</span>(x)];</span><br><span class="line">	    <span class="keyword">if</span> (f == <span class="number">2</span>) &#123;</span><br><span class="line">	        now_ans--;</span><br><span class="line">	    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (f == <span class="number">3</span>) &#123;</span><br><span class="line">	        now_ans++;</span><br><span class="line">	    &#125;</span><br><span class="line">        f--;</span><br><span class="line">    &#125;;</span><br><span class="line">	<span class="comment">// 窗口优化</span></span><br><span class="line">    <span class="type">int</span> blk = (<span class="type">int</span>)<span class="built_in">sqrt</span>(n);</span><br><span class="line">    <span class="function">vector&lt;Query&gt; <span class="title">queries</span><span class="params">(q)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; q; i++) &#123;</span><br><span class="line">        cin &gt;&gt; queries[i].l &gt;&gt; queries[i].r;</span><br><span class="line">        queries[i].id = i;</span><br><span class="line">        queries[i].blk = queries[i].l / blk;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(queries.<span class="built_in">begin</span>(), queries.<span class="built_in">end</span>(), [&amp;](<span class="type">const</span> Query &amp;A, <span class="type">const</span> Query &amp;B) &#123;</span><br><span class="line">        <span class="keyword">if</span> (A.blk == B.blk) <span class="keyword">return</span> A.r &lt; B.r;</span><br><span class="line">        <span class="keyword">return</span> A.blk &lt; B.blk;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="type">int</span> curL = <span class="number">1</span>, curR = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;q : queries) &#123;</span><br><span class="line">        <span class="keyword">while</span> (curR &lt; q.r) <span class="built_in">add</span>(original[++curR]);</span><br><span class="line">        <span class="keyword">while</span> (curR &gt; q.r) <span class="built_in">remove</span>(original[curR--]);</span><br><span class="line">        <span class="keyword">while</span> (curL &lt; q.l) <span class="built_in">remove</span>(original[curL++]);</span><br><span class="line">        <span class="keyword">while</span> (curL &gt; q.l) <span class="built_in">add</span>(original[--curL]);</span><br><span class="line">        ans[q.id] = now_ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; q; i++) cout &lt;&lt; ans[i] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="KMP算法"><a href="#KMP算法" class="headerlink" title="KMP算法"></a>KMP算法</h3><p>字符匹配匹配加速，加速的点在于匹配失败后不一定直接返回起点重新匹配，而是跳到最大前缀处，如<code>abab......</code>匹配失败时，会跳到2位置而不是0位置</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    string s1, s2;</span><br><span class="line">    cin &gt;&gt; s1 &gt;&gt; s2;</span><br><span class="line">    <span class="type">int</span> n = <span class="built_in">int</span>(s1.<span class="built_in">size</span>());</span><br><span class="line">    <span class="type">int</span> m = <span class="built_in">int</span>(s2.<span class="built_in">size</span>());</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">next1</span><span class="params">(m + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="type">int</span> i1 = <span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> mark1 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i1 &lt;= m)&#123;</span><br><span class="line">        <span class="keyword">if</span>(s2[i1 - <span class="number">1</span>] == s2[mark1])&#123;</span><br><span class="line">            next1[i1++] = ++ mark1;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(mark1 != <span class="number">0</span>)&#123;</span><br><span class="line">            mark1 = next1[mark1];</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            next1[i1++] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> j1 = i1 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(j1 &lt; n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(s1[j1] == s2[i1])&#123;</span><br><span class="line">            j1 ++, i1 ++;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(i1 != <span class="number">0</span>)&#123;</span><br><span class="line">            i1 = next1[i1];</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            j1 ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(i1 == m)&#123;</span><br><span class="line">            cout &lt;&lt; j1 - i1 + <span class="number">1</span> &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            i1 = next1[i1];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i ++)&#123;</span><br><span class="line">    	cout &lt;&lt; next1[i];</span><br><span class="line">    	<span class="keyword">if</span>(i != m) cout &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="manacher算法"><a href="#manacher算法" class="headerlink" title="manacher算法"></a>manacher算法</h3><p>以某一节点为中心向两端扩展的最大回文串</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long </span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function">string <span class="title">manacherss</span><span class="params">(string s)</span></span>&#123;</span><br><span class="line">	string ss = <span class="string">&quot;#&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i ++)&#123;</span><br><span class="line">		ss += s[i];</span><br><span class="line">		ss += <span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ss;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	string s;</span><br><span class="line">	cin &gt;&gt; s;</span><br><span class="line">	string ss = <span class="built_in">manacherss</span>(s);</span><br><span class="line">	<span class="type">int</span> n = ss.<span class="built_in">size</span>();</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">r1</span><span class="params">(n, <span class="number">0</span>)</span></span>; <span class="comment">// 真实回文串的长度为r[i] - 1;</span></span><br><span class="line">	<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, r = <span class="number">0</span>, c = <span class="number">0</span>, len; i &lt; n; i ++)&#123;</span><br><span class="line">		len = r &gt; i ? <span class="built_in">min</span>(r1[<span class="number">2</span> * c - i], r - i) : <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span>(i - len &gt;= <span class="number">0</span> &amp;&amp; i + len &lt; n &amp;&amp; ss[i - len] == ss[i + len])&#123;</span><br><span class="line">			len ++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(len + i &gt; r)&#123;</span><br><span class="line">			r = len + i;</span><br><span class="line">			c = i;</span><br><span class="line">		&#125;</span><br><span class="line">		r1[i] = len;</span><br><span class="line">		ans = <span class="built_in">max</span>(ans, len);</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; ans - <span class="number">1</span> &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">   </span><br><span class="line">    <span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--) &#123;</span><br><span class="line">	     <span class="built_in">solve</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Z函数"><a href="#Z函数" class="headerlink" title="Z函数"></a>Z函数</h3><p>对于一个长度为n的字符串s，定义函数z[i]表示s和s[i, n - 1]的最长公共前缀（LCP）的长度则z被成为s的Z函数</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P5410</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long </span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Z1</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp; z, string s, <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	z[<span class="number">0</span>] = n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, c = <span class="number">1</span>, r = <span class="number">1</span>, len; i &lt; n; i ++)&#123;</span><br><span class="line">		len = r &gt; i ? <span class="built_in">min</span>(z[i - c], r - i) : <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(i + len &lt; n &amp;&amp; s[len] == s[i + len])&#123;</span><br><span class="line">			len ++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(i + len &gt; r)&#123;</span><br><span class="line">			r = i + len;</span><br><span class="line">			c = i;</span><br><span class="line">		&#125;</span><br><span class="line">		z[i] = len;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">E1</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp; e, vector&lt;<span class="type">int</span>&gt; &amp; z, string s1, string s2, <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, r = <span class="number">0</span>, c = <span class="number">0</span>, len; i &lt; n; i ++)&#123;</span><br><span class="line">		len = r &gt; i ? <span class="built_in">min</span>(z[i - c], r - i) : <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(i + len &lt; n &amp;&amp; s1[i + len] == s2[len])&#123;</span><br><span class="line">			len ++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(i + len &gt; r)&#123;</span><br><span class="line">			r = i + len;</span><br><span class="line">			c = i;</span><br><span class="line">		&#125;</span><br><span class="line">		e[i] = len;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	string s1, s2;</span><br><span class="line">	cin &gt;&gt; s1 &gt;&gt; s2;</span><br><span class="line">	<span class="comment">// 求得该字符串的最长前缀</span></span><br><span class="line">	<span class="type">int</span> n = s2.<span class="built_in">size</span>();</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">Z</span><span class="params">(n, <span class="number">0</span>)</span></span>;</span><br><span class="line">	<span class="built_in">Z1</span>(Z, s2, n);</span><br><span class="line">	<span class="comment">// 求该串以某一串为基准的最长前缀</span></span><br><span class="line">	<span class="type">int</span> m = s1.<span class="built_in">size</span>();</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">E</span><span class="params">(m + <span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="built_in">E1</span>(E, Z, s1, s2, m);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="前缀树"><a href="#前缀树" class="headerlink" title="前缀树"></a>前缀树</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">//静态数组版本</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">150001</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M2 = <span class="number">28</span>;</span><br><span class="line"><span class="type">int</span> cnt=<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> pass1[M];</span><br><span class="line"><span class="type">int</span> end1[M];</span><br><span class="line"><span class="type">int</span> t1[M][M2];</span><br><span class="line"><span class="type">int</span> op1;</span><br><span class="line">string op2;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">memset</span>(t1, <span class="number">0</span>, <span class="built_in">sizeof</span>(t1));</span><br><span class="line">    <span class="built_in">memset</span>(end1, <span class="number">0</span>, <span class="built_in">sizeof</span>(end1));</span><br><span class="line">    <span class="built_in">memset</span>(pass1, <span class="number">0</span>, <span class="built_in">sizeof</span>(pass1));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(<span class="type">const</span> string&amp; word)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> cur=<span class="number">1</span>;</span><br><span class="line">    pass1[cur]++;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;word.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">        <span class="type">int</span> path = word[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(t1[cur][path]==<span class="number">0</span>)&#123;</span><br><span class="line">            t1[cur][path]=++cnt;</span><br><span class="line">        &#125;</span><br><span class="line">        cur=t1[cur][path];</span><br><span class="line">        pass1[cur]++;</span><br><span class="line">    &#125;end1[cur]++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">search</span><span class="params">(<span class="type">const</span> string&amp; word)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> cur=<span class="number">1</span>;<span class="type">int</span> path;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;word.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">        path=word[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(t1[cur][path]==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cur=t1[cur][path];</span><br><span class="line">    &#125;<span class="keyword">return</span> end1[cur];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">erase</span><span class="params">(<span class="type">const</span> string&amp; word)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">search</span>(word)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="type">int</span> path;</span><br><span class="line">        <span class="type">int</span> cur=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;word.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            path = word[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span>(--pass1[t1[cur][path]]==<span class="number">0</span>)&#123;</span><br><span class="line">                t1[cur][path]=<span class="number">0</span>;</span><br><span class="line">                <span class="comment">//  之后会重新分配节点，所以遍历不到未减减的end</span></span><br><span class="line">                <span class="keyword">return</span> ;</span><br><span class="line">            &#125;cur=t1[cur][path];</span><br><span class="line">        &#125;</span><br><span class="line">        end1[cur]--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">prefixNumber</span><span class="params">(<span class="type">const</span> string&amp; pre)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> cur=<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> path;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;pre.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">        path = pre[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(t1[cur][path]==<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cur=t1[cur][path];</span><br><span class="line">    &#125;<span class="keyword">return</span> pass1[cur];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123; </span><br><span class="line">    string line;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">getline</span>(cin, line)) &#123;</span><br><span class="line">        <span class="built_in">build</span>();</span><br><span class="line">        <span class="type">int</span> m = <span class="built_in">stoi</span>(line);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; ++i) &#123;</span><br><span class="line">            <span class="built_in">getline</span>(cin, line);</span><br><span class="line">            <span class="function">stringstream <span class="title">ss</span><span class="params">(line)</span></span>;</span><br><span class="line">            <span class="type">int</span> op;</span><br><span class="line">            string word;</span><br><span class="line">            ss &gt;&gt; op &gt;&gt; word;</span><br><span class="line">            <span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="built_in">insert</span>(word);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="built_in">erase</span>(word);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">3</span>) &#123;</span><br><span class="line">                cout &lt;&lt; (<span class="built_in">search</span>(word) &gt; <span class="number">0</span> ? <span class="string">&quot;YES&quot;</span> : <span class="string">&quot;NO&quot;</span>) &lt;&lt; endl;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">4</span>) &#123;</span><br><span class="line">                cout &lt;&lt; <span class="built_in">prefixNumber</span>(word) &lt;&lt; endl;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="AC自动机"><a href="#AC自动机" class="headerlink" title="AC自动机"></a>AC自动机</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P3796</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2e4</span>;</span><br><span class="line"><span class="type">int</span> cnt1;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">fail1</span><span class="params">(N)</span></span>;</span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">tree1</span>(N, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(<span class="number">26</span>,<span class="number">0</span>));</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">end1</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">times1</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(N)</span></span>; <span class="comment">// BFS队列实现</span></span><br><span class="line"><span class="comment">//  链式前向星</span></span><br><span class="line"><span class="type">int</span> cnt2;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">head</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">next1</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">to</span><span class="params">(N)</span></span>;</span><br><span class="line">string s1;</span><br><span class="line"><span class="comment">// 构建前缀树</span></span><br><span class="line"><span class="function">vector&lt;string&gt; <span class="title">F1</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="function">vector&lt;string&gt; <span class="title">s1</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">	string temp1;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, x; i &lt;= n; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; temp1;</span><br><span class="line">        s1[i] = temp1; </span><br><span class="line">        x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>, y; j &lt; temp1.<span class="built_in">size</span>(); j ++)&#123;</span><br><span class="line">            y = temp1[j] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span>(tree1[x][y] == <span class="number">0</span>)&#123;</span><br><span class="line">                tree1[x][y] = ++cnt1;</span><br><span class="line">            &#125;</span><br><span class="line">            x = tree1[x][y];</span><br><span class="line">        &#125;</span><br><span class="line">        end1[i] = x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 构建自动机</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">F2</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">// BFS遍历</span></span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    l = r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i ++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(tree1[<span class="number">0</span>][i] != <span class="number">0</span>)&#123;</span><br><span class="line">            v1[r++] = tree1[<span class="number">0</span>][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> u;</span><br><span class="line">    <span class="keyword">while</span>(l &lt; r)&#123;</span><br><span class="line">        u = v1[l ++];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i ++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(tree1[u][i] == <span class="number">0</span>)&#123;</span><br><span class="line">                tree1[u][i] = tree1[fail1[u]][i];</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                fail1[tree1[u][i]] = tree1[fail1[u]][i];</span><br><span class="line">                v1[r ++] = tree1[u][i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 反向建图</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add1</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">    next1[++cnt2] = head[u];</span><br><span class="line">    head[u] = cnt2;</span><br><span class="line">    to[cnt2] = v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 统计次数</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">F3</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> e = head[x]; e &gt; <span class="number">0</span>; e = next1[e])&#123;</span><br><span class="line">        <span class="built_in">F3</span>(to[e]);</span><br><span class="line">        times1[x] += times1[to[e]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; N; i ++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">26</span>; j ++)&#123;</span><br><span class="line">			tree1[i][j] = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	cnt2 = cnt1 = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">fill</span>(head.<span class="built_in">begin</span>(), head.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">	<span class="built_in">fill</span>(times1.<span class="built_in">begin</span>(), times1.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">	<span class="built_in">fill</span>(fail1.<span class="built_in">begin</span>(), fail1.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">build</span>();</span><br><span class="line">    vector&lt;string&gt; ss = <span class="built_in">F1</span>();</span><br><span class="line">    <span class="built_in">F2</span>();</span><br><span class="line">    cin &gt;&gt; s1;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, u = <span class="number">0</span>; i &lt; s1.<span class="built_in">size</span>(); i ++)&#123;</span><br><span class="line">        u = tree1[u][s1[i] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        times1[u] ++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= cnt1; i ++)&#123;</span><br><span class="line">        <span class="built_in">add1</span>(fail1[i], i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">F3</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">int</span> max1 = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(times1[end1[i]] &gt; max1)&#123;</span><br><span class="line">        	max1 = times1[end1[i]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; max1 &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    	<span class="keyword">if</span>(times1[end1[i]] == max1)&#123;</span><br><span class="line">    		cout &lt;&lt; ss[i] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">while</span>(n)&#123;</span><br><span class="line">    	<span class="built_in">solve</span>();</span><br><span class="line">    	cin &gt;&gt; n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="字符串哈希"><a href="#字符串哈希" class="headerlink" title="字符串哈希"></a>字符串哈希</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P3370</span></span><br><span class="line"><span class="comment">// 利用质数进制信息</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long </span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="type">int</span> base = <span class="number">39127</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">v</span><span class="params">(<span class="type">char</span> c)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ans;</span><br><span class="line">	<span class="keyword">if</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; <span class="string">&#x27;9&#x27;</span> &gt;= c)&#123;</span><br><span class="line">		ans = c - <span class="string">&#x27;0&#x27;</span> + <span class="number">1</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&#x27;a&#x27;</span> &lt;= c &amp;&amp; <span class="string">&#x27;z&#x27;</span> &gt;= c)&#123;</span><br><span class="line">		ans = c - <span class="string">&#x27;a&#x27;</span> + <span class="number">11</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		ans = c - <span class="string">&#x27;A&#x27;</span> + <span class="number">27</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 加速进制</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F</span><span class="params">(string s)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ans = <span class="built_in">v</span>(s[<span class="number">0</span>]);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; s.<span class="built_in">size</span>(); i ++)&#123;</span><br><span class="line">		ans = ans * base + <span class="built_in">v</span>(s[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin &gt;&gt; n;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(n)</span></span>;</span><br><span class="line">	string s;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++)&#123;</span><br><span class="line">		cin &gt;&gt; s;</span><br><span class="line">		v1[i] = <span class="built_in">F</span>(s);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">sort</span>(v1.<span class="built_in">begin</span>(), v1.<span class="built_in">end</span>());</span><br><span class="line">	<span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i ++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(v1[i] != v1[i - <span class="number">1</span>])&#123;</span><br><span class="line">			ans ++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// https://www.luogu.com.cn/record/204776127</span></span><br><span class="line"><span class="comment">// 要求一段区间内的hash值，用前缀和</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">H</span><span class="params">(vector&lt;<span class="type">int</span>&gt; &amp; hash, vector&lt;<span class="type">int</span>&gt; &amp; power, <span class="type">int</span> l, <span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(l &gt; <span class="number">0</span>)&#123;</span><br><span class="line">		l = hash[l - <span class="number">1</span>] * power[r - l + <span class="number">1</span>]; </span><br><span class="line">	&#125;</span><br><span class="line">	r = hash[r];</span><br><span class="line">	<span class="keyword">return</span> r - l;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve2</span><span class="params">()</span></span>&#123;</span><br><span class="line">	string s1, s2;</span><br><span class="line">	cin &gt;&gt; s1 &gt;&gt; s2;	</span><br><span class="line">	<span class="type">int</span> n = s1.<span class="built_in">size</span>(), m = s2.<span class="built_in">size</span>();</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">hash1</span><span class="params">(n)</span>, <span class="title">hash2</span><span class="params">(m)</span>, <span class="title">power</span><span class="params">(max(n, m))</span></span>;</span><br><span class="line">	power[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; power.<span class="built_in">size</span>(); i ++)&#123;</span><br><span class="line">		power[i] = power[i - <span class="number">1</span>] * base;</span><br><span class="line">	&#125;	</span><br><span class="line">	hash1[<span class="number">0</span>] = s1[<span class="number">0</span>] - <span class="string">&#x27;A&#x27;</span> + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i ++)&#123;</span><br><span class="line">		hash1[i] = hash1[i - <span class="number">1</span>] * base + s1[i] - <span class="string">&#x27;A&#x27;</span> + <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	hash2[<span class="number">0</span>] = s2[<span class="number">0</span>] - <span class="string">&#x27;A&#x27;</span> + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; m; i ++)&#123;</span><br><span class="line">		hash2[i] = hash2[i - <span class="number">1</span>] * base + s2[i] - <span class="string">&#x27;A&#x27;</span> + <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> l1, l2, r1;</span><br><span class="line">	<span class="type">int</span> l, r, len, mid;</span><br><span class="line">	<span class="type">int</span> k;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt;= n - m; i ++)&#123;</span><br><span class="line">		l1 = i, r1 = i + m - <span class="number">1</span>;</span><br><span class="line">		k = <span class="number">0</span>;</span><br><span class="line">		l2 = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(l1 &lt;= r1 &amp;&amp; k &lt;= <span class="number">3</span>)&#123;</span><br><span class="line">			l = l1, r = r1;</span><br><span class="line">			len = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">				mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">H</span>(hash1, power, l1, mid) == <span class="built_in">H</span>(hash2, power, l2, l2 + mid - l1))&#123;</span><br><span class="line">					len = mid - l1 + <span class="number">1</span>;</span><br><span class="line">					l = mid + <span class="number">1</span>;</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					r = mid - <span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(l1 + len &lt;= r1)&#123;</span><br><span class="line">				k ++;</span><br><span class="line">				l1 += len + <span class="number">1</span>;</span><br><span class="line">				l2 += len + <span class="number">1</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(k &lt;= <span class="number">3</span>)&#123;</span><br><span class="line">			ans ++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="异或哈希"><a href="#异或哈希" class="headerlink" title="异或哈希"></a>异或哈希</h3><p>题目大概描述：给定一个数字序列a，请你找出最长的连续子区间，使得这个子区间内所有数字的乘积是一个完全平方数。如果存在多个长度相同的子区间，选择最靠左的一个。</p>
<p>完全平方数可以差分为质因数乘积，且所有质因数的个数均为偶数。</p>
<p>故把每一个数的值改为落单质因数的哈希值，如果某一个区间的异或值为0，就说明该区间的质因数都是偶数，说明乘积是一个完全平方数，利用前缀和思想可以加速这一查找过程（当一个状态第一次出现时，记录位置，以后每次出现都说明中间与第一次出现的位置的间隔为一个完全平方数）。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> ull = <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="function">mt19937_64 <span class="title">rng</span><span class="params">(chrono::steady_clock::now().time_since_epoch().count())</span></span>;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1e6</span> + <span class="number">1</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">spf</span><span class="params">(N)</span></span>; <span class="comment">// 最小质因子</span></span><br><span class="line"><span class="function">vector&lt;ull&gt; <span class="title">prime_hash</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">init</span><span class="params">()</span> </span>= [&amp;]()&#123;</span><br><span class="line">	<span class="built_in">iota</span>(spf.<span class="built_in">begin</span>(), spf.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt; N; i ++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(spf[i] == i)&#123;</span><br><span class="line">            prime_hash[i] = <span class="built_in">rng</span>();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = i &lt;&lt; <span class="number">1</span>; j &lt; N; j += i)&#123;</span><br><span class="line">                <span class="keyword">if</span>(spf[j] == j)&#123;</span><br><span class="line">                    spf[j] = i;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 根据最小质因子求某一个数的hash值</span></span><br><span class="line"><span class="keyword">auto</span> get_hash = [&amp;](<span class="type">int</span> x) -&gt; ull &#123;</span><br><span class="line">    ull ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(x &gt; <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="type">int</span> p = spf[x];</span><br><span class="line">        <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(x % p == <span class="number">0</span>)&#123;</span><br><span class="line">            x /= p;</span><br><span class="line">            cnt ^= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(cnt &amp; <span class="number">1</span>)&#123;</span><br><span class="line">            ans ^= prime_hash[p];		</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">cin &gt;&gt; t;</span><br><span class="line"><span class="keyword">while</span>(t --)&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;ull&gt; <span class="title">pref</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    pref[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; v1[i];</span><br><span class="line">        pref[i] = pref[i - <span class="number">1</span>] ^ <span class="built_in">get_hash</span>(v1[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    unordered_map&lt;ull,<span class="type">int</span>&gt; pos;</span><br><span class="line">    pos[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>, l = <span class="number">-1</span>, r = <span class="number">-1</span>;</span><br><span class="line">    ull x;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">        x = pref[i];</span><br><span class="line">        <span class="keyword">if</span>(pos.<span class="built_in">count</span>(x))&#123;</span><br><span class="line">            <span class="keyword">if</span>(i - pos[x] &gt; ans)&#123;</span><br><span class="line">                ans = i - pos[x];</span><br><span class="line">                l = pos[x] + <span class="number">1</span>, r = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            pos[x] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; l &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; r &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;   </span><br></pre></td></tr></table></figure>

<h3 id="质数-素数"><a href="#质数-素数" class="headerlink" title="质数&#x2F;素数"></a>质数&#x2F;素数</h3><h4 id="质数判别"><a href="#质数判别" class="headerlink" title="质数判别"></a>质数判别</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// 普通判别方法</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">p</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (n &lt;= <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> n &gt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n % <span class="number">6</span> != <span class="number">1</span> &amp;&amp; n % <span class="number">6</span> != <span class="number">5</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> sqrt1 = (<span class="type">int</span>) <span class="built_in">sqrt</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">5</span>; i &lt;= sqrt1; i += <span class="number">6</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span> || n % (i + <span class="number">2</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Miller Rabin Prime判别法</span></span><br><span class="line"><span class="keyword">using</span> ll = <span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="comment">// 大数的时候用</span></span><br><span class="line"><span class="comment">//typedef __int128 ll;</span></span><br><span class="line">vector&lt;ll&gt; primes = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">37</span>&#125;;</span><br><span class="line"><span class="function">ll <span class="title">power</span><span class="params">(ll base, ll exp, ll mod)</span> </span>&#123;</span><br><span class="line">    ll result = <span class="number">1</span>;</span><br><span class="line">    base %= mod;</span><br><span class="line">    <span class="keyword">while</span> (exp &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (exp &amp; <span class="number">1</span>) result = (result * base) % mod;</span><br><span class="line">        base = (base * base) % mod;</span><br><span class="line">        exp &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">witness</span><span class="params">(ll a, ll n)</span> </span>&#123;</span><br><span class="line">    ll u = n - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ((u &amp; <span class="number">1</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        t++;</span><br><span class="line">        u &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll x = <span class="built_in">power</span>(a, u, n);</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="number">1</span> || x == n - <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; t - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        x = (x * x) % n;</span><br><span class="line">        <span class="keyword">if</span> (x == n - <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">millerRabin</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (n % <span class="number">2</span> == <span class="number">0</span>) <span class="keyword">return</span> n == <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> (ll p : primes) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p &gt;= n) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">witness</span>(p, n)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="线性质数筛"><a href="#线性质数筛" class="headerlink" title="线性质数筛"></a>线性质数筛</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 质数筛</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">F1</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i * i &lt;= x; i ++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(x % i != <span class="number">0</span>)&#123;</span><br><span class="line">			v1.<span class="built_in">push_back</span>(i);</span><br><span class="line">			<span class="keyword">while</span>(x % i == <span class="number">0</span>) x /= i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 求数值小于等于n的质数的个数,</span></span><br><span class="line"><span class="comment">// 质数筛-埃氏筛</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">  	cin &gt;&gt; n;</span><br><span class="line">  	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">	v[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  	<span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= <span class="built_in">sqrt</span>(n); i++)&#123;</span><br><span class="line">		<span class="keyword">if</span> (v[i] == <span class="number">0</span>)&#123;</span><br><span class="line">	    	<span class="keyword">for</span> (<span class="type">int</span> j = i + i; j &lt;= n; j += i) v[j] = <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">  	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    	<span class="keyword">if</span> (!v[i]) cnt++;</span><br><span class="line">  	&#125;</span><br><span class="line">  	cout &lt;&lt; cnt &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 只是计数的话，埃氏筛还能改进</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ehrlich2</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">visit</span><span class="params">(n + <span class="number">1</span>, <span class="literal">false</span>)</span></span>;</span><br><span class="line">    <span class="type">int</span> cnt = (n + <span class="number">1</span>) / <span class="number">2</span>; <span class="comment">// 估计质数数量(奇数)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">3</span>; i * i &lt;= n; i += <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!visit[i]) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = i * i; j &lt;= n; j += <span class="number">2</span> * i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!visit[j]) &#123;</span><br><span class="line">                    visit[j] = <span class="literal">true</span>;</span><br><span class="line">                    cnt--;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 使用线性筛法计算每个数字的最小质因子 `spf`（smallest prime factor）</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">1e6</span> + <span class="number">1</span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">spf</span><span class="params">(N)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">init</span><span class="params">()</span> </span>= [&amp;]()&#123;</span><br><span class="line">	<span class="built_in">iota</span>(spf.<span class="built_in">begin</span>(), spf.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt; N; i ++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(spf[i] == i)&#123;</span><br><span class="line">            prime_hash[i] = <span class="built_in">rng</span>();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = i &lt;&lt; <span class="number">1</span>; j &lt; N; j += i)&#123;</span><br><span class="line">                <span class="keyword">if</span>(spf[j] == j)&#123;</span><br><span class="line">                    spf[j] = i;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 欧拉筛时间复杂度O(n)</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">euler</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">visit</span><span class="params">(n + <span class="number">1</span>, <span class="literal">false</span>)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">prime</span><span class="params">(n / <span class="number">2</span> + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!visit[i]) &#123;</span><br><span class="line">            prime[cnt++] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; cnt; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i * prime[j] &gt; n) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            visit[i * prime[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % prime[j] == <span class="number">0</span>) &#123;</span><br><span class="line">    			<span class="comment">// 保证每个合数只被最小的质数遍历一次</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Pick定理"><a href="#Pick定理" class="headerlink" title="Pick定理"></a>Pick定理</h3><p><code>S = i + b / 2 - 1</code></p>
<p><code>S</code>：图形的面积（可以是实数）；</p>
<p><code>i</code>：图形内部的格点数；</p>
<p><code>b</code>：图形边界上的格点数（包括顶点）；</p>
<p>给定两个整数点<code>(x1, y1), (y1, y2)</code>,  两点间（包括端点)的格点数为<code>gcd(|x2 - x1|, |y2 - y1|) + 1</code></p>
<p>则求某区域内的格点数的方法为<code>i = S − 2 / b + 1</code></p>
<h3 id="差分"><a href="#差分" class="headerlink" title="差分"></a>差分</h3><p>对区间进行快速加法操作</p>
<h4 id="一维-1"><a href="#一维-1" class="headerlink" title="一维"></a>一维</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 若有原数组则要分开处理，最后加上原数组或者进行以下处理</span></span><br><span class="line">v[i] = original[i] - original[i - <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, vector&lt;<span class="type">int</span>&gt; &amp; v)</span></span>&#123;</span><br><span class="line">	v[l] += x;</span><br><span class="line">	v[r + <span class="number">1</span>] -= x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    v[i] += v[i - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="二维-1"><a href="#二维-1" class="headerlink" title="二维"></a>二维</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 和原数组分开处理，最后加上原数组，或者进行以下处理</span></span><br><span class="line">v[i][j] = a[i][j] - a[i - <span class="number">1</span>][j] - a[i][j - <span class="number">1</span>] + a[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2, <span class="type">int</span> val, vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; v)</span></span>&#123;</span><br><span class="line">	v[x1][y1] += val;</span><br><span class="line">    v[x2 + <span class="number">1</span>][y1] -= val;</span><br><span class="line">    v[x1][y2 + <span class="number">1</span>] -= val;</span><br><span class="line">    v[x2 + <span class="number">1</span>][y2 + <span class="number">1</span>] += val;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="序列-数组问题"><a href="#序列-数组问题" class="headerlink" title="序列&#x2F;数组问题"></a>序列&#x2F;数组问题</h3><h4 id="最长公共子序列"><a href="#最长公共子序列" class="headerlink" title="最长公共子序列"></a>最长公共子序列</h4><p>递归&#x2F;递推+路径</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// 递归版</span></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line">string s1, s2;</span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">dp</span>(<span class="number">1001</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(<span class="number">1001</span>, <span class="number">-1</span>));</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F1</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(i == n || j == n)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(dp[i][j] != <span class="number">-1</span>) <span class="keyword">return</span> dp[i][j];</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(s1[i] == s2[j])&#123;</span><br><span class="line">            ans = <span class="built_in">max</span>(&#123;<span class="built_in">F1</span>(i + <span class="number">1</span>, j + <span class="number">1</span>) + <span class="number">1</span>, <span class="built_in">F1</span>(i + <span class="number">1</span>, j), <span class="built_in">F1</span>(i , j + <span class="number">1</span>)&#125;);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            ans = <span class="built_in">max</span>(<span class="built_in">F1</span>(i + <span class="number">1</span>, j), <span class="built_in">F1</span>(i, j + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        dp[i][j] = ans;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 递推版</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">F2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    string s1, s2;</span><br><span class="line">    cin &gt;&gt; s1 &gt;&gt; s2;</span><br><span class="line">    <span class="type">int</span> n = s1.<span class="built_in">size</span>(), m = s2.<span class="built_in">size</span>();</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">dp</span>(n + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;(m + <span class="number">1</span>, <span class="number">0</span>));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; j ++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s1[i - <span class="number">1</span>] == s2[ j - <span class="number">1</span>])&#123;</span><br><span class="line">                dp[i][j] = dp[i - <span class="number">1</span>][j - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                dp[i][j] = <span class="built_in">max</span>(dp[i - <span class="number">1</span>][j], dp[i][ j - <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 求路径</span></span><br><span class="line">    string s;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = n, j = m; i &amp;&amp; j;)&#123;</span><br><span class="line">    	<span class="keyword">if</span>(s1[i - <span class="number">1</span>] == s2[j - <span class="number">1</span>])&#123;</span><br><span class="line">    		s += s1[i - <span class="number">1</span>];</span><br><span class="line">    		i --;</span><br><span class="line">    		j --;</span><br><span class="line">    	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    		<span class="keyword">if</span>(dp[i - <span class="number">1</span>][j] &gt; dp[i][j - <span class="number">1</span>]) i --;</span><br><span class="line">    		<span class="keyword">else</span> j --;</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(s.<span class="built_in">size</span>() == <span class="number">0</span>)&#123;</span><br><span class="line">    	cout &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, j = s.<span class="built_in">size</span>() - <span class="number">1</span>; i &lt; j; i ++, j --) <span class="built_in">swap</span>(s[i], s[j]);</span><br><span class="line">    cout &lt;&lt; s &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="最长递增子序列"><a href="#最长递增子序列" class="headerlink" title="最长递增子序列"></a>最长递增子序列</h4><p>两个序列包含完全相同的数字使，可以将一个数组的顺序映射到另一个数组上，这时其最长公共子序列变成求最长递增子序列问题（或者反向求最长递减子序列）</p>
<h5 id="普通版"><a href="#普通版" class="headerlink" title="普通版"></a>普通版</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F1</span><span class="params">(<span class="type">int</span> x, vector&lt;<span class="type">int</span>&gt; &amp; v)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> r = v.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">-1</span>;</span><br><span class="line">    <span class="type">int</span> mid;</span><br><span class="line">    <span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">        mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(x &lt; v[mid]) l = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            r = mid - <span class="number">1</span>;</span><br><span class="line">            ans = mid;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v2</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">temp</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, x; i &lt;= n; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">        temp[x] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n ; i ++)&#123;</span><br><span class="line">        cin &gt;&gt; v2[i];  </span><br><span class="line">        v2[i] = temp[v2[i]];</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; ans;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = n, x; i; i --)&#123;</span><br><span class="line">        x = <span class="built_in">F1</span>(v2[i], ans);</span><br><span class="line">        <span class="keyword">if</span>(x == <span class="number">-1</span>)&#123;</span><br><span class="line">            ans.<span class="built_in">push_back</span>(v2[i]);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            ans[x] = v2[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="字典序最小版"><a href="#字典序最小版" class="headerlink" title="字典序最小版"></a>字典序最小版</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F1</span><span class="params">(<span class="type">int</span> x, vector&lt;<span class="type">int</span>&gt; &amp; v)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> ans = <span class="number">-1</span>;</span><br><span class="line">	<span class="type">int</span> l = <span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> r = v.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">	<span class="type">int</span> mid;</span><br><span class="line">	<span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">		mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(x &lt; v[mid])&#123;</span><br><span class="line">			l = mid + <span class="number">1</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			r = mid - <span class="number">1</span>;</span><br><span class="line">			ans = mid;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">	cout.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	cin &gt;&gt; n;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span>&amp; x : v1) cin &gt;&gt; x;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; v2;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dp</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = n - <span class="number">1</span>, ans; i &gt;= <span class="number">0</span>; i --)&#123;</span><br><span class="line">		ans = <span class="built_in">F1</span>(v1[i], v2);</span><br><span class="line">		<span class="keyword">if</span>(ans == <span class="number">-1</span>)&#123;</span><br><span class="line">			v2.<span class="built_in">push_back</span>(v1[i]);</span><br><span class="line">			dp[i] = v2.<span class="built_in">size</span>();</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			v2[ans] = v1[i];</span><br><span class="line">			dp[i] = ans + <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">int</span> m = v2.<span class="built_in">size</span>();</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">ans</span><span class="params">(m, <span class="number">1e9</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> x : dp) cout &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, x; i &lt; n; i ++)&#123;</span><br><span class="line">		x = dp[i];</span><br><span class="line">		<span class="keyword">if</span>(x == m) ans[<span class="number">0</span>] = v1[i];</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(ans[m - x - <span class="number">1</span>] &lt; v1[i])&#123;</span><br><span class="line">				ans[m - x] = v1[i];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; m; i ++)&#123;</span><br><span class="line">		cout &lt;&lt; ans[i];</span><br><span class="line">		<span class="keyword">if</span>(i != m) cout &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="累加和不大于k的最长子数组"><a href="#累加和不大于k的最长子数组" class="headerlink" title="累加和不大于k的最长子数组"></a>累加和不大于k的最长子数组</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="type">int</span> n;</span><br><span class="line">	<span class="type">int</span> k;</span><br><span class="line">	cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(n, <span class="number">0</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> &amp; x : v1) cin &gt;&gt; x;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">min1</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">minend</span><span class="params">(n)</span></span>;</span><br><span class="line">	min1[n - <span class="number">1</span>] = v1[n - <span class="number">1</span>];</span><br><span class="line">	minend[n - <span class="number">1</span>] = n - <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = n - <span class="number">2</span>; i &gt;= <span class="number">0</span>; i --)&#123;</span><br><span class="line">		<span class="keyword">if</span>(min1[i + <span class="number">1</span>] &lt;= <span class="number">0</span>)&#123;</span><br><span class="line">			min1[i] = v1[i] + min1[i + <span class="number">1</span>];</span><br><span class="line">			minend[i] = minend[i + <span class="number">1</span>];</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			min1[i] = v1[i];</span><br><span class="line">			minend[i] = i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>, sum1 = <span class="number">0</span>, r = <span class="number">0</span>; i &lt; n; i ++)&#123;</span><br><span class="line">		<span class="keyword">while</span>(r &lt; n  &amp;&amp; sum1 + min1[r] &lt;= k)&#123;</span><br><span class="line">			sum1 += min1[r];</span><br><span class="line">			r = minend[r] + <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(r &gt; i)&#123;</span><br><span class="line">			ans = <span class="built_in">max</span>(ans, r - i);</span><br><span class="line">			sum1 -= v1[i];</span><br><span class="line">		&#125;<span class="keyword">else</span> r = i + <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="DP"><a href="#DP" class="headerlink" title="DP"></a>DP</h3><h4 id="数位DP"><a href="#数位DP" class="headerlink" title="数位DP"></a>数位DP</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数位dp https://www.luogu.com.cn/problem/P2602</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> d)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> cur, temp = n, l, r = <span class="number">1</span>; temp; r *= <span class="number">10</span>, temp /= <span class="number">10</span>)&#123;</span><br><span class="line">        cur = temp % <span class="number">10</span>;</span><br><span class="line">        l = temp / <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">if</span>(d == <span class="number">0</span>) l --;</span><br><span class="line">        ans += l * r;</span><br><span class="line">        <span class="keyword">if</span>(d &lt; cur)&#123;</span><br><span class="line">            ans += r;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(d == cur)&#123;</span><br><span class="line">            ans += n % r + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> l, r;</span><br><span class="line">    cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i ++)&#123;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">F</span>(r, i) - <span class="built_in">F</span>(l - <span class="number">1</span>, i);</span><br><span class="line">        <span class="keyword">if</span>(i != <span class="number">9</span>) cout &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/P3413</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">is</span><span class="params">(string s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>, j; i &lt; s.<span class="built_in">size</span>(); i ++)&#123;</span><br><span class="line">        j = i - <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>((j &gt;= <span class="number">0</span> &amp;&amp; s[j] == s[i]) || s[i] == s[i - <span class="number">1</span>]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 统计0-n中所有不是回文数的数 f1表示是否选过数 f2表示是否可以任意选</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F</span><span class="params">(<span class="type">int</span> i1, string s, <span class="type">int</span> l, <span class="type">int</span> ll, <span class="type">bool</span> f1, <span class="type">bool</span> f2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(i1 == s.<span class="built_in">size</span>()) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(!f1)&#123;</span><br><span class="line">        ans = (ans + <span class="built_in">F</span>(i1 + <span class="number">1</span>, s, <span class="number">-1</span>, <span class="number">-1</span>, <span class="literal">false</span>, <span class="literal">true</span>)) % mod;</span><br><span class="line">        <span class="keyword">if</span>(!f2)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; s[i1] - <span class="string">&#x27;0&#x27;</span>; i ++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i != l &amp;&amp; i != ll)&#123;</span><br><span class="line">                    ans = (ans + <span class="built_in">F</span>(i1 + <span class="number">1</span>, s, i, l, <span class="literal">true</span>, <span class="literal">true</span>)) % mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(s[i1] - <span class="string">&#x27;0&#x27;</span> != l &amp;&amp; s[i1] - <span class="string">&#x27;0&#x27;</span> != ll) ans = (ans + <span class="built_in">F</span>(i1 + <span class="number">1</span>, s, s[i1] - <span class="string">&#x27;0&#x27;</span>, l, <span class="literal">true</span>, <span class="literal">false</span>)) % mod;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> sum = <span class="number">9</span>;</span><br><span class="line">            <span class="keyword">if</span>(++i1 != s.<span class="built_in">size</span>()) sum *= <span class="number">9</span>;</span><br><span class="line">            <span class="keyword">while</span>(++i1 &lt; s.<span class="built_in">size</span>())&#123;</span><br><span class="line">                sum = (sum * <span class="number">8</span>) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">            ans = (ans + sum) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!f2)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s[i1] - <span class="string">&#x27;0&#x27;</span>; i ++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i != l &amp;&amp; i != ll)&#123;</span><br><span class="line">                    ans = (ans + <span class="built_in">F</span>(i1 + <span class="number">1</span>, s, i, l, <span class="literal">true</span>, <span class="literal">true</span>)) % mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(s[i1] - <span class="string">&#x27;0&#x27;</span> != l &amp;&amp; s[i1] - <span class="string">&#x27;0&#x27;</span> != ll) ans = (ans + <span class="built_in">F</span>(i1 + <span class="number">1</span>, s, s[i1] - <span class="string">&#x27;0&#x27;</span>, l, <span class="literal">true</span>, <span class="literal">false</span>)) % mod;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> sum;</span><br><span class="line">            <span class="keyword">if</span>(ll == <span class="number">-1</span>)&#123;</span><br><span class="line">                sum = <span class="number">9</span>;</span><br><span class="line">                <span class="keyword">while</span>(++ i1 &lt; s.<span class="built_in">size</span>())&#123;</span><br><span class="line">                    sum = (sum * <span class="number">8</span>) % mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                sum = <span class="number">8</span>;</span><br><span class="line">                <span class="keyword">while</span>(++ i1 &lt; s.<span class="built_in">size</span>())&#123;</span><br><span class="line">                    sum = (sum * <span class="number">8</span>) % mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ans = (ans + sum) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 统计0-n中的所有数 f1表示是否选过数 f2表示是否可以任意选</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">F2</span><span class="params">(<span class="type">int</span> i1, string s, <span class="type">bool</span> f1, <span class="type">bool</span> f2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(i1 == s.<span class="built_in">size</span>()) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(!f1)&#123;</span><br><span class="line">        ans = (ans + <span class="built_in">F2</span>(i1 + <span class="number">1</span>, s, <span class="literal">false</span>, <span class="literal">true</span>)) % mod;</span><br><span class="line">        <span class="keyword">if</span>(!f2)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; s[i1] - <span class="string">&#x27;0&#x27;</span>; i ++)&#123;</span><br><span class="line">                ans = (ans + <span class="built_in">F2</span>(i1 + <span class="number">1</span>, s, <span class="literal">true</span>, <span class="literal">true</span>)) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">            ans = (ans + <span class="built_in">F2</span>(i1 + <span class="number">1</span>, s, <span class="literal">true</span>, <span class="literal">false</span>)) % mod;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> sum = <span class="number">9</span>; <span class="comment">// 不能为零</span></span><br><span class="line">            <span class="keyword">while</span>(++ i1 &lt; s.<span class="built_in">size</span>())&#123;</span><br><span class="line">                sum = (sum * <span class="number">10</span>) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">            ans = (ans + sum) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!f2)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; s[i1] - <span class="string">&#x27;0&#x27;</span>; i ++)&#123;</span><br><span class="line">                ans = (ans + <span class="built_in">F2</span>(i1 + <span class="number">1</span>, s, <span class="literal">true</span>, <span class="literal">true</span>)) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">            ans = (ans + <span class="built_in">F2</span>(i1 + <span class="number">1</span>, s, <span class="literal">true</span>, <span class="literal">false</span>)) % mod;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> sum = <span class="number">10</span>; <span class="comment">// 能为零</span></span><br><span class="line">            <span class="keyword">while</span>(++ i1 &lt; s.<span class="built_in">size</span>())&#123;</span><br><span class="line">                sum = (sum * <span class="number">10</span>) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">            ans = (ans + sum) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    string s1, s2;</span><br><span class="line">    cin &gt;&gt; s1 &gt;&gt; s2;</span><br><span class="line">    <span class="type">int</span> n1 = <span class="built_in">F</span>(<span class="number">0</span>, s1, <span class="number">-1</span>, <span class="number">-1</span>, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> n2 = <span class="built_in">F</span>(<span class="number">0</span>, s2, <span class="number">-1</span>, <span class="number">-1</span>, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> ans1 = (n2 - n1  + <span class="built_in">is</span>(s1) + mod) % mod;</span><br><span class="line">    <span class="type">int</span> n3 = <span class="built_in">F2</span>(<span class="number">0</span>, s1, <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> n4 = <span class="built_in">F2</span>(<span class="number">0</span>, s2, <span class="literal">false</span> ,<span class="literal">false</span>);</span><br><span class="line">    <span class="type">int</span> ans2 = (n4 - n3 + <span class="number">1</span> + mod) % mod;</span><br><span class="line">    cout &lt;&lt; (ans2 - ans1 + mod) % mod &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="树形DP-1"><a href="#树形DP-1" class="headerlink" title="树形DP"></a>树形DP</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// https://pintia.cn/problem-sets/1859417373569925120/exam/problems/type/7?problemSetProblemId=1859417373590896646</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">my</span>&#123;</span><br><span class="line">	<span class="type">int</span> w, b;</span><br><span class="line">	priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;&gt;&gt; qw, qb;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>) -&gt; ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--)&#123;</span><br><span class="line">    	<span class="type">int</span> n;</span><br><span class="line">    	cin &gt;&gt; n;</span><br><span class="line">    	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">color</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">val</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">root</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    	<span class="function">vector <span class="title">adj</span><span class="params">(n + <span class="number">1</span>, vector&lt;<span class="type">int</span>&gt;())</span></span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    		<span class="type">int</span> m;</span><br><span class="line">    		cin &gt;&gt; color[i] &gt;&gt; val[i] &gt;&gt; m;</span><br><span class="line">    		<span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; j ++)&#123;</span><br><span class="line">    			<span class="type">int</span> v;</span><br><span class="line">    			cin &gt;&gt; v;</span><br><span class="line">    			adj[i].<span class="built_in">push_back</span>(v);</span><br><span class="line">    			root[v] --;</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// 传回可以被改色的节点</span></span><br><span class="line">		<span class="keyword">auto</span> F = [&amp;](<span class="keyword">auto</span> &amp;&amp; f, <span class="type">int</span> u) -&gt; my &#123;</span><br><span class="line">			<span class="type">int</span> w1 = <span class="number">0</span>, b1 = <span class="number">0</span>;</span><br><span class="line">			priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;&gt;&gt; qw1, qb1;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">auto</span> v : adj[u])&#123;</span><br><span class="line">				my temp = <span class="built_in">f</span>(f, v);</span><br><span class="line">				w1 += temp.w;</span><br><span class="line">				b1 += temp.b;</span><br><span class="line">				<span class="keyword">while</span>(!temp.qw.<span class="built_in">empty</span>())&#123;</span><br><span class="line">					qw1.<span class="built_in">push</span>(temp.qw.<span class="built_in">top</span>());</span><br><span class="line">					temp.qw.<span class="built_in">pop</span>();</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">while</span>(!temp.qb.<span class="built_in">empty</span>())&#123;</span><br><span class="line">					qb1.<span class="built_in">push</span>(temp.qb.<span class="built_in">top</span>());</span><br><span class="line">					temp.qb.<span class="built_in">pop</span>();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// cout &lt;&lt; u &lt;&lt; &quot; &quot; &lt;&lt; w1 &lt;&lt; &quot; &quot; &lt;&lt; b1 &lt;&lt;  &quot;\n&quot;;</span></span><br><span class="line">			<span class="comment">// priority_queue&lt;int, vector&lt;int&gt;, greater&lt;&gt;&gt; q11 = qw1, q22 = qb1;</span></span><br><span class="line">			<span class="comment">// cout &lt;&lt; &quot;w: &quot;;</span></span><br><span class="line">			<span class="comment">// while(!q11.empty())&#123;</span></span><br><span class="line">				<span class="comment">// cout &lt;&lt; q11.top() &lt;&lt; &quot; &quot;;</span></span><br><span class="line">				<span class="comment">// q11.pop();</span></span><br><span class="line">			<span class="comment">// &#125;cout &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">			<span class="comment">// cout &lt;&lt; &quot;b: &quot;;</span></span><br><span class="line">			<span class="comment">// while(!q22.empty())&#123;</span></span><br><span class="line">				<span class="comment">// cout &lt;&lt; q22.top() &lt;&lt; &quot; &quot;;</span></span><br><span class="line">				<span class="comment">// q22.pop();</span></span><br><span class="line">			<span class="comment">// &#125;cout &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">			my temp;</span><br><span class="line">			priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;&gt;&gt; q1, q2;</span><br><span class="line">			temp.w = temp.b = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">if</span>(color[u] == <span class="number">0</span>)&#123;</span><br><span class="line">				temp.w ++;</span><br><span class="line">				q1.<span class="built_in">push</span>(val[u]);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				temp.b ++;</span><br><span class="line">				q2.<span class="built_in">push</span>(val[u]);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(w1 != b1)&#123;</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">abs</span>(w1 - b1) == <span class="number">1</span>)&#123;</span><br><span class="line">					<span class="keyword">if</span>(w1 &gt; b1)&#123;</span><br><span class="line">						q1.<span class="built_in">push</span>(qw1.<span class="built_in">top</span>());</span><br><span class="line">					&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">						q2.<span class="built_in">push</span>(qb1.<span class="built_in">top</span>());</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">					<span class="keyword">while</span>(<span class="built_in">abs</span>(w1 - b1) &gt;= <span class="number">2</span>)&#123;</span><br><span class="line">						<span class="keyword">if</span>(w1 &gt; b1)&#123;</span><br><span class="line">							ans += qw1.<span class="built_in">top</span>();</span><br><span class="line">							qw1.<span class="built_in">pop</span>();</span><br><span class="line">							w1 --, b1 ++;</span><br><span class="line">						&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">							ans += qb1.<span class="built_in">top</span>();</span><br><span class="line">							qb1.<span class="built_in">pop</span>();</span><br><span class="line">							w1 --, b1 ++;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			temp.qw = q1, temp.qb = q2;</span><br><span class="line">			temp.w += w1, temp.b += b1;</span><br><span class="line">			<span class="keyword">return</span> temp;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(root[i] == <span class="number">0</span>)&#123;</span><br><span class="line">				<span class="built_in">F</span>(F, i);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">    	cout &lt;&lt; ans &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Fliegel–Van-Flandern-算法"><a href="#Fliegel–Van-Flandern-算法" class="headerlink" title="Fliegel–Van Flandern 算法"></a>Fliegel–Van Flandern 算法</h3><p>这个算法可以将从公元前4713年1月1日（即儒略日JD&#x3D;0）起计算的**儒略日数（JD）**转换为公历日期（年、月、日），并自动判断是在儒略历还是格里历中（1582年10月15日为切换点）。</p>
<ul>
<li>JD ≥ 2299161：采用<strong>格里历</strong>（即1582年10月15日之后）</li>
<li>JD &lt; 2299161：采用<strong>儒略历</strong></li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Fliegel–Van Flandern 算法</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">julianDayToDate</span><span class="params">(ll JD, ll &amp;day, ll &amp;month, ll &amp;year, <span class="type">bool</span> &amp;isBC)</span> </span>&#123;</span><br><span class="line">    ll A, B, C, D, E;</span><br><span class="line">    <span class="keyword">if</span> (JD &gt;= <span class="number">2299161</span>) &#123; </span><br><span class="line">        <span class="type">double</span> alpha = <span class="built_in">floor</span>((JD - <span class="number">1867216.25</span>) / <span class="number">36524.25</span>);</span><br><span class="line">        A = JD + <span class="number">1</span> + alpha - <span class="built_in">floor</span>(alpha / <span class="number">4.0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123; </span><br><span class="line">        A = JD;</span><br><span class="line">    &#125;</span><br><span class="line">    B = A + <span class="number">1524</span>;</span><br><span class="line">    C = <span class="built_in">floor</span>((<span class="type">double</span>)(B - <span class="number">122.1</span>) / <span class="number">365.25</span>);</span><br><span class="line">    D = <span class="built_in">floor</span>(<span class="number">365.25</span> * (<span class="type">double</span>)C);</span><br><span class="line">    E = <span class="built_in">floor</span>((<span class="type">double</span>)(B - D) / <span class="number">30.6001</span>);</span><br><span class="line">    day = B - D - <span class="built_in">floor</span>(<span class="number">30.6001</span> * E);</span><br><span class="line">    <span class="keyword">if</span> (E &lt; <span class="number">14</span>)</span><br><span class="line">        month = E - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        month = E - <span class="number">13</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (month &gt; <span class="number">2</span>)</span><br><span class="line">        year = C - <span class="number">4716</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        year = C - <span class="number">4715</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (year &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        isBC = <span class="literal">true</span>;</span><br><span class="line">        day = day;</span><br><span class="line">        month = month;</span><br><span class="line">        year = -(year) + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        isBC = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">    ll Q;</span><br><span class="line">    cin &gt;&gt; Q;</span><br><span class="line">    <span class="keyword">while</span>(Q--)&#123;</span><br><span class="line">        ll JD;</span><br><span class="line">        cin &gt;&gt; JD;</span><br><span class="line">        ll day, month, year;</span><br><span class="line">        <span class="type">bool</span> isBC = <span class="literal">false</span>;</span><br><span class="line">        <span class="built_in">julianDayToDate</span>(JD, day, month, year, isBC);</span><br><span class="line">        <span class="keyword">if</span>(isBC)&#123;</span><br><span class="line">            cout &lt;&lt; day &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; month &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; year &lt;&lt; <span class="string">&quot; BC\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            cout &lt;&lt; day &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; month &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; year &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="逆波兰式"><a href="#逆波兰式" class="headerlink" title="逆波兰式"></a>逆波兰式</h3><p>逆波兰表达式（Reverse Polish Notation，简称 <code>RPN</code>），也称为后缀表达式，是一种将运算符放在操作数之后的数学表达方式。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mod1 1000000007</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="type">int</span> N = <span class="number">3e5</span> + <span class="number">1</span>;</span><br><span class="line"><span class="function">vector&lt;ll&gt; <span class="title">stack1</span><span class="params">(N,<span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="type">int</span> size1;</span><br><span class="line">ll a;</span><br><span class="line">ll b;</span><br><span class="line">ll ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">    size1 = <span class="number">0</span>;</span><br><span class="line">    string s;</span><br><span class="line">    <span class="built_in">getline</span>(cin,s);</span><br><span class="line">    <span class="function">istringstream <span class="title">ios</span><span class="params">(s)</span></span>;</span><br><span class="line">    string token;</span><br><span class="line">    <span class="keyword">while</span>(ios &gt;&gt; token)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">isdigit</span>(token[<span class="number">0</span>]))&#123;</span><br><span class="line">            stack1[size1++] = <span class="built_in">stoll</span>(token);</span><br><span class="line">            <span class="comment">// cout &lt;&lt; stoll(token) &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            b = stack1[--size1];</span><br><span class="line">            a = stack1[--size1];</span><br><span class="line">            <span class="comment">// cout &lt;&lt; a &lt;&lt; &quot; &quot; &lt;&lt; b &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">            <span class="keyword">if</span>(token == <span class="string">&quot;+&quot;</span>)&#123;</span><br><span class="line">                ans = (a + b) % mod1;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(token == <span class="string">&quot;-&quot;</span>)&#123;</span><br><span class="line">                ans = (a - b) % mod1;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(token == <span class="string">&quot;*&quot;</span>)&#123;</span><br><span class="line">                ans = (a * b) % mod1;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                ans = (a / b) % mod1;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// cout &lt;&lt; ans &lt;&lt; &quot;\n&quot;;</span></span><br><span class="line">            stack1[size1++] = ans;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; stack1[size1 - <span class="number">1</span>] &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="约瑟夫环"><a href="#约瑟夫环" class="headerlink" title="约瑟夫环"></a>约瑟夫环</h3><p>约瑟夫环问题描述的是一群人围成一圈，每隔固定人数（即第 k 个人）被淘汰，直到最后剩下一个人。最后存活的人的位置可以通过下面的递推式来求解：</p>
<p>假设只有 1 个人时，存活的位置为 0（注意：这里用 0 表示编号，从 0 开始）；当有 i 个人时，可以利用 i-1 个人的结果递推出 i 个人的情况。<br>递推公式为：</p>
<p>f(i) &#x3D; (f(i−1) + k ) mod  i</p>
<p>其中，f(i)表示 i 个人时最后存活者的编号。</p>
<p>i &#x3D; 1 时，f[i]显然等于0</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">josephus</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> result = <span class="number">0</span>; <span class="comment">// 初始只有一个人时，位置是 0</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        result = (result + k) % i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="离散化-1"><a href="#离散化-1" class="headerlink" title="离散化"></a>离散化</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>) -&gt; ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// cin &gt;&gt; t;</span></span><br><span class="line">    <span class="keyword">while</span> (t--)&#123;</span><br><span class="line">    	<span class="type">int</span> n;</span><br><span class="line">    	cin &gt;&gt; n;</span><br><span class="line">    	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v1</span><span class="params">(n + <span class="number">1</span>)</span>, <span class="title">ord</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    		cin &gt;&gt; v1[i];</span><br><span class="line">    		ord[i] = v1[i];</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="built_in">sort</span>(ord.<span class="built_in">begin</span>() + <span class="number">1</span>, ord.<span class="built_in">end</span>());</span><br><span class="line">    	<span class="type">int</span> m = <span class="number">1</span>;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt;= n; i ++)&#123;</span><br><span class="line">    		<span class="keyword">if</span>(ord[m] != ord[i])&#123;</span><br><span class="line">    			ord[++ m] = ord[i];</span><br><span class="line">    		&#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">auto</span> find = [&amp;](<span class="type">int</span> x) -&gt; <span class="type">int</span> &#123;</span><br><span class="line">    		<span class="type">int</span> l = <span class="number">1</span>, r = m;</span><br><span class="line">    		<span class="type">int</span> mid, ans;</span><br><span class="line">    		<span class="keyword">while</span>(l &lt;= r)&#123;</span><br><span class="line">    			mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    			<span class="keyword">if</span>(x &gt;= ord[mid])&#123;</span><br><span class="line">    				ans = mid;</span><br><span class="line">    				l = mid + <span class="number">1</span>;</span><br><span class="line">    			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    				r = mid - <span class="number">1</span>;</span><br><span class="line">    			&#125;</span><br><span class="line">    		&#125;</span><br><span class="line">    		<span class="keyword">return</span> ans;</span><br><span class="line">    	&#125;;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;after: &quot;</span> &lt;&lt; <span class="built_in">find</span>(v1[i]) &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="N皇后问题"><a href="#N皇后问题" class="headerlink" title="N皇后问题"></a>N皇后问题</h3><h4 id="位运算版本"><a href="#位运算版本" class="headerlink" title="位运算版本"></a>位运算版本</h4><p>每次将状态进行左移和右移一位模拟对角线移动，而且利用位运算快速得到此行能够放置的位置</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">vector&lt;array&lt;<span class="type">int</span>,11&gt;&gt; sols;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> colMask, <span class="type">int</span> d1Mask, <span class="type">int</span> d2Mask, array&lt;<span class="type">int</span>,<span class="number">11</span>&gt;&amp; col)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (row == n) &#123;</span><br><span class="line">        sols.<span class="built_in">push_back</span>(col);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> avail = ((<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>) &amp; ~(colMask | d1Mask | d2Mask); </span><br><span class="line">    <span class="keyword">while</span> (avail) &#123;</span><br><span class="line">        <span class="type">int</span> p = avail &amp; -avail; </span><br><span class="line">        <span class="type">int</span> c = __builtin_ctz(p);</span><br><span class="line">        col[row] = c;</span><br><span class="line">        <span class="built_in">dfs</span>(row + <span class="number">1</span>,</span><br><span class="line">            colMask | p,</span><br><span class="line">            (d1Mask | p) &lt;&lt; <span class="number">1</span>,</span><br><span class="line">            (d2Mask | p) &gt;&gt; <span class="number">1</span>,</span><br><span class="line">            col);</span><br><span class="line">        avail ^= p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="literal">nullptr</span>);</span><br><span class="line">	cin &gt;&gt; n;</span><br><span class="line">    array&lt;<span class="type">int</span>,11&gt; col&#123;&#125;;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, col);</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> S = sols.<span class="built_in">size</span>();</span><br><span class="line">    cout &lt;&lt; S &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h2><h3 id="set"><a href="#set" class="headerlink" title="set"></a>set</h3><p>基于红黑树实现的自动排序、无重复元素的关联容器</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">set&lt;<span class="type">int</span>&gt; s;                  <span class="comment">// 升序，默认 less&lt;int&gt;</span></span><br><span class="line">set&lt;string&gt; names;</span><br><span class="line">set&lt;<span class="type">int</span>, greater&lt;<span class="type">int</span>&gt;&gt; s2;   <span class="comment">// 降序排列</span></span><br><span class="line">s.<span class="built_in">insert</span>(<span class="number">5</span>);    <span class="comment">// 插入 5，若已存在则无效</span></span><br><span class="line">s.<span class="built_in">erase</span>(<span class="number">5</span>);       <span class="comment">// 删除值为5的元素</span></span><br><span class="line">s.<span class="built_in">erase</span>(it);      <span class="comment">// 通过迭代器删除</span></span><br><span class="line">s.<span class="built_in">erase</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">end</span>()); <span class="comment">// 清空</span></span><br><span class="line"><span class="keyword">auto</span> it = s.<span class="built_in">find</span>(<span class="number">5</span>);     <span class="comment">// 找到返回迭代器，否则为 s.end()</span></span><br><span class="line"><span class="keyword">if</span> (it != s.<span class="built_in">end</span>()) cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; found\n&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (s.<span class="built_in">count</span>(<span class="number">5</span>)) cout &lt;&lt; <span class="string">&quot;存在&quot;</span>;</span><br><span class="line">s.<span class="built_in">size</span>();</span><br><span class="line">s.<span class="built_in">empty</span>();</span><br><span class="line">s.<span class="built_in">clear</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> it = s.<span class="built_in">begin</span>(); it != s.<span class="built_in">end</span>(); ++it)</span><br><span class="line">    cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> x : s)</span><br><span class="line">    cout &lt;&lt; x &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line"><span class="keyword">auto</span> it1 = s.<span class="built_in">lower_bound</span>(<span class="number">5</span>); <span class="comment">// 返回 ≥ 5 的第一个元素迭代器</span></span><br><span class="line"><span class="keyword">auto</span> it2 = s.<span class="built_in">upper_bound</span>(<span class="number">5</span>); <span class="comment">// 返回 &gt; 5 的第一个元素迭代器</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cmp</span> &#123;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&amp; a, <span class="type">const</span> pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;&amp; b)</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a.first &lt; b.first;  <span class="comment">// 可定义复合排序规则</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">set&lt;pair&lt;<span class="type">int</span>,<span class="type">int</span>&gt;, cmp&gt; s;</span><br></pre></td></tr></table></figure>

<p>插入&#x2F;删除&#x2F;查找都是O(log n)</p>
<h3 id="ordered-set"><a href="#ordered-set" class="headerlink" title="ordered_set"></a>ordered_set</h3><p>解释各个部分的作用</p>
<table>
<thead>
<tr>
<th>代码部分</th>
<th>功能</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>s.insert(5)</code></td>
<td>插入元素</td>
<td><code>ordered_set</code> 自动去重</td>
</tr>
<tr>
<td><code>s.erase(7)</code></td>
<td>删除元素</td>
<td>需先检查元素是否存在</td>
</tr>
<tr>
<td><code>find_by_order(k)</code></td>
<td>获取第 k 小元素</td>
<td><code>0-based</code>，需先检查是否为空</td>
</tr>
<tr>
<td><code>order_of_key(10)</code></td>
<td>获取小于某个值的元素数量</td>
<td><code>O(log n)</code> 复杂度</td>
</tr>
<tr>
<td><code>find(5)</code></td>
<td>查找元素</td>
<td>直接返回迭代器</td>
</tr>
<tr>
<td><code>s.size()</code></td>
<td>获取集合大小</td>
<td><code>O(1)</code> 复杂度</td>
</tr>
<tr>
<td><code>s.clear()</code></td>
<td>清空集合</td>
<td>直接清空</td>
</tr>
</tbody></table>
<p>时间复杂度</p>
<ul>
<li>插入：<code>O(log n)</code></li>
<li>删除：<code>O(log n)</code></li>
<li>查找：<code>O(log n)</code></li>
<li>获取第 k 小元素：<code>O(log n)</code></li>
<li>获取小于 x 的元素数量：<code>O(log n)</code></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ext/pb_ds/assoc_container.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ext/pb_ds/tree_policy.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_pbds;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> tree&lt;</span><br><span class="line">    <span class="type">int</span>, </span><br><span class="line">    null_type, </span><br><span class="line">    less&lt;<span class="type">int</span>&gt;, </span><br><span class="line">    rb_tree_tag, </span><br><span class="line">    tree_order_statistics_node_update</span><br><span class="line">&gt; ordered_set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ordered_set s;</span><br><span class="line">    s.<span class="built_in">insert</span>(<span class="number">5</span>);</span><br><span class="line">    <span class="keyword">if</span> (s.<span class="built_in">find</span>(<span class="number">7</span>) != s.<span class="built_in">end</span>()) s.<span class="built_in">erase</span>(<span class="number">7</span>);</span><br><span class="line">    <span class="keyword">if</span> (s.<span class="built_in">size</span>() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;The 2nd smallest element is: &quot;</span> &lt;&lt; *s.<span class="built_in">find_by_order</span>(<span class="number">1</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (s.<span class="built_in">find</span>(<span class="number">5</span>) != s.<span class="built_in">end</span>()) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;5 exists in the set\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!s.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Minimum element: &quot;</span> &lt;&lt; *s.<span class="built_in">find_by_order</span>(<span class="number">0</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Maximum element: &quot;</span> &lt;&lt; *s.<span class="built_in">find_by_order</span>(s.<span class="built_in">size</span>() - <span class="number">1</span>) &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    s.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="string"><a href="#string" class="headerlink" title="string"></a>string</h3><h4 id="数值与字符串转化"><a href="#数值与字符串转化" class="headerlink" title="数值与字符串转化"></a>数值与字符串转化</h4><table>
<thead>
<tr>
<th>函数签名</th>
<th>作用说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>to_string(val)</code></td>
<td>把 <code>val</code> 转换成 <code>string</code></td>
</tr>
<tr>
<td><code>stoi(s, p, b)</code></td>
<td>把字符串 <code>s</code> 从下标 <code>p</code> 开始转换成 <code>b</code> 进制的 <code>int</code></td>
</tr>
<tr>
<td><code>stol(s, p, b)</code></td>
<td>转换成 <code>long</code></td>
</tr>
<tr>
<td><code>stoul(s, p, b)</code></td>
<td>转换成 <code>unsigned long</code></td>
</tr>
<tr>
<td><code>stoll(s, p, b)</code></td>
<td>转换成 <code>long long</code></td>
</tr>
<tr>
<td><code>stoull(s, p, b)</code></td>
<td>转换成 <code>unsigned long long</code></td>
</tr>
<tr>
<td><code>stof(s, p, b)</code></td>
<td>转换成 <code>float</code></td>
</tr>
<tr>
<td><code>stod(s, p, b)</code></td>
<td>转换成 <code>double</code></td>
</tr>
<tr>
<td><code>stold(s, p, b)</code></td>
<td>转换成 <code>long double</code></td>
</tr>
</tbody></table>
<p><code>p</code> 和 <code>b</code>可省，默认为十进制</p>
<h4 id="字符串输入与分割"><a href="#字符串输入与分割" class="headerlink" title="字符串输入与分割"></a>字符串输入与分割</h4><p><code>getline(cin, s)</code></p>
<p><code>stringstream s(ss)</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">string s1;</span><br><span class="line"><span class="built_in">getline</span>(cin, s1);</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; v1;</span><br><span class="line"><span class="function">stringstream <span class="title">ss</span><span class="params">(s1)</span></span>;</span><br><span class="line">string temp;</span><br><span class="line"><span class="comment">// while(ss &gt;&gt; temp) 按空格读取</span></span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">getline</span>(ss, temp, <span class="string">&#x27;,&#x27;</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(temp[<span class="number">0</span>] == <span class="string">&#x27;-&#x27;</span>)&#123;</span><br><span class="line">        temp = temp.<span class="built_in">substr</span>(<span class="number">1</span>);</span><br><span class="line">        v1.<span class="built_in">push_back</span>(-<span class="built_in">stoi</span>(temp));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        v1.<span class="built_in">push_back</span>(<span class="built_in">stoi</span>(temp));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="改变大小写"><a href="#改变大小写" class="headerlink" title="改变大小写"></a>改变大小写</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">transform</span>(起点, 终点, 输出位置, 处理函数)</span><br><span class="line"><span class="comment">// 变小写</span></span><br><span class="line"><span class="built_in">transform</span>(s1.<span class="built_in">begin</span>(), s1.<span class="built_in">end</span>(), s1.<span class="built_in">begin</span>(), ::tolower);</span><br><span class="line"><span class="comment">// 变大写</span></span><br><span class="line"><span class="built_in">transform</span>(s1.<span class="built_in">begin</span>(), s1.<span class="built_in">end</span>(), s1.<span class="built_in">begin</span>(), ::toupper);</span><br><span class="line"><span class="comment">// 转换到另一个字符串</span></span><br><span class="line">string src = <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">string dest;</span><br><span class="line">dest.<span class="built_in">resize</span>(src.<span class="built_in">size</span>());</span><br><span class="line"><span class="built_in">transform</span>(src.<span class="built_in">begin</span>(), src.<span class="built_in">end</span>(), dest.<span class="built_in">begin</span>(), ::tolower);</span><br><span class="line"><span class="comment">// dest 现在是 &quot;hello&quot;，原始 src 不变</span></span><br></pre></td></tr></table></figure>

<h4 id="子串substr"><a href="#子串substr" class="headerlink" title="子串substr"></a>子串<code>substr</code></h4><p><code>substr(st, len)</code></p>
<p><code>len</code>省略时表示到en</p>
<h4 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h4><h5 id="find"><a href="#find" class="headerlink" title="find"></a><code>find</code></h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="function">std::string <span class="title">str</span> <span class="params">(<span class="string">&quot;There are two needles in this haystack with needles.&quot;</span>)</span></span>;</span><br><span class="line">    <span class="function">std::string <span class="title">str2</span> <span class="params">(<span class="string">&quot;needle&quot;</span>)</span></span>;</span><br><span class="line">    <span class="comment">//在str当中查找第一个出现的needle，找到则返回出现的位置，否则返回结尾</span></span><br><span class="line">    std::<span class="type">size_t</span> found = str.<span class="built_in">find</span>(str2);</span><br><span class="line">    <span class="keyword">if</span> (found!=std::string::npos) <span class="comment">// 结尾</span></span><br><span class="line">    <span class="comment">//在str当中，从第found+1的位置开始查找参数字符串的前6个字符</span></span><br><span class="line">    found = str.<span class="built_in">find</span>(<span class="string">&quot;needles are small&quot;</span>,found+<span class="number">1</span>,<span class="number">6</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="rfind"><a href="#rfind" class="headerlink" title="rfind"></a><code>rfind</code></h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//rfind是找最后一个出现的匹配字符串</span></span><br><span class="line">std::<span class="type">size_t</span> found = str.<span class="built_in">rfind</span>(str2);</span><br></pre></td></tr></table></figure>

<h5 id="find-of"><a href="#find-of" class="headerlink" title="find_...of"></a><code>find_...of</code></h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">find_first_of</span>(args) <span class="comment">// **查找args中任何一个字符第一次出现的位置**</span></span><br><span class="line"><span class="built_in">find_last_of</span>(args) <span class="comment">// **最后一个出现的位置**</span></span><br><span class="line"><span class="built_in">find_fist_not_of</span>(args) <span class="comment">// **查找第一个不在args中的字符**</span></span><br><span class="line">find_last_not_of <span class="comment">// **查找最后一个不在args中出现的字符**</span></span><br></pre></td></tr></table></figure>

<h4 id="插入insert"><a href="#插入insert" class="headerlink" title="插入insert"></a>插入insert</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    string str=<span class="string">&quot;to be question&quot;</span>;</span><br><span class="line">    string str2=<span class="string">&quot;the &quot;</span>;</span><br><span class="line">    string str3=<span class="string">&quot;or not to be&quot;</span>;</span><br><span class="line">    string::iterator it;</span><br><span class="line">    <span class="comment">//s.insert(pos,str)//在s的pos位置插入str</span></span><br><span class="line">    str.<span class="built_in">insert</span>(<span class="number">6</span>,str2); </span><br><span class="line">    <span class="comment">//s.insert(pos,str,a,n)在s的pos位置插入str中插入位置a到后面的n个字符</span></span><br><span class="line">    str.<span class="built_in">insert</span>(<span class="number">6</span>,str3,<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line">    <span class="comment">//s.insert(pos,cstr,n)//在pos位置插入cstr字符串从开始到后面的n个字符</span></span><br><span class="line">    str.<span class="built_in">insert</span>(<span class="number">10</span>,<span class="string">&quot;that is cool&quot;</span>,<span class="number">8</span>); </span><br><span class="line">    <span class="comment">//s.insert(pos,n,ch)在s.pos位置上面插入n个ch</span></span><br><span class="line">    str.<span class="built_in">insert</span>(<span class="number">15</span>,<span class="number">1</span>,<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">    <span class="comment">//s.insert(s.it,ch)在s的it指向位置前面插入一个字符ch，返回新插入的位置的迭代器</span></span><br><span class="line">    it = str.<span class="built_in">insert</span>(str.<span class="built_in">begin</span>()+<span class="number">5</span>,<span class="string">&#x27;,&#x27;</span>); <span class="comment">// to be, not to be: that is the question</span></span><br><span class="line">    <span class="comment">//s.insert(s.it,n,ch)//在s的it所指向位置的前面插入n个ch</span></span><br><span class="line">    str.<span class="built_in">insert</span> (str.<span class="built_in">end</span>(),<span class="number">3</span>,<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">    <span class="comment">//s.insert(it,str.ita,str.itb)在it所指向的位置的前面插入[ita,itb)的字符串</span></span><br><span class="line">    str.<span class="built_in">insert</span> (it+<span class="number">2</span>,str3.<span class="built_in">begin</span>(),str3.<span class="built_in">begin</span>()+<span class="number">3</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="map-unordered-map"><a href="#map-unordered-map" class="headerlink" title="map  &amp; unordered_map"></a>map  &amp; unordered_map</h3><p>map基于红黑树（或其他平衡二叉树）实现，所有元素按照key的大小有序存储。</p>
<p>unordered_map基于哈希表实现，元素按照哈希桶无序存储。</p>
<table>
<thead>
<tr>
<th>操作</th>
<th>map</th>
<th>unordered_map</th>
</tr>
</thead>
<tbody><tr>
<td>查找&#x2F;插入&#x2F;删除</td>
<td>O(logN)（严格）</td>
<td>平均O(1),最坏O(N)（哈希冲突）</td>
</tr>
</tbody></table>
<blockquote>
<p>如果对 key 的顺序有需求，或数据量不极端、性能要求严格稳定，就用 <code>map</code>。</p>
</blockquote>
<blockquote>
<p>如果数据随机分布、对遍历顺序无要求，希望获得极快的平均查找速度，可用 <code>unordered_map</code>，但要注意：</p>
<ol>
<li><strong>适当 <code>reserve</code></strong>：提前 <code>reserve(bucket_count)</code> 或 <code>max_load_factor</code> 来减少扩容；</li>
<li><strong>自定义哈希</strong>：在 CF 等平台上可用 <code>splitmix64</code> 等更安全的哈希函数，防止碰撞攻击。</li>
</ol>
</blockquote>
<h2 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h2><h3 id="重载运算符号（比较）"><a href="#重载运算符号（比较）" class="headerlink" title="重载运算符号（比较）"></a>重载运算符号（比较）</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 结构体</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">my</span>&#123;</span><br><span class="line">    <span class="type">int</span> l, r, index;</span><br><span class="line">    <span class="built_in">my</span>(<span class="type">int</span> a, <span class="type">int</span> b, <span class="type">int</span> c)&#123;</span><br><span class="line">        l = a, r = b, index = c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> my x) <span class="type">const</span> &#123;  </span><br><span class="line">            <span class="comment">// 优先队列中比较关系反着来</span></span><br><span class="line">            <span class="keyword">return</span> l &gt; x.l;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// lambda（示例为小根堆）</span></span><br><span class="line"><span class="keyword">auto</span> cmp = [](pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; x, pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; y) &#123;</span><br><span class="line">    <span class="keyword">return</span> x.second &gt; y.second;</span><br><span class="line">&#125;;</span><br><span class="line">priority_queue&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;, vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt;, <span class="keyword">decltype</span>(cmp)&gt; <span class="built_in">q</span>(cmp); </span><br></pre></td></tr></table></figure>

<h3 id="求最大的最小或者最小的最大问题"><a href="#求最大的最小或者最小的最大问题" class="headerlink" title="求最大的最小或者最小的最大问题"></a>求最大的最小或者最小的最大问题</h3><p>大概率是用二分来查询最合适的答案，具体算法看题</p>
<h3 id="圆周率-960"><a href="#圆周率-960" class="headerlink" title="圆周率&#960;"></a>圆周率&#960;</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">double</span> pi  =  <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br></pre></td></tr></table></figure>

<h3 id="求容器最大值"><a href="#求容器最大值" class="headerlink" title="求容器最大值"></a>求容器最大值</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*<span class="built_in">max_element</span>(vec.<span class="built_in">begin</span>(), vec.<span class="built_in">end</span>());</span><br></pre></td></tr></table></figure>

<h3 id="全排列"><a href="#全排列" class="headerlink" title="全排列"></a>全排列</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">std::string s = <span class="string">&quot;aba&quot;</span>; </span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">    std::cout &lt;&lt; s &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;<span class="keyword">while</span> (std::<span class="built_in">next_permutation</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">end</span>()));</span><br><span class="line">std::cout &lt;&lt; s &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="求二维平面上的三角形面积"><a href="#求二维平面上的三角形面积" class="headerlink" title="求二维平面上的三角形面积"></a>求二维平面上的三角形面积</h3><h4 id="给定三个顶点"><a href="#给定三个顶点" class="headerlink" title="给定三个顶点"></a>给定三个顶点</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">S = <span class="built_in">abs</span>(x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2)) / <span class="number">2</span>;</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line">S = <span class="built_in">abs</span>((x2 - x1) * (y3 - y1) - (x3 - x1) * (y2 - y1)) / <span class="number">2</span>;</span><br><span class="line"><span class="comment">// 两个参数相较于三个参数，有如下优势，可以取一个坐标为基准（2坐标与1坐标，3坐标与1坐标，每个参数都进行了一次碰面），进行点与点之间的逻辑处理，如判断处坐标异或值</span></span><br></pre></td></tr></table></figure>

<h4 id="给定三条边"><a href="#给定三条边" class="headerlink" title="给定三条边"></a>给定三条边</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = (a + b + c) / <span class="number">2</span>;</span><br><span class="line">S = <span class="built_in">sqrt</span>(p * (p -a ) * (p - b) * (p - c));</span><br></pre></td></tr></table></figure>

<h3 id="求三维空间中两条直线最短距离"><a href="#求三维空间中两条直线最短距离" class="headerlink" title="求三维空间中两条直线最短距离"></a>求三维空间中两条直线最短距离</h3><p><code>L1</code>经过<code>A(x1,  y1,  z1)</code>, <code>B(x2,  y2,  z2)</code></p>
<p><code>L2</code>经过<code> C(x3,  y3,  z3)</code>, <code>D(x4,  y4,  z4)</code></p>
<p><code>L1</code>的方向向量<code>d1 = B - A</code>, <code>L2</code>的方向向量<code>d2 = D - C</code></p>
<p><code>n = d1 * d2</code></p>
<p>如果n为0,则两直线平行</p>
<p>任选<code>L1</code>上的点A和<code>L2</code>上的点C，计算<code>AC = C - A</code></p>
<p>不平行时，两直线最短距离<code>d = |AC  .*  n| / |n|</code></p>
<p>平行时，<code>d = |AC * d1| / |d1|</code></p>
<hr>
<p>不平行情况<br>$$<br>若 \vec{d_1} \times \vec{d_2} \neq 0，则最短距离公式为<br>$$</p>
<p>$$<br>d &#x3D; \frac{\left| (C - A) \cdot \bigl(\vec{d_1} \times \vec{d_2}\bigr) \right|}{|\vec{d_1} \times \vec{d_2}|}.<br>$$</p>
<p>其中：<br>$$<br>(C - A) 表示向量，<br>\cdot 为点乘，<br>\times 为叉乘。<br>$$</p>
<p>$$<br>该公式的几何意义是：\vec{d_1} \times \vec{d_2} 垂直于两条直线，(C - A) 在此垂直方向上的投影长度即为两条直线的最短距离。<br>$$</p>
<p>平行情况<br>$$<br>若 \vec{d_1} \times \vec{d_2} &#x3D; 0，则说明两条直线平行或重合。此时最短距离可以由下式给出：<br>$$</p>
<p>$$<br>d &#x3D; \frac{|(C - A) \times \vec{d_1}|}{|\vec{d_1}|}.<br>$$</p>
<p>如果出现退化情况（例如 A&#x3D;B 或 C&#x3D;D），需要进一步做特殊处理。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fr first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sc second</span></span><br><span class="line"><span class="comment">// baidu 14 2</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">point</span>&#123;</span><br><span class="line">	<span class="type">double</span> x, y, z;</span><br><span class="line">	<span class="built_in">point</span>(<span class="type">double</span> x1 = <span class="number">0</span>, <span class="type">double</span> y1 = <span class="number">0</span>, <span class="type">double</span> z1 = <span class="number">0</span>): <span class="built_in">x</span>(x1), <span class="built_in">y</span>(y1), <span class="built_in">z</span>(z1) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cin.<span class="built_in">tie</span>(<span class="number">0</span>) -&gt; ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">	<span class="type">int</span> t = <span class="number">1</span>;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    <span class="keyword">while</span> (t--)&#123;</span><br><span class="line">    	<span class="type">double</span> x1, x2, x3, x4, y1, y2, y3, y4, z1, z2, z3, z4;</span><br><span class="line">    	cin &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; z1 &gt;&gt; x2 &gt;&gt; y2 &gt;&gt; z2 &gt;&gt; x3 &gt;&gt; y3 &gt;&gt; z3 &gt;&gt; x4 &gt;&gt; y4 &gt;&gt; z4;</span><br><span class="line">    	point a = point&#123;x1, y1, z1&#125;, b = &#123;x2, y2, z2&#125;, c = &#123;x3, y3, z3&#125;, d = &#123;x4, y4, z4&#125;;</span><br><span class="line">    	<span class="comment">// 向量减法：返回 b - a</span></span><br><span class="line">    	<span class="keyword">auto</span> vecSub = [](<span class="type">const</span> point &amp; a, <span class="type">const</span> point &amp; b) -&gt; point &#123;</span><br><span class="line">    		point temp = <span class="built_in">point</span>(b.x - a.x, b.y - a.y, b.z - a.z);</span><br><span class="line">    		<span class="keyword">return</span> temp;</span><br><span class="line">    	&#125;;</span><br><span class="line">    	<span class="comment">// 向量叉乘 (仅适用于 3D)</span></span><br><span class="line">    	<span class="keyword">auto</span> crossProduct = [](<span class="type">const</span> point &amp; a, <span class="type">const</span> point &amp; b) -&gt; point&#123;</span><br><span class="line">    		point temp = <span class="built_in">point</span>(a.y * b.z - a.z * b.y, a.z * b.x - a.x * b.z, a.x * b.y - a.y * b.x);</span><br><span class="line">    		<span class="keyword">return</span> temp;</span><br><span class="line">    	&#125;;</span><br><span class="line">    	<span class="comment">// 向量点乘</span></span><br><span class="line">    	<span class="keyword">auto</span> dotProduct = [](<span class="type">const</span> point &amp; a, <span class="type">const</span> point &amp; b) -&gt; <span class="type">double</span> &#123;</span><br><span class="line">    		<span class="keyword">return</span> a.x * b.x + a.y * b.y + a.z * b.z;</span><br><span class="line">    	&#125;;</span><br><span class="line">    	<span class="comment">// 向量的模长</span></span><br><span class="line">    	<span class="keyword">auto</span> norm = [](<span class="type">const</span> point &amp; a) -&gt; <span class="type">double</span> &#123;</span><br><span class="line">    		<span class="keyword">return</span> <span class="built_in">sqrt</span>(a.x * a.x + a.y * a.y + a.z * a.z);</span><br><span class="line">    	&#125;;</span><br><span class="line">    	point d1 = <span class="built_in">vecSub</span>(a, b), d2 = <span class="built_in">vecSub</span>(c, d); </span><br><span class="line">    	point n = <span class="built_in">crossProduct</span>(d1, d2);</span><br><span class="line">    	<span class="type">double</span> norm_n = <span class="built_in">norm</span>(n);</span><br><span class="line">    	point AC = <span class="built_in">vecSub</span>(c, a);</span><br><span class="line">    	<span class="type">double</span> distance = <span class="number">0.0</span>;</span><br><span class="line">    	<span class="comment">// 如果 n != 0，说明两条直线不平行</span></span><br><span class="line">    	<span class="keyword">if</span>(<span class="built_in">fabs</span>(norm_n) &gt; <span class="number">1e-12</span>)&#123;</span><br><span class="line">    		<span class="comment">// 最短距离公式: |(C - A) · (d1 x d2)| / ||d1 x d2||</span></span><br><span class="line">    		distance = <span class="built_in">fabs</span>(<span class="built_in">dotProduct</span>(AC, n)) / norm_n;</span><br><span class="line">    	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    		<span class="comment">// n = 0，说明两条直线平行或共线</span></span><br><span class="line">		    <span class="comment">// 使用平行直线距离公式: ||(C - A) x d1|| / ||d1||</span></span><br><span class="line">		    point temp1 = <span class="built_in">crossProduct</span>(AC, d1);</span><br><span class="line">		    <span class="type">double</span> norm_temp1 = <span class="built_in">norm</span>(temp1), norm_d1 = <span class="built_in">norm</span>(d1);</span><br><span class="line">		    <span class="keyword">if</span>(<span class="built_in">fabs</span>(norm_d1) &lt; <span class="number">1e-12</span>)&#123;</span><br><span class="line">		    	<span class="comment">// 若 d1Norm=0，说明 A、B 是同一点；若 d2Norm=0，C、D 同理。此时需特殊处理</span></span><br><span class="line">		    	<span class="type">double</span> norm_d2 = <span class="built_in">norm</span>(d2);</span><br><span class="line">		    	<span class="keyword">if</span>(<span class="built_in">fabs</span>(norm_d2) &lt; <span class="number">1e-12</span>)&#123;</span><br><span class="line">		    		<span class="comment">// 两条“直线”都是点，计算 A 到 C 的距离</span></span><br><span class="line">		    		distance = <span class="built_in">sqrt</span>(<span class="built_in">pow</span>(a.x - c.x, <span class="number">2</span>) + <span class="built_in">pow</span>(a.y - c.y, <span class="number">2</span>) + <span class="built_in">pow</span>(a.z - c.z, <span class="number">2</span>));</span><br><span class="line">;		    	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		    		<span class="comment">// 只需计算点 A 到直线 CD 的距离</span></span><br><span class="line">	                <span class="comment">// 距离 = ||(C - A) x d2|| / ||d2||</span></span><br><span class="line">	                point temp2 = <span class="built_in">crossProduct</span>(AC, d2);</span><br><span class="line">	                distance = <span class="built_in">norm</span>(temp2) / <span class="built_in">norm</span>(d2);</span><br><span class="line">		    	&#125;</span><br><span class="line">		    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		    	distance = <span class="built_in">norm</span>(temp1) / <span class="built_in">norm</span>(d1);</span><br><span class="line">		    &#125;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">&quot;%.3lf\n&quot;</span>, distance);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="GCD数量级"><a href="#GCD数量级" class="headerlink" title="GCD数量级"></a>GCD数量级</h3><p>一个数组的GCD前缀不同种类是log级别的，可通过此题进行进一步了解和体会<a target="_blank" rel="noopener" href="https://codeforces.com/gym/105386/problem/E">2024ICPCKunming</a></p>
<h3 id="点到直线的距离公式"><a href="#点到直线的距离公式" class="headerlink" title="点到直线的距离公式"></a>点到直线的距离公式</h3><p><strong>设：</strong><br>$$<br>P(x_0,,y_0)<br>$$<br> 为平面上一点，<br>直线 L 的方程为<br>$$<br>A x + B y + C &#x3D; 0.<br>$$</p>
<p>则P到直线L的距离d为<br>$$<br>d &#x3D; \frac{|,A x_0 + B y_0 + C,|}{\sqrt{A^2 + B^2}}.<br>$$</p>
<h3 id="随机数"><a href="#随机数" class="headerlink" title="随机数"></a>随机数</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">srand</span>((<span class="type">unsigned</span>)<span class="built_in">time</span>(<span class="literal">NULL</span>));</span><br><span class="line">cout &lt;&lt; (<span class="built_in">rand</span>()) % <span class="number">17</span>;</span><br></pre></td></tr></table></figure>

<h3 id="完全平方数"><a href="#完全平方数" class="headerlink" title="完全平方数"></a>完全平方数</h3><p>一个数为完全平方数当且仅当该分解后该数所有质因数个数均为偶数</p>
<h3 id="随机哈希编码"><a href="#随机哈希编码" class="headerlink" title="随机哈希编码"></a>随机哈希编码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">mt19937_64 <span class="title">rng</span><span class="params">(chrono::steady_clock::now().time_since_epoch().count())</span></span>;</span><br><span class="line"><span class="type">int</span> a_hash = <span class="built_in">rng</span>();</span><br></pre></td></tr></table></figure>

<h3 id="批量操作"><a href="#批量操作" class="headerlink" title="批量操作"></a>批量操作</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a[<span class="number">5</span>];</span><br><span class="line"><span class="comment">// 连续填充</span></span><br><span class="line"><span class="built_in">iota</span>(a, a + <span class="number">5</span>, <span class="number">1</span>);  <span class="comment">// a = &#123;1, 2, 3, 4, 5&#125;</span></span><br><span class="line"><span class="comment">// 适合设置为0、-1、255（即所有字节一致的值）</span></span><br><span class="line"><span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="built_in">sizeof</span>(a));  <span class="comment">// 将数组 a 中的所有字节设为 0</span></span><br><span class="line"><span class="comment">// 支持所有基础类型和STL容器</span></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line"><span class="built_in">fill</span>(a, a + <span class="number">5</span>, <span class="number">42</span>);  <span class="comment">// a = &#123;42, 42, 42, 42, 42&#125;</span></span><br><span class="line"><span class="built_in">fill</span>(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>(), <span class="number">42</span>);</span><br></pre></td></tr></table></figure>

<h3 id="lower-bound-upper-bound"><a href="#lower-bound-upper-bound" class="headerlink" title="lower_bound &amp; upper_bound"></a>lower_bound &amp; upper_bound</h3><p>ower_bound( )和upper_bound( )都是利用二分查找的方法在一个排好序的数组中进行查找的。</p>
<p>在从小到大的排序数组中，</p>
<ul>
<li><p><code>lower_bound(begin, end, value)</code></p>
<p>  返回<strong>第一个 ≥ value 的位置</strong></p>
</li>
<li><p><code>upper_bound(begin, end, value)</code><br>  返回<strong>第一个 &gt; value 的位置</strong></p>
</li>
</ul>
<p>在从小到大的排序数组中，</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; v = &#123;<span class="number">-1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">34</span>&#125;;</span><br><span class="line">    <span class="built_in">sort</span>(v.<span class="built_in">begin</span>() + <span class="number">1</span>, v.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> pos1 = <span class="built_in">lower_bound</span>(v.<span class="built_in">begin</span>() + <span class="number">1</span>, v.<span class="built_in">end</span>(), <span class="number">7</span>) - v.<span class="built_in">begin</span>();</span><br><span class="line">    <span class="type">int</span> pos2 = <span class="built_in">upper_bound</span>(v.<span class="built_in">begin</span>() + <span class="number">1</span>, v.<span class="built_in">end</span>(), <span class="number">7</span>) - v.<span class="built_in">begin</span>();</span><br><span class="line">    cout &lt;&lt; pos1 &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; v[pos1] &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; pos2 &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; v[pos2] &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">sort</span>(v.<span class="built_in">begin</span>() + <span class="number">1</span>, v.<span class="built_in">end</span>(), <span class="built_in">greater</span>&lt;<span class="type">int</span>&gt;());</span><br><span class="line">    <span class="type">int</span> pos3 = <span class="built_in">lower_bound</span>(v.<span class="built_in">begin</span>() + <span class="number">1</span>, v.<span class="built_in">end</span>(), <span class="number">7</span>, <span class="built_in">greater</span>&lt;<span class="type">int</span>&gt;()) - v.<span class="built_in">begin</span>();</span><br><span class="line">    <span class="type">int</span> pos4 = <span class="built_in">upper_bound</span>(v.<span class="built_in">begin</span>() + <span class="number">1</span>, v.<span class="built_in">end</span>(), <span class="number">7</span>, <span class="built_in">greater</span>&lt;<span class="type">int</span>&gt;()) - v.<span class="built_in">begin</span>();</span><br><span class="line">    cout &lt;&lt; pos3 &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; v[pos3] &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; pos4 &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; v[pos4] &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="折尺定理"><a href="#折尺定理" class="headerlink" title="折尺定理"></a>折尺定理</h3><p>一堆有各自长度($a_{1},a_{2},a_{3} \dots$)木棍能否连接在两个点上，取决于是否$L_{\min}\le D\le L_{\max}$,其中，$L_{\max} &#x3D; \sum_{i &#x3D; 1}^{n}a_{i} $ ,$L_{\min} &#x3D; max(0, 2 * a_{\max} - L_{\max})$，D为两点间距离</p>
<h3 id="两两绝对值求和"><a href="#两两绝对值求和" class="headerlink" title="两两绝对值求和"></a>两两绝对值求和</h3><p>当你把一组数排序后，对所有「两两差的绝对值之和」$\sum_{0\le p&lt;q\le n} |a_q - a_p|$ 有一个经典结论：</p>
<p>$\sum_{0 \le p &lt; q \le n} (a_q - a_p)&#x3D; \sum_{k&#x3D;0}^n a_k (k - (n-k))$</p>
<p>这是因为：</p>
<ul>
<li><p>对于固定的$a_k$，它作为“右端” $q_{q}$ 的时候，会和前面所有 k 个更小的数 $a_0,\dots,a_{k-1}$ 相减，累计贡献</p>
<p>  $\displaystyle +,a_k\times k$。</p>
</li>
<li><p>同时它也会作为“左端” $a_p$ 被后面所有 (n−k) 个更大的数 $a_{k+1},\dots,a_n$相减，贡献</p>
<p>  $-,a_k\times (n - k)$。</p>
</li>
<li><p>合并起来，就是</p>
<p>  $a_k(k−(n−k))&#x3D;a_k(2k−n).$</p>
</li>
</ul>
<p>注意这里不需要再写绝对值了，因为排序保证了“后者减前者”总是非负的。</p>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/tengfei461807914/article/details/52203202">字符串 CSDN</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/algorithmzuo/algorithm-journey">左程云</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/duiwangxiaomi/article/details/104288351">三角形面积</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40160605/article/details/80150252">lower_bound &amp; upper_bound</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>请我一杯咖啡吧！</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/p2.png" alt="jiangshun 比特币">
        <span>比特币</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>jiangshun
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://liujunhong2.github.io/algorithm.html" title="algorithm">https://liujunhong2.github.io/algorithm.html</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/algorithm/" rel="tag"># algorithm</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/cycle.html" rel="prev" title="cycle">
                  <i class="fa fa-angle-left"></i> cycle
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/%E8%B4%B4%E8%BA%AB%E4%BF%9D%E9%95%96.html" rel="next" title="贴身保镖">
                  贴身保镖 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">jiangshun</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">27k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">1:39</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
